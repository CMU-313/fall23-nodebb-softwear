<!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <script>
      /*! For license information please see mutation-test-elements.js.LICENSE.txt */
!function(){var t={3704:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o),a=r(8991),l=r.n(a),c=new URL(r(9138),r.b),u=new URL(r(3783),r.b),d=s()(i()),h=l()(c),p=l()(u);d.push([t.id,":host(:not([theme=dark])){--prism-maintext:#393a34;--prism-background:#f6f8fa;--prism-border:#ddd;--prism-cdata:#998;--prism-comment:var(--prism-cdata);--prism-doctype:var(--prism-cdata);--prism-prolog:var(--prism-cdata);--prism-attr-value:#e3116c;--prism-string:var(--prism-attr-value);--prism-boolean:#36acaa;--prism-entity:var(--prism-boolean);--prism-url:var(--prism-boolean);--prism-constant:var(--prism-boolean);--prism-inserted:var(--prism-boolean);--prism-number:var(--prism-boolean);--prism-property:var(--prism-boolean);--prism-regex:var(--prism-boolean);--prism-symbol:var(--prism-boolean);--prism-variable:var(--prism-boolean);--prism-atrule:#00a4db;--prism-attr-name:var(--prism-atrule);--prism-attr:var(--prism-atrule);--prism-operator:var(--prism-maintext);--prism-punctuation:var(--prism-maintext);--prism-deleted:#9a050f;--prism-function:var(--prism-deleted);--prism-function-variable:#6f42c1;--prism-selector:#00009f;--prism-tag:var(--prism-selector);--prism-keyword:var(--prism-selector)}:host([theme=dark]){--prism-maintext:#d3d0c8;--prism-background:#1d1f21;--prism-border:rgb(var(--mut-gray-200));--prism-cdata:#7c7c7c;--prism-comment:var(--prism-cdata);--prism-doctype:var(--prism-cdata);--prism-prolog:var(--prism-cdata);--prism-punctuation:#c5c8c6;--prism-tag:#96cbfe;--prism-property:var(--prism-tag);--prism-keyword:var(--prism-tag);--prism-class-name:#ffffb6;--prism-boolean:#9c9;--prism-constant:var(--prism-boolean);--prism-symbol:#f92672;--prism-deleted:var(--prism-symbol);--prism-number:#ff73fd;--prism-inserted:#a8ff60;--prism-selector:var(--prism-inserted);--prism-attr-name:var(--prism-inserted);--prism-string:var(--prism-inserted);--prism-char:var(--prism-inserted);--prism-builtin:var(--prism-inserted);--prism-variable:#c6c5fe;--prism-operator:#ededed;--prism-entity:#ffffb6;--prism-url:#96cbfe;--prism-attr-value:#f9ee98;--prism-atrule:var(--prism-attr-value);--prism-function:#dad085;--prism-regex:#e9c062;--prism-important:#fd971f}:host(:not([theme=dark])){--mut-file-ts-color:#498ba7;--mut-file-ts-test-color:#b7b73b;--mut-file-scala-color:#b8383d;--mut-file-java-color:#b8383d;--mut-file-js-color:#b7b73b;--mut-file-js-test-color:#cc6d2e;--mut-file-php-color:#9068b0;--mut-file-html-color:#498ba7;--mut-file-csharp-color:#498ba7;--mut-file-vue-color:#7fae42;--mut-file-gherkin-color:#00a818}:host([theme=dark]){--mut-file-ts-color:#519aba;--mut-file-ts-test-color:#cbcb41;--mut-file-scala-color:#cc3e44;--mut-file-java-color:#cc3e44;--mut-file-js-color:#cbcb41;--mut-file-js-test-color:#e37933;--mut-file-php-color:#a074c4;--mut-file-html-color:#519aba;--mut-file-csharp-color:#519aba;--mut-file-vue-color:#8dc149;--mut-file-gherkin-color:#10b828}:host(:not([theme=dark])){--mut-gray-bg:rgb(var(--mut-white,255 255 255)/1);--mut-octicon-icon-color:#498ba7;--mut-line-number:#6e7781;--mut-diff-add-bg:#e6ffec;--mut-diff-add-bg-line-number:#ccffd8;--mut-diff-add-line-number:#24292f;--mut-diff-del-bg:#ffebe9;--mut-diff-del-bg-line-number:#ffd7d5;--mut-diff-del-line-number:var(--mut-diff-add-line-number);--mut-badge-info-bg:#54c6ec;--mut-badge-info:#212529;--mut-code-lense:#919191;--mut-squiggly-Survived:url("+h+");--mut-squiggly-NoCoverage:url("+p+");--mut-body-bg:#fff}:host([theme=dark]){--mut-gray-50:24 24 27;--mut-gray-100:39 39 42;--mut-gray-200:63 63 70;--mut-gray-300:82 82 91;--mut-gray-400:113 113 122;--mut-gray-500:161 161 170;--mut-gray-600:212 212 216;--mut-gray-700:228 228 231;--mut-gray-800:244 244 245;--mut-gray-900:250 250 250;--mut-primary-100:7 89 133;--mut-primary-800:224 242 254;--mut-primary-900:240 249 255;--mut-primary-on:14 165 233;--mut-body-bg:#18181b;--mut-white:var(--mut-gray-50);--mut-octicon-icon-color:#519aba;--mut-line-number:#484f58;--mut-diff-add-bg:rgba(46,160,67,.15);--mut-diff-add-bg-line-number:rgba(63,185,80,.3);--mut-diff-add-line-number:#c9d1d9;--mut-diff-del-bg:rgba(248,81,73,.15);--mut-diff-del-bg-line-number:rgba(248,81,73,.3);--mut-diff-del-line-number:#c9d1d9;--mut-badge-info-bg:#17a3b8;--mut-badge-info:#fff;--mut-code-lense:#999;--mut-squiggly-Survived:url("+h+");--mut-squiggly-NoCoverage:url("+p+");color-scheme:dark}",""]),e.Z=d},9483:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,":host([mode=closed]){height:0}:host([mode=half]){height:120px}:host([mode=open]){height:50%}:host([mode=open]) .scrollable{height:100%;overflow-x:hidden;overflow-y:auto}",""]),e.Z=s},8847:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,"svg.cs{fill:var(--mut-file-csharp-color)}svg.html{fill:var(--mut-file-html-color)}svg.java{fill:var(--mut-file-java-color)}svg.javascript{fill:var(--mut-file-js-color)}svg.scala{fill:var(--mut-file-scala-color)}svg.typescript{fill:var(--mut-file-ts-color)}svg.php{fill:var(--mut-file-php-color)}svg.vue{fill:var(--mut-file-vue-color)}svg.octicon{fill:var(--mut-octicon-icon-color)}svg.javascript.test,svg.typescript.test{fill:var(--mut-file-js-test-color)}svg.gherkin{fill:var(--mut-file-gherkin-color)}svg{vertical-align:middle;width:20px}",""]),e.Z=s},5545:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,'#report-code-block{background:var(--prism-background);border:1px solid var(--prism-border);overflow-x:auto;overflow-y:visible}.line-numbers{counter-reset:mte-line-number}.line .line-number{color:var(--mut-line-number);counter-increment:mte-line-number;padding:0 10px 0 15px;text-align:right}.line .line-number:before{content:counter(mte-line-number)}.line-marker:before{content:" ";padding:0 5px}.mte-selected-Pending .mutant.Pending{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.Pending{fill:#a3a3a3}.mte-selected-Killed .mutant.Killed{border-bottom:2px solid;border-color:#16a34a;cursor:pointer}svg.mutant-dot.Killed{fill:#16a34a}svg.mutant-dot.NoCoverage{fill:#f97316}svg.mutant-dot.Survived{fill:#ef4444}.mte-selected-Timeout .mutant.Timeout{border-bottom:2px solid;border-color:#fbbf24;cursor:pointer}svg.mutant-dot.Timeout{fill:#fbbf24}.mte-selected-CompileError .mutant.CompileError{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.CompileError{fill:#a3a3a3}.mte-selected-RuntimeError .mutant.RuntimeError{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.RuntimeError{fill:#a3a3a3}.mte-selected-Ignored .mutant.Ignored{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.Ignored{fill:#a3a3a3}svg.mutant-dot.selected{fill:#38bdf8}.mte-selected-Survived .mutant.Survived{border-bottom-style:solid;border-image-outset:6px;border-image-repeat:repeat;border-image-slice:0 0 4 0;border-image-source:var(--mut-squiggly-Survived);border-image-width:4px;cursor:pointer}.mte-selected-Survived .mutant.Survived .mutant.NoCoverage,.mte-selected-Survived .mutant.Survived .mutant.Survived{border-bottom-style:none;-o-border-image:none;border-image:none}.mte-selected-NoCoverage .mutant.NoCoverage{border-bottom-style:solid;border-image-outset:6px;border-image-repeat:repeat;border-image-slice:0 0 4 0;border-image-source:var(--mut-squiggly-NoCoverage);border-image-width:4px;cursor:pointer}.mte-selected-NoCoverage .mutant.NoCoverage .mutant.NoCoverage,.mte-selected-NoCoverage .mutant.NoCoverage .mutant.Survived{border-bottom-style:none;-o-border-image:none;border-image:none}.mutant-dot{cursor:pointer}svg.mutant-dot{margin:2px}.diff-old{background-color:var(--mut-diff-del-bg)}.diff-focus{background-color:var(--mut-diff-add-bg-line-number)}.diff-old .line-number{background-color:var(--mut-diff-del-bg-line-number);color:var(--mut-diff-del-line-number)}.diff-old .line-marker:before{content:"-"}.diff-new{background-color:var(--mut-diff-add-bg)}.diff-new .empty-line-number{background-color:var(--mut-diff-add-bg-line-number);color:var(--mut-diff-add-line-number)}.diff-new .line-marker:before{content:"+"}',""]),e.Z=s},3813:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,"main{padding-bottom:120px}",""]),e.Z=s},1276:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,".step-button{--tw-bg-opacity:1;--tw-text-opacity:1;align-items:center;background-color:rgb(var(--mut-primary-600,2 132 199)/var(--tw-bg-opacity));border-radius:.375rem;color:rgb(var(--mut-white,255 255 255)/var(--tw-text-opacity));display:inline-flex;margin-right:.5rem;padding:.25rem;text-align:center}.step-button:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-primary-700,3 105 161)/var(--tw-bg-opacity))}.step-button:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);--tw-ring-opacity:1;--tw-ring-color:rgb(var(--mut-primary-500,14 165 233)/var(--tw-ring-opacity));box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);outline:2px solid transparent;outline-offset:2px}",""]),e.Z=s},5110:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,'#report-code-block{background:var(--prism-background);border:1px solid var(--prism-border);overflow-x:auto;overflow-y:visible}.line-numbers{counter-reset:mte-line-number}.line .line-number{color:var(--mut-line-number);counter-increment:mte-line-number;padding:0 10px 0 15px;text-align:right}.line .line-number:before{content:counter(mte-line-number)}.line-marker:before{content:" ";padding:0 5px}svg.test-dot.Killing{fill:#15803d}svg.test-dot.Covering{fill:#fbbf24}svg.test-dot.NotCovering{fill:#f97316}svg.test-dot.selected{fill:#38bdf8}svg.test-dot{margin:2px}',""]),e.Z=s},9827:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,"main{padding-bottom:120px}",""]),e.Z=s},4835:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,'#darkTheme{position:absolute;right:100vw}#darkTheme+label{--i:0;--j:calc(1 - var(--i));grid-gap:.15em .06em;background:hsl(199,98%,calc(var(--j)*48%));border-radius:.75em;color:transparent;cursor:pointer;display:grid;height:1.5em;overflow:hidden;padding:.15em;transition:.3s;-webkit-user-select:none;user-select:none}#darkTheme+label:after,#darkTheme+label:before{content:"";height:1.2em;transition:inherit;width:1.2em}#darkTheme+label:before{--poly:polygon(44.133707561% 12.9616872277%,50% 0%,55.866292439% 12.9616872277%,59.7057141913% 13.7777815142%,63.4387981079% 14.9907340064%,67.0246437402% 16.5872553429%,79.3892626146% 9.5491502813%,76.5165042945% 23.4834957055%,79.1429735546% 26.4004853356%,81.450146298% 29.5760361869%,83.4127446571% 32.9753562598%,97.5528258148% 34.5491502813%,87.0383127723% 44.133707561%,87.4486075533% 48.0374016409%,87.4486075533% 51.9625983591%,87.0383127723% 55.866292439%,97.5528258148% 65.4508497187%,83.4127446571% 67.0246437402%,81.450146298% 70.4239638131%,79.1429735546% 73.5995146644%,76.5165042945% 76.5165042945%,79.3892626146% 90.4508497187%,67.0246437402% 83.4127446571%,63.4387981079% 85.0092659936%,59.7057141913% 86.2222184858%,55.866292439% 87.0383127723%,50% 100%,44.133707561% 87.0383127723%,40.2942858087% 86.2222184858%,36.561201892% 85.0092659936%,32.9753562598% 83.4127446571%,20.6107373854% 90.4508497187%,23.4834957055% 76.5165042945%,20.8570264454% 73.5995146644%,18.5498537021% 70.4239638131%,16.587255343% 67.0246437402%,2.4471741856% 65.4508497188%,12.9616872286% 55.8662924391%,12.5513924487% 51.9625983594%,12.5513924508% 48.0374016414%,12.961687236% 44.1337075622%,2.4471742159% 34.5491502859%,16.587255404% 32.9753562694%,18.5498538164% 29.5760362054%,20.8570266557% 26.4004853707%,23.4834960862% 23.4834957706%,20.6107385856% 9.5491504949%,32.97535832% 16.5872557238%,36.5612054098% 14.9907346728%,40.2942917387% 13.7777826649%);background:#ff0;-webkit-clip-path:var(--poly);clip-path:var(--poly);transform:translate(calc(var(--i)*(100% + .06em))) scale(calc(1 - var(--i)*.8));transform-origin:20% 20%}#darkTheme+label:after{background:radial-gradient(circle at 19% 19%,transparent 41%,#fff 43%);border-radius:50%;grid-column:2;transform:translatey(calc(var(--i)*(-130% - .15em)))}#darkTheme:checked+label{--i:1}.check-box-container{width:2.9em}',""]),e.Z=s},5043:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,"",""]),e.Z=s},6773:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o),a=r(5863),l=r(4911),c=s()(i());c.i(a.Z),c.i(l.Z),c.push([t.id,"",""]),e.Z=c},7063:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o),a=r(8991),l=r.n(a),c=new URL(r(6526),r.b),u=new URL(r(1716),r.b),d=new URL(r(4995),r.b),h=new URL(r(421),r.b),p=s()(i()),f=l()(c),m=l()(u),g=l()(d),v=l()(h);p.push([t.id,'/*! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com*/*,:after,:before{border-color:rgb(var(--mut-gray-200,228 228 231)/1);border-style:solid;border-width:0;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:rgb(var(--mut-gray-400,161 161 170)/1);opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}[multiple],[type=date],[type=datetime-local],[type=email],[type=month],[type=number],[type=password],[type=search],[type=tel],[type=text],[type=time],[type=url],[type=week],input:where(:not([type])),select,textarea{--tw-shadow:0 0 #0000;-webkit-appearance:none;appearance:none;background-color:#fff;border-color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-border-opacity,1));border-radius:0;border-width:1px;font-size:1rem;line-height:1.5rem;padding:.5rem .75rem}[multiple]:focus,[type=date]:focus,[type=datetime-local]:focus,[type=email]:focus,[type=month]:focus,[type=number]:focus,[type=password]:focus,[type=search]:focus,[type=tel]:focus,[type=text]:focus,[type=time]:focus,[type=url]:focus,[type=week]:focus,input:where(:not([type])):focus,select:focus,textarea:focus{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);border-color:#2563eb;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}input::placeholder,textarea::placeholder{color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-text-opacity,1));opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em}::-webkit-datetime-edit,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-meridiem-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-year-field{padding-bottom:0;padding-top:0}select{background-image:url('+f+');background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem;-webkit-print-color-adjust:exact;print-color-adjust:exact}[multiple],[size]:where(select:not([size="1"])){background-image:none;background-position:0 0;background-repeat:unset;background-size:initial;padding-right:.75rem;-webkit-print-color-adjust:unset;print-color-adjust:unset}[type=checkbox],[type=radio]{--tw-shadow:0 0 #0000;-webkit-appearance:none;appearance:none;background-color:#fff;background-origin:border-box;border-color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-border-opacity,1));border-width:1px;color:#2563eb;display:inline-block;flex-shrink:0;height:1rem;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;-webkit-user-select:none;user-select:none;vertical-align:middle;width:1rem}[type=checkbox]{border-radius:0}[type=radio]{border-radius:100%}[type=checkbox]:focus,[type=radio]:focus{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:2px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}[type=checkbox]:checked,[type=radio]:checked{background-color:currentColor;background-position:50%;background-repeat:no-repeat;background-size:100% 100%;border-color:transparent}[type=checkbox]:checked{background-image:url('+m+")}[type=radio]:checked{background-image:url("+g+")}[type=checkbox]:checked:focus,[type=checkbox]:checked:hover,[type=radio]:checked:focus,[type=radio]:checked:hover{background-color:currentColor;border-color:transparent}[type=checkbox]:indeterminate{background-color:currentColor;background-image:url("+v+");background-position:50%;background-repeat:no-repeat;background-size:100% 100%;border-color:transparent}[type=checkbox]:indeterminate:focus,[type=checkbox]:indeterminate:hover{background-color:currentColor;border-color:transparent}[type=file]{background:unset;border-color:inherit;border-radius:0;border-width:0;font-size:unset;line-height:inherit;padding:0}[type=file]:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{margin-left:auto;margin-right:auto;width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}@media (min-width:2000px){.container{max-width:2000px}}.sr-only{clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.bottom-0{bottom:0}.left-0{left:0}.top-0{top:0}.top-offset{top:var(--top-offset,0)}.z-10{z-index:10}.z-20{z-index:20}.float-right{float:right}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-6{margin-left:1.5rem;margin-right:1.5rem}.my-3{margin-bottom:.75rem;margin-top:.75rem}.my-4{margin-bottom:1rem;margin-top:1rem}.-mb-px{margin-bottom:-1px}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.mr-12{margin-right:3rem}.mr-2{margin-right:.5rem}.mr-3{margin-right:.75rem}.mr-4{margin-right:1rem}.mr-6{margin-right:1.5rem}.mr-auto{margin-right:auto}.ms-3{-webkit-margin-start:.75rem;margin-inline-start:.75rem}.mt-2{margin-top:.5rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.h-2{height:.5rem}.h-3{height:.75rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-8{height:2rem}.w-12{width:3rem}.w-24{width:6rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-full{width:100%}.min-w-\\[24px\\]{min-width:24px}.max-w-6xl{max-width:72rem}.table-auto{table-layout:auto}.rotate-180{--tw-rotate:180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-help{cursor:help}.cursor-pointer{cursor:pointer}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.gap-4{gap:1rem}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-divide-opacity))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-t-3xl{border-top-left-radius:1.5rem;border-top-right-radius:1.5rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-none{border-style:none}.border-gray-200{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-border-opacity))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-border-opacity))}.border-primary-600{--tw-border-opacity:1;border-color:rgb(var(--mut-primary-600,2 132 199)/var(--tw-border-opacity))}.border-transparent{border-color:transparent}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.bg-gray-200\\/60{background-color:rgb(var(--mut-gray-200,228 228 231)/.6)}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74/var(--tw-bg-opacity))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213/var(--tw-bg-opacity))}.bg-primary-100{--tw-bg-opacity:1;background-color:rgb(var(--mut-primary-100,224 242 254)/var(--tw-bg-opacity))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226/var(--tw-bg-opacity))}.bg-red-600{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(var(--mut-white,255 255 255)/var(--tw-bg-opacity))}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195/var(--tw-bg-opacity))}.bg-yellow-400{--tw-bg-opacity:1;background-color:rgb(250 204 21/var(--tw-bg-opacity))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4/var(--tw-bg-opacity))}.p-1{padding:.25rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\\.5{padding-left:.625rem;padding-right:.625rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0{padding-bottom:0;padding-top:0}.py-0\\.5{padding-bottom:.125rem;padding-top:.125rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-6{padding-bottom:1.5rem;padding-top:1.5rem}.pb-4{padding-bottom:1rem}.pl-1{padding-left:.25rem}.pr-2{padding-right:.5rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-5xl{font-size:3rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.font-semibold{font-weight:600}.tracking-tight{letter-spacing:-.025em}.text-gray-200{--tw-text-opacity:1;color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(var(--mut-gray-600,82 82 91)/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(var(--mut-gray-700,63 63 70)/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(var(--mut-gray-800,39 39 42)/var(--tw-text-opacity))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61/var(--tw-text-opacity))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52/var(--tw-text-opacity))}.text-orange-800{--tw-text-opacity:1;color:rgb(154 52 18/var(--tw-text-opacity))}.text-primary-800{--tw-text-opacity:1;color:rgb(var(--mut-primary-800,7 89 133)/var(--tw-text-opacity))}.text-primary-on{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28/var(--tw-text-opacity))}.text-red-800{--tw-text-opacity:1;color:rgb(153 27 27/var(--tw-text-opacity))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4/var(--tw-text-opacity))}.text-yellow-800{--tw-text-opacity:1;color:rgb(133 77 14/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.decoration-dotted{text-decoration-style:dotted}.opacity-0{opacity:0}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.\\!ring-offset-gray-200{--tw-ring-offset-color:rgb(var(--mut-gray-200,228 228 231)/1)!important}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-lg{--tw-backdrop-blur:blur(16px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.after\\:text-gray-800:after{--tw-text-opacity:1;color:rgb(var(--mut-gray-800,39 39 42)/var(--tw-text-opacity));content:var(--tw-content)}.after\\:content-\\[\\'\\/\\'\\]:after{--tw-content:\"/\";content:var(--tw-content)}.even\\:bg-gray-100:nth-child(2n),.odd\\:bg-gray-100:nth-child(odd){--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.hover\\:cursor-pointer:hover{cursor:pointer}.hover\\:border-gray-300:hover{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-border-opacity))}.hover\\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.hover\\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.hover\\:text-gray-700:hover{--tw-text-opacity:1;color:rgb(var(--mut-gray-700,63 63 70)/var(--tw-text-opacity))}.hover\\:text-gray-900:hover{--tw-text-opacity:1;color:rgb(var(--mut-gray-900,24 24 27)/var(--tw-text-opacity))}.hover\\:text-primary-on:hover{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}.hover\\:underline:hover{text-decoration-line:underline}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\\:ring-primary-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(var(--mut-primary-500,14 165 233)/var(--tw-ring-opacity))}.active\\:bg-gray-200:active,.group:hover .group-hover\\:bg-gray-200{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.aria-selected\\:border-b-\\[3px\\][aria-selected=true]{border-bottom-width:3px}.aria-selected\\:border-primary-700[aria-selected=true]{--tw-border-opacity:1;border-color:rgb(var(--mut-primary-700,3 105 161)/var(--tw-border-opacity))}.aria-selected\\:text-primary-on[aria-selected=true]{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}@media (prefers-reduced-motion:no-preference){.motion-safe\\:transition-\\[height\\2c max-width\\]{transition-duration:.15s;transition-property:height,max-width;transition-timing-function:cubic-bezier(.4,0,.2,1)}.motion-safe\\:transition-max-width{transition-duration:.15s;transition-property:max-width;transition-timing-function:cubic-bezier(.4,0,.2,1)}.motion-safe\\:duration-200{transition-duration:.2s}}@media (min-width:768px){.md\\:ml-2{margin-left:.5rem}.md\\:after\\:pl-1:after{content:var(--tw-content);padding-left:.25rem}}@media (min-width:1536px){.\\32xl\\:w-28{width:7rem}}",""]),e.Z=p},4911:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,'pre[class*="language-"].line-numbers {\n\tposition: relative;\n\tpadding-left: 3.8em;\n\tcounter-reset: linenumber;\n}\n\npre[class*="language-"].line-numbers > code {\n\tposition: relative;\n\twhite-space: inherit;\n}\n\n.line-numbers .line-numbers-rows {\n\tposition: absolute;\n\tpointer-events: none;\n\ttop: 0;\n\tfont-size: 100%;\n\tleft: -3.8em;\n\twidth: 3em; /* works for line-numbers below 1000 lines */\n\tletter-spacing: -1px;\n\tborder-right: 1px solid #999;\n\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n\n}\n\n\t.line-numbers-rows > span {\n\t\tdisplay: block;\n\t\tcounter-increment: linenumber;\n\t}\n\n\t\t.line-numbers-rows > span:before {\n\t\t\tcontent: counter(linenumber);\n\t\t\tcolor: #999;\n\t\t\tdisplay: block;\n\t\t\tpadding-right: 0.8em;\n\t\t\ttext-align: right;\n\t\t}\n',""]),e.Z=s},5863:function(t,e,r){"use strict";var n=r(9601),i=r.n(n),o=r(2609),s=r.n(o)()(i());s.push([t.id,"/**\n * GHColors theme by Avi Aryan (http://aviaryan.in)\n * Inspired by Github syntax coloring\n */\n\ncode[class*='language-'],\npre[class*='language-'] {\n  color: var(--prism-maintext);\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  direction: ltr;\n  font-size: 1em;\n  text-align: left;\n  white-space: pre;\n  word-spacing: normal;\n  word-break: normal;\n  line-height: 1.5;\n\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n\npre > code[class*='language-'] {\n  font-size: 1em;\n}\n\n/* Code blocks */\npre[class*='language-'] {\n  padding: 1em;\n  margin: 0.5em 0;\n  overflow: auto;\n  border: 1px solid var(--prism-border);\n  border-radius: 0.25rem;\n}\n\n:not(pre) > code[class*='language-'],\npre[class*='language-'] {\n  background: var(--prism-background);\n}\n\n.token.comment,\n.token.prolog,\n.token.doctype,\n.token.italic,\n.token.cdata {\n  font-style: italic;\n}\n\n.token.important,\n.token.function,\n.token.bold {\n  font-weight: bold;\n}\n\n.token.namespace {\n  opacity: 0.7;\n}\n\n.token.atrule {\n  color: var(--prism-atrule);\n}\n.token.attr {\n  color: var(--prism-attr);\n}\n.token.attr-name {\n  color: var(--prism-attr-name);\n}\n.token.boolean {\n  color: var(--prism-boolean);\n}\n.token.builtin {\n  color: var(--prism-builtin);\n}\n.token.cdata {\n  color: var(--prism-cdata);\n}\n.token.changed {\n  color: var(--prism-changed);\n}\n.token.char {\n  color: var(--prism-char);\n}\n.token.comment {\n  color: var(--prism-comment);\n}\n.token.constant {\n  color: var(--prism-constant);\n}\n.token.deleted {\n  color: var(--prism-deleted);\n}\n.token.doctype {\n  color: var(--prism-doctype);\n}\n.token.entity {\n  color: var(--prism-entity);\n  cursor: help;\n}\n.token.function {\n  color: var(--prism-function);\n}\n.token.function-variable {\n  color: var(--prism-function-variable, var(--prism-function));\n}\n.token.inserted {\n  color: var(--prism-inserted);\n}\n.token.keyword {\n  color: var(--prism-keyword);\n}\n.token.number {\n  color: var(--prism-number);\n}\n.token.operator {\n  color: var(--prism-operator);\n}\n.token.prolog {\n  color: var(--prism-prolog);\n}\n.token.property {\n  color: var(--prism-property);\n}\n.token.punctuation {\n  color: var(--prism-punctuation);\n}\n.token.regex {\n  color: var(--prism-regex);\n}\n.token.selector {\n  color: var(--prism-selector);\n}\n.token.string {\n  color: var(--prism-string);\n}\n.token.symbol {\n  color: var(--prism-symbol);\n}\n.token.tag {\n  color: var(--prism-tag);\n}\n.token.url {\n  color: var(--prism-url);\n}\n.token.variable {\n  color: var(--prism-variable);\n}\n.token.placeholder {\n  color: var(--prism-placeholder);\n}\n.token.statement {\n  color: var(--prism-statement);\n}\n.token.attr-value {\n  color: var(--prism-attr-value);\n}\n.token.control {\n  color: var(--prism-control);\n}\n.token.directive {\n  color: var(--prism-directive);\n}\n.token.unit {\n  color: var(--prism-unit);\n}\n.token.important {\n  color: var(--prism-important);\n}\n.token.class-name {\n  color: var(--prism-class-name);\n}\n",""]),e.Z=s},2609:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);n&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),e.push(u))}},e}},8991:function(t){"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},9601:function(t){"use strict";t.exports=function(t){return t[1]}},8267:function(){Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/}},3712:function(t,e,r){var n=function(t){var e=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,r=0,n={},i={manual:t.Prism&&t.Prism.manual,disableWorkerMessageHandler:t.Prism&&t.Prism.disableWorkerMessageHandler,util:{encode:function t(e){return e instanceof o?new o(e.type,t(e.content),e.alias):Array.isArray(e)?e.map(t):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).slice(8,-1)},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++r}),t.__id},clone:function t(e,r){var n,o;switch(r=r||{},i.util.type(e)){case"Object":if(o=i.util.objId(e),r[o])return r[o];for(var s in n={},r[o]=n,e)e.hasOwnProperty(s)&&(n[s]=t(e[s],r));return n;case"Array":return o=i.util.objId(e),r[o]?r[o]:(n=[],r[o]=n,e.forEach((function(e,i){n[i]=t(e,r)})),n);default:return e}},getLanguage:function(t){for(;t;){var r=e.exec(t.className);if(r)return r[1].toLowerCase();t=t.parentElement}return"none"},setLanguage:function(t,r){t.className=t.className.replace(RegExp(e,"gi"),""),t.classList.add("language-"+r)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(n){var t=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(n.stack)||[])[1];if(t){var e=document.getElementsByTagName("script");for(var r in e)if(e[r].src==t)return e[r]}return null}},isActive:function(t,e,r){for(var n="no-"+e;t;){var i=t.classList;if(i.contains(e))return!0;if(i.contains(n))return!1;t=t.parentElement}return!!r}},languages:{plain:n,plaintext:n,text:n,txt:n,extend:function(t,e){var r=i.util.clone(i.languages[t]);for(var n in e)r[n]=e[n];return r},insertBefore:function(t,e,r,n){var o=(n=n||i.languages)[t],s={};for(var a in o)if(o.hasOwnProperty(a)){if(a==e)for(var l in r)r.hasOwnProperty(l)&&(s[l]=r[l]);r.hasOwnProperty(a)||(s[a]=o[a])}var c=n[t];return n[t]=s,i.languages.DFS(i.languages,(function(e,r){r===c&&e!=t&&(this[e]=s)})),s},DFS:function t(e,r,n,o){o=o||{};var s=i.util.objId;for(var a in e)if(e.hasOwnProperty(a)){r.call(e,a,e[a],n||a);var l=e[a],c=i.util.type(l);"Object"!==c||o[s(l)]?"Array"!==c||o[s(l)]||(o[s(l)]=!0,t(l,r,a,o)):(o[s(l)]=!0,t(l,r,null,o))}}},plugins:{},highlightAll:function(t,e){i.highlightAllUnder(document,t,e)},highlightAllUnder:function(t,e,r){var n={callback:r,container:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",n),n.elements=Array.prototype.slice.apply(n.container.querySelectorAll(n.selector)),i.hooks.run("before-all-elements-highlight",n);for(var o,s=0;o=n.elements[s++];)i.highlightElement(o,!0===e,n.callback)},highlightElement:function(e,r,n){var o=i.util.getLanguage(e),s=i.languages[o];i.util.setLanguage(e,o);var a=e.parentElement;a&&"pre"===a.nodeName.toLowerCase()&&i.util.setLanguage(a,o);var l={element:e,language:o,grammar:s,code:e.textContent};function c(t){l.highlightedCode=t,i.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,i.hooks.run("after-highlight",l),i.hooks.run("complete",l),n&&n.call(l.element)}if(i.hooks.run("before-sanity-check",l),(a=l.element.parentElement)&&"pre"===a.nodeName.toLowerCase()&&!a.hasAttribute("tabindex")&&a.setAttribute("tabindex","0"),!l.code)return i.hooks.run("complete",l),void(n&&n.call(l.element));if(i.hooks.run("before-highlight",l),l.grammar)if(r&&t.Worker){var u=new Worker(i.filename);u.onmessage=function(t){c(t.data)},u.postMessage(JSON.stringify({language:l.language,code:l.code,immediateClose:!0}))}else c(i.highlight(l.code,l.grammar,l.language));else c(i.util.encode(l.code))},highlight:function(t,e,r){var n={code:t,grammar:e,language:r};if(i.hooks.run("before-tokenize",n),!n.grammar)throw new Error('The language "'+n.language+'" has no grammar.');return n.tokens=i.tokenize(n.code,n.grammar),i.hooks.run("after-tokenize",n),o.stringify(i.util.encode(n.tokens),n.language)},tokenize:function(t,e){var r=e.rest;if(r){for(var n in r)e[n]=r[n];delete e.rest}var i=new l;return c(i,i.head,t),a(t,i,e,i.head,0),function(t){for(var e=[],r=t.head.next;r!==t.tail;)e.push(r.value),r=r.next;return e}(i)},hooks:{all:{},add:function(t,e){var r=i.hooks.all;r[t]=r[t]||[],r[t].push(e)},run:function(t,e){var r=i.hooks.all[t];if(r&&r.length)for(var n,o=0;n=r[o++];)n(e)}},Token:o};function o(t,e,r,n){this.type=t,this.content=e,this.alias=r,this.length=0|(n||"").length}function s(t,e,r,n){t.lastIndex=e;var i=t.exec(r);if(i&&n&&i[1]){var o=i[1].length;i.index+=o,i[0]=i[0].slice(o)}return i}function a(t,e,r,n,l,d){for(var h in r)if(r.hasOwnProperty(h)&&r[h]){var p=r[h];p=Array.isArray(p)?p:[p];for(var f=0;f<p.length;++f){if(d&&d.cause==h+","+f)return;var m=p[f],g=m.inside,v=!!m.lookbehind,b=!!m.greedy,y=m.alias;if(b&&!m.pattern.global){var w=m.pattern.toString().match(/[imsuy]*$/)[0];m.pattern=RegExp(m.pattern.source,w+"g")}for(var x=m.pattern||m,k=n.next,$=l;k!==e.tail&&!(d&&$>=d.reach);$+=k.value.length,k=k.next){var S=k.value;if(e.length>t.length)return;if(!(S instanceof o)){var _,A=1;if(b){if(!(_=s(x,$,t,v))||_.index>=t.length)break;var M=_.index,C=_.index+_[0].length,E=$;for(E+=k.value.length;M>=E;)E+=(k=k.next).value.length;if($=E-=k.value.length,k.value instanceof o)continue;for(var P=k;P!==e.tail&&(E<C||"string"==typeof P.value);P=P.next)A++,E+=P.value.length;A--,S=t.slice($,E),_.index-=$}else if(!(_=s(x,0,S,v)))continue;M=_.index;var T=_[0],j=S.slice(0,M),F=S.slice(M+T.length),z=$+S.length;d&&z>d.reach&&(d.reach=z);var O=k.prev;if(j&&(O=c(e,O,j),$+=j.length),u(e,O,A),k=c(e,O,new o(h,g?i.tokenize(T,g):T,y,T)),F&&c(e,k,F),A>1){var R={cause:h+","+f,reach:z};a(t,e,r,k.prev,$,R),d&&R.reach>d.reach&&(d.reach=R.reach)}}}}}}function l(){var t={value:null,prev:null,next:null},e={value:null,prev:t,next:null};t.next=e,this.head=t,this.tail=e,this.length=0}function c(t,e,r){var n=e.next,i={value:r,prev:e,next:n};return e.next=i,n.prev=i,t.length++,i}function u(t,e,r){for(var n=e.next,i=0;i<r&&n!==t.tail;i++)n=n.next;e.next=n,n.prev=e,t.length-=i}if(t.Prism=i,o.stringify=function t(e,r){if("string"==typeof e)return e;if(Array.isArray(e)){var n="";return e.forEach((function(e){n+=t(e,r)})),n}var o={type:e.type,content:t(e.content,r),tag:"span",classes:["token",e.type],attributes:{},language:r},s=e.alias;s&&(Array.isArray(s)?Array.prototype.push.apply(o.classes,s):o.classes.push(s)),i.hooks.run("wrap",o);var a="";for(var l in o.attributes)a+=" "+l+'="'+(o.attributes[l]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+a+">"+o.content+"</"+o.tag+">"},!t.document)return t.addEventListener?(i.disableWorkerMessageHandler||t.addEventListener("message",(function(e){var r=JSON.parse(e.data),n=r.language,o=r.code,s=r.immediateClose;t.postMessage(i.highlight(o,i.languages[n],n)),s&&t.close()}),!1),i):i;var d=i.util.currentScript();function h(){i.manual||i.highlightAll()}if(d&&(i.filename=d.src,d.hasAttribute("data-manual")&&(i.manual=!0)),!i.manual){var p=document.readyState;"loading"===p||"interactive"===p&&d&&d.defer?document.addEventListener("DOMContentLoaded",h):window.requestAnimationFrame?window.requestAnimationFrame(h):window.setTimeout(h,16)}return i}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});t.exports&&(t.exports=n),void 0!==r.g&&(r.g.Prism=n)},8423:function(){!function(t){function e(t,e){return t.replace(/<<(\d+)>>/g,(function(t,r){return"(?:"+e[+r]+")"}))}function r(t,r,n){return RegExp(e(t,r),n||"")}function n(t,e){for(var r=0;r<e;r++)t=t.replace(/<<self>>/g,(function(){return"(?:"+t+")"}));return t.replace(/<<self>>/g,"[^\\s\\S]")}var i="bool byte char decimal double dynamic float int long object sbyte short string uint ulong ushort var void",o="class enum interface record struct",s="add alias and ascending async await by descending from(?=\\s*(?:\\w|$)) get global group into init(?=\\s*;) join let nameof not notnull on or orderby partial remove select set unmanaged value when where with(?=\\s*{)",a="abstract as base break case catch checked const continue default delegate do else event explicit extern finally fixed for foreach goto if implicit in internal is lock namespace new null operator out override params private protected public readonly ref return sealed sizeof stackalloc static switch this throw try typeof unchecked unsafe using virtual volatile while yield";function l(t){return"\\b(?:"+t.trim().replace(/ /g,"|")+")\\b"}var c=l(o),u=RegExp(l(i+" "+o+" "+s+" "+a)),d=l(o+" "+s+" "+a),h=l(i+" "+o+" "+a),p=n(/<(?:[^<>;=+\-*/%&|^]|<<self>>)*>/.source,2),f=n(/\((?:[^()]|<<self>>)*\)/.source,2),m=/@?\b[A-Za-z_]\w*\b/.source,g=e(/<<0>>(?:\s*<<1>>)?/.source,[m,p]),v=e(/(?!<<0>>)<<1>>(?:\s*\.\s*<<1>>)*/.source,[d,g]),b=/\[\s*(?:,\s*)*\]/.source,y=e(/<<0>>(?:\s*(?:\?\s*)?<<1>>)*(?:\s*\?)?/.source,[v,b]),w=e(/[^,()<>[\];=+\-*/%&|^]|<<0>>|<<1>>|<<2>>/.source,[p,f,b]),x=e(/\(<<0>>+(?:,<<0>>+)+\)/.source,[w]),k=e(/(?:<<0>>|<<1>>)(?:\s*(?:\?\s*)?<<2>>)*(?:\s*\?)?/.source,[x,v,b]),$={keyword:u,punctuation:/[<>()?,.:[\]]/},S=/'(?:[^\r\n'\\]|\\.|\\[Uux][\da-fA-F]{1,8})'/.source,_=/"(?:\\.|[^\\"\r\n])*"/.source,A=/@"(?:""|\\[\s\S]|[^\\"])*"(?!")/.source;t.languages.csharp=t.languages.extend("clike",{string:[{pattern:r(/(^|[^$\\])<<0>>/.source,[A]),lookbehind:!0,greedy:!0},{pattern:r(/(^|[^@$\\])<<0>>/.source,[_]),lookbehind:!0,greedy:!0}],"class-name":[{pattern:r(/(\busing\s+static\s+)<<0>>(?=\s*;)/.source,[v]),lookbehind:!0,inside:$},{pattern:r(/(\busing\s+<<0>>\s*=\s*)<<1>>(?=\s*;)/.source,[m,k]),lookbehind:!0,inside:$},{pattern:r(/(\busing\s+)<<0>>(?=\s*=)/.source,[m]),lookbehind:!0},{pattern:r(/(\b<<0>>\s+)<<1>>/.source,[c,g]),lookbehind:!0,inside:$},{pattern:r(/(\bcatch\s*\(\s*)<<0>>/.source,[v]),lookbehind:!0,inside:$},{pattern:r(/(\bwhere\s+)<<0>>/.source,[m]),lookbehind:!0},{pattern:r(/(\b(?:is(?:\s+not)?|as)\s+)<<0>>/.source,[y]),lookbehind:!0,inside:$},{pattern:r(/\b<<0>>(?=\s+(?!<<1>>|with\s*\{)<<2>>(?:\s*[=,;:{)\]]|\s+(?:in|when)\b))/.source,[k,h,m]),inside:$}],keyword:u,number:/(?:\b0(?:x[\da-f_]*[\da-f]|b[01_]*[01])|(?:\B\.\d+(?:_+\d+)*|\b\d+(?:_+\d+)*(?:\.\d+(?:_+\d+)*)?)(?:e[-+]?\d+(?:_+\d+)*)?)(?:[dflmu]|lu|ul)?\b/i,operator:/>>=?|<<=?|[-=]>|([-+&|])\1|~|\?\?=?|[-+*/%&|^!=<>]=?/,punctuation:/\?\.?|::|[{}[\];(),.:]/}),t.languages.insertBefore("csharp","number",{range:{pattern:/\.\./,alias:"operator"}}),t.languages.insertBefore("csharp","punctuation",{"named-parameter":{pattern:r(/([(,]\s*)<<0>>(?=\s*:)/.source,[m]),lookbehind:!0,alias:"punctuation"}}),t.languages.insertBefore("csharp","class-name",{namespace:{pattern:r(/(\b(?:namespace|using)\s+)<<0>>(?:\s*\.\s*<<0>>)*(?=\s*[;{])/.source,[m]),lookbehind:!0,inside:{punctuation:/\./}},"type-expression":{pattern:r(/(\b(?:default|sizeof|typeof)\s*\(\s*(?!\s))(?:[^()\s]|\s(?!\s)|<<0>>)*(?=\s*\))/.source,[f]),lookbehind:!0,alias:"class-name",inside:$},"return-type":{pattern:r(/<<0>>(?=\s+(?:<<1>>\s*(?:=>|[({]|\.\s*this\s*\[)|this\s*\[))/.source,[k,v]),inside:$,alias:"class-name"},"constructor-invocation":{pattern:r(/(\bnew\s+)<<0>>(?=\s*[[({])/.source,[k]),lookbehind:!0,inside:$,alias:"class-name"},"generic-method":{pattern:r(/<<0>>\s*<<1>>(?=\s*\()/.source,[m,p]),inside:{function:r(/^<<0>>/.source,[m]),generic:{pattern:RegExp(p),alias:"class-name",inside:$}}},"type-list":{pattern:r(/\b((?:<<0>>\s+<<1>>|record\s+<<1>>\s*<<5>>|where\s+<<2>>)\s*:\s*)(?:<<3>>|<<4>>|<<1>>\s*<<5>>|<<6>>)(?:\s*,\s*(?:<<3>>|<<4>>|<<6>>))*(?=\s*(?:where|[{;]|=>|$))/.source,[c,g,m,k,u.source,f,/\bnew\s*\(\s*\)/.source]),lookbehind:!0,inside:{"record-arguments":{pattern:r(/(^(?!new\s*\()<<0>>\s*)<<1>>/.source,[g,f]),lookbehind:!0,greedy:!0,inside:t.languages.csharp},keyword:u,"class-name":{pattern:RegExp(k),greedy:!0,inside:$},punctuation:/[,()]/}},preprocessor:{pattern:/(^[\t ]*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(#)\b(?:define|elif|else|endif|endregion|error|if|line|nullable|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});var M=_+"|"+S,C=e(/\/(?![*/])|\/\/[^\r\n]*[\r\n]|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>/.source,[M]),E=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[C]),2),P=/\b(?:assembly|event|field|method|module|param|property|return|type)\b/.source,T=e(/<<0>>(?:\s*\(<<1>>*\))?/.source,[v,E]);t.languages.insertBefore("csharp","class-name",{attribute:{pattern:r(/((?:^|[^\s\w>)?])\s*\[\s*)(?:<<0>>\s*:\s*)?<<1>>(?:\s*,\s*<<1>>)*(?=\s*\])/.source,[P,T]),lookbehind:!0,greedy:!0,inside:{target:{pattern:r(/^<<0>>(?=\s*:)/.source,[P]),alias:"keyword"},"attribute-arguments":{pattern:r(/\(<<0>>*\)/.source,[E]),inside:t.languages.csharp},"class-name":{pattern:RegExp(v),inside:{punctuation:/\./}},punctuation:/[:,]/}}});var j=/:[^}\r\n]+/.source,F=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[C]),2),z=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[F,j]),O=n(e(/[^"'/()]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>|\(<<self>>*\)/.source,[M]),2),R=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[O,j]);function N(e,n){return{interpolation:{pattern:r(/((?:^|[^{])(?:\{\{)*)<<0>>/.source,[e]),lookbehind:!0,inside:{"format-string":{pattern:r(/(^\{(?:(?![}:])<<0>>)*)<<1>>(?=\}$)/.source,[n,j]),lookbehind:!0,inside:{punctuation:/^:/}},punctuation:/^\{|\}$/,expression:{pattern:/[\s\S]+/,alias:"language-csharp",inside:t.languages.csharp}}},string:/[\s\S]+/}}t.languages.insertBefore("csharp","string",{"interpolation-string":[{pattern:r(/(^|[^\\])(?:\$@|@\$)"(?:""|\\[\s\S]|\{\{|<<0>>|[^\\{"])*"/.source,[z]),lookbehind:!0,greedy:!0,inside:N(z,F)},{pattern:r(/(^|[^@\\])\$"(?:\\.|\{\{|<<0>>|[^\\"{])*"/.source,[R]),lookbehind:!0,greedy:!0,inside:N(R,O)}],char:{pattern:RegExp(S),greedy:!0}}),t.languages.dotnet=t.languages.cs=t.languages.csharp}(Prism)},7252:function(){!function(t){var e=/(?:\r?\n|\r)[ \t]*\|.+\|(?:(?!\|).)*/.source;t.languages.gherkin={pystring:{pattern:/("""|''')[\s\S]+?\1/,alias:"string"},comment:{pattern:/(^[ \t]*)#.*/m,lookbehind:!0},tag:{pattern:/(^[ \t]*)@\S*/m,lookbehind:!0},feature:{pattern:/((?:^|\r?\n|\r)[ \t]*)(?:Ability|Ahoy matey!|Arwedd|Aspekt|Besigheid Behoefte|Business Need|Caracteristica|Característica|Egenskab|Egenskap|Eiginleiki|Feature|Fīča|Fitur|Fonctionnalité|Fonksyonalite|Funcionalidade|Funcionalitat|Functionalitate|Funcţionalitate|Funcționalitate|Functionaliteit|Fungsi|Funkcia|Funkcija|Funkcionalitāte|Funkcionalnost|Funkcja|Funksie|Funktionalität|Funktionalitéit|Funzionalità|Hwaet|Hwæt|Jellemző|Karakteristik|Lastnost|Mak|Mogucnost|laH|Mogućnost|Moznosti|Možnosti|OH HAI|Omadus|Ominaisuus|Osobina|Özellik|Potrzeba biznesowa|perbogh|poQbogh malja'|Požadavek|Požiadavka|Pretty much|Qap|Qu'meH 'ut|Savybė|Tính năng|Trajto|Vermoë|Vlastnosť|Właściwość|Značilnost|Δυνατότητα|Λειτουργία|Могућност|Мөмкинлек|Особина|Свойство|Үзенчәлеклелек|Функционал|Функционалност|Функция|Функціонал|תכונה|خاصية|خصوصیت|صلاحیت|کاروبار کی ضرورت|وِیژگی|रूप लेख|ਖਾਸੀਅਤ|ਨਕਸ਼ ਨੁਹਾਰ|ਮੁਹਾਂਦਰਾ|గుణము|ಹೆಚ್ಚಳ|ความต้องการทางธุรกิจ|ความสามารถ|โครงหลัก|기능|フィーチャ|功能|機能):(?:[^:\r\n]+(?:\r?\n|\r|$))*/,lookbehind:!0,inside:{important:{pattern:/(:)[^\r\n]+/,lookbehind:!0},keyword:/[^:\r\n]+:/}},scenario:{pattern:/(^[ \t]*)(?:Abstract Scenario|Abstrakt Scenario|Achtergrond|Aer|Ær|Agtergrond|All y'all|Antecedentes|Antecedents|Atburðarás|Atburðarásir|Awww, look mate|B4|Background|Baggrund|Bakgrund|Bakgrunn|Bakgrunnur|Beispiele|Beispiller|Bối cảnh|Cefndir|Cenario|Cenário|Cenario de Fundo|Cenário de Fundo|Cenarios|Cenários|Contesto|Context|Contexte|Contexto|Conto|Contoh|Contone|Dæmi|Dasar|Dead men tell no tales|Delineacao do Cenario|Delineação do Cenário|Dis is what went down|Dữ liệu|Dyagram Senaryo|Dyagram senaryo|Egzanp|Ejemplos|Eksempler|Ekzemploj|Enghreifftiau|Esbozo do escenario|Escenari|Escenario|Esempi|Esquema de l'escenari|Esquema del escenario|Esquema do Cenario|Esquema do Cenário|EXAMPLZ|Examples|Exempel|Exemple|Exemples|Exemplos|First off|Fono|Forgatókönyv|Forgatókönyv vázlat|Fundo|Geçmiş|Grundlage|Hannergrond|ghantoH|Háttér|Heave to|Istorik|Juhtumid|Keadaan|Khung kịch bản|Khung tình huống|Kịch bản|Koncept|Konsep skenario|Kontèks|Kontekst|Kontekstas|Konteksts|Kontext|Konturo de la scenaro|Latar Belakang|lut chovnatlh|lut|lutmey|Lýsing Atburðarásar|Lýsing Dæma|MISHUN SRSLY|MISHUN|Menggariskan Senario|mo'|Náčrt Scenára|Náčrt Scénáře|Náčrt Scenáru|Oris scenarija|Örnekler|Osnova|Osnova Scenára|Osnova scénáře|Osnutek|Ozadje|Paraugs|Pavyzdžiai|Példák|Piemēri|Plan du scénario|Plan du Scénario|Plan Senaryo|Plan senaryo|Plang vum Szenario|Pozadí|Pozadie|Pozadina|Príklady|Příklady|Primer|Primeri|Primjeri|Przykłady|Raamstsenaarium|Reckon it's like|Rerefons|Scenár|Scénář|Scenarie|Scenarij|Scenarijai|Scenarijaus šablonas|Scenariji|Scenārijs|Scenārijs pēc parauga|Scenarijus|Scenario|Scénario|Scenario Amlinellol|Scenario Outline|Scenario Template|Scenariomal|Scenariomall|Scenarios|Scenariu|Scenariusz|Scenaro|Schema dello scenario|Se ðe|Se the|Se þe|Senario|Senaryo Deskripsyon|Senaryo deskripsyon|Senaryo|Senaryo taslağı|Shiver me timbers|Situācija|Situai|Situasie Uiteensetting|Situasie|Skenario konsep|Skenario|Skica|Structura scenariu|Structură scenariu|Struktura scenarija|Stsenaarium|Swa hwaer swa|Swa|Swa hwær swa|Szablon scenariusza|Szenario|Szenariogrundriss|Tapaukset|Tapaus|Tapausaihio|Taust|Tausta|Template Keadaan|Template Senario|Template Situai|The thing of it is|Tình huống|Variantai|Voorbeelde|Voorbeelden|Wharrimean is|Yo-ho-ho|You'll wanna|Założenia|Παραδείγματα|Περιγραφή Σεναρίου|Σενάρια|Σενάριο|Υπόβαθρο|Кереш|Контекст|Концепт|Мисаллар|Мисоллар|Основа|Передумова|Позадина|Предистория|Предыстория|Приклади|Пример|Примери|Примеры|Рамка на сценарий|Скица|Структура сценарија|Структура сценария|Структура сценарію|Сценарий|Сценарий структураси|Сценарийның төзелеше|Сценарији|Сценарио|Сценарій|Тарих|Үрнәкләр|דוגמאות|רקע|תבנית תרחיש|תרחיש|الخلفية|الگوی سناریو|امثلة|پس منظر|زمینه|سناریو|سيناريو|سيناريو مخطط|مثالیں|منظر نامے کا خاکہ|منظرنامہ|نمونه ها|उदाहरण|परिदृश्य|परिदृश्य रूपरेखा|पृष्ठभूमि|ਉਦਾਹਰਨਾਂ|ਪਟਕਥਾ|ਪਟਕਥਾ ਢਾਂਚਾ|ਪਟਕਥਾ ਰੂਪ ਰੇਖਾ|ਪਿਛੋਕੜ|ఉదాహరణలు|కథనం|నేపథ్యం|సన్నివేశం|ಉದಾಹರಣೆಗಳು|ಕಥಾಸಾರಾಂಶ|ವಿವರಣೆ|ಹಿನ್ನೆಲೆ|โครงสร้างของเหตุการณ์|ชุดของตัวอย่าง|ชุดของเหตุการณ์|แนวคิด|สรุปเหตุการณ์|เหตุการณ์|배경|시나리오|시나리오 개요|예|サンプル|シナリオ|シナリオアウトライン|シナリオテンプレ|シナリオテンプレート|テンプレ|例|例子|剧本|剧本大纲|劇本|劇本大綱|场景|场景大纲|場景|場景大綱|背景):[^:\r\n]*/m,lookbehind:!0,inside:{important:{pattern:/(:)[^\r\n]*/,lookbehind:!0},keyword:/[^:\r\n]+:/}},"table-body":{pattern:RegExp("("+e+")(?:"+e+")+"),lookbehind:!0,inside:{outline:{pattern:/<[^>]+>/,alias:"variable"},td:{pattern:/\s*[^\s|][^|]*/,alias:"string"},punctuation:/\|/}},"table-head":{pattern:RegExp(e),inside:{th:{pattern:/\s*[^\s|][^|]*/,alias:"variable"},punctuation:/\|/}},atrule:{pattern:/(^[ \t]+)(?:'a|'ach|'ej|7|a|A také|A taktiež|A tiež|A zároveň|Aber|Ac|Adott|Akkor|Ak|Aleshores|Ale|Ali|Allora|Alors|Als|Ama|Amennyiben|Amikor|Ampak|an|AN|Ananging|And y'all|And|Angenommen|Anrhegedig a|An|Apabila|Atès|Atesa|Atunci|Avast!|Aye|A|awer|Bagi|Banjur|Bet|Biết|Blimey!|Buh|But at the end of the day I reckon|But y'all|But|BUT|Cal|Când|Cand|Cando|Ce|Cuando|Če|Ða ðe|Ða|Dadas|Dada|Dados|Dado|DaH ghu' bejlu'|dann|Dann|Dano|Dan|Dar|Dat fiind|Data|Date fiind|Date|Dati fiind|Dati|Daţi fiind|Dați fiind|DEN|Dato|De|Den youse gotta|Dengan|Diberi|Diyelim ki|Donada|Donat|Donitaĵo|Do|Dun|Duota|Ðurh|Eeldades|Ef|Eğer ki|Entao|Então|Entón|E|En|Entonces|Epi|És|Etant donnée|Etant donné|Et|Étant données|Étant donnée|Étant donné|Etant données|Etant donnés|Étant donnés|Fakat|Gangway!|Gdy|Gegeben seien|Gegeben sei|Gegeven|Gegewe|ghu' noblu'|Gitt|Given y'all|Given|Givet|Givun|Ha|Cho|I CAN HAZ|In|Ir|It's just unbelievable|I|Ja|Jeśli|Jeżeli|Kad|Kada|Kadar|Kai|Kaj|Když|Keď|Kemudian|Ketika|Khi|Kiedy|Ko|Kuid|Kui|Kun|Lan|latlh|Le sa a|Let go and haul|Le|Lè sa a|Lè|Logo|Lorsqu'<|Lorsque|mä|Maar|Mais|Mając|Ma|Majd|Maka|Manawa|Mas|Men|Menawa|Mutta|Nalika|Nalikaning|Nanging|Når|När|Nato|Nhưng|Niin|Njuk|O zaman|Och|Og|Oletetaan|Ond|Onda|Oraz|Pak|Pero|Però|Podano|Pokiaľ|Pokud|Potem|Potom|Privzeto|Pryd|Quan|Quand|Quando|qaSDI'|Så|Sed|Se|Siis|Sipoze ke|Sipoze Ke|Sipoze|Si|Şi|Și|Soit|Stel|Tada|Tad|Takrat|Tak|Tapi|Ter|Tetapi|Tha the|Tha|Then y'all|Then|Thì|Thurh|Toda|Too right|Un|Und|ugeholl|Và|vaj|Vendar|Ve|wann|Wanneer|WEN|Wenn|When y'all|When|Wtedy|Wun|Y'know|Yeah nah|Yna|Youse know like when|Youse know when youse got|Y|Za predpokladu|Za předpokladu|Zadan|Zadani|Zadano|Zadate|Zadato|Zakładając|Zaradi|Zatati|Þa þe|Þa|Þá|Þegar|Þurh|Αλλά|Δεδομένου|Και|Όταν|Τότε|А також|Агар|Але|Али|Аммо|А|Әгәр|Әйтик|Әмма|Бирок|Ва|Вә|Дадено|Дано|Допустим|Если|Задате|Задати|Задато|И|І|К тому же|Када|Кад|Когато|Когда|Коли|Ләкин|Лекин|Нәтиҗәдә|Нехай|Но|Онда|Припустимо, що|Припустимо|Пусть|Также|Та|Тогда|Тоді|То|Унда|Һәм|Якщо|אבל|אזי|אז|בהינתן|וגם|כאשר|آنگاه|اذاً|اگر|اما|اور|با فرض|بالفرض|بفرض|پھر|تب|ثم|جب|عندما|فرض کیا|لكن|لیکن|متى|هنگامی|و|अगर|और|कदा|किन्तु|चूंकि|जब|तथा|तदा|तब|परन्तु|पर|यदि|ਅਤੇ|ਜਦੋਂ|ਜਿਵੇਂ ਕਿ|ਜੇਕਰ|ਤਦ|ਪਰ|అప్పుడు|ఈ పరిస్థితిలో|కాని|చెప్పబడినది|మరియు|ಆದರೆ|ನಂತರ|ನೀಡಿದ|ಮತ್ತು|ಸ್ಥಿತಿಯನ್ನು|กำหนดให้|ดังนั้น|แต่|เมื่อ|และ|그러면<|그리고<|단<|만약<|만일<|먼저<|조건<|하지만<|かつ<|しかし<|ただし<|ならば<|もし<|並且<|但し<|但是<|假如<|假定<|假設<|假设<|前提<|同时<|同時<|并且<|当<|當<|而且<|那么<|那麼<)(?=[ \t])/m,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\\r\n])*"|'(?:\\.|[^'\\\r\n])*'/,inside:{outline:{pattern:/<[^>]+>/,alias:"variable"}}},outline:{pattern:/<[^>]+>/,alias:"variable"}}}(Prism)},3701:function(){!function(t){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};t.languages.java=t.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[t.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),t.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),t.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,(function(){return e.source}))),lookbehind:!0,inside:{punctuation:/\./}}})}(Prism)},4883:function(){Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),Prism.languages.js=Prism.languages.javascript},3502:function(){!function(t){function e(t,e){return"___"+t.toUpperCase()+e+"___"}Object.defineProperties(t.languages["markup-templating"]={},{buildPlaceholders:{value:function(r,n,i,o){if(r.language===n){var s=r.tokenStack=[];r.code=r.code.replace(i,(function(t){if("function"==typeof o&&!o(t))return t;for(var i,a=s.length;-1!==r.code.indexOf(i=e(n,a));)++a;return s[a]=t,i})),r.grammar=t.languages.markup}}},tokenizePlaceholders:{value:function(r,n){if(r.language===n&&r.tokenStack){r.grammar=t.languages[n];var i=0,o=Object.keys(r.tokenStack);!function s(a){for(var l=0;l<a.length&&!(i>=o.length);l++){var c=a[l];if("string"==typeof c||c.content&&"string"==typeof c.content){var u=o[i],d=r.tokenStack[u],h="string"==typeof c?c:c.content,p=e(n,u),f=h.indexOf(p);if(f>-1){++i;var m=h.substring(0,f),g=new t.Token(n,t.tokenize(d,r.grammar),"language-"+n,d),v=h.substring(f+p.length),b=[];m&&b.push.apply(b,s([m])),b.push(g),v&&b.push.apply(b,s([v])),"string"==typeof c?a.splice.apply(a,[l,1].concat(b)):c.content=b}}else c.content&&s(c.content)}return a}(r.tokens)}}}})}(Prism)},5744:function(){Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup,Prism.hooks.add("wrap",(function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))})),Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,e){var r={};r["language-"+e]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[e]},r.cdata=/^<!\[CDATA\[|\]\]>$/i;var n={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}};n["language-"+e]={pattern:/[\s\S]+/,inside:Prism.languages[e]};var i={};i[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return t})),"i"),lookbehind:!0,greedy:!0,inside:n},Prism.languages.insertBefore("markup","cdata",i)}}),Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(t,e){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:Prism.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.xml=Prism.languages.extend("markup",{}),Prism.languages.ssml=Prism.languages.xml,Prism.languages.atom=Prism.languages.xml,Prism.languages.rss=Prism.languages.xml},4999:function(){!function(t){var e=/\/\*[\s\S]*?\*\/|\/\/.*|#(?!\[).*/,r=[{pattern:/\b(?:false|true)\b/i,alias:"boolean"},{pattern:/(::\s*)\b[a-z_]\w*\b(?!\s*\()/i,greedy:!0,lookbehind:!0},{pattern:/(\b(?:case|const)\s+)\b[a-z_]\w*(?=\s*[;=])/i,greedy:!0,lookbehind:!0},/\b(?:null)\b/i,/\b[A-Z_][A-Z0-9_]*\b(?!\s*\()/],n=/\b0b[01]+(?:_[01]+)*\b|\b0o[0-7]+(?:_[0-7]+)*\b|\b0x[\da-f]+(?:_[\da-f]+)*\b|(?:\b\d+(?:_\d+)*\.?(?:\d+(?:_\d+)*)?|\B\.\d+)(?:e[+-]?\d+)?/i,i=/<?=>|\?\?=?|\.{3}|\??->|[!=]=?=?|::|\*\*=?|--|\+\+|&&|\|\||<<|>>|[?~]|[/^|%*&<>.+-]=?/,o=/[{}\[\](),:;]/;t.languages.php={delimiter:{pattern:/\?>$|^<\?(?:php(?=\s)|=)?/i,alias:"important"},comment:e,variable:/\$+(?:\w+\b|(?=\{))/,package:{pattern:/(namespace\s+|use\s+(?:function\s+)?)(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,lookbehind:!0,inside:{punctuation:/\\/}},"class-name-definition":{pattern:/(\b(?:class|enum|interface|trait)\s+)\b[a-z_]\w*(?!\\)\b/i,lookbehind:!0,alias:"class-name"},"function-definition":{pattern:/(\bfunction\s+)[a-z_]\w*(?=\s*\()/i,lookbehind:!0,alias:"function"},keyword:[{pattern:/(\(\s*)\b(?:array|bool|boolean|float|int|integer|object|string)\b(?=\s*\))/i,alias:"type-casting",greedy:!0,lookbehind:!0},{pattern:/([(,?]\s*)\b(?:array(?!\s*\()|bool|callable|(?:false|null)(?=\s*\|)|float|int|iterable|mixed|object|self|static|string)\b(?=\s*\$)/i,alias:"type-hint",greedy:!0,lookbehind:!0},{pattern:/(\)\s*:\s*(?:\?\s*)?)\b(?:array(?!\s*\()|bool|callable|(?:false|null)(?=\s*\|)|float|int|iterable|mixed|never|object|self|static|string|void)\b/i,alias:"return-type",greedy:!0,lookbehind:!0},{pattern:/\b(?:array(?!\s*\()|bool|float|int|iterable|mixed|object|string|void)\b/i,alias:"type-declaration",greedy:!0},{pattern:/(\|\s*)(?:false|null)\b|\b(?:false|null)(?=\s*\|)/i,alias:"type-declaration",greedy:!0,lookbehind:!0},{pattern:/\b(?:parent|self|static)(?=\s*::)/i,alias:"static-context",greedy:!0},{pattern:/(\byield\s+)from\b/i,lookbehind:!0},/\bclass\b/i,{pattern:/((?:^|[^\s>:]|(?:^|[^-])>|(?:^|[^:]):)\s*)\b(?:abstract|and|array|as|break|callable|case|catch|clone|const|continue|declare|default|die|do|echo|else|elseif|empty|enddeclare|endfor|endforeach|endif|endswitch|endwhile|enum|eval|exit|extends|final|finally|fn|for|foreach|function|global|goto|if|implements|include|include_once|instanceof|insteadof|interface|isset|list|match|namespace|never|new|or|parent|print|private|protected|public|readonly|require|require_once|return|self|static|switch|throw|trait|try|unset|use|var|while|xor|yield|__halt_compiler)\b/i,lookbehind:!0}],"argument-name":{pattern:/([(,]\s*)\b[a-z_]\w*(?=\s*:(?!:))/i,lookbehind:!0},"class-name":[{pattern:/(\b(?:extends|implements|instanceof|new(?!\s+self|\s+static))\s+|\bcatch\s*\()\b[a-z_]\w*(?!\\)\b/i,greedy:!0,lookbehind:!0},{pattern:/(\|\s*)\b[a-z_]\w*(?!\\)\b/i,greedy:!0,lookbehind:!0},{pattern:/\b[a-z_]\w*(?!\\)\b(?=\s*\|)/i,greedy:!0},{pattern:/(\|\s*)(?:\\?\b[a-z_]\w*)+\b/i,alias:"class-name-fully-qualified",greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/(?:\\?\b[a-z_]\w*)+\b(?=\s*\|)/i,alias:"class-name-fully-qualified",greedy:!0,inside:{punctuation:/\\/}},{pattern:/(\b(?:extends|implements|instanceof|new(?!\s+self\b|\s+static\b))\s+|\bcatch\s*\()(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,alias:"class-name-fully-qualified",greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/\b[a-z_]\w*(?=\s*\$)/i,alias:"type-declaration",greedy:!0},{pattern:/(?:\\?\b[a-z_]\w*)+(?=\s*\$)/i,alias:["class-name-fully-qualified","type-declaration"],greedy:!0,inside:{punctuation:/\\/}},{pattern:/\b[a-z_]\w*(?=\s*::)/i,alias:"static-context",greedy:!0},{pattern:/(?:\\?\b[a-z_]\w*)+(?=\s*::)/i,alias:["class-name-fully-qualified","static-context"],greedy:!0,inside:{punctuation:/\\/}},{pattern:/([(,?]\s*)[a-z_]\w*(?=\s*\$)/i,alias:"type-hint",greedy:!0,lookbehind:!0},{pattern:/([(,?]\s*)(?:\\?\b[a-z_]\w*)+(?=\s*\$)/i,alias:["class-name-fully-qualified","type-hint"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/(\)\s*:\s*(?:\?\s*)?)\b[a-z_]\w*(?!\\)\b/i,alias:"return-type",greedy:!0,lookbehind:!0},{pattern:/(\)\s*:\s*(?:\?\s*)?)(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,alias:["class-name-fully-qualified","return-type"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}}],constant:r,function:{pattern:/(^|[^\\\w])\\?[a-z_](?:[\w\\]*\w)?(?=\s*\()/i,lookbehind:!0,inside:{punctuation:/\\/}},property:{pattern:/(->\s*)\w+/,lookbehind:!0},number:n,operator:i,punctuation:o};var s={pattern:/\{\$(?:\{(?:\{[^{}]+\}|[^{}]+)\}|[^{}])+\}|(^|[^\\{])\$+(?:\w+(?:\[[^\r\n\[\]]+\]|->\w+)?)/,lookbehind:!0,inside:t.languages.php},a=[{pattern:/<<<'([^']+)'[\r\n](?:.*[\r\n])*?\1;/,alias:"nowdoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<<'[^']+'|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<'?|[';]$/}}}},{pattern:/<<<(?:"([^"]+)"[\r\n](?:.*[\r\n])*?\1;|([a-z_]\w*)[\r\n](?:.*[\r\n])*?\2;)/i,alias:"heredoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<<(?:"[^"]+"|[a-z_]\w*)|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<"?|[";]$/}},interpolation:s}},{pattern:/`(?:\\[\s\S]|[^\\`])*`/,alias:"backtick-quoted-string",greedy:!0},{pattern:/'(?:\\[\s\S]|[^\\'])*'/,alias:"single-quoted-string",greedy:!0},{pattern:/"(?:\\[\s\S]|[^\\"])*"/,alias:"double-quoted-string",greedy:!0,inside:{interpolation:s}}];t.languages.insertBefore("php","variable",{string:a,attribute:{pattern:/#\[(?:[^"'\/#]|\/(?![*/])|\/\/.*$|#(?!\[).*$|\/\*(?:[^*]|\*(?!\/))*\*\/|"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*')+\](?=\s*[a-z$#])/im,greedy:!0,inside:{"attribute-content":{pattern:/^(#\[)[\s\S]+(?=\]$)/,lookbehind:!0,inside:{comment:e,string:a,"attribute-class-name":[{pattern:/([^:]|^)\b[a-z_]\w*(?!\\)\b/i,alias:"class-name",greedy:!0,lookbehind:!0},{pattern:/([^:]|^)(?:\\?\b[a-z_]\w*)+/i,alias:["class-name","class-name-fully-qualified"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}}],constant:r,number:n,operator:i,punctuation:o}},delimiter:{pattern:/^#\[|\]$/,alias:"punctuation"}}}}),t.hooks.add("before-tokenize",(function(e){/<\?/.test(e.code)&&t.languages["markup-templating"].buildPlaceholders(e,"php",/<\?(?:[^"'/#]|\/(?![*/])|("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|(?:\/\/|#(?!\[))(?:[^?\n\r]|\?(?!>))*(?=$|\?>|[\r\n])|#\[|\/\*(?:[^*]|\*(?!\/))*(?:\*\/|$))*?(?:\?>|$)/g)})),t.hooks.add("after-tokenize",(function(e){t.languages["markup-templating"].tokenizePlaceholders(e,"php")}))}(Prism)},458:function(){Prism.languages.scala=Prism.languages.extend("java",{"triple-quoted-string":{pattern:/"""[\s\S]*?"""/,greedy:!0,alias:"string"},string:{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},keyword:/<-|=>|\b(?:abstract|case|catch|class|def|derives|do|else|enum|extends|extension|final|finally|for|forSome|given|if|implicit|import|infix|inline|lazy|match|new|null|object|opaque|open|override|package|private|protected|return|sealed|self|super|this|throw|trait|transparent|try|type|using|val|var|while|with|yield)\b/,number:/\b0x(?:[\da-f]*\.)?[\da-f]+|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e\d+)?[dfl]?/i,builtin:/\b(?:Any|AnyRef|AnyVal|Boolean|Byte|Char|Double|Float|Int|Long|Nothing|Short|String|Unit)\b/,symbol:/'[^\d\s\\]\w*/}),Prism.languages.insertBefore("scala","triple-quoted-string",{"string-interpolation":{pattern:/\b[a-z]\w*(?:"""(?:[^$]|\$(?:[^{]|\{(?:[^{}]|\{[^{}]*\})*\}))*?"""|"(?:[^$"\r\n]|\$(?:[^{]|\{(?:[^{}]|\{[^{}]*\})*\}))*")/i,greedy:!0,inside:{id:{pattern:/^\w+/,greedy:!0,alias:"function"},escape:{pattern:/\\\$"|\$[$"]/,greedy:!0,alias:"symbol"},interpolation:{pattern:/\$(?:\w+|\{(?:[^{}]|\{[^{}]*\})*\})/,greedy:!0,inside:{punctuation:/^\$\{?|\}$/,expression:{pattern:/[\s\S]+/,inside:Prism.languages.scala}}},string:/[\s\S]+/}}}),delete Prism.languages.scala["class-name"],delete Prism.languages.scala.function,delete Prism.languages.scala.constant},3083:function(){!function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var e=t.languages.extend("typescript",{});delete e["class-name"],t.languages.typescript["class-name"].inside=e,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),t.languages.ts=t.languages.typescript}(Prism)},4882:function(){"undefined"!=typeof Prism&&"undefined"!=typeof document&&document.createRange&&(Prism.plugins.KeepMarkup=!0,Prism.hooks.add("before-highlight",(function(t){if(t.element.children.length&&Prism.util.isActive(t.element,"keep-markup",!0)){var e=Prism.util.isActive(t.element,"drop-tokens",!1),r=0,n=[];o(t.element),n.length&&(t.keepMarkup=n)}function i(t){if(function(t){return!e||"span"!==t.nodeName.toLowerCase()||!t.classList.contains("token")}(t)){var i={element:t,posOpen:r};n.push(i),o(t),i.posClose=r}else o(t)}function o(t){for(var e=0,n=t.childNodes.length;e<n;e++){var o=t.childNodes[e];1===o.nodeType?i(o):3===o.nodeType&&(r+=o.data.length)}}})),Prism.hooks.add("after-highlight",(function(t){if(t.keepMarkup&&t.keepMarkup.length){var e=function(t,r){for(var n=0,i=t.childNodes.length;n<i;n++){var o=t.childNodes[n];if(1===o.nodeType){if(!e(o,r))return!1}else 3===o.nodeType&&(!r.nodeStart&&r.pos+o.data.length>r.node.posOpen&&(r.nodeStart=o,r.nodeStartPos=r.node.posOpen-r.pos),r.nodeStart&&r.pos+o.data.length>=r.node.posClose&&(r.nodeEnd=o,r.nodeEndPos=r.node.posClose-r.pos),r.pos+=o.data.length);if(r.nodeStart&&r.nodeEnd){var s=document.createRange();return s.setStart(r.nodeStart,r.nodeStartPos),s.setEnd(r.nodeEnd,r.nodeEndPos),r.node.element.innerHTML="",r.node.element.appendChild(s.extractContents()),s.insertNode(r.node.element),s.detach(),!1}}return!0};t.keepMarkup.forEach((function(r){e(t.element,{node:r,pos:0})})),t.highlightedCode=t.element.innerHTML}})))},5622:function(){!function(){if("undefined"!=typeof Prism&&"undefined"!=typeof document){var t="line-numbers",e=/\n(?!$)/g,r=Prism.plugins.lineNumbers={getLine:function(e,r){if("PRE"===e.tagName&&e.classList.contains(t)){var n=e.querySelector(".line-numbers-rows");if(n){var i=parseInt(e.getAttribute("data-start"),10)||1,o=i+(n.children.length-1);r<i&&(r=i),r>o&&(r=o);var s=r-i;return n.children[s]}}},resize:function(t){i([t])},assumeViewportIndependence:!0},n=void 0;window.addEventListener("resize",(function(){r.assumeViewportIndependence&&n===window.innerWidth||(n=window.innerWidth,i(Array.prototype.slice.call(document.querySelectorAll("pre."+t))))})),Prism.hooks.add("complete",(function(r){if(r.code){var n=r.element,o=n.parentNode;if(o&&/pre/i.test(o.nodeName)&&!n.querySelector(".line-numbers-rows")&&Prism.util.isActive(n,t)){n.classList.remove(t),o.classList.add(t);var s,a=r.code.match(e),l=a?a.length+1:1,c=new Array(l+1).join("<span></span>");(s=document.createElement("span")).setAttribute("aria-hidden","true"),s.className="line-numbers-rows",s.innerHTML=c,o.hasAttribute("data-start")&&(o.style.counterReset="linenumber "+(parseInt(o.getAttribute("data-start"),10)-1)),r.element.appendChild(s),i([o]),Prism.hooks.run("line-numbers",r)}}})),Prism.hooks.add("line-numbers",(function(t){t.plugins=t.plugins||{},t.plugins.lineNumbers=!0}))}function i(t){if(0!=(t=t.filter((function(t){var e,r=(e=t,e?window.getComputedStyle?getComputedStyle(e):e.currentStyle||null:null)["white-space"];return"pre-wrap"===r||"pre-line"===r}))).length){var r=t.map((function(t){var r=t.querySelector("code"),n=t.querySelector(".line-numbers-rows");if(r&&n){var i=t.querySelector(".line-numbers-sizer"),o=r.textContent.split(e);i||((i=document.createElement("span")).className="line-numbers-sizer",r.appendChild(i)),i.innerHTML="0",i.style.display="block";var s=i.getBoundingClientRect().height;return i.innerHTML="",{element:t,lines:o,lineHeights:[],oneLinerHeight:s,sizer:i}}})).filter(Boolean);r.forEach((function(t){var e=t.sizer,r=t.lines,n=t.lineHeights,i=t.oneLinerHeight;n[r.length-1]=void 0,r.forEach((function(t,r){if(t&&t.length>1){var o=e.appendChild(document.createElement("span"));o.style.display="block",o.textContent=t}else n[r]=i}))})),r.forEach((function(t){for(var e=t.sizer,r=t.lineHeights,n=0,i=0;i<r.length;i++)void 0===r[i]&&(r[i]=e.children[n++].getBoundingClientRect().height)})),r.forEach((function(t){var e=t.sizer,r=t.element.querySelector(".line-numbers-rows");e.style.display="none",e.innerHTML="",t.lineHeights.forEach((function(t,e){r.children[e].style.height=t+"px"}))}))}}}()},7951:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.aggregateResultsByModule=void 0;const n=r(5740);function i(t,e){if(e){const r=o.bind(void 0,t);return e.map(r)}}function o(t,e){return`${t}_${e}`}e.aggregateResultsByModule=function(t){const e=Object.values(t).map((t=>t.projectRoot)).filter(n.isNotNullish),r={files:{},schemaVersion:"1.7",thresholds:t[0]?.thresholds??{high:80,low:60},projectRoot:e.length?(0,n.determineCommonBasePath)(e):void 0,config:{}};return Object.entries(t).reduce(((t,[e,s])=>{if(Object.entries((0,n.normalizeFileNames)(s.files)).forEach((([t,n])=>{r.files[`${e}/${t}`]={...n,mutants:[...n.mutants.map((({id:t,coveredBy:r,killedBy:n,...s})=>({...s,id:o(e,t),killedBy:i(e,n),coveredBy:i(e,r)})))]}})),s.testFiles){const t=r.testFiles??(r.testFiles=Object.create(null));Object.entries((0,n.normalizeFileNames)(s.testFiles)).forEach((([r,n])=>{t[`${e}/${r}`]={...n,tests:n.tests.map((({id:t,...r})=>({...r,id:o(e,t)})))}}))}return t}),r)}},2103:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.countFileMetrics=e.countTestFileMetrics=e.calculateFileMetrics=e.calculateMutationTestMetrics=e.calculateMetrics=void 0;const n=r(5740),i=r(9130),o=r(5740),s=r(8533),a=r(8689),l="All files";function c(t,e,r){const n=Object.keys(e);return 1===n.length&&""===n[0]?d(t,e[n[0]],r):u(t,e,r)}function u(t,e,r){const i=r(Object.values(e)),a=function(t,e){const r=(0,o.groupBy)(Object.entries(t),(t=>t[0].split("/")[0]));return Object.keys(r).map((t=>{if(r[t].length>1||r[t][0][0]!==t){const n={};return r[t].forEach((e=>n[e[0].substr(t.length+1)]=e[1])),u(t,n,e)}{const[n,i]=r[t][0];return d(n,i,e)}})).sort(n.compareNames)}(e,r);return new s.MetricsResult(t,a,i)}function d(t,e,r){return new s.MetricsResult(t,[],r([e]),e)}function h(t){const e=t.flatMap((t=>t.tests)),r=t=>e.filter((e=>e.status===t)).length;return{total:e.length,killing:r(a.TestStatus.Killing),covering:r(a.TestStatus.Covering),notCovering:r(a.TestStatus.NotCovering)}}function p(t){const e=t.flatMap((t=>t.mutants)),r=t=>e.filter((e=>e.status===t)).length,n=r(i.MutantStatus.Pending),o=r(i.MutantStatus.Killed),s=r(i.MutantStatus.Timeout),a=r(i.MutantStatus.Survived),l=r(i.MutantStatus.NoCoverage),c=r(i.MutantStatus.RuntimeError),u=r(i.MutantStatus.CompileError),d=r(i.MutantStatus.Ignored),h=s+o,p=a+l,f=h+a,m=p+h,g=c+u;return{pending:n,killed:o,timeout:s,survived:a,noCoverage:l,runtimeErrors:c,compileErrors:u,ignored:d,totalDetected:h,totalUndetected:p,totalCovered:f,totalValid:m,totalInvalid:g,mutationScore:m>0?h/m*100:NaN,totalMutants:m+g+d+n,mutationScoreBasedOnCoveredCode:m>0?h/f*100||0:NaN}}e.calculateMetrics=function(t){const e=(0,n.normalize)(t,"",((t,e)=>new s.FileUnderTestModel(t,e)));return u(l,e,p)},e.calculateMutationTestMetrics=function(t){const{files:e,testFiles:r,projectRoot:i=""}=t,o=(0,n.normalize)(e,i,((t,e)=>new s.FileUnderTestModel(t,e)));if(r&&Object.keys(r).length){const t=(0,n.normalize)(r,i,((t,e)=>new s.TestFileModel(t,e)));return function(t,e){const r=new Map(e.map((t=>[t.id,t])));for(const e of t){const t=e.coveredBy?.map((t=>r.get(t)))??[];for(const r of t)r&&(e.addCoveredBy(r),r.addCovered(e));const n=e.killedBy?.map((t=>r.get(t)))??[];for(const t of n)t&&(e.addKilledBy(t),t.addKilled(e))}}(Object.values(o).flatMap((t=>t.mutants)),Object.values(t).flatMap((t=>t.tests))),{systemUnderTestMetrics:c(l,o,p),testMetrics:c("All tests",t,h)}}return{systemUnderTestMetrics:c(l,o,p),testMetrics:void 0}},e.calculateFileMetrics=d,e.countTestFileMetrics=h,e.countFileMetrics=p},400:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compareNames=e.determineCommonBasePath=e.normalize=e.normalizeFileNames=void 0;const r="/";function n(t,e,r){const n=Object.keys(t),s=o(n),a=Object.create(null);return n.forEach((n=>{const o=i(n.startsWith(e)?n.substr(e.length):n);a[i(n.substr(s.length))]=r(t[n],o)})),a}function i(t){return t.split(/\/|\\/).filter(Boolean).join("/")}function o(t){const e=t.map((t=>t.split(/\/|\\/).slice(0,-1)));return t.length?e.reduce((function(t,e){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t.splice(0,r);return t})).join(r):""}e.normalizeFileNames=function(t,e=""){return n(t,e,(t=>t))},e.normalize=n,e.determineCommonBasePath=o,e.compareNames=function(t,e){const r=t=>t.file?`1${t.name}`:`0${t.name}`;return r(t).localeCompare(r(e))}},7648:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.groupBy=void 0,e.groupBy=function(t,e){return t.reduce(((t,r)=>{const n=e(r);return Object.prototype.hasOwnProperty.call(t,n)||(t[n]=[]),t[n].push(r),t}),{})}},5740:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(7648),e),i(r(400),e),i(r(9676),e),i(r(3029),e)},3029:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNotNullish=void 0,e.isNotNullish=function(t){return null!=t}},9676:function(t,e){"use strict";function r(t){return 10===t||13===t||8232===t||8233===t}Object.defineProperty(e,"__esModule",{value:!0}),e.computeLineStarts=void 0,e.computeLineStarts=function(t){const e=[];let n=0,i=0;function o(t){e.push(i),i=t}for(o(0);n<t.length;){const e=t.charCodeAt(n);switch(n++,e){case 13:10===t.charCodeAt(n)&&n++,o(n);break;case 10:o(n);break;default:e>127&&r(e)&&o(n)}}return e.push(i),e}},4193:function(t,e,r){"use strict";e.ih=e.xR=void 0;var n=r(2103);Object.defineProperty(e,"xR",{enumerable:!0,get:function(){return n.calculateMutationTestMetrics}});r(7951),r(5740);var i=r(8533);Object.defineProperty(e,"ih",{enumerable:!0,get:function(){return i.TestStatus}})},1211:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileUnderTestModel=void 0;const n=r(1223),i=r(7966);class o extends i.SourceFile{constructor(t,e){super(),this.name=e,this.language=t.language,this.source=t.source,this.mutants=t.mutants.map((t=>{const e=new n.MutantModel(t);return e.sourceFile=this,e}))}getMutationLines(t){const e=this.getLineMap(),r=e[t.location.start.line],n=e[t.location.end.line],i=e[t.location.end.line+1];return`${this.source.substr(r,t.location.start.column-1)}${t.replacement??t.description??t.mutatorName}${this.source.substring(n+t.location.end.column-1,i)}`}}e.FileUnderTestModel=o},8533:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TestStatus=e.TestModel=e.TestFileModel=e.MutantModel=e.MetricsResult=e.FileUnderTestModel=void 0;var n=r(1211);Object.defineProperty(e,"FileUnderTestModel",{enumerable:!0,get:function(){return n.FileUnderTestModel}});var i=r(9522);Object.defineProperty(e,"MetricsResult",{enumerable:!0,get:function(){return i.MetricsResult}});var o=r(1223);Object.defineProperty(e,"MutantModel",{enumerable:!0,get:function(){return o.MutantModel}});var s=r(7100);Object.defineProperty(e,"TestFileModel",{enumerable:!0,get:function(){return s.TestFileModel}});var a=r(8689);Object.defineProperty(e,"TestModel",{enumerable:!0,get:function(){return a.TestModel}}),Object.defineProperty(e,"TestStatus",{enumerable:!0,get:function(){return a.TestStatus}})},9522:function(t,e,r){"use strict";var n,i,o=this&&this.__classPrivateFieldGet||function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.MetricsResult=void 0;const s=r(2103);e.MetricsResult=class{constructor(t,e,r,i){n.add(this),this.name=t,this.childResults=e,this.metrics=r,this.file=i}updateParent(t){this.parent=t,this.childResults.forEach((t=>t.updateParent(this)))}updateAllMetrics(){void 0===this.parent?this.updateMetrics():this.parent.updateAllMetrics()}updateMetrics(){if(void 0!==this.file)this.file.tests?this.metrics=(0,s.countTestFileMetrics)([this.file]):this.metrics=(0,s.countFileMetrics)([this.file]);else{this.childResults.forEach((t=>{t.updateMetrics()}));const t=o(this,n,"m",i).call(this,this.childResults);if(0===t.length)return;t[0].tests?this.metrics=(0,s.countTestFileMetrics)(t):this.metrics=(0,s.countFileMetrics)(t)}}},n=new WeakSet,i=function t(e){const r=[];return 0===e.length||e.forEach((e=>{e.file?r.push(e.file):r.push(...o(this,n,"m",t).call(this,e.childResults))})),r}},1223:function(t,e){"use strict";var r,n,i=this&&this.__classPrivateFieldGet||function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};function o(t){if(void 0===t)throw new Error("mutant.sourceFile was not defined")}Object.defineProperty(e,"__esModule",{value:!0}),e.MutantModel=void 0,e.MutantModel=class{constructor(t){r.set(this,new Map),n.set(this,new Map),this.coveredBy=t.coveredBy,this.description=t.description,this.duration=t.duration,this.id=t.id,this.killedBy=t.killedBy,this.location=t.location,this.mutatorName=t.mutatorName,this.replacement=t.replacement,this.static=t.static,this.status=t.status,this.statusReason=t.statusReason,this.testsCompleted=t.testsCompleted}addCoveredBy(t){this.coveredByTests||(this.coveredByTests=[]),i(this,r,"f").has(t.id)||(i(this,r,"f").set(t.id,t),this.coveredByTests?.push(t))}addKilledBy(t){this.killedByTests||(this.killedByTests=[]),i(this,n,"f").has(t.id)||(i(this,n,"f").set(t.id,t),this.killedByTests?.push(t))}getMutatedLines(){return o(this.sourceFile),this.sourceFile.getMutationLines(this)}getOriginalLines(){return o(this.sourceFile),this.sourceFile.getLines(this.location)}get fileName(){return o(this.sourceFile),this.sourceFile.name}update(){this.sourceFile?.result?.file&&this.sourceFile.result.updateAllMetrics()}},r=new WeakMap,n=new WeakMap},7966:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SourceFile=e.assertSourceDefined=void 0;const n=r(5740);function i(t){if(void 0===t)throw new Error("sourceFile.source is undefined")}e.assertSourceDefined=i,e.SourceFile=class{getLineMap(){return i(this.source),this.lineMap??(this.lineMap=(0,n.computeLineStarts)(this.source))}getLines(t){i(this.source);const e=this.getLineMap();return this.source.substring(e[t.start.line],e[(t.end??t.start).line+1])}}},7100:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TestFileModel=void 0;const n=r(7966),i=r(8689);class o extends n.SourceFile{constructor(t,e){super(),this.name=e,this.source=t.source,this.tests=t.tests.map((t=>{const e=new i.TestModel(t);return e.sourceFile=this,e}))}}e.TestFileModel=o},8689:function(t,e){"use strict";var r,n,i,o=this&&this.__classPrivateFieldGet||function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};function s(t){if(void 0===t)throw new Error("test.sourceFile was not defined")}Object.defineProperty(e,"__esModule",{value:!0}),e.TestModel=e.TestStatus=void 0,function(t){t.Killing="Killing",t.Covering="Covering",t.NotCovering="NotCovering"}(i||(e.TestStatus=i={})),e.TestModel=class{addCovered(t){this.coveredMutants||(this.coveredMutants=[]),o(this,n,"f").has(t.id)||(o(this,n,"f").set(t.id,t),this.coveredMutants.push(t))}addKilled(t){this.killedMutants||(this.killedMutants=[]),o(this,r,"f").has(t.id)||(o(this,r,"f").set(t.id,t),this.killedMutants.push(t))}constructor(t){r.set(this,new Map),n.set(this,new Map),Object.entries(t).forEach((([t,e])=>{this[t]=e}))}getLines(){return s(this.sourceFile),function(t){if(void 0===t)throw new Error("test.location was not defined")}(this.location),this.sourceFile.getLines(this.location)}get fileName(){return s(this.sourceFile),this.sourceFile.name}get status(){return this.killedMutants?.length?i.Killing:this.coveredMutants?.length?i.Covering:i.NotCovering}update(){this.sourceFile?.result?.file&&this.sourceFile.result.updateAllMetrics()}},r=new WeakMap,n=new WeakMap},9130:function(t,e){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.MutantStatus=void 0,function(t){t.Killed="Killed",t.Survived="Survived",t.NoCoverage="NoCoverage",t.CompileError="CompileError",t.RuntimeError="RuntimeError",t.Timeout="Timeout",t.Ignored="Ignored",t.Pending="Pending"}(r||(e.MutantStatus=r={}))},9138:function(t){"use strict";t.exports="data:image/svg+xml;charset=UTF8,<svg xmlns=%27http://www.w3.org/2000/svg%27 height=%273%27 width=%276%27><g fill=%27%23ef4444%27><path d=%27m5.5 0-3 3H1.1l3-3z%27/><path d=%27m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z%27/></g></svg>"},3783:function(t){"use strict";t.exports="data:image/svg+xml;charset=UTF8,<svg xmlns=%27http://www.w3.org/2000/svg%27 height=%273%27 width=%276%27><g fill=%27%23fb923c%27><path d=%27m5.5 0-3 3H1.1l3-3z%27/><path d=%27m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z%27/></g></svg>"},4995:function(t){"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 16 16%27%3E%3Ccircle cx=%278%27 cy=%278%27 r=%273%27/%3E%3C/svg%3E"},1716:function(t){"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27%23fff%27 viewBox=%270 0 16 16%27%3E%3Cpath d=%27M12.207 4.793a1 1 0 0 1 0 1.414l-5 5a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L6.5 9.086l4.293-4.293a1 1 0 0 1 1.414 0z%27/%3E%3C/svg%3E"},421:function(t){"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27none%27 viewBox=%270 0 16 16%27%3E%3Cpath stroke=%27%23fff%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27M4 8h8%27/%3E%3C/svg%3E"},6526:function(t){"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27none%27 viewBox=%270 0 20 20%27%3E%3Cpath stroke=%27rgb%28var%28--mut-gray-500, 113 113 122%29 / var%28--tw-stroke-opacity, 1%29%29%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%271.5%27 d=%27m6 8 4 4 4-4%27/%3E%3C/svg%3E"}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={id:n,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}r.m=t,r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.b=document.baseURI||self.location.href,function(){"use strict";const t=window,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),i=new WeakMap;class o{constructor(t,e,r){if(this._$cssResult$=!0,r!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const r=this.t;if(e&&void 0===t){const e=void 0!==r&&1===r.length;e&&(t=i.get(r)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&i.set(r,t))}return t}toString(){return this.cssText}}const s=t=>new o("string"==typeof t?t:t+"",void 0,n),a=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const r of t.cssRules)e+=r.cssText;return s(e)})(t):t;var l;const c=window,u=c.trustedTypes,d=u?u.emptyScript:"",h=c.reactiveElementPolyfillSupport,p={toAttribute(t,e){switch(e){case Boolean:t=t?d:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=null!==t;break;case Number:r=null===t?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch(t){r=null}}return r}},f=(t,e)=>e!==t&&(e==e||t==t),m={attribute:!0,type:String,converter:p,reflect:!1,hasChanged:f};class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,r)=>{const n=this._$Ep(r,e);void 0!==n&&(this._$Ev.set(n,r),t.push(n))})),t}static createProperty(t,e=m){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const r="symbol"==typeof t?Symbol():"__"+t,n=this.getPropertyDescriptor(t,r,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}}static getPropertyDescriptor(t,e,r){return{get(){return this[e]},set(n){const i=this[t];this[e]=n,this.requestUpdate(t,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||m}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const r of e)this.createProperty(r,t[r])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const t of r)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const r=e.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,r;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(r=t.hostConnected)||void 0===r||r.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var r;const n=null!==(r=this.shadowRoot)&&void 0!==r?r:this.attachShadow(this.constructor.shadowRootOptions);return((r,n)=>{e?r.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((e=>{const n=document.createElement("style"),i=t.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,r.appendChild(n)}))})(n,this.constructor.elementStyles),n}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,r){this._$AK(t,r)}_$EO(t,e,r=m){var n;const i=this.constructor._$Ep(t,r);if(void 0!==i&&!0===r.reflect){const o=(void 0!==(null===(n=r.converter)||void 0===n?void 0:n.toAttribute)?r.converter:p).toAttribute(e,r.type);this._$El=t,null==o?this.removeAttribute(i):this.setAttribute(i,o),this._$El=null}}_$AK(t,e){var r;const n=this.constructor,i=n._$Ev.get(t);if(void 0!==i&&this._$El!==i){const t=n.getPropertyOptions(i),o="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(r=t.converter)||void 0===r?void 0:r.fromAttribute)?t.converter:p;this._$El=i,this[i]=o.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,r){let n=!0;void 0!==t&&(((r=r||this.constructor.getPropertyOptions(t)).hasChanged||f)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===r.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,r))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(r)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(r)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var v;g.finalized=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:"open"},null==h||h({ReactiveElement:g}),(null!==(l=c.reactiveElementVersions)&&void 0!==l?l:c.reactiveElementVersions=[]).push("1.6.1");const b=window,y=b.trustedTypes,w=y?y.createPolicy("lit-html",{createHTML:t=>t}):void 0,x="$lit$",k=`lit$${(Math.random()+"").slice(9)}$`,$="?"+k,S=`<${$}>`,_=document,A=()=>_.createComment(""),M=t=>null===t||"object"!=typeof t&&"function"!=typeof t,C=Array.isArray,E=t=>C(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]),P="[ \t\n\f\r]",T=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,j=/-->/g,F=/>/g,z=RegExp(`>|${P}(?:([^\\s"'>=/]+)(${P}*=${P}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),O=/'/g,R=/"/g,N=/^(?:script|style|textarea|title)$/i,B=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),L=B(1),D=B(2),I=Symbol.for("lit-noChange"),U=Symbol.for("lit-nothing"),H=new WeakMap,Z=_.createTreeWalker(_,129,null,!1),K=(t,e)=>{const r=t.length-1,n=[];let i,o=2===e?"<svg>":"",s=T;for(let e=0;e<r;e++){const r=t[e];let a,l,c=-1,u=0;for(;u<r.length&&(s.lastIndex=u,l=s.exec(r),null!==l);)u=s.lastIndex,s===T?"!--"===l[1]?s=j:void 0!==l[1]?s=F:void 0!==l[2]?(N.test(l[2])&&(i=RegExp("</"+l[2],"g")),s=z):void 0!==l[3]&&(s=z):s===z?">"===l[0]?(s=null!=i?i:T,c=-1):void 0===l[1]?c=-2:(c=s.lastIndex-l[2].length,a=l[1],s=void 0===l[3]?z:'"'===l[3]?R:O):s===R||s===O?s=z:s===j||s===F?s=T:(s=z,i=void 0);const d=s===z&&t[e+1].startsWith("/>")?" ":"";o+=s===T?r+S:c>=0?(n.push(a),r.slice(0,c)+x+r.slice(c)+k+d):r+k+(-2===c?(n.push(void 0),e):d)}const a=o+(t[r]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==w?w.createHTML(a):a,n]};class q{constructor({strings:t,_$litType$:e},r){let n;this.parts=[];let i=0,o=0;const s=t.length-1,a=this.parts,[l,c]=K(t,e);if(this.el=q.createElement(l,r),Z.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(n=Z.nextNode())&&a.length<s;){if(1===n.nodeType){if(n.hasAttributes()){const t=[];for(const e of n.getAttributeNames())if(e.endsWith(x)||e.startsWith(k)){const r=c[o++];if(t.push(e),void 0!==r){const t=n.getAttribute(r.toLowerCase()+x).split(k),e=/([.?@])?(.*)/.exec(r);a.push({type:1,index:i,name:e[2],strings:t,ctor:"."===e[1]?J:"?"===e[1]?X:"@"===e[1]?tt:Y})}else a.push({type:6,index:i})}for(const e of t)n.removeAttribute(e)}if(N.test(n.tagName)){const t=n.textContent.split(k),e=t.length-1;if(e>0){n.textContent=y?y.emptyScript:"";for(let r=0;r<e;r++)n.append(t[r],A()),Z.nextNode(),a.push({type:2,index:++i});n.append(t[e],A())}}}else if(8===n.nodeType)if(n.data===$)a.push({type:2,index:i});else{let t=-1;for(;-1!==(t=n.data.indexOf(k,t+1));)a.push({type:7,index:i}),t+=k.length-1}i++}}static createElement(t,e){const r=_.createElement("template");return r.innerHTML=t,r}}function V(t,e,r=t,n){var i,o,s,a;if(e===I)return e;let l=void 0!==n?null===(i=r._$Co)||void 0===i?void 0:i[n]:r._$Cl;const c=M(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(o=null==l?void 0:l._$AO)||void 0===o||o.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,r,n)),void 0!==n?(null!==(s=(a=r)._$Co)&&void 0!==s?s:a._$Co=[])[n]=l:r._$Cl=l),void 0!==l&&(e=V(t,l._$AS(t,e.values),l,n)),e}class W{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:r},parts:n}=this._$AD,i=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:_).importNode(r,!0);Z.currentNode=i;let o=Z.nextNode(),s=0,a=0,l=n[0];for(;void 0!==l;){if(s===l.index){let e;2===l.type?e=new G(o,o.nextSibling,this,t):1===l.type?e=new l.ctor(o,l.name,l.strings,this,t):6===l.type&&(e=new et(o,this,t)),this._$AV.push(e),l=n[++a]}s!==(null==l?void 0:l.index)&&(o=Z.nextNode(),s++)}return Z.currentNode=_,i}v(t){let e=0;for(const r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,e),e+=r.strings.length-2):r._$AI(t[e])),e++}}class G{constructor(t,e,r,n){var i;this.type=2,this._$AH=U,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=r,this.options=n,this._$Cp=null===(i=null==n?void 0:n.isConnected)||void 0===i||i}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=V(this,t,e),M(t)?t===U||null==t||""===t?(this._$AH!==U&&this._$AR(),this._$AH=U):t!==this._$AH&&t!==I&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):E(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==U&&M(this._$AH)?this._$AA.nextSibling.data=t:this.$(_.createTextNode(t)),this._$AH=t}g(t){var e;const{values:r,_$litType$:n}=t,i="number"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=q.createElement(n.h,this.options)),n);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===i)this._$AH.v(r);else{const t=new W(i,this),e=t.u(this.options);t.v(r),this.$(e),this._$AH=t}}_$AC(t){let e=H.get(t.strings);return void 0===e&&H.set(t.strings,e=new q(t)),e}T(t){C(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let r,n=0;for(const i of t)n===e.length?e.push(r=new G(this.k(A()),this.k(A()),this,this.options)):r=e[n],r._$AI(i),n++;n<e.length&&(this._$AR(r&&r._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){var r;for(null===(r=this._$AP)||void 0===r||r.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class Y{constructor(t,e,r,n,i){this.type=1,this._$AH=U,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=U}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,r,n){const i=this.strings;let o=!1;if(void 0===i)t=V(this,t,e,0),o=!M(t)||t!==this._$AH&&t!==I,o&&(this._$AH=t);else{const n=t;let s,a;for(t=i[0],s=0;s<i.length-1;s++)a=V(this,n[r+s],e,s),a===I&&(a=this._$AH[s]),o||(o=!M(a)||a!==this._$AH[s]),a===U?t=U:t!==U&&(t+=(null!=a?a:"")+i[s+1]),this._$AH[s]=a}o&&!n&&this.j(t)}j(t){t===U?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class J extends Y{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===U?void 0:t}}const Q=y?y.emptyScript:"";class X extends Y{constructor(){super(...arguments),this.type=4}j(t){t&&t!==U?this.element.setAttribute(this.name,Q):this.element.removeAttribute(this.name)}}class tt extends Y{constructor(t,e,r,n,i){super(t,e,r,n,i),this.type=5}_$AI(t,e=this){var r;if((t=null!==(r=V(this,t,e,0))&&void 0!==r?r:U)===I)return;const n=this._$AH,i=t===U&&n!==U||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,o=t!==U&&(n===U||i);i&&this.element.removeEventListener(this.name,this,n),o&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,r;"function"==typeof this._$AH?this._$AH.call(null!==(r=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==r?r:this.element,t):this._$AH.handleEvent(t)}}class et{constructor(t,e,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){V(this,t)}}const rt={O:x,P:k,A:$,C:1,M:K,L:W,D:E,R:V,I:G,V:Y,H:X,N:tt,U:J,F:et},nt=b.litHtmlPolyfillSupport;var it,ot;null==nt||nt(q,G),(null!==(v=b.litHtmlVersions)&&void 0!==v?v:b.litHtmlVersions=[]).push("2.7.4");class st extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const r=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=r.firstChild),r}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,r)=>{var n,i;const o=null!==(n=null==r?void 0:r.renderBefore)&&void 0!==n?n:e;let s=o._$litPart$;if(void 0===s){const t=null!==(i=null==r?void 0:r.renderBefore)&&void 0!==i?i:null;o._$litPart$=s=new G(e.insertBefore(A(),t),t,void 0,null!=r?r:{})}return s._$AI(t),s})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return I}}st.finalized=!0,st._$litElement$=!0,null===(it=globalThis.litElementHydrateSupport)||void 0===it||it.call(globalThis,{LitElement:st});const at=globalThis.litElementPolyfillSupport;null==at||at({LitElement:st}),(null!==(ot=globalThis.litElementVersions)&&void 0!==ot?ot:globalThis.litElementVersions=[]).push("3.3.2");const lt=t=>e=>"function"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:r,elements:n}=e;return{kind:r,elements:n,finisher(e){customElements.define(t,e)}}})(t,e),ct=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(r){r.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(r){r.createProperty(e.key,t)}};function ut(t){return(e,r)=>void 0!==r?((t,e,r)=>{e.constructor.createProperty(r,t)})(t,e,r):ct(t,e)}function dt(t){return ut({...t,state:!0})}var ht;null===(ht=window.HTMLSlotElement)||void 0===ht||ht.prototype.assignedElements;var pt=r(4193),ft=r(7063),mt=r(6773),gt=r(5043),vt=r(3712);r(5622),r(8267),r(4883),r(3083),r(8423),r(3701),r(458),r(7252),r(5744),r(3502),r(4999),r(4882);const bt=s(ft.Z),yt=s(mt.Z),wt=s(gt.Z);function xt(t){return"function"==typeof t}function kt(t){return function(e){if(function(t){return xt(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}var $t=function(t,e){return $t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},$t(t,e)};function St(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}$t(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function _t(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function At(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mt(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function Ct(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}function Et(t){return this instanceof Et?(this.v=t,this):new Et(t)}function Pt(t){var e=t((function(t){Error.call(t),t.stack=(new Error).stack}));return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}Object.create,Object.create;var Tt=Pt((function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}));function jt(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var Ft=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var t,e,r,n,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=At(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}else o.remove(this);var l=this.initialTeardown;if(xt(l))try{l()}catch(t){i=t instanceof Tt?t.errors:[t]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=At(c),d=u.next();!d.done;d=u.next()){var h=d.value;try{Rt(h)}catch(t){i=null!=i?i:[],t instanceof Tt?i=Ct(Ct([],Mt(i)),Mt(t.errors)):i.push(t)}}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}if(i)throw new Tt(i)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)Rt(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&jt(e,t)},t.prototype.remove=function(e){var r=this._finalizers;r&&jt(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t;var e}(),zt=Ft.EMPTY;function Ot(t){return t instanceof Ft||t&&"closed"in t&&xt(t.remove)&&xt(t.add)&&xt(t.unsubscribe)}function Rt(t){xt(t)?t():t.unsubscribe()}var Nt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Bt={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=Bt.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,Ct([t,e],Mt(r))):setTimeout.apply(void 0,Ct([t,e],Mt(r)))},clearTimeout:function(t){var e=Bt.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Lt(t){Bt.setTimeout((function(){var e=Nt.onUnhandledError;if(!e)throw t;e(t)}))}function Dt(){}var It=Ut("C",void 0,void 0);function Ut(t,e,r){return{kind:t,value:e,error:r}}var Ht=null;function Zt(t){if(Nt.useDeprecatedSynchronousErrorHandling){var e=!Ht;if(e&&(Ht={errorThrown:!1,error:null}),t(),e){var r=Ht,n=r.errorThrown,i=r.error;if(Ht=null,n)throw i}}else t()}var Kt=function(t){function e(e){var r=t.call(this)||this;return r.isStopped=!1,e?(r.destination=e,Ot(e)&&e.add(r)):r.destination=Qt,r}return St(e,t),e.create=function(t,e,r){return new Gt(t,e,r)},e.prototype.next=function(t){this.isStopped?Jt(function(t){return Ut("N",t,void 0)}(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?Jt(Ut("E",void 0,t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?Jt(It,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Ft),qt=Function.prototype.bind;function Vt(t,e){return qt.call(t,e)}var Wt=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){Yt(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){Yt(t)}else Yt(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){Yt(t)}},t}(),Gt=function(t){function e(e,r,n){var i,o,s=t.call(this)||this;return xt(e)||!e?i={next:null!=e?e:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:s&&Nt.useDeprecatedNextContext?((o=Object.create(e)).unsubscribe=function(){return s.unsubscribe()},i={next:e.next&&Vt(e.next,o),error:e.error&&Vt(e.error,o),complete:e.complete&&Vt(e.complete,o)}):i=e,s.destination=new Wt(i),s}return St(e,t),e}(Kt);function Yt(t){var e;Nt.useDeprecatedSynchronousErrorHandling?(e=t,Nt.useDeprecatedSynchronousErrorHandling&&Ht&&(Ht.errorThrown=!0,Ht.error=e)):Lt(t)}function Jt(t,e){var r=Nt.onStoppedNotification;r&&Bt.setTimeout((function(){return r(t,e)}))}var Qt={closed:!0,next:Dt,error:function(t){throw t},complete:Dt};function Xt(t,e,r,n,i){return new te(t,e,r,n,i)}var te=function(t){function e(e,r,n,i,o,s){var a=t.call(this,e)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=r?function(t){try{r(t)}catch(t){e.error(t)}}:t.prototype._next,a._error=i?function(t){try{i(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=n?function(){try{n()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return St(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(Kt);function ee(t,e){return kt((function(r,n){var i=0;r.subscribe(Xt(n,(function(r){n.next(t.call(e,r,i++))})))}))}var re=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function ne(t){return xt(null==t?void 0:t.then)}var ie="function"==typeof Symbol&&Symbol.observable||"@@observable";function oe(t){return t}var se=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n,i=this,o=(n=t)&&n instanceof Kt||function(t){return t&&xt(t.next)&&xt(t.error)&&xt(t.complete)}(n)&&Ot(n)?t:new Gt(t,e,r);return Zt((function(){var t=i,e=t.operator,r=t.source;o.add(e?e.call(o,r):r?i._subscribe(o):i._trySubscribe(o))})),o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=ae(e))((function(e,n){var i=new Gt({next:function(e){try{t(e)}catch(t){n(t),i.unsubscribe()}},error:n,complete:e});r.subscribe(i)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[ie]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0===(r=t).length?oe:1===r.length?r[0]:function(t){return r.reduce((function(t,e){return e(t)}),t)})(this);var r},t.prototype.toPromise=function(t){var e=this;return new(t=ae(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function ae(t){var e;return null!==(e=null!=t?t:Nt.Promise)&&void 0!==e?e:Promise}function le(t){return xt(t[ie])}function ce(t){return Symbol.asyncIterator&&xt(null==t?void 0:t[Symbol.asyncIterator])}function ue(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var de="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function he(t){return xt(null==t?void 0:t[de])}function pe(t){return function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){o.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{!function(t){t.value instanceof Et?Promise.resolve(t.value.v).then(l,c):u(o[0][2],t)}(i[t](e))}catch(t){u(o[0][3],t)}}function l(t){a("next",t)}function c(t){a("throw",t)}function u(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var e,r,n;return _t(this,(function(i){switch(i.label){case 0:e=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Et(e.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,Et(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Et(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}function fe(t){return xt(null==t?void 0:t.getReader)}function me(t){if(t instanceof se)return t;if(null!=t){if(le(t))return i=t,new se((function(t){var e=i[ie]();if(xt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(re(t))return n=t,new se((function(t){for(var e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()}));if(ne(t))return r=t,new se((function(t){r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Lt)}));if(ce(t))return ge(t);if(he(t))return e=t,new se((function(t){var r,n;try{for(var i=At(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()}));if(fe(t))return ge(pe(t))}var e,r,n,i;throw ue(t)}function ge(t){return new se((function(e){(function(t,e){var r,n,i,o;return function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){var s,a;return _t(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=At(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}}(t),l.label=1;case 1:return[4,r.next()];case 2:if((n=l.sent()).done)return[3,4];if(s=n.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(o=r.return)?[4,o.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))}))})(t,e).catch((function(t){return e.error(t)}))}))}function ve(t,e,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=e.schedule((function(){r(),i?t.add(this.schedule(null,n)):this.unsubscribe()}),n);if(t.add(o),!i)return o}function be(t,e,r){return void 0===r&&(r=1/0),xt(e)?be((function(r,n){return ee((function(t,i){return e(r,t,n,i)}))(me(t(r,n)))}),r):("number"==typeof e&&(r=e),kt((function(e,n){return function(t,e,r,n,i,o,s,a){var l=[],c=0,u=0,d=!1,h=function(){!d||l.length||c||e.complete()},p=function(t){return c<n?f(t):l.push(t)},f=function(t){c++;var i=!1;me(r(t,u++)).subscribe(Xt(e,(function(t){e.next(t)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(;l.length&&c<n;)t=void 0,t=l.shift(),f(t);h()}catch(t){e.error(t)}var t})))};return t.subscribe(Xt(e,p,(function(){d=!0,h()}))),function(){}}(e,n,t,r)})))}var ye=new se((function(t){return t.complete()}));function we(t){return t&&xt(t.schedule)}function xe(t){return t[t.length-1]}function ke(t){return we(xe(t))?t.pop():void 0}function $e(t,e){return void 0===e&&(e=0),kt((function(r,n){r.subscribe(Xt(n,(function(r){return ve(n,t,(function(){return n.next(r)}),e)}),(function(){return ve(n,t,(function(){return n.complete()}),e)}),(function(r){return ve(n,t,(function(){return n.error(r)}),e)})))}))}function Se(t,e){return void 0===e&&(e=0),kt((function(r,n){n.add(t.schedule((function(){return r.subscribe(n)}),e))}))}function _e(t,e){if(!t)throw new Error("Iterable cannot be null");return new se((function(r){ve(r,e,(function(){var n=t[Symbol.asyncIterator]();ve(r,e,(function(){n.next().then((function(t){t.done?r.complete():r.next(t.value)}))}),0,!0)}))}))}function Ae(t,e){return e?function(t,e){if(null!=t){if(le(t))return function(t,e){return me(t).pipe(Se(e),$e(e))}(t,e);if(re(t))return function(t,e){return new se((function(r){var n=0;return e.schedule((function(){n===t.length?r.complete():(r.next(t[n++]),r.closed||this.schedule())}))}))}(t,e);if(ne(t))return function(t,e){return me(t).pipe(Se(e),$e(e))}(t,e);if(ce(t))return _e(t,e);if(he(t))return function(t,e){return new se((function(r){var n;return ve(r,e,(function(){n=t[de](),ve(r,e,(function(){var t,e,i;try{e=(t=n.next()).value,i=t.done}catch(t){return void r.error(t)}i?r.complete():r.next(e)}),0,!0)})),function(){return xt(null==n?void 0:n.return)&&n.return()}}))}(t,e);if(fe(t))return function(t,e){return _e(pe(t),e)}(t,e)}throw ue(t)}(t,e):me(t)}var Me=Array.isArray;var Ce=["addListener","removeListener"],Ee=["addEventListener","removeEventListener"],Pe=["on","off"];function Te(t,e,r,n){if(xt(r)&&(n=r,r=void 0),n)return Te(t,e,r).pipe((i=n,ee((function(t){return function(t,e){return Me(e)?t.apply(void 0,Ct([],Mt(e))):t(e)}(i,t)}))));var i,o=Mt(function(t){return xt(t.addEventListener)&&xt(t.removeEventListener)}(t)?Ee.map((function(n){return function(i){return t[n](e,i,r)}})):function(t){return xt(t.addListener)&&xt(t.removeListener)}(t)?Ce.map(je(t,e)):function(t){return xt(t.on)&&xt(t.off)}(t)?Pe.map(je(t,e)):[],2),s=o[0],a=o[1];if(!s&&re(t))return be((function(t){return Te(t,e,r)}))(me(t));if(!s)throw new TypeError("Invalid event target");return new se((function(t){var e=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.next(1<e.length?e:e[0])};return s(e),function(){return a(e)}}))}function je(t,e){return function(r){return function(n){return t[r](e,n)}}}const Fe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=ke(t),n=function(t,e){return"number"==typeof xe(t)?t.pop():1/0}(t),i=t;return i.length?1===i.length?me(i[0]):function(t){return void 0===t&&(t=1/0),be(oe,t)}(n)(Ae(i,r)):ye}(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ae(t,ke(t))}(1),Te(window,"hashchange").pipe((ze=t=>t.preventDefault(),Ne=xt(ze)?{next:ze,error:Oe,complete:Re}:ze,Ne?kt((function(t,e){var r;null===(r=Ne.subscribe)||void 0===r||r.call(Ne);var n=!0;t.subscribe(Xt(e,(function(t){var r;null===(r=Ne.next)||void 0===r||r.call(Ne,t),e.next(t)}),(function(){var t;n=!1,null===(t=Ne.complete)||void 0===t||t.call(Ne),e.complete()}),(function(t){var r;n=!1,null===(r=Ne.error)||void 0===r||r.call(Ne,t),e.error(t)}),(function(){var t,e;n&&(null===(t=Ne.unsubscribe)||void 0===t||t.call(Ne)),null===(e=Ne.finalize)||void 0===e||e.call(Ne)})))})):oe))).pipe(ee((()=>window.location.hash.substr(1).split("/").filter(Boolean).map(decodeURIComponent))));var ze,Oe,Re,Ne,Be;!function(t){t.mutant="mutant",t.test="test"}(Be||(Be={}));var Le=function(t){function e(e,r){return t.call(this)||this}return St(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(Ft),De={setInterval:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=De.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,Ct([t,e],Mt(r))):setInterval.apply(void 0,Ct([t,e],Mt(r)))},clearInterval:function(t){var e=De.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},Ie=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return St(e,t),e.prototype.schedule=function(t,e){var r;if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),De.setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&De.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r,n=!1;try{this.work(t)}catch(t){n=!0,r=t||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},e.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,jt(n,this),null!=e&&(this.id=this.recycleAsyncId(r,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(Le),Ue={now:function(){return(Ue.delegate||Date).now()},delegate:void 0},He=function(){function t(e,r){void 0===r&&(r=t.now),this.schedulerActionCtor=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(r,e)},t.now=Ue.now,t}(),Ze=function(t){function e(e,r){void 0===r&&(r=He.now);var n=t.call(this,e,r)||this;return n.actions=[],n._active=!1,n}return St(e,t),e.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(He),Ke=new Ze(Ie),qe=Ke;function Ve(t,e){return void 0===e&&(e=Ke),r=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=Ke),t<0&&(t=0),function(t,e,r){void 0===t&&(t=0),void 0===r&&(r=qe);var n=-1;return null!=e&&(we(e)?r=e:n=e),new se((function(e){var i,o=(i=t)instanceof Date&&!isNaN(i)?+t-r.now():t;o<0&&(o=0);var s=0;return r.schedule((function(){e.closed||(e.next(s++),0<=n?this.schedule(void 0,n):e.complete())}),o)}))}(t,t,e)}(t,e),kt((function(t,e){var n=!1,i=null;t.subscribe(Xt(e,(function(t){n=!0,i=t}))),me(r).subscribe(Xt(e,(function(){if(n){n=!1;var t=i;i=null,e.next(t)}}),Dt))}));var r}var We=r(3704);function Ge(t,e,r){return new CustomEvent(t,{detail:e,...r})}var Ye=r(9130);const Je=(t,e)=>L`<li title=${t||U} class="my-3 rounded bg-white px-2 py-3 shadow">${e}</li>`,Qe=(t,e)=>L`<p title=${e||U}>${t}</p>`,Xe=t=>L`<div class="mb-6 mr-6 mt-2 flex flex-col gap-4">${t}</div>`,tr=(t,e)=>L`<span role="img" aria-label="${e}">${t}</span>`;var er=r(9483),rr=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let nr=class extends st{constructor(){super(...arguments),this.mode="closed",this.hasDetail=!1,this.toggleReadMore=t=>{"open"===this.mode?this.mode="half":this.mode="open",t.preventDefault(),t.stopImmediatePropagation()}}get toggleMoreLabel(){switch(this.mode){case"half":return L`${tr("🔼","up arrow")} More`;case"open":return L`${tr("🔽","down arrow")} Less`;case"closed":return U}}render(){return L`<aside @click="${t=>t.stopPropagation()}">
      <div class="mx-6">
        <header class="w-full py-4">
          <h2>
            <slot name="header"></slot>
            ${ir(this.hasDetail,L`<button data-testId="btnReadMoreToggle" class="ml-2 align-middle" @click="${this.toggleReadMore}"
                >${this.toggleMoreLabel}</button
              >`)}
          </h2>
        </header>
        <div class="scrollable container fixed motion-safe:transition-max-width">
          <slot name="summary"></slot>
          ${ir(this.hasDetail&&"open"===this.mode,L`<slot name="detail"></slot>`)}
        </div>
      </div>
    </aside>`}};function ir(t,e){return t?"function"==typeof e?e():e:U}function or(t,e){return null==t?U:e(t)}function sr(t){switch(t){case Ye.MutantStatus.Killed:return"success";case Ye.MutantStatus.NoCoverage:return"caution";case Ye.MutantStatus.Survived:return"danger";case Ye.MutantStatus.Timeout:return"warning";case Ye.MutantStatus.Ignored:case Ye.MutantStatus.RuntimeError:case Ye.MutantStatus.Pending:case Ye.MutantStatus.CompileError:return"secondary"}}function ar(t){switch(t){case pt.ih.Killing:return"success";case pt.ih.Covering:return"warning";case pt.ih.NotCovering:return"caution"}}function lr(t){switch(t){case pt.ih.Killing:return tr("✅",t);case pt.ih.Covering:return tr("☂",t);case pt.ih.NotCovering:return tr("🌧",t)}}function cr(t){switch(t){case Ye.MutantStatus.Killed:return tr("✅",t);case Ye.MutantStatus.NoCoverage:return tr("🙈",t);case Ye.MutantStatus.Ignored:return tr("🤥",t);case Ye.MutantStatus.Survived:return tr("👽",t);case Ye.MutantStatus.Timeout:return tr("⏰",t);case Ye.MutantStatus.Pending:return tr("⌛",t);case Ye.MutantStatus.RuntimeError:case Ye.MutantStatus.CompileError:return tr("💥",t)}}function ur(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function dr(...t){const e=new URL(window.location.href);return new URL(`#${t.filter(Boolean).join("/")}`,e).href}function hr(t){return t.length>1?"s":""}function pr({fileName:t,location:e}){return t?`${t}${e?`:${e.start.line}:${e.start.column}`:""}`:""}function fr(t){t&&!function(t){const{top:e,bottom:r}=t.getBoundingClientRect();return e>=0&&r<=(window.innerHeight||document.documentElement.clientHeight)-120}(t)&&t.scrollIntoView({block:"center",behavior:"smooth"})}function mr(){const t="test";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}nr.styles=[s(er.Z),bt],rr([ut({reflect:!0})],nr.prototype,"mode",void 0),rr([ut({reflect:!0,type:Boolean})],nr.prototype,"hasDetail",void 0),rr([ut()],nr.prototype,"toggleMoreLabel",null),nr=rr([lt("mte-drawer")],nr);var gr=Pt((function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),vr=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return St(e,t),e.prototype.lift=function(t){var e=new br(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new gr},e.prototype.next=function(t){var e=this;Zt((function(){var r,n;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var i=At(e.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(t)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}}))},e.prototype.error=function(t){var e=this;Zt((function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var r=e.observers;r.length;)r.shift().error(t)}}))},e.prototype.complete=function(){var t=this;Zt((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}}))},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,r=this,n=r.hasError,i=r.isStopped,o=r.observers;return n||i?zt:(this.currentObservers=null,o.push(t),new Ft((function(){e.currentObservers=null,jt(o,t)})))},e.prototype._checkFinalizedStatuses=function(t){var e=this,r=e.hasError,n=e.thrownError,i=e.isStopped;r?t.error(n):i&&t.complete()},e.prototype.asObservable=function(){var t=new se;return t.source=this,t},e.create=function(t,e){return new br(t,e)},e}(se),br=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return St(e,t),e.prototype.next=function(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)},e.prototype.error=function(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:zt},e}(vr);const yr=new vr;var wr,xr=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class kr extends st{constructor(){super(...arguments),wr.set(this,new Ft)}shouldReactivate(){return!0}reactivate(){this.requestUpdate()}connectedCallback(){super.connectedCallback(),xr(this,wr,"f").add(yr.subscribe((()=>this.shouldReactivate()&&this.reactivate())))}disconnectedCallback(){super.disconnectedCallback(),xr(this,wr,"f").unsubscribe()}}wr=new WeakMap;var $r=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let Sr=class extends kr{constructor(){super(...arguments),this.context={view:Be.mutant,path:[]},this.path=[],this.mutants=new Map,this.tests=new Map,this.themeSwitch=t=>{this.theme=t.detail,mr()&&localStorage.setItem("mutation-testing-elements-theme",this.theme)},this.subscriptions=[],this.sseSubscriptions=new Set}get themeBackgroundColor(){return getComputedStyle(this).getPropertyValue("--mut-body-bg")}get title(){return this.context.result?this.titlePostfix?`${this.context.result.name} - ${this.titlePostfix}`:this.context.result.name:""}firstUpdated(){(0===this.path.length||this.path[0]!==Be.mutant&&this.path[0]!==Be.test)&&window.location.replace(dr(`${Be.mutant}`))}async loadData(){if(this.src)try{const t=await fetch(this.src);this.report=await t.json()}catch(t){const e=String(t);this.errorMessage=e}}async willUpdate(t){this.theme||(this.theme=this.getTheme()),this.report&&(t.has("report")&&this.updateModel(this.report),(t.has("path")||t.has("report"))&&(this.updateContext(),this.updateTitle())),t.has("src")&&await this.loadData()}updated(t){t.has("theme")&&this.theme&&this.dispatchEvent(Ge("theme-changed",{theme:this.theme,themeBackgroundColor:this.themeBackgroundColor}))}getTheme(){return mr()&&localStorage.getItem("mutation-testing-elements-theme")||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light")}updateModel(t){function e(t){return function e(r){r?.file&&t(r.file,r),r?.childResults.forEach((t=>{e(t)}))}}this.rootModel=(0,pt.xR)(t),e(((t,e)=>{t.result=e,t.mutants.forEach((t=>this.mutants.set(t.id,t)))}))(this.rootModel?.systemUnderTestMetrics),e(((t,e)=>{t.result=e,t.tests.forEach((t=>this.tests.set(t.id,t)))}))(this.rootModel?.testMetrics),this.rootModel.systemUnderTestMetrics.updateParent(),this.rootModel.testMetrics?.updateParent()}updateContext(){if(this.rootModel){const t=(t,e)=>e.reduce(((t,e)=>t?.childResults.find((t=>t.name===e))),t),e=this.path.slice(1);this.path[0]===Be.test&&this.rootModel.testMetrics?this.context={view:Be.test,path:e,result:t(this.rootModel.testMetrics,this.path.slice(1))}:this.context={view:Be.mutant,path:e,result:t(this.rootModel.systemUnderTestMetrics,this.path.slice(1))}}}updateTitle(){document.title=this.title}connectedCallback(){super.connectedCallback(),this.subscriptions.push(Fe.subscribe((t=>this.path=t))),this.initializeSse()}initializeSse(){if(!this.sse)return;this.source=new EventSource(this.sse);const t=Te(this.source,"mutant-tested").subscribe((t=>{const e=JSON.parse(t.data);if(!this.report)return;const r=this.mutants.get(e.id);if(void 0!==r){this.theMutant=r;for(const[t,r]of Object.entries(e))this.theMutant[t]=r;e.killedBy&&e.killedBy.forEach((t=>{const e=this.tests.get(t);void 0!==e&&(this.theTest=e,e.addKilled(this.theMutant),this.theMutant.addKilledBy(e))})),e.coveredBy&&e.coveredBy.forEach((t=>{const e=this.tests.get(t);void 0!==e&&(this.theTest=e,e.addCovered(this.theMutant),this.theMutant.addCoveredBy(e))}))}})),e=Te(this.source,"mutant-tested").pipe(Ve(100)).subscribe((()=>{this.applyChanges()}));this.sseSubscriptions.add(t),this.sseSubscriptions.add(e),this.source.addEventListener("finished",(()=>{this.source?.close(),this.applyChanges(),this.sseSubscriptions.forEach((t=>t.unsubscribe()))}))}applyChanges(){this.theMutant?.update(),this.theTest?.update(),yr.next()}disconnectedCallback(){super.disconnectedCallback(),this.subscriptions.forEach((t=>t.unsubscribe()))}renderTitle(){return this.context.result?L`
        <h1 class="text-5xl font-bold tracking-tight">
          ${this.context.result.name}${this.titlePostfix?L`<small class="text-light-muted ml-4 font-light">${this.titlePostfix}</small>`:U}
        </h1>
      `:U}render(){return this.context.result??this.errorMessage?L`
        <div class="container bg-white pb-4 font-sans text-gray-800 motion-safe:transition-max-width">
          <div class="space-y-4 transition-colors">
            ${this.renderErrorMessage()}
            <mte-theme-switch @theme-switch="${this.themeSwitch}" class="sticky top-offset z-20 float-right pt-6" .theme="${this.theme}">
            </mte-theme-switch>
            ${this.renderTitle()} ${this.renderTabs()}
            <mte-breadcrumb .view="${this.context.view}" .path="${this.context.path}"></mte-breadcrumb>
            <mte-result-status-bar
              .detected="${this.rootModel?.systemUnderTestMetrics.metrics.totalDetected}"
              .undetected="${this.rootModel?.systemUnderTestMetrics.metrics.totalUndetected}"
              .invalid="${this.rootModel?.systemUnderTestMetrics.metrics.totalInvalid}"
              .ignored="${this.rootModel?.systemUnderTestMetrics.metrics.ignored}"
              .pending="${this.rootModel?.systemUnderTestMetrics.metrics.pending}"
              .total="${this.rootModel?.systemUnderTestMetrics.metrics.totalMutants}"
            ></mte-result-status-bar>
            ${"mutant"===this.context.view&&this.context.result?L`<mte-mutant-view
                  id="mte-mutant-view"
                  .result="${this.context.result}"
                  .thresholds="${this.report.thresholds}"
                  .path="${this.path}"
                ></mte-mutant-view>`:U}
            ${"test"===this.context.view&&this.context.result?L`<mte-test-view id="mte-test-view" .result="${this.context.result}" .path="${this.path}"></mte-test-view>`:U}
          </div>
        </div>
      `:L``}renderErrorMessage(){return this.errorMessage?L`<div class="my-4 rounded-lg bg-red-100 p-4 text-sm text-red-700" role="alert">${this.errorMessage}</div>`:U}renderTabs(){if(this.rootModel?.testMetrics){const t="mutant"===this.context.view,e="test"===this.context.view;return L`
        <nav class="border-b border-gray-200 text-center text-sm font-medium  text-gray-600">
          <ul class="-mb-px flex flex-wrap" role="tablist">
            ${[{type:"mutant",isActive:t,text:"👽 Mutants"},{type:"test",isActive:e,text:"🧪 Tests"}].map((({type:t,isActive:e,text:r})=>L`<li class="mr-2" role="presentation">
                  <a
                    class="inline-block rounded-t-lg border-b-2 border-transparent p-4 transition-colors hover:border-gray-300 hover:bg-gray-200 hover:text-gray-700 aria-selected:border-b-[3px] aria-selected:border-primary-700  aria-selected:text-primary-on"
                    role="tab"
                    href="${dr(t)}"
                    aria-selected="${e}"
                    aria-controls="mte-${t}-view"
                    >${r}</a
                  >
                </li>`))}
          </ul>
        </nav>
      `}return U}};Sr.styles=[wt,s(We.Z),bt],$r([ut({attribute:!1})],Sr.prototype,"report",void 0),$r([ut({attribute:!1})],Sr.prototype,"rootModel",void 0),$r([ut()],Sr.prototype,"src",void 0),$r([ut()],Sr.prototype,"sse",void 0),$r([ut({attribute:!1})],Sr.prototype,"errorMessage",void 0),$r([ut({attribute:!1})],Sr.prototype,"context",void 0),$r([ut()],Sr.prototype,"path",void 0),$r([ut({attribute:"title-postfix"})],Sr.prototype,"titlePostfix",void 0),$r([ut({reflect:!0})],Sr.prototype,"theme",void 0),$r([ut({attribute:!1})],Sr.prototype,"themeBackgroundColor",null),$r([ut()],Sr.prototype,"title",null),Sr=$r([lt("mutation-test-report-app")],Sr);const{I:_r}=rt,Ar=()=>document.createComment(""),Mr=(t,e,r)=>{var n;const i=t._$AA.parentNode,o=void 0===e?t._$AB:e._$AA;if(void 0===r){const e=i.insertBefore(Ar(),o),n=i.insertBefore(Ar(),o);r=new _r(e,n,t,t.options)}else{const e=r._$AB.nextSibling,s=r._$AM,a=s!==t;if(a){let e;null===(n=r._$AQ)||void 0===n||n.call(r,t),r._$AM=t,void 0!==r._$AP&&(e=t._$AU)!==s._$AU&&r._$AP(e)}if(e!==o||a){let t=r._$AA;for(;t!==e;){const e=t.nextSibling;i.insertBefore(t,o),t=e}}}return r},Cr=(t,e,r=t)=>(t._$AI(e,r),t),Er={},Pr=t=>{var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);let r=t._$AA;const n=t._$AB.nextSibling;for(;r!==n;){const t=r.nextSibling;r.remove(),r=t}},Tr=t=>(...e)=>({_$litDirective$:t,values:e});class jr{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,r){this._$Ct=t,this._$AM=e,this._$Ci=r}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const Fr=(t,e)=>{var r,n;const i=t._$AN;if(void 0===i)return!1;for(const t of i)null===(n=(r=t)._$AO)||void 0===n||n.call(r,e,!1),Fr(t,e);return!0},zr=t=>{let e,r;do{if(void 0===(e=t._$AM))break;r=e._$AN,r.delete(t),t=e}while(0===(null==r?void 0:r.size))},Or=t=>{for(let e;e=t._$AM;t=e){let r=e._$AN;if(void 0===r)e._$AN=r=new Set;else if(r.has(t))break;r.add(t),Br(e)}};function Rr(t){void 0!==this._$AN?(zr(this),this._$AM=t,Or(this)):this._$AM=t}function Nr(t,e=!1,r=0){const n=this._$AH,i=this._$AN;if(void 0!==i&&0!==i.size)if(e)if(Array.isArray(n))for(let t=r;t<n.length;t++)Fr(n[t],!1),zr(n[t]);else null!=n&&(Fr(n,!1),zr(n));else Fr(this,t)}const Br=t=>{var e,r,n,i;2==t.type&&(null!==(e=(n=t)._$AP)&&void 0!==e||(n._$AP=Nr),null!==(r=(i=t)._$AQ)&&void 0!==r||(i._$AQ=Rr))};class Lr extends jr{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,r){super._$AT(t,e,r),Or(this),this.isConnected=t._$AU}_$AO(t,e=!0){var r,n;t!==this.isConnected&&(this.isConnected=t,t?null===(r=this.reconnected)||void 0===r||r.call(this):null===(n=this.disconnected)||void 0===n||n.call(this)),e&&(Fr(this,t),zr(this))}setValue(t){if((t=>void 0===this._$Ct.strings)())this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}class Dr{}const Ir=new WeakMap,Ur=Tr(class extends Lr{render(t){return U}update(t,[e]){var r;const n=e!==this.G;return n&&void 0!==this.G&&this.ot(void 0),(n||this.rt!==this.lt)&&(this.G=e,this.ct=null===(r=t.options)||void 0===r?void 0:r.host,this.ot(this.lt=t.element)),U}ot(t){var e;if("function"==typeof this.G){const r=null!==(e=this.ct)&&void 0!==e?e:globalThis;let n=Ir.get(r);void 0===n&&(n=new WeakMap,Ir.set(r,n)),void 0!==n.get(this.G)&&this.G.call(this.ct,void 0),n.set(this.G,t),void 0!==t&&this.G.call(this.ct,t)}else this.G.value=t}get rt(){var t,e,r;return"function"==typeof this.G?null===(e=Ir.get(null!==(t=this.ct)&&void 0!==t?t:globalThis))||void 0===e?void 0:e.get(this.G):null===(r=this.G)||void 0===r?void 0:r.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});var Hr,Zr;function Kr(t){switch(function(t){return t.substr(t.lastIndexOf(".")+1).toLocaleLowerCase()}(t)){case"cs":return Hr.csharp;case"html":return Hr.html;case"java":return Hr.java;case"js":case"cjs":case"mjs":return Hr.javascript;case"ts":case"tsx":case"cts":case"mts":return Hr.typescript;case"scala":return Hr.scala;case"php":return Hr.php;case"vue":return Hr.vue;case"feature":return Hr.gherkin;default:return}}function qr(t,e){const r=Kr(e)??"plain";let n=r;return r===Hr.vue&&(n=Hr.html),(0,vt.highlight)(t,vt.languages[n],n)}function Vr(t,e){let r=[];const n=[],i={column:0,line:1,offset:-1},o=[];let s=!1,a=0;for(;a<t.length;){switch(s&&!Wr(t[a])&&(o.forEach((t=>l(c(t)))),s=!1),t[a]){case Zr.CarriageReturn:i.offset++;break;case Zr.NewLine:u(),i.offset++,i.line++,i.column=0,s=!0;break;case Zr.LT:{const t=h();t.isClosing?f(t):p(t);break}case Zr.Amp:d(g());break;default:d(t[a])}a++}return u(),n;function l(...t){r.push(...t)}function c({attributes:t,elementName:e,isClosing:r}){return r?`</${e}>`:`<${e}${Object.entries(t??{}).reduce(((t,[e,r])=>void 0===r?`${t} ${e}`:`${t} ${e}="${r}"`),"")}>`}function u(){o.forEach((t=>l(c({...t,isClosing:!0})))),n.push(r.join("")),r=[]}function d(t){if(i.column++,i.offset++,e)for(const t of e(i))t.isClosing?f(t):(l(c(t)),o.push(t));l(t)}function h(){a++;const e="/"===t[a]||void 0;e&&a++;const r=a;for(;!Wr(t[a])&&t[a]!==Zr.GT;)a++;return{elementName:t.substring(r,a),attributes:function(){const e=Object.create(null);for(;a<t.length;){const r=t[a];if(r===Zr.GT)return e;if(!Wr(r)){const{name:t,value:r}=m();e[t]=r}a++}throw new Error(`Missing closing tag near ${t.substr(a-10)}`)}(),isClosing:e}}function p(t){o.push(t),l(c(t))}function f(t){let e;for(e=o.length-1;e>=0;e--){const r=o[e];if(t.elementName===r.elementName&&r.id===t.id){l(c(t)),o.splice(e,1);for(let t=e;t<o.length;t++)l(c(o[t]));break}l(c({...r,isClosing:!0}))}if(-1===e)throw new Error(`Cannot find corresponding opening tag for ${c(t)}`)}function m(){const e=a;for(;"="!==t[a];)a++;const r=t.substring(e,a);a++;const n=function(){'"'===t[a]&&a++;const e=a;for(;'"'!==t[a];)a++;return t.substring(e,a)}();return{name:r,value:n}}function g(){const e=a;for(;t[a]!==Zr.Semicolon;)a++;return t.substring(e,a+1)}}function Wr(t){return t===Zr.NewLine||t===Zr.Space||t===Zr.Tab}function Gr(t,e){return t.line>e.line||t.line===e.line&&t.column>=e.column}!function(t){t.csharp="cs",t.java="java",t.javascript="javascript",t.html="html",t.php="php",t.scala="scala",t.typescript="typescript",t.vue="vue",t.gherkin="gherkin"}(Hr||(Hr={})),function(t){t.CarriageReturn="\r",t.NewLine="\n",t.Space=" ",t.Amp="&",t.Semicolon=";",t.LT="<",t.GT=">",t.Tab="\t"}(Zr||(Zr={}));var Yr=r(5545);class Jr extends jr{constructor(t){if(super(t),this.et=U,2!==t.type)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===U||null==t)return this.ft=void 0,this.et=t;if(t===I)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.et)return this.ft;this.et=t;const e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}Jr.directiveName="unsafeHTML",Jr.resultType=1;const Qr=Tr(Jr);function Xr(t,e){return t===U&&e===U?U:L`<span class="ml-1 flex flex-row items-center">${t}${e}</span>`}function tn(t,e){return L`<tr class="line"
    ><td class="line-number"></td><td class="line-marker"></td><td class="code flex"><span>${Qr(t)}</span>${e}</td></tr
  >`}var en=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};const rn="diff-old",nn="diff-new";let on=class extends kr{constructor(){super(...arguments),this.filters=[],this.selectedMutantStates=[],this.lines=[],this.mutants=[],this.codeRef=new Dr,this.filtersChanged=t=>{this.selectedMutantStates=t.detail.concat([Ye.MutantStatus.Pending])},this.codeClicked=t=>{if(t.stopPropagation(),t.target instanceof Element){let e=t.target;const r=[];for(;e instanceof Element;e=e.parentElement){const t=e.getAttribute("mutant-id"),n=this.mutants.find((({id:e})=>e.toString()===t));n&&r.push(n)}const n=(this.selectedMutant?r.indexOf(this.selectedMutant):-1)+1;r[n]?(this.toggleMutant(r[n]),an()):this.selectedMutant&&(this.toggleMutant(this.selectedMutant),an())}},this.nextMutant=()=>{const t=this.selectedMutant?(this.mutants.indexOf(this.selectedMutant)+1)%this.mutants.length:0;this.mutants[t]&&this.toggleMutant(this.mutants[t])},this.previousMutant=()=>{const t=this.selectedMutant?(this.mutants.indexOf(this.selectedMutant)+this.mutants.length-1)%this.mutants.length:this.mutants.length-1;this.mutants[t]&&this.toggleMutant(this.mutants[t])}}render(){const t=new Map;for(const e of this.mutants){let r=t.get(e.location.start.line);r||(r=[],t.set(e.location.start.line,r)),r.push(e)}const e=e=>this.renderMutantDots([...t.entries()].filter((([t])=>t>e)).flatMap((([,t])=>t)));return L`
      <mte-state-filter
        allow-toggle-all
        .filters="${this.filters}"
        @filters-changed="${this.filtersChanged}"
        @next=${this.nextMutant}
        @previous=${this.previousMutant}
      ></mte-state-filter>
      <pre
        @click="${this.codeClicked}"
        id="report-code-block"
        class="line-numbers ${this.selectedMutantStates.map((t=>`mte-selected-${t}`)).join(" ")} flex rounded-md py-4"
      >
        <code ${Ur(this.codeRef)} class="flex language-${this.model.language}">
          <table>${this.lines.map(((r,n)=>{const i=n+1;return tn(r,Xr(this.renderMutantDots(t.get(i)),this.lines.length===i?e(i):U))}))}</table>
          </code>
          </pre>
    `}renderMutantDots(t){return t?.length?t.map((t=>D`<svg mutant-id="${t.id}" class="mutant-dot ${this.selectedMutant?.id===t.id?"selected":t.status}" height="10" width="12">
          <title>${sn(t)}</title>
          <circle cx="5" cy="5" r="5" />
          </svg>`)):U}toggleMutant(t){if(this.removeCurrentDiff(),this.selectedMutant===t)return this.selectedMutant=void 0,void this.dispatchEvent(Ge("mutant-selected",{selected:!1,mutant:t}));this.selectedMutant=t;const e=this.codeRef.value.querySelectorAll("tr.line");for(let r=t.location.start.line-1;r<t.location.end.line;r++)e.item(r).classList.add(rn);const r=this.highlightedReplacementRows(t),n=e.item(t.location.end.line-1);n.insertAdjacentHTML("afterend",r),fr(n),this.dispatchEvent(Ge("mutant-selected",{selected:!0,mutant:t}))}removeCurrentDiff(){this.codeRef.value.querySelectorAll(`.${rn}`).forEach((t=>t.classList.remove(rn))),this.codeRef.value.querySelectorAll(`.${nn}`).forEach((t=>t.remove()))}reactivate(){super.reactivate(),this.updateFileRepresentation()}update(t){t.has("model")&&this.model&&this.updateFileRepresentation(),(t.has("model")&&this.model||t.has("selectedMutantStates"))&&(this.mutants=this.model.mutants.filter((t=>this.selectedMutantStates.includes(t.status))).sort(((t,e)=>Gr(t.location.start,e.location.start)?1:-1)),this.selectedMutant&&!this.mutants.includes(this.selectedMutant)&&t.has("selectedMutantStates")&&this.selectedMutantsHaveChanged(t.get("selectedMutantStates"))&&this.toggleMutant(this.selectedMutant)),super.update(t)}updateFileRepresentation(){this.filters=[Ye.MutantStatus.Killed,Ye.MutantStatus.Survived,Ye.MutantStatus.NoCoverage,Ye.MutantStatus.Ignored,Ye.MutantStatus.Timeout,Ye.MutantStatus.CompileError,Ye.MutantStatus.RuntimeError].filter((t=>this.model.mutants.some((e=>e.status===t)))).map((t=>({enabled:[...this.selectedMutantStates,Ye.MutantStatus.Survived,Ye.MutantStatus.NoCoverage,Ye.MutantStatus.Timeout].includes(t),count:this.model.mutants.filter((e=>e.status===t)).length,status:t,label:L`${cr(t)} ${t}`,context:sr(t)})));const t=qr(this.model.source,this.model.name),e=new Set,r=new Set(this.model.mutants);this.lines=Vr(t,(function*(t){for(const r of e)Gr(t,r.location.end)&&(e.delete(r),yield{elementName:"span",id:r.id,isClosing:!0});for(const n of r)Gr(t,n.location.start)&&(e.add(n),r.delete(n),yield{elementName:"span",id:n.id,attributes:{class:ur(`mutant border-none ${n.status}`),title:ur(sn(n)),"mutant-id":ur(n.id.toString())}})}))}selectedMutantsHaveChanged(t){return t.length!==this.selectedMutantStates.length||!t.every(((t,e)=>this.selectedMutantStates[e]===t))}highlightedReplacementRows(t){const e=t.getMutatedLines().trimEnd(),r=t.getOriginalLines().trimEnd(),[n,i]=function(t,e){let r=0,n=e.length-1;for(;t[r]===e[r]&&r<e.length;)r++;const i=t.length-e.length;for(;t[n+i]===e[n]&&n>r;)n--;n===r&&(Wr(e[r-1])||r--),n++;const o=e.substring(r,n);return["true","false"].forEach((t=>{o===t.substr(0,t.length-1)&&t.endsWith(e[n])&&n++,o===t.substr(1,t.length)&&t.startsWith(e[r-1])&&r--})),[r,n]}(r,e),o=Vr(qr(e,this.model.name),(function*({offset:t}){t===n?yield{elementName:"span",id:"diff-focus",attributes:{class:"diff-focus"}}:t===i&&(yield{elementName:"span",id:"diff-focus",isClosing:!0})})),s=`<tr class="${nn}"><td class="empty-line-number"></td><td class="line-marker"></td><td class="code">`;return o.map((t=>`${s}${t}</td></tr>`)).join("")}};function sn(t){return`${t.mutatorName} ${t.status}`}function an(){window.getSelection()?.removeAllRanges()}on.styles=[yt,bt,s(Yr.Z)],en([dt()],on.prototype,"filters",void 0),en([ut()],on.prototype,"model",void 0),en([dt()],on.prototype,"selectedMutantStates",void 0),en([dt()],on.prototype,"selectedMutant",void 0),en([dt()],on.prototype,"lines",void 0),en([dt()],on.prototype,"mutants",void 0),on=en([lt("mte-file")],on);const ln=(t,e,r)=>{const n=new Map;for(let i=e;i<=r;i++)n.set(t[i],i);return n},cn=Tr(class extends jr{constructor(t){if(super(t),2!==t.type)throw Error("repeat() can only be used in text expressions")}dt(t,e,r){let n;void 0===r?r=e:void 0!==e&&(n=e);const i=[],o=[];let s=0;for(const e of t)i[s]=n?n(e,s):s,o[s]=r(e,s),s++;return{values:o,keys:i}}render(t,e,r){return this.dt(t,e,r).values}update(t,[e,r,n]){var i;const o=t._$AH,{values:s,keys:a}=this.dt(e,r,n);if(!Array.isArray(o))return this.ht=a,s;const l=null!==(i=this.ht)&&void 0!==i?i:this.ht=[],c=[];let u,d,h=0,p=o.length-1,f=0,m=s.length-1;for(;h<=p&&f<=m;)if(null===o[h])h++;else if(null===o[p])p--;else if(l[h]===a[f])c[f]=Cr(o[h],s[f]),h++,f++;else if(l[p]===a[m])c[m]=Cr(o[p],s[m]),p--,m--;else if(l[h]===a[m])c[m]=Cr(o[h],s[m]),Mr(t,c[m+1],o[h]),h++,m--;else if(l[p]===a[f])c[f]=Cr(o[p],s[f]),Mr(t,o[h],o[p]),p--,f++;else if(void 0===u&&(u=ln(a,f,m),d=ln(l,h,p)),u.has(l[h]))if(u.has(l[p])){const e=d.get(a[f]),r=void 0!==e?o[e]:null;if(null===r){const e=Mr(t,o[h]);Cr(e,s[f]),c[f]=e}else c[f]=Cr(r,s[f]),Mr(t,o[h],r),o[e]=null;f++}else Pr(o[p]),p--;else Pr(o[h]),h++;for(;f<=m;){const e=Mr(t,c[m+1]);Cr(e,s[f]),c[f++]=e}for(;h<=p;){const t=o[h++];null!==t&&Pr(t)}return this.ht=a,((t,e=Er)=>{t._$AH=e})(t,c),I}});var un=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let dn=class extends st{get rootName(){switch(this.view){case Be.mutant:return"All files";case Be.test:return"All tests"}}render(){return L`<nav class="my-4 flex rounded-md border border-primary-600 bg-primary-100 p-3 text-gray-700" aria-label="Breadcrumb">
      <ol class="inline-flex items-center">
        ${this.path&&this.path.length>0?this.renderLink(this.rootName,[]):this.renderActiveItem(this.rootName)}
        ${this.renderBreadcrumbItems()}
      </ol>
    </nav> `}renderBreadcrumbItems(){if(this.path){const t=this.path;return cn(t,(t=>t),((e,r)=>r===t.length-1?this.renderActiveItem(e):this.renderLink(e,t.slice(0,r+1))))}}renderActiveItem(t){return L`<li aria-current="page">
      <span class="ml-1 text-sm font-medium text-gray-800">${t}</span>
    </li> `}renderLink(t,e){return L`<li class="after:text-gray-800 after:content-['/'] md:after:pl-1">
      <a
        href="${dr(this.view,...e)}"
        class="ml-1 text-sm font-medium text-primary-800 underline hover:text-gray-900 hover:underline md:ml-2"
        >${t}</a
      >
    </li>`}};dn.styles=[bt],un([ut()],dn.prototype,"path",void 0),un([ut()],dn.prototype,"view",void 0),dn=un([lt("mte-breadcrumb")],dn);var hn=r(1276),pn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let fn=class extends kr{constructor(){super(...arguments),this.next=t=>{t.stopPropagation(),this.dispatchEvent(Ge("next",void 0,{bubbles:!0,composed:!0}))},this.previous=t=>{t.stopPropagation(),this.dispatchEvent(Ge("previous",void 0,{bubbles:!0,composed:!0}))}}updated(t){t.has("filters")&&this.dispatchFiltersChangedEvent()}checkboxChanged(t,e){t.enabled=e,this.dispatchFiltersChangedEvent()}dispatchFiltersChangedEvent(){this.dispatchEvent(Ge("filters-changed",this.filters.filter((({enabled:t})=>t)).map((({status:t})=>t))))}render(){return L`
      <div class="sticky top-offset z-10 flex flex-row bg-white py-6">
        <div class="mr-3">
          <button title="Previous" @click=${this.previous} type="button" class="step-button">
            <svg aria-hidden="true" class="h-4 w-4 rotate-180" fill="white" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                fill-rule="evenodd"
                d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <span class="sr-only">Select previous mutant</span>
          </button>
          <button title="Next" @click=${this.next} type="button" class="step-button">
            <svg aria-hidden="true" class="h-4 w-4" fill="white" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                fill-rule="evenodd"
                d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <span class="sr-only">Select next mutant</span>
          </button>
        </div>

        ${ir(this.filters?.length,cn(this.filters,(t=>t.status),(t=>L`
              <div class="mr-4 flex items-center" data-status="${t.status}">
                <input
                  ?checked="${t.enabled}"
                  id="filter-${t.status}"
                  aria-describedby="status-description"
                  type="checkbox"
                  value="${t.status}"
                  @input="${e=>this.checkboxChanged(t,e.target.checked)}"
                  class="h-5 w-5 rounded border-gray-300 bg-gray-100 text-primary-on !ring-offset-gray-200 focus:outline-none focus:ring-2 focus:ring-primary-500"
                />

                <label
                  for="filter-${t.status}"
                  class="${this.bgForContext(t.context)} mx-2 rounded px-2.5 py-0.5 text-sm font-medium hover:cursor-pointer"
                >
                  ${t.label} (${t.count})
                </label>
              </div>
            `)))}
      </div>
    `}bgForContext(t){switch(t){case"success":return"bg-green-100 text-green-800";case"warning":return"bg-yellow-100 text-yellow-800";case"danger":return"bg-red-100 text-red-800";case"caution":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}}};fn.styles=[bt,s(hn.Z)],pn([ut({type:Array})],fn.prototype,"filters",void 0),fn=pn([lt("mte-state-filter")],fn);var mn=r(4835),gn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let vn=class extends st{constructor(){super(...arguments),this.dispatchThemeChangedEvent=t=>{const e=t.target.checked;this.dispatchEvent(Ge("theme-switch",e?"dark":"light"))}}render(){return L`
      <div class="check-box-container" @click="${t=>t.stopPropagation()}">
        <input type="checkbox" @click="${this.dispatchThemeChangedEvent}" ?checked="${"dark"==this.theme}" id="darkTheme" />
        <label for="darkTheme">Dark</label>
      </div>
    `}};vn.styles=[bt,s(mn.Z)],gn([ut()],vn.prototype,"theme",void 0),vn=gn([lt("mte-theme-switch")],vn);const bn=({hasDetail:t,mode:e},r)=>L`<mte-drawer
    class="container fixed bottom-0 z-10 overflow-hidden rounded-t-3xl bg-gray-200/60 shadow-xl backdrop-blur-lg motion-safe:transition-[height,max-width] motion-safe:duration-200"
    ?hasDetail=${t}
    .mode="${e}"
  >
    ${r}
  </mte-drawer>`;var yn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};const wn=t=>`${t.name}${t.sourceFile&&t.location?` (${pr(t)})`:""}`;let xn=class extends kr{constructor(){super(...arguments),this.mode="closed"}render(){return bn({hasDetail:Boolean(this.mutant?.killedByTests?.length||this.mutant?.coveredByTests?.length),mode:this.mode},or(this.mutant,(t=>L`
          <span class="align-middle text-lg" slot="header"
            >${cr(t.status)} ${t.mutatorName} ${t.status}
            (${t.location.start.line}:${t.location.start.column})</span
          >
          <span slot="summary">${this.renderSummary()}</span>
          <span slot="detail" class="block">${this.renderDetail()}</span>
        `)))}renderSummary(){return Xe(L`${this.mutant?.killedByTests?.[0]?Qe(L`${tr("🎯","killed")} Killed by:
            ${this.mutant.killedByTests?.[0].name}${this.mutant.killedByTests.length>1?`(and ${this.mutant.killedByTests.length-1} more)`:""}`):U}
      ${ir(this.mutant?.static,Qe(L`${tr("🗿","static")} Static mutant`))}
      ${or(this.mutant?.coveredByTests,(t=>Qe(L`${tr("☂️","umbrella")} Covered by ${t.length}
          test${hr(t)}${this.mutant?.status===Ye.MutantStatus.Survived?" (yet still survived)":""}`)))}
      ${ir(this.mutant?.statusReason?.trim(),Qe(L`${tr("🕵️","spy")} ${this.mutant.statusReason}`,`Reason for the ${this.mutant.status} status`))}
      ${or(this.mutant?.description,(t=>Qe(L`${tr("📖","book")} ${t}`)))}`)}renderDetail(){return L`<ul class="mb-6 mr-12">
      ${this.mutant?.killedByTests?.map((t=>Je("This mutant was killed by this test",L`${tr("🎯","killed")} ${wn(t)}`)))}
      ${this.mutant?.coveredByTests?.filter((t=>!this.mutant?.killedByTests?.includes(t))).map((t=>Je("This mutant was covered by this test",L`${tr("☂️","umbrella")} ${wn(t)}`)))}
    </ul>`}};xn.styles=[bt],yn([ut()],xn.prototype,"mutant",void 0),yn([ut({reflect:!0})],xn.prototype,"mode",void 0),xn=yn([lt("mte-drawer-mutant")],xn);var kn=r(3813),$n=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let Sn=class extends kr{constructor(){super(...arguments),this.drawerMode="closed",this.handleClick=()=>{this.drawerMode="closed"},this.handleMutantSelected=t=>{this.selectedMutant=t.detail.mutant,this.drawerMode=t.detail.selected?"half":"closed"}}updated(t){t.has("result")&&!this.result.file&&(this.drawerMode="closed")}render(){return L`
      <main @click="${this.handleClick}">
        <mte-metrics-table .columns="${_n}" .currentPath="${this.path}" .thresholds="${this.thresholds}" .model="${this.result}">
        </mte-metrics-table>
        ${this.result.file?L`<mte-file @mutant-selected="${this.handleMutantSelected}" .model="${this.result.file}"></mte-file>`:U}
      </main>
      <mte-drawer-mutant .mode="${this.drawerMode}" .mutant="${this.selectedMutant}"></mte-drawer-mutant>
    `}};Sn.styles=[s(kn.Z),bt],$n([ut()],Sn.prototype,"drawerMode",void 0),$n([ut()],Sn.prototype,"selectedMutant",void 0),$n([ut()],Sn.prototype,"result",void 0),$n([ut({attribute:!1,reflect:!1})],Sn.prototype,"thresholds",void 0),$n([ut({attribute:!1,reflect:!1})],Sn.prototype,"path",void 0),Sn=$n([lt("mte-mutant-view")],Sn);const _n=[{key:"mutationScore",label:"Mutation score",tooltip:"The percentage of mutants that were detected. The higher, the better!",category:"percentage"},{key:"killed",label:"Killed",tooltip:"At least one test failed while these mutants were active. This is what you want!",category:"number"},{key:"survived",label:"Survived",tooltip:"All tests passed while these mutants were active. You're missing a test for them.",category:"number"},{key:"timeout",label:"Timeout",tooltip:"Running the tests while these mutants were active resulted in a timeout. For example, an infinite loop.",category:"number"},{key:"noCoverage",label:"No coverage",tooltip:"These mutants aren't covered by one of your tests and survived as a result.",category:"number"},{key:"ignored",label:"Ignored",tooltip:"These mutants weren't tested because they are ignored. Either by user action, or for another reason.",category:"number"},{key:"runtimeErrors",label:"Runtime errors",tooltip:"Running tests when these mutants are active resulted in an error (rather than a failed test). For example: an out of memory error.",category:"number"},{key:"compileErrors",label:"Compile errors",tooltip:"Mutants that caused a compile error.",category:"number"},{key:"totalDetected",label:"Detected",tooltip:"The number of mutants detected by your tests (killed + timeout).",category:"number",width:"large",isBold:!0},{key:"totalUndetected",label:"Undetected",tooltip:"The number of mutants that are not detected by your tests (survived + no coverage).",category:"number",width:"large",isBold:!0},{key:"totalMutants",label:"Total",tooltip:"All mutants (except runtimeErrors + compileErrors)",category:"number",width:"large",isBold:!0}];var An=r(9827),Mn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let Cn=class extends kr{constructor(){super(...arguments),this.drawerMode="closed",this.handleClick=()=>{this.drawerMode="closed"},this.handleTestSelected=t=>{this.selectedTest=t.detail.test,this.drawerMode=t.detail.selected?"half":"closed"}}updated(t){t.has("result")&&!this.result.file&&(this.drawerMode="closed")}render(){return L`
      <main @click="${this.handleClick}">
        <mte-metrics-table .columns="${En}" .currentPath="${this.path}" .model="${this.result}"> </mte-metrics-table>
        ${this.result.file?L`<mte-test-file @test-selected="${this.handleTestSelected}" .model="${this.result.file}"></mte-test-file>`:U}
      </main>
      <mte-drawer-test .mode="${this.drawerMode}" .test="${this.selectedTest}"></mte-drawer-test>
    `}};Cn.styles=[s(An.Z),bt],Mn([ut()],Cn.prototype,"drawerMode",void 0),Mn([ut()],Cn.prototype,"result",void 0),Mn([ut({attribute:!1,reflect:!1})],Cn.prototype,"path",void 0),Mn([ut()],Cn.prototype,"selectedTest",void 0),Cn=Mn([lt("mte-test-view")],Cn);const En=[{key:"killing",label:"Killing",tooltip:"These tests killed at least one mutant",width:"normal",category:"number"},{key:"covering",label:"Covering",tooltip:"These tests are covering at least one mutant, but not killing any of them.",width:"normal",category:"number"},{key:"notCovering",label:"Not Covering",tooltip:"These tests were not covering a mutant (and thus not killing any of them).",width:"normal",category:"number"},{key:"total",label:"Total tests",width:"large",category:"number",isBold:!0}],Pn=Tr(class extends jr{constructor(t){var e;if(super(t),1!==t.type||"class"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){var r,n;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!(null===(r=this.nt)||void 0===r?void 0:r.has(t))&&this.it.add(t);return this.render(e)}const i=t.element.classList;this.it.forEach((t=>{t in e||(i.remove(t),this.it.delete(t))}));for(const t in e){const r=!!e[t];r===this.it.has(t)||(null===(n=this.nt)||void 0===n?void 0:n.has(t))||(r?(i.add(t),this.it.add(t)):(i.remove(t),this.it.delete(t)))}return I}});var Tn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let jn=class extends kr{constructor(){super(...arguments),this.currentPath=[],this.thresholds={high:80,low:60},this.hasMultipleColspan=!1}willUpdate(t){t.has("columns")&&(this.hasMultipleColspan=this.columns.some((t=>"percentage"===t.category)))}render(){return L`${this.model?L`<div class="overflow-x-auto rounded-md border border-gray-200">
          <table class="w-full table-auto text-left text-sm">${this.renderTableHeadRow()}${this.renderTableBody(this.model)} </table>
        </div>`:U}`}renderTableHeadRow(){return L`<thead class="border-b border-gray-200 text-center text-sm">
      <tr>
        <th scope="col" class="px-4 py-4">
          <div class="flex items-center justify-around">
            <span>File / Directory</span
            ><a
              href="https://stryker-mutator.io/docs/mutation-testing-elements/mutant-states-and-metrics"
              target="_blank"
              class="info-icon float-right"
              title="What does this all mean?"
              >${tr("ℹ","info icon")}</a
            >
          </div>
        </th>
        ${cn(this.columns,(t=>t.key),(t=>this.renderTableHead(t)))}
      </tr>
    </thead>`}renderTableHead(t){const e=`tooltip-${t.key.toString()}`,r=t.tooltip?L`<mte-tooltip title="${t.tooltip}" id="${e}">${t.label}</mte-tooltip>`:L`<span id="${e}">${t.label}</span>`;return"percentage"===t.category?L` <th colspan="2" class="px-2 even:bg-gray-100"> ${r} </th>`:L`<th class="w-24 px-2 even:bg-gray-100 2xl:w-28">
      <div class="inline-block">${r}</div>
    </th>`}renderTableBody(t){return L`<tbody class="divide-y divide-gray-200">${this.renderRow(t.name,t)} ${(()=>t.file?U:t.childResults.map((t=>{const e=[t.name];for(;!t.file&&1===t.childResults.length;)t=t.childResults[0],e.push(t.name);return this.renderRow(e.join("/"),t,...this.currentPath,...e)})))()}</tbody>`}renderRow(t,e,...r){return L`<tr title="${e.name}" class="group hover:bg-gray-200">
      <td class="font-semibold">
        <div class="flex items-center justify-start">
          <mte-file-icon file-name="${e.name}" ?file="${e.file}" class="mx-1"></mte-file-icon> ${r.length>0?L`<a class="mr-auto inline-block w-full py-4 pr-2 hover:text-primary-on hover:underline" href="${dr(...r)}"
                >${t}</a
              >`:L`<span class="py-4">${e.name}</span>`}
        </div>
      </td>
      ${this.columns.map((t=>this.renderCell(t,e.metrics)))}
    </tr>`}renderCell(t,e){const r=e[t.key],n=this.hasMultipleColspan?"odd:bg-gray-100":"even:bg-gray-100";if("percentage"===t.category){const e=!isNaN(r),i=this.determineBgColoringClass(r),o=this.determineTextColoringClass(r),s=r.toFixed(2),a=`width: ${r}%`;return L`<td class="bg-gray-100 px-4 py-4 group-hover:bg-gray-200">
          ${e?L`<div class="h-3 w-full min-w-[24px] rounded-full bg-gray-300">
                <div
                  class="${i} h-3 rounded-full pl-1 transition-all"
                  role="progressbar"
                  aria-valuenow="${s}"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  aria-describedby="tooltip-mutationScore"
                  title="${t.label}"
                  style="${a}"
                ></div>
              </div>`:L` <span class="text-light-muted font-bold">N/A</span> `}
        </td>
        <td class="${o} ${n} w-12 pr-2 text-center font-bold group-hover:bg-gray-200"
          >${e?L`<span class="transition-colors">${s}</span>`:U}</td
        >`}return L`<td
      class="${Pn({"font-bold":t.isBold??!1,[n]:!0})} py-4 text-center group-hover:bg-gray-200"
      aria-describedby="${`tooltip-${t.key.toString()}`}"
      >${r}</td
    >`}determineBgColoringClass(t){return!isNaN(t)&&this.thresholds?t<this.thresholds.low?"bg-red-600 text-gray-200":t<this.thresholds.high?"bg-yellow-400":"bg-green-600 text-gray-200":"bg-blue-600"}determineTextColoringClass(t){return!isNaN(t)&&this.thresholds?t<this.thresholds.low?"text-red-700":t<this.thresholds.high?"text-yellow-600":"text-green-700":""}};jn.styles=[bt],Tn([ut()],jn.prototype,"model",void 0),Tn([ut()],jn.prototype,"currentPath",void 0),Tn([ut({type:Array})],jn.prototype,"columns",void 0),Tn([ut()],jn.prototype,"thresholds",void 0),jn=Tn([lt("mte-metrics-table")],jn);var Fn=r(5110),zn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let On=class extends kr{constructor(){super(...arguments),this.filters=[],this.lines=[],this.enabledStates=[],this.tests=[],this.filtersChanged=t=>{this.enabledStates=t.detail,this.selectedTest&&!this.enabledStates.includes(this.selectedTest.status)&&this.toggleTest(this.selectedTest)},this.nextTest=()=>{const t=this.selectedTest?(this.tests.findIndex((({id:t})=>t===this.selectedTest.id))+1)%this.tests.length:0;this.selectTest(this.tests[t])},this.previousTest=()=>{const t=this.selectedTest?(this.tests.findIndex((({id:t})=>t===this.selectedTest.id))+this.tests.length-1)%this.tests.length:this.tests.length-1;this.selectTest(this.tests[t])}}toggleTest(t){this.selectedTest===t?(this.selectedTest=void 0,this.dispatchEvent(Ge("test-selected",{selected:!1,test:t}))):(this.selectedTest=t,this.dispatchEvent(Ge("test-selected",{selected:!0,test:t})),fr(this.shadowRoot.querySelector(`[test-id="${t.id}"]`)))}selectTest(t){t&&this.toggleTest(t)}render(){return L`
      <mte-state-filter
        @next=${this.nextTest}
        @previous=${this.previousTest}
        .filters="${this.filters}"
        @filters-changed="${this.filtersChanged}"
      ></mte-state-filter>
      ${this.renderTestList()} ${this.renderCode()}
    `}renderTestList(){const t=this.tests.filter((t=>!t.location));return t.length?L`<ul class="max-w-6xl">
        ${cn(t,(t=>t.id),(t=>L`<li class="my-3">
              <button
                class="w-full rounded p-3 text-left hover:bg-gray-100 active:bg-gray-200"
                type="button"
                data-active="${this.selectedTest===t}"
                test-id="${t.id}"
                @click=${e=>{e.stopPropagation(),this.toggleTest(t)}}
                >${lr(t.status)} ${t.name} [${t.status}]
              </button>
            </li>`))}
      </ul>`:U}renderCode(){if(this.model?.source){const t=new Map;for(const e of this.tests)if(e.location){let r=t.get(e.location.start.line);r||(r=[],t.set(e.location.start.line,r)),r.push(e)}const e=e=>this.renderTestDots([...t.entries()].filter((([t])=>t>e)).flatMap((([,t])=>t)));return L`<pre id="report-code-block" class="line-numbers flex rounded-md p-1"><code class="flex language-${Kr(this.model.name)}">
      <table>
        ${this.lines.map(((r,n)=>{const i=n+1;return tn(r,Xr(this.renderTestDots(t.get(i)),this.lines.length===i?e(i):U))}))}</table></code></pre>`}return U}renderTestDots(t){return t?.length?t.map((t=>D`<svg test-id="${t.id}" class="cursor-pointer test-dot ${this.selectedTest===t?"selected":t.status}" @click=${e=>{e.stopPropagation(),this.toggleTest(t)}} height="10" width="12">
          <title>${function(t){return`${t.name} (${t.status})`}(t)}</title>
          <circle cx="5" cy="5" r="5" />
          </svg>`)):U}reactivate(){super.reactivate(),this.updateFileRepresentation()}willUpdate(t){t.has("model")&&this.updateFileRepresentation(),(t.has("model")||t.has("enabledStates"))&&this.model&&(this.tests=this.model.tests.filter((t=>this.enabledStates.includes(t.status))).sort(((t,e)=>t.location&&e.location?Gr(t.location.start,e.location.start)?1:-1:this.model.tests.indexOf(t)-this.model.tests.indexOf(e)))),super.update(t)}updateFileRepresentation(){if(!this.model)return;const t=this.model;this.filters=[pt.ih.Killing,pt.ih.Covering,pt.ih.NotCovering].filter((e=>t.tests.some((t=>t.status===e)))).map((e=>({enabled:!0,count:t.tests.filter((t=>t.status===e)).length,status:e,label:L`${lr(e)} ${e}`,context:ar(e)}))),this.model.source&&(this.lines=Vr(qr(this.model.source,this.model.name)))}};On.styles=[yt,bt,s(Fn.Z)],zn([ut()],On.prototype,"model",void 0),zn([dt()],On.prototype,"filters",void 0),zn([dt()],On.prototype,"lines",void 0),zn([dt()],On.prototype,"enabledStates",void 0),zn([dt()],On.prototype,"selectedTest",void 0),zn([dt()],On.prototype,"tests",void 0),On=zn([lt("mte-test-file")],On);var Rn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};const Nn=t=>L`<code>${t.getMutatedLines()}</code> (${pr(t)})`;let Bn=class extends kr{constructor(){super(...arguments),this.mode="closed"}render(){return bn({hasDetail:Boolean(this.test?.killedMutants?.length||this.test?.coveredMutants?.length),mode:this.mode},or(this.test,(t=>L`
          <span class="align-middle text-lg" slot="header"
            >${lr(t.status)} ${t.name} [${t.status}]
            ${t.location?L`(${t.location.start.line}:${t.location.start.column})`:U}</span
          >
          <span slot="summary">${this.renderSummary()}</span>
          <span class="block" slot="detail">${this.renderDetail()}</span>
        `)))}renderSummary(){return Xe(L`${this.test?.killedMutants?.[0]?Qe(L`${tr("🎯","killed")} Killed:
            ${Nn(this.test.killedMutants?.[0])}${this.test.killedMutants.length>1?L` (and ${this.test.killedMutants.length-1} more)`:""}`):U}
      ${or(this.test?.coveredMutants,(t=>Qe(L`${tr("☂️","umbrella")} Covered ${t.length}
          mutant${hr(t)}${this.test?.status===pt.ih.Covering?" (yet didn't kill any of them)":""}`)))}`)}renderDetail(){return L`<ul class="mb-6 mr-12">
      ${this.test?.killedMutants?.map((t=>Je("This test killed this mutant",L`${tr("🎯","killed")} ${Nn(t)}`)))}
      ${this.test?.coveredMutants?.filter((t=>!this.test?.killedMutants?.includes(t))).map((t=>Je("This test covered this mutant",L`${tr("☂️","umbrella")} ${Nn(t)}`)))}
    </ul>`}};Bn.styles=[bt],Rn([ut()],Bn.prototype,"test",void 0),Rn([ut({reflect:!0})],Bn.prototype,"mode",void 0),Bn=Rn([lt("mte-drawer-test")],Bn);var Ln=r(8847),Dn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let In=class extends st{get language(){return Kr(this.fileName)}get isTestFile(){const t=this.fileName.substr(0,this.fileName.lastIndexOf(".")).toLowerCase();return t.endsWith("spec")||t.endsWith("test")}get cssClass(){return Pn({[this.language?.toString()??"unknown"]:this.isFile,test:this.isTestFile})}render(){if(!this.isFile)return D`<svg aria-label="directory" class="octicon octicon-file-directory" viewBox="0 0 14 16" version="1.1" width="14" height="16" role="img"><path fill-rule="evenodd" d="M 13,2 H 7 V 1 C 7,0.34 6.69,0 6,0 H 1 C 0.45,0 0,0.45 0,1 v 10 c 0,0.55 0.45,1 1,1 h 12 c 0.55,0 1,-0.45 1,-1 V 3 C 14,2.45 13.55,2 13,2 Z M 6,2 H 1 V 1 h 5 z" id="path2" /></svg>`;if(!this.language)return D`<svg aria-label="file" class="octicon octicon-file" viewBox="0 0 12 16" version="1.1" width="12" height="16" role="img"><path fill-rule="evenodd" d="M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z"></path></svg>`;switch(this.language){case Hr.csharp:return D`<svg class="${this.cssClass}" aria-label="cs" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g><path d="M7.1 15.9c0-1.3.2-2.4.6-3.4.4-1 .9-1.8 1.6-2.5.7-.7 1.5-1.2 2.4-1.6s1.9-.5 2.9-.5 1.9.2 2.7.6c.8.4 1.5.9 2 1.4l-2.2 2.5c-.4-.3-.7-.6-1.1-.7-.4-.1-.8-.3-1.4-.3-.5 0-.9.1-1.3.3-.4.2-.8.5-1.1.9s-.5.8-.7 1.4c-.2.6-.3 1.2-.3 1.9 0 1.5.3 2.6 1 3.3.7.8 1.5 1.2 2.6 1.2.5 0 1-.1 1.4-.3.4-.2.8-.5 1.1-.9l2.2 2.5c-.7.8-1.4 1.3-2.2 1.7-.8.4-1.7.6-2.7.6s-2-.2-2.9-.5-1.7-.8-2.4-1.5-1.1-1.7-1.5-2.7c-.5-.9-.7-2.1-.7-3.4z"/><path d="M21.8 17.1h-1l-.4 2.4h-1.2l.4-2.4h-1.2V16h1.5l.2-1.6h-1.3v-1.1h1.5l.4-2.4h1.2l-.4 2.4h1l.4-2.4h1.2l-.4 2.4H25v1.1h-1.6l-.2 1.6h1.3v1.1h-1.6l-.4 2.4h-1.2c0 .1.5-2.4.5-2.4zm-.8-1h1l.2-1.6h-1l-.2 1.6z"/></g></svg>`;case Hr.html:return D`<svg class="${this.cssClass}" aria-label="html" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M8 15l6-5.6V12l-4.5 4 4.5 4v2.6L8 17v-2zm16 2.1l-6 5.6V20l4.6-4-4.6-4V9.3l6 5.6v2.2z"/></svg>`;case Hr.java:return D`<svg class="${this.cssClass}" aria-label="java" xmlns="http://www.w3.org/2000/svg" viewBox="-4 -4 20 20"><path class="cls-1" d="M6 0a6 6 0 1 0 6 6 6 6 0 0 0-6-6zm2.14 6.8a2.16 2.16 0 0 1-2.29 2.41 2.5 2.5 0 0 1-2-.87l.73-.92a1.52 1.52 0 0 0 1.23.59c.66 0 1.06-.42 1.06-1.32V2.8h1.26z"/></svg>`;case Hr.javascript:return D`<svg class="${this.cssClass}" aria-label="js" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path  d="M11.4 10h2.7v7.6c0 3.4-1.6 4.6-4.3 4.6-.6 0-1.5-.1-2-.3l.3-2.2c.4.2.9.3 1.4.3 1.1 0 1.9-.5 1.9-2.4V10zm5.1 9.2c.7.4 1.9.8 3 .8 1.3 0 1.9-.5 1.9-1.3s-.6-1.2-2-1.7c-2-.7-3.3-1.8-3.3-3.6 0-2.1 1.7-3.6 4.6-3.6 1.4 0 2.4.3 3.1.6l-.6 2.2c-.5-.2-1.3-.6-2.5-.6s-1.8.5-1.8 1.2c0 .8.7 1.1 2.2 1.7 2.1.8 3.1 1.9 3.1 3.6 0 2-1.6 3.7-4.9 3.7-1.4 0-2.7-.4-3.4-.7l.6-2.3z"/></svg>`;case Hr.typescript:return D`<svg class="${this.cssClass}" aria-label="ts" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M15.6 11.8h-3.4V22H9.7V11.8H6.3V10h9.2v1.8zm7.7 7.1c0-.5-.2-.8-.5-1.1-.3-.3-.9-.5-1.7-.8-1.4-.4-2.5-.9-3.3-1.5-.7-.6-1.1-1.3-1.1-2.3 0-1 .4-1.8 1.3-2.4.8-.6 1.9-.9 3.2-.9 1.3 0 2.4.4 3.2 1.1.8.7 1.2 1.6 1.2 2.6h-2.3c0-.6-.2-1-.6-1.4-.4-.3-.9-.5-1.6-.5-.6 0-1.1.1-1.5.4-.4.3-.5.7-.5 1.1 0 .4.2.7.6 1 .4.3 1 .5 2 .8 1.3.4 2.3.9 3 1.5.7.6 1 1.4 1 2.4s-.4 1.9-1.2 2.4c-.8.6-1.9.9-3.2.9-1.3 0-2.5-.3-3.4-1s-1.5-1.6-1.4-2.9h2.4c0 .7.2 1.2.7 1.6.4.3 1.1.5 1.8.5s1.2-.1 1.5-.4c.2-.3.4-.7.4-1.1z"/></svg>`;case Hr.scala:return D`<svg class="${this.cssClass}" aria-label="scala" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M21.6 7v4.2c-.1.1-.1.2-.2.2-.3.3-.7.5-1.1.6-.9.3-1.9.5-2.8.7-1.6.3-3.1.5-4.7.7-.8.1-1.6.2-2.4.4V9.6c.1-.1.2-.1.4-.1 1.2-.2 2.5-.4 3.8-.5 1.9-.3 3.8-.5 5.6-1.1.5-.2 1.1-.4 1.4-.9zm0 5.6v4.2l-.2.2c-.5.4-1.1.6-1.6.8-.8.2-1.6.4-2.4.5-1 .2-1.9.3-2.9.5-1.4.2-2.7.3-4.1.6v-4.2c.1-.1.2-.1.3-.1 1.7-.2 3.4-.5 5.1-.7 1.4-.2 2.9-.5 4.3-.9.6-.2 1.1-.4 1.5-.9zM10.5 25h-.1v-4.2c.1-.1.2-.1.3-.1 1.2-.2 2.3-.3 3.5-.5 2-.3 3.9-.5 5.8-1.1.6-.2 1.2-.4 1.6-.9v4.2c-.1.2-.3.3-.5.5-.6.3-1.2.5-1.9.7-1.2.3-2.5.5-3.7.7-1.3.2-2.6.4-3.9.5-.4 0-.7.1-1.1.2z"/></svg>`;case Hr.php:return D`<svg class="${this.cssClass}" aria-label="php" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M12.7 19.7c-.1-.6-.4-1.1-1-1.3-.2-.1-.5-.3-.7-.4-.3-.1-.6-.2-.8-.3-.2-.1-.4 0-.6.2-.1.2 0 .4.1.5.1.2.2.3.4.5.2.3.4.5.7.8.2.3.4.5.3.9-.1.7-.4 1.4-.9 1.9-.1.1-.2.1-.2.1-.3 0-.7-.2-.9-.4-.3-.3-.2-.6.1-.8.1 0 .2-.1.2-.2.2-.2.3-.4.2-.7-.1-.1-.1-.2-.2-.3-.4-.4-.9-.8-1.4-1.2-1.3-1-1.9-2.2-2-3.6-.1-1.6.3-3.1 1.1-4.5.3-.5.7-1 1.3-1.3.4-.2.8-.3 1.2-.4 1.1-.3 2.3-.5 3.5-.3 1 .2 1.8.7 2.1 1.7.2.7.3 1.3.2 2-.1 1.4-1.2 2.6-2.5 3-.6.2-.9.1-1.2-.4-.2-.3-.5-.7-.7-1.1V14c0-.1-.1-.1-.1-.2.1.6.2 1.2.5 1.7.2.3.4.5.8.5 1.3.1 2.3-.3 3.1-1.3.8-1.1 1-2.4.8-3.8 0-.3-.1-.5-.2-.8 0-.2 0-.3.2-.4.1 0 .2 0 .2-.1 1-.2 2.1-.3 3.1-.2 1.2.1 2.3.4 3.3 1.1 1.6 1 2.6 2.5 3.1 4.3.1.3.1.5.1.8 0 .2-.1.2-.3.1-.2-.1-.3-.3-.4-.4-.1-.1-.2-.3-.3-.4-.1-.1-.2-.1-.2 0s-.1.2-.1.3c-.3 1-.7 1.9-1.4 2.6-.1.1-.2.3-.2.4 0 .4-.1.8 0 1.2.1.8.2 1.7.3 2.5.1.5-.1.7-.5.9-.3.1-.6.2-1 .2h-1.6c0-.6 0-1.2-.5-1.5.1-.4.2-.8.3-1.3.1-.4 0-.7-.2-1-.2-.3-.5-.3-.8-.2-.8.5-1.6.5-2.5.2-.4-.1-.7-.1-.9.3-.2.4-.3.8-.3 1.2 0 .5.1 1.1.2 1.6 0 .3 0 .4-.3.5-.7.2-1.4.2-2 .1h-.1c0-.6 0-1.2-.7-1.5.4-.4.4-1.1.3-1.7zm-4.1-2.3c.1-.1.2-.2.2-.4.1-.3-.2-.8-.5-.9-.2-.1-.3 0-.4.1-.3.3-.5.6-.8.9 0 .1-.1.1-.1.2-.1.2 0 .4.2.4.1 0 .3 0 .4.1.4 0 .7-.1 1-.4zm0-3.3c0-.2-.2-.4-.4-.4s-.5.2-.4.5c0 .2.2.4.5.4.1-.1.3-.3.3-.5z"/></svg>`;case Hr.vue:return D`<svg class="${this.cssClass}" aria-label="vue" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1000"><path d="M600 495.9l159.1-275.4h-84.4L600 349.7l-74.6-129.2h-84.5z"/><path d="M793.7 220.5L600 555.9 406.3 220.5H277l323 559 323-559z"/></svg>`;case Hr.gherkin:return D`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16.129,2a12.348,12.348,0,0,0-2.35,24.465V30c7.371-1.114,13.9-6.982,14.384-14.684a12.8,12.8,0,0,0-5.9-11.667c-.223-.132-.449-.262-.682-.377s-.481-.231-.729-.33c-.079-.033-.156-.063-.235-.094-.216-.08-.435-.17-.658-.236A12.188,12.188,0,0,0,16.129,2Z" style="fill:var(--mut-file-gherkin-color)"/><path d="M18.68,6.563a1.345,1.345,0,0,0-1.178.472,5.493,5.493,0,0,0-.518.9,2.9,2.9,0,0,0,.377,3.023A3.317,3.317,0,0,0,19.763,9,2.388,2.388,0,0,0,20,8,1.411,1.411,0,0,0,18.68,6.563Zm-5.488.071A1.441,1.441,0,0,0,11.85,8,2.388,2.388,0,0,0,12.085,9a3.427,3.427,0,0,0,2.473,1.96,3.141,3.141,0,0,0-.212-3.85,1.322,1.322,0,0,0-1.154-.472Zm-3.7,3.637a1.3,1.3,0,0,0-.73,2.338,5.663,5.663,0,0,0,.895.543,3.386,3.386,0,0,0,3.179-.307,3.492,3.492,0,0,0-2.049-2.338,2.69,2.69,0,0,0-1.06-.236,1.369,1.369,0,0,0-.236,0Zm11.611,4.582a3.44,3.44,0,0,0-1.955.567A3.492,3.492,0,0,0,21.2,17.758a2.69,2.69,0,0,0,1.06.236,1.329,1.329,0,0,0,.966-2.362,5.47,5.47,0,0,0-.895-.52,3.247,3.247,0,0,0-1.225-.26Zm-10.292.071a3.247,3.247,0,0,0-1.225.26,2.575,2.575,0,0,0-.895.543A1.34,1.34,0,0,0,9.73,18.065a2.426,2.426,0,0,0,1.06-.236,3.185,3.185,0,0,0,1.955-2.338,3.366,3.366,0,0,0-1.931-.567Zm3.815,2.314a3.317,3.317,0,0,0-2.4,1.96,2.286,2.286,0,0,0-.236.968,1.4,1.4,0,0,0,2.426.992,5.492,5.492,0,0,0,.518-.9,3.109,3.109,0,0,0-.306-3.023Zm2.8.071a3.141,3.141,0,0,0,.212,3.85,1.47,1.47,0,0,0,2.5-.9,2.388,2.388,0,0,0-.236-.992,3.427,3.427,0,0,0-2.473-1.96Z" style="fill:#fff"/></svg>`}}};In.styles=[s(Ln.Z)],Dn([ut({attribute:"file-name"})],In.prototype,"fileName",void 0),Dn([ut({attribute:"file",type:Boolean})],In.prototype,"isFile",void 0),In=Dn([lt("mte-file-icon")],In);var Un=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};let Hn=class extends st{render(){return L`<span class="cursor-help underline decoration-dotted" title="${this.title}"><slot></slot></span>`}};Hn.styles=[bt],Un([ut({attribute:!0})],Hn.prototype,"title",void 0),Hn=Un([lt("mte-tooltip")],Hn);var Zn,Kn,qn,Vn,Wn,Gn,Yn,Jn,Qn,Xn=function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s},ti=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let ei=class extends st{constructor(){super(),Zn.add(this),this.detected=0,this.undetected=0,this.invalid=0,this.ignored=0,this.pending=0,this.total=0,this.shouldBeSmall=!1,Kn.set(this,void 0)}connectedCallback(){super.connectedCallback(),function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(t,r):i?i.value=r:e.set(t,r)}(this,Kn,new window.IntersectionObserver((([t])=>{t.isIntersecting?this.shouldBeSmall=!1:this.shouldBeSmall=!0,this.requestUpdate()})),"f"),ti(this,Kn,"f").observe(this)}disconnectedCallback(){super.disconnectedCallback(),ti(this,Kn,"f")?.disconnect()}render(){return L`
      ${ti(this,Zn,"m",qn).call(this)}
      <div class="my-4 rounded-md border border-gray-200 bg-white transition-all">
        <div class="relative">
          <div class="parts flex h-8 w-full overflow-hidden rounded bg-gray-200">${ti(this,Zn,"m",Wn).call(this)}</div>
        </div>
      </div>
    `}};Kn=new WeakMap,Zn=new WeakSet,qn=function(){return L`<div
      class="${this.shouldBeSmall?"opacity-1":"opacity-0"} pointer-events-none fixed left-0 top-0 z-20 flex w-full justify-center transition-all"
    >
      <div class="container w-full bg-white py-2">
        <div class="flex h-2 overflow-hidden rounded bg-gray-200">${ti(this,Zn,"m",Yn).call(this).map((t=>ti(this,Zn,"m",Vn).call(this,t)))}</div>
      </div>
    </div>`},Vn=function(t){return L`<div
      class="${ti(this,Zn,"m",Jn).call(this,t.type)} z-20 h-2 transition-all"
      style="width: ${ti(this,Zn,"m",Qn).call(this,t.amount)}%"
    ></div>`},Wn=function(){return L`${ti(this,Zn,"m",Yn).call(this).map((t=>ti(this,Zn,"m",Gn).call(this,t)))}`},Gn=function(t){return L`<div
      title="${t.tooltip}"
      style="width: ${ti(this,Zn,"m",Qn).call(this,t.amount)}%"
      class="${ti(this,Zn,"m",Jn).call(this,t.type)} ${0===t.amount?"opacity-0":""} relative flex h-8 items-center overflow-hidden transition-all"
    >
      <span class="ms-3 font-bold text-gray-800">${t.amount}</span>
    </div>`},Yn=function(){return[{type:"detected",amount:this.detected,tooltip:"killed + timeout"},{type:"undetected",amount:this.undetected,tooltip:"survived + no coverage"},{type:"ignored + invalid",amount:this.ignored+this.invalid,tooltip:"ignored + runtime error + compile error"},{type:"pending",amount:this.pending,tooltip:"pending"}]},Jn=function(t){switch(t){case"detected":return"bg-green-600";case"undetected":return"bg-red-600";case"ignored + invalid":return"bg-yellow-600";default:return"bg-gray-200"}},Qn=function(t){return 0!==this.total?100*t/this.total:0},ei.styles=[bt],Xn([ut({attribute:!1})],ei.prototype,"detected",void 0),Xn([ut({attribute:!1})],ei.prototype,"undetected",void 0),Xn([ut({attribute:!1})],ei.prototype,"invalid",void 0),Xn([ut({attribute:!1})],ei.prototype,"ignored",void 0),Xn([ut({attribute:!1})],ei.prototype,"pending",void 0),Xn([ut({attribute:!1})],ei.prototype,"total",void 0),Xn([dt()],ei.prototype,"shouldBeSmall",void 0),ei=Xn([lt("mte-result-status-bar")],ei)}()}();
    </script>
  </head>
  <body>
    <svg style="width: 80px; position:fixed; right:10px; bottom:10px; z-index:10" class="stryker-image" viewBox="0 0 1458 1458" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2"><path fill="none" d="M0 0h1458v1458H0z"/><clipPath id="a"><path d="M0 0h1458v1458H0z"/></clipPath><g clip-path="url(#a)"><path d="M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729" fill="#e74c3c" fill-rule="nonzero"/><path d="M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z" fill-opacity=".3"/><path d="M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z" fill="#f1c40f" fill-rule="nonzero"/><path d="M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z"/></g></svg>
    <mutation-test-report-app titlePostfix="Stryker">
      Your browser doesn't support <a href="https://caniuse.com/#search=custom%20elements">custom elements</a>.
      Please use a latest version of an evergreen browser (Firefox, Chrome, Safari, Opera, Edge, etc).
    </mutation-test-report-app>
    <script>
      const app = document.querySelector('mutation-test-report-app');
      app.report = {"files":{"src/posts/bookmarks.js":{"language":"javascript","mutants":[{"id":"3","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":13},"start":{"column":50,"line":11}}},{"id":"1","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":9},"start":{"column":48,"line":7}}},{"id":"0","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":68},"start":{"column":35,"line":6}}},{"id":"2","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":8},"start":{"column":37,"line":8}}},{"id":"4","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":12},"start":{"column":37,"line":12}}},{"id":"6","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":16},"start":{"column":13,"line":16}}},{"id":"8","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":16},"start":{"column":13,"line":16}}},{"id":"10","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":18},"start":{"column":37,"line":16}}},{"id":"7","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":16},"start":{"column":13,"line":16}}},{"id":"9","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":16},"start":{"column":13,"line":16}}},{"id":"11","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":17},"start":{"column":29,"line":17}}},{"id":"12","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":20},"start":{"column":31,"line":20}}},{"id":"13","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":20},"start":{"column":31,"line":20}}},{"id":"17","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":23},"start":{"column":38,"line":23}}},{"id":"14","mutatorName":"EqualityOperator","replacement":"type !== 'bookmark'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":20},"start":{"column":31,"line":20}}},{"id":"16","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":25},"start":{"column":61,"line":22}}},{"id":"15","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":20},"start":{"column":40,"line":20}}},{"id":"18","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":23},"start":{"column":39,"line":23}}},{"id":"22","mutatorName":"LogicalOperator","replacement":"isBookmarking || hasBookmarked","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":27},"start":{"column":13,"line":27}}},{"id":"21","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":27},"start":{"column":13,"line":27}}},{"id":"23","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":29},"start":{"column":45,"line":27}}},{"id":"19","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":23},"start":{"column":46,"line":23}}},{"id":"20","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":27},"start":{"column":13,"line":27}}},{"id":"24","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":28},"start":{"column":29,"line":28}}},{"id":"28","mutatorName":"BooleanLiteral","replacement":"isBookmarking","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":31},"start":{"column":13,"line":31}}},{"id":"25","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":31},"start":{"column":13,"line":31}}},{"id":"27","mutatorName":"LogicalOperator","replacement":"!isBookmarking || !hasBookmarked","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":31},"start":{"column":13,"line":31}}},{"id":"26","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":31},"start":{"column":13,"line":31}}},{"id":"29","mutatorName":"BooleanLiteral","replacement":"hasBookmarked","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":31},"start":{"column":31,"line":31}}},{"id":"30","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":33},"start":{"column":47,"line":31}}},{"id":"34","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":37},"start":{"column":28,"line":35}}},{"id":"32","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":35},"start":{"column":13,"line":35}}},{"id":"31","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":32},"start":{"column":29,"line":32}}},{"id":"33","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":35},"start":{"column":13,"line":35}}},{"id":"35","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":36},"start":{"column":35,"line":36}}},{"id":"36","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":39},"start":{"column":16,"line":37}}},{"id":"38","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":40},"start":{"column":34,"line":40}}},{"id":"39","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":40},"start":{"column":45,"line":40}}},{"id":"41","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":41},"start":{"column":48,"line":41}}},{"id":"40","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":40},"start":{"column":58,"line":40}}},{"id":"37","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":38},"start":{"column":38,"line":38}}},{"id":"42","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":42},"start":{"column":39,"line":42}}},{"id":"5","mutatorName":"BlockStatement","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":6,"line":55},"start":{"column":51,"line":15}}},{"id":"44","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":49},"start":{"column":51,"line":44}}},{"id":"46","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":48},"start":{"column":53,"line":48}}},{"id":"45","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":48},"start":{"column":38,"line":48}}},{"id":"47","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":54},"start":{"column":16,"line":51}}},{"id":"48","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":67},"start":{"column":53,"line":57}}},{"id":"49","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":58},"start":{"column":13,"line":58}}},{"id":"52","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":58},"start":{"column":13,"line":58}}},{"id":"51","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":58},"start":{"column":13,"line":58}}},{"id":"53","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":60},"start":{"column":37,"line":58}}},{"id":"50","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":58},"start":{"column":13,"line":58}}},{"id":"54","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":59},"start":{"column":49,"line":59}}},{"id":"43","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":49,"line":44},"start":{"column":28,"line":44}}},{"id":"56","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":59},"start":{"column":64,"line":59}}},{"id":"57","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":62},"start":{"column":13,"line":62}}},{"id":"58","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":62},"start":{"column":13,"line":62}}},{"id":"59","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":65},"start":{"column":33,"line":62}}},{"id":"60","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":63},"start":{"column":34,"line":63}}},{"id":"61","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":63},"start":{"column":41,"line":63}}},{"id":"62","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":66},"start":{"column":37,"line":66}}},{"id":"55","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":60,"line":59},"start":{"column":55,"line":59}}}],"source":"'use strict';\n\nconst db = require('../database');\nconst plugins = require('../plugins');\n\nmodule.exports = function (Posts) {\n    Posts.bookmark = async function (pid, uid) {\n        return await toggleBookmark('bookmark', pid, uid);\n    };\n\n    Posts.unbookmark = async function (pid, uid) {\n        return await toggleBookmark('unbookmark', pid, uid);\n    };\n\n    async function toggleBookmark(type, pid, uid) {\n        if (parseInt(uid, 10) <"+"= 0) {\n            throw new Error('[[error:not-logged-in]]');\n        }\n\n        const isBookmarking = type === 'bookmark';\n\n        const [postData, hasBookmarked] = await Promise.all([\n            Posts.getPostFields(pid, ['pid', 'uid']),\n            Posts.hasBookmarked(pid, uid),\n        ]);\n\n        if (isBookmarking && hasBookmarked) {\n            throw new Error('[[error:already-bookmarked]]');\n        }\n\n        if (!isBookmarking && !hasBookmarked) {\n            throw new Error('[[error:already-unbookmarked]]');\n        }\n\n        if (isBookmarking) {\n            await db.sortedSetAdd(`uid:${uid}:bookmarks`, Date.now(), pid);\n        } else {\n            await db.sortedSetRemove(`uid:${uid}:bookmarks`, pid);\n        }\n        await db[isBookmarking ? 'setAdd' : 'setRemove'](`pid:${pid}:users_bookmarked`, uid);\n        postData.bookmarks = await db.setCount(`pid:${pid}:users_bookmarked`);\n        await Posts.setPostField(pid, 'bookmarks', postData.bookmarks);\n\n        plugins.hooks.fire(`action:post.${type}`, {\n            pid: pid,\n            uid: uid,\n            owner: postData.uid,\n            current: hasBookmarked ? 'bookmarked' : 'unbookmarked',\n        });\n\n        return {\n            post: postData,\n            isBookmarked: isBookmarking,\n        };\n    }\n\n    Posts.hasBookmarked = async function (pid, uid) {\n        if (parseInt(uid, 10) <"+"= 0) {\n            return Array.isArray(pid) ? pid.map(() => false) : false;\n        }\n\n        if (Array.isArray(pid)) {\n            const sets = pid.map(pid => `pid:${pid}:users_bookmarked`);\n            return await db.isMemberOfSets(sets, uid);\n        }\n        return await db.isSetMember(`pid:${pid}:users_bookmarked`, uid);\n    };\n};\n"},"src/posts/cache.js":{"language":"javascript","mutants":[{"id":"63","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"At least one of max, maxSize, or ttl is required","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":12},"start":{"column":30,"line":6}}},{"id":"64","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":7},"start":{"column":11,"line":7}}},{"id":"65","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":9},"start":{"column":35,"line":9}}},{"id":"66","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":9},"start":{"column":44,"line":9}}},{"id":"68","mutatorName":"LogicalOperator","replacement":"n.length && 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":9},"start":{"column":44,"line":9}}},{"id":"70","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":11},"start":{"column":14,"line":11}}},{"id":"71","mutatorName":"EqualityOperator","replacement":"global.env !== 'production'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":11},"start":{"column":14,"line":11}}},{"id":"69","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":11},"start":{"column":14,"line":11}}},{"id":"72","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":11},"start":{"column":29,"line":11}}},{"id":"67","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":57,"line":9},"start":{"column":44,"line":9}}}],"source":"'use strict';\n\nconst cacheCreate = require('../cache/lru');\nconst meta = require('../meta');\n\nmodule.exports = cacheCreate({\n    name: 'post',\n    maxSize: meta.config.postCacheSize,\n    sizeCalculation: function (n) { return n.length || 1; },\n    ttl: 0,\n    enabled: global.env === 'production',\n});\n"},"src/posts/category.js":{"language":"javascript","mutants":[{"id":"73","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":41},"start":{"column":35,"line":10}}},{"id":"74","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":14},"start":{"column":46,"line":11}}},{"id":"75","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":12},"start":{"column":51,"line":12}}},{"id":"77","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":23},"start":{"column":49,"line":16}}},{"id":"76","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":13},"start":{"column":48,"line":13}}},{"id":"79","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":17},"start":{"column":60,"line":17}}},{"id":"80","mutatorName":"MethodExpression","replacement":"postData.map(post => post && post.tid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":18},"start":{"column":29,"line":18}}},{"id":"81","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":18},"start":{"column":42,"line":18}}},{"id":"82","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":18},"start":{"column":50,"line":18}}},{"id":"83","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":18},"start":{"column":50,"line":18}}},{"id":"84","mutatorName":"LogicalOperator","replacement":"post || post.tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":18},"start":{"column":50,"line":18}}},{"id":"85","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":19},"start":{"column":62,"line":19}}},{"id":"86","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":19},"start":{"column":63,"line":19}}},{"id":"87","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":21},"start":{"column":35,"line":21}}},{"id":"89","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":21},"start":{"column":43,"line":21}}},{"id":"88","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":21},"start":{"column":43,"line":21}}},{"id":"78","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":66,"line":17},"start":{"column":59,"line":17}}},{"id":"92","mutatorName":"BooleanLiteral","replacement":"cid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":26},"start":{"column":13,"line":26}}},{"id":"94","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":26},"start":{"column":13,"line":26}}},{"id":"91","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":35},"start":{"column":56,"line":25}}},{"id":"93","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":26},"start":{"column":13,"line":26}}},{"id":"95","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":28},"start":{"column":19,"line":26}}},{"id":"96","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":30},"start":{"column":13,"line":30}}},{"id":"90","mutatorName":"LogicalOperator","replacement":"tidToTopic[post.tid] || tidToTopic[post.tid].cid","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":91,"line":21},"start":{"column":43,"line":21}}},{"id":"98","mutatorName":"LogicalOperator","replacement":"!Array.isArray(cid) && cid.length === 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":30},"start":{"column":13,"line":30}}},{"id":"99","mutatorName":"BooleanLiteral","replacement":"Array.isArray(cid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":30},"start":{"column":13,"line":30}}},{"id":"101","mutatorName":"EqualityOperator","replacement":"cid.length !== 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":30},"start":{"column":36,"line":30}}},{"id":"100","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":30},"start":{"column":36,"line":30}}},{"id":"102","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":32},"start":{"column":54,"line":30}}},{"id":"103","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":33},"start":{"column":51,"line":33}}},{"id":"106","mutatorName":"MethodExpression","replacement":"pids","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":39},"start":{"column":16,"line":39}}},{"id":"104","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":40},"start":{"column":53,"line":37}}},{"id":"105","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":38},"start":{"column":55,"line":38}}},{"id":"108","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":39},"start":{"column":44,"line":39}}},{"id":"107","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":39},"start":{"column":28,"line":39}}},{"id":"97","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":52,"line":30},"start":{"column":13,"line":30}}},{"id":"110","mutatorName":"LogicalOperator","replacement":"pid || isMembers[index]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":39},"start":{"column":44,"line":39}}},{"id":"109","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-data]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":67,"line":39},"start":{"column":44,"line":39}}}],"source":"\n'use strict';\n\n\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst topics = require('../topics');\n\nmodule.exports = function (Posts) {\n    Posts.getCidByPid = async function (pid) {\n        const tid = await Posts.getPostField(pid, 'tid');\n        return await topics.getTopicField(tid, 'cid');\n    };\n\n    Posts.getCidsByPids = async function (pids) {\n        const postData = await Posts.getPostsFields(pids, ['tid']);\n        const tids = _.uniq(postData.map(post => post && post.tid).filter(Boolean));\n        const topicData = await topics.getTopicsFields(tids, ['cid']);\n        const tidToTopic = _.zipObject(tids, topicData);\n        const cids = postData.map(post => tidToTopic[post.tid] && tidToTopic[post.tid].cid);\n        return cids;\n    };\n\n    Posts.filterPidsByCid = async function (pids, cid) {\n        if (!cid) {\n            return pids;\n        }\n\n        if (!Array.isArray(cid) || cid.length === 1) {\n            return await filterPidsBySingleCid(pids, cid);\n        }\n        const pidsArr = await Promise.all(cid.map(c => Posts.filterPidsByCid(pids, c)));\n        return _.union(...pidsArr);\n    };\n\n    async function filterPidsBySingleCid(pids, cid) {\n        const isMembers = await db.isSortedSetMembers(`cid:${parseInt(cid, 10)}:pids`, pids);\n        return pids.filter((pid, index) => pid && isMembers[index]);\n    }\n};\n"},"src/posts/create.js":{"language":"javascript","mutants":[{"id":"111","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":83},"start":{"column":35,"line":14}}},{"id":"112","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":72},"start":{"column":42,"line":15}}},{"id":"113","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":20},"start":{"column":27,"line":20}}},{"id":"114","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":20},"start":{"column":27,"line":20}}},{"id":"115","mutatorName":"LogicalOperator","replacement":"data.timestamp && Date.now()","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":20},"start":{"column":27,"line":20}}},{"id":"117","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":21},"start":{"column":24,"line":21}}},{"id":"118","mutatorName":"LogicalOperator","replacement":"data.isMain && false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":21},"start":{"column":24,"line":21}}},{"id":"116","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":21},"start":{"column":24,"line":21}}},{"id":"119","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":21},"start":{"column":39,"line":21}}},{"id":"120","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":23},"start":{"column":13,"line":23}}},{"id":"122","mutatorName":"LogicalOperator","replacement":"!uid || parseInt(uid, 10) !== 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":23},"start":{"column":13,"line":23}}},{"id":"123","mutatorName":"BooleanLiteral","replacement":"uid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":23},"start":{"column":13,"line":23}}},{"id":"125","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) === 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":23},"start":{"column":21,"line":23}}},{"id":"126","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":25},"start":{"column":46,"line":23}}},{"id":"124","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":23},"start":{"column":21,"line":23}}},{"id":"127","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":24},"start":{"column":29,"line":24}}},{"id":"128","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":27},"start":{"column":13,"line":27}}},{"id":"132","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":29},"start":{"column":56,"line":27}}},{"id":"129","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":27},"start":{"column":13,"line":27}}},{"id":"130","mutatorName":"LogicalOperator","replacement":"data.toPid || !utils.isNumber(data.toPid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":27},"start":{"column":13,"line":27}}},{"id":"131","mutatorName":"BooleanLiteral","replacement":"utils.isNumber(data.toPid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":27},"start":{"column":27,"line":27}}},{"id":"121","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":44,"line":23},"start":{"column":13,"line":23}}},{"id":"134","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":31},"start":{"column":46,"line":31}}},{"id":"136","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":38},"start":{"column":24,"line":32}}},{"id":"137","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":40},"start":{"column":13,"line":40}}},{"id":"135","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":31},"start":{"column":56,"line":31}}},{"id":"138","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":40},"start":{"column":13,"line":40}}},{"id":"139","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":42},"start":{"column":25,"line":40}}},{"id":"140","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":43},"start":{"column":13,"line":43}}},{"id":"141","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":43},"start":{"column":13,"line":43}}},{"id":"142","mutatorName":"LogicalOperator","replacement":"data.ip || meta.config.trackIpPerPost","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":43},"start":{"column":13,"line":43}}},{"id":"143","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":45},"start":{"column":52,"line":43}}},{"id":"144","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":46},"start":{"column":13,"line":46}}},{"id":"133","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":52,"line":28},"start":{"column":29,"line":28}}},{"id":"148","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":48},"start":{"column":48,"line":46}}},{"id":"146","mutatorName":"LogicalOperator","replacement":"data.handle || !parseInt(uid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":46},"start":{"column":13,"line":46}}},{"id":"147","mutatorName":"BooleanLiteral","replacement":"parseInt(uid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":46},"start":{"column":28,"line":46}}},{"id":"149","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":50},"start":{"column":47,"line":50}}},{"id":"150","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":50},"start":{"column":69,"line":50}}},{"id":"151","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":52},"start":{"column":28,"line":52}}},{"id":"152","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":54},"start":{"column":60,"line":54}}},{"id":"153","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":54},"start":{"column":61,"line":54}}},{"id":"154","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":54},"start":{"column":68,"line":54}}},{"id":"155","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":66},"start":{"column":27,"line":57}}},{"id":"156","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":58},"start":{"column":29,"line":58}}},{"id":"145","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":46,"line":46},"start":{"column":13,"line":46}}},{"id":"160","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":68},"start":{"column":62,"line":68}}},{"id":"158","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":59},"start":{"column":42,"line":59}}},{"id":"159","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":68},"start":{"column":43,"line":68}}},{"id":"162","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":70},"start":{"column":48,"line":70}}},{"id":"161","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":70},"start":{"column":28,"line":70}}},{"id":"163","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":82},"start":{"column":52,"line":74}}},{"id":"165","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":75},"start":{"column":13,"line":75}}},{"id":"164","mutatorName":"BooleanLiteral","replacement":"postData.toPid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":75},"start":{"column":13,"line":75}}},{"id":"166","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":75},"start":{"column":13,"line":75}}},{"id":"167","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":77},"start":{"column":30,"line":75}}},{"id":"168","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":81},"start":{"column":27,"line":78}}},{"id":"157","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":40,"line":59},"start":{"column":32,"line":59}}},{"id":"171","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":80},"start":{"column":58,"line":80}}},{"id":"170","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":80},"start":{"column":32,"line":80}}},{"id":"169","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":60,"line":79},"start":{"column":29,"line":79}}}],"source":"'use strict';\n\nconst _ = require('lodash');\n\nconst meta = require('../meta');\nconst db = require('../database');\nconst plugins = require('../plugins');\nconst user = require('../user');\nconst topics = require('../topics');\nconst categories = require('../categories');\nconst groups = require('../groups');\nconst utils = require('../utils');\n\nmodule.exports = function (Posts) {\n    Posts.create = async function (data) {\n        // This is an internal method, consider using Topics.reply instead\n        const { uid } = data;\n        const { tid } = data;\n        const content = data.content.toString();\n        const timestamp = data.timestamp || Date.now();\n        const isMain = data.isMain || false;\n\n        if (!uid && parseInt(uid, 10) !== 0) {\n            throw new Error('[[error:invalid-uid]]');\n        }\n\n        if (data.toPid && !utils.isNumber(data.toPid)) {\n            throw new Error('[[error:invalid-pid]]');\n        }\n\n        const pid = await db.incrObjectField('global', 'nextPid');\n        let postData = {\n            pid: pid,\n            uid: uid,\n            tid: tid,\n            content: content,\n            timestamp: timestamp,\n        };\n\n        if (data.toPid) {\n            postData.toPid = data.toPid;\n        }\n        if (data.ip && meta.config.trackIpPerPost) {\n            postData.ip = data.ip;\n        }\n        if (data.handle && !parseInt(uid, 10)) {\n            postData.handle = data.handle;\n        }\n\n        let result = await plugins.hooks.fire('filter:post.create', { post: postData, data: data });\n        postData = result.post;\n        await db.setObject(`post:${postData.pid}`, postData);\n\n        const topicData = await topics.getTopicFields(tid, ['cid', 'pinned']);\n        postData.cid = topicData.cid;\n\n        await Promise.all([\n            db.sortedSetAdd('posts:pid', timestamp, postData.pid),\n            db.incrObjectField('global', 'postCount'),\n            user.onNewPostMade(postData),\n            topics.onNewPostMade(postData),\n            categories.onNewPostMade(topicData.cid, topicData.pinned, postData),\n            groups.onNewPostMade(postData),\n            addReplyTo(postData, timestamp),\n            Posts.uploads.sync(postData.pid),\n        ]);\n\n        result = await plugins.hooks.fire('filter:post.get', { post: postData, uid: data.uid });\n        result.post.isMain = isMain;\n        plugins.hooks.fire('action:post.save', { post: _.clone(result.post) });\n        return result.post;\n    };\n\n    async function addReplyTo(postData, timestamp) {\n        if (!postData.toPid) {\n            return;\n        }\n        await Promise.all([\n            db.sortedSetAdd(`pid:${postData.toPid}:replies`, timestamp, postData.pid),\n            db.incrObjectField(`post:${postData.toPid}`, 'replies'),\n        ]);\n    }\n};\n"},"src/posts/data.js":{"language":"javascript","mutants":[{"id":"172","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":11},"start":{"column":19,"line":7}}},{"id":"173","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":8},"start":{"column":5,"line":8}}},{"id":"174","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":8},"start":{"column":12,"line":8}}},{"id":"175","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":8},"start":{"column":19,"line":8}}},{"id":"176","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":8},"start":{"column":26,"line":8}}},{"id":"178","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":9},"start":{"column":5,"line":9}}},{"id":"179","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":9},"start":{"column":16,"line":9}}},{"id":"180","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":9},"start":{"column":29,"line":9}}},{"id":"181","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":9},"start":{"column":43,"line":9}}},{"id":"183","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":10},"start":{"column":16,"line":10}}},{"id":"182","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":10},"start":{"column":5,"line":10}}},{"id":"184","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":10},"start":{"column":29,"line":10}}},{"id":"186","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":27},"start":{"column":58,"line":14}}},{"id":"185","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":56},"start":{"column":35,"line":13}}},{"id":"187","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"177","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":48,"line":8},"start":{"column":37,"line":8}}},{"id":"189","mutatorName":"LogicalOperator","replacement":"!Array.isArray(pids) && !pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"190","mutatorName":"BooleanLiteral","replacement":"Array.isArray(pids)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":15},"start":{"column":13,"line":15}}},{"id":"192","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":17},"start":{"column":51,"line":15}}},{"id":"191","mutatorName":"BooleanLiteral","replacement":"pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":37,"line":15}}},{"id":"193","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":16},"start":{"column":20,"line":16}}},{"id":"194","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":18},"start":{"column":31,"line":18}}},{"id":"195","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":18},"start":{"column":38,"line":18}}},{"id":"196","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":20},"start":{"column":49,"line":20}}},{"id":"197","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":24},"start":{"column":74,"line":20}}},{"id":"198","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":25},"start":{"column":30,"line":25}}},{"id":"199","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":32},"start":{"column":46,"line":29}}},{"id":"188","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"201","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":30},"start":{"column":57,"line":30}}},{"id":"202","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":31},"start":{"column":16,"line":31}}},{"id":"204","mutatorName":"LogicalOperator","replacement":"posts || posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":31},"start":{"column":16,"line":31}}},{"id":"203","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":31},"start":{"column":16,"line":31}}},{"id":"205","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":36},"start":{"column":48,"line":34}}},{"id":"206","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":35},"start":{"column":49,"line":35}}},{"id":"207","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":41},"start":{"column":54,"line":38}}},{"id":"208","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":39},"start":{"column":53,"line":39}}},{"id":"209","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":46},"start":{"column":56,"line":43}}},{"id":"210","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":44},"start":{"column":50,"line":44}}},{"id":"211","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":50},"start":{"column":61,"line":48}}},{"id":"200","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":55,"line":30},"start":{"column":50,"line":30}}},{"id":"213","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":55},"start":{"column":54,"line":52}}},{"id":"214","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":53},"start":{"column":28,"line":53}}},{"id":"215","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":54},"start":{"column":28,"line":54}}},{"id":"216","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":54},"start":{"column":53,"line":54}}},{"id":"217","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":54},"start":{"column":61,"line":54}}},{"id":"218","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":71},"start":{"column":35,"line":58}}},{"id":"219","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":13,"line":59},"start":{"column":9,"line":59}}},{"id":"220","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":13,"line":59},"start":{"column":9,"line":59}}},{"id":"221","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":70},"start":{"column":15,"line":59}}},{"id":"222","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":61},"start":{"column":13,"line":61}}},{"id":"212","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":58,"line":49},"start":{"column":40,"line":49}}},{"id":"223","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":61},"start":{"column":13,"line":61}}},{"id":"225","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":61},"start":{"column":33,"line":61}}},{"id":"226","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":61},"start":{"column":67,"line":61}}},{"id":"228","mutatorName":"ArithmeticOperator","replacement":"post.upvotes + post.downvotes","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":62},"start":{"column":26,"line":62}}},{"id":"227","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":63},"start":{"column":81,"line":61}}},{"id":"229","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":64},"start":{"column":13,"line":64}}},{"id":"230","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":64},"start":{"column":13,"line":64}}},{"id":"224","mutatorName":"LogicalOperator","replacement":"post.hasOwnProperty('upvotes') || post.hasOwnProperty('downvotes')","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":79,"line":61},"start":{"column":13,"line":61}}},{"id":"231","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":64},"start":{"column":33,"line":64}}},{"id":"233","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":67},"start":{"column":13,"line":67}}},{"id":"234","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":67},"start":{"column":13,"line":67}}},{"id":"235","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":67},"start":{"column":33,"line":67}}},{"id":"236","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":69},"start":{"column":44,"line":67}}},{"id":"238","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":68},"start":{"column":30,"line":68}}},{"id":"237","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":68},"start":{"column":30,"line":68}}},{"id":"240","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":68},"start":{"column":83,"line":68}}},{"id":"239","mutatorName":"EqualityOperator","replacement":"post.edited === 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":68},"start":{"column":30,"line":68}}},{"id":"232","mutatorName":"BlockStatement","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":10,"line":66},"start":{"column":47,"line":64}}}],"source":"'use strict';\n\nconst db = require('../database');\nconst plugins = require('../plugins');\nconst utils = require('../utils');\n\nconst intFields = [\n    'uid', 'pid', 'tid', 'deleted', 'timestamp',\n    'upvotes', 'downvotes', 'deleterUid', 'edited',\n    'replies', 'bookmarks', 'endorsed',\n];\n\nmodule.exports = function (Posts) {\n    Posts.getPostsFields = async function (pids, fields) {\n        if (!Array.isArray(pids) || !pids.length) {\n            return [];\n        }\n        const keys = pids.map(pid => `post:${pid}`);\n        const postData = await db.getObjects(keys, fields);\n        const result = await plugins.hooks.fire('filter:post.getFields', {\n            pids: pids,\n            posts: postData,\n            fields: fields,\n        });\n        result.posts.forEach(post => modifyPost(post, fields));\n        return result.posts;\n    };\n\n    Posts.getPostData = async function (pid) {\n        const posts = await Posts.getPostsFields([pid], []);\n        return posts && posts.length ? posts[0] : null;\n    };\n\n    Posts.getPostsData = async function (pids) {\n        return await Posts.getPostsFields(pids, []);\n    };\n\n    Posts.getPostField = async function (pid, field) {\n        const post = await Posts.getPostFields(pid, [field]);\n        return post ? post[field] : null;\n    };\n\n    Posts.getPostFields = async function (pid, fields) {\n        const posts = await Posts.getPostsFields([pid], fields);\n        return posts ? posts[0] : null;\n    };\n\n    Posts.setPostField = async function (pid, field, value) {\n        await Posts.setPostFields(pid, { [field]: value });\n    };\n\n    Posts.setPostFields = async function (pid, data) {\n        await db.setObject(`post:${pid}`, data);\n        plugins.hooks.fire('action:post.setFields', { data: { ...data, pid } });\n    };\n};\n\nfunction modifyPost(post, fields) {\n    if (post) {\n        db.parseIntFields(post, intFields, fields);\n        if (post.hasOwnProperty('upvotes') && post.hasOwnProperty('downvotes')) {\n            post.votes = post.upvotes - post.downvotes;\n        }\n        if (post.hasOwnProperty('timestamp')) {\n            post.timestampISO = utils.toISOString(post.timestamp);\n        }\n        if (post.hasOwnProperty('edited')) {\n            post.editedISO = post.edited !== 0 ? utils.toISOString(post.edited) : '';\n        }\n    }\n}\n"},"src/posts/delete.js":{"language":"javascript","mutants":[{"id":"241","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":244},"start":{"column":35,"line":13}}},{"id":"242","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":16},"start":{"column":46,"line":14}}},{"id":"244","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":20},"start":{"column":47,"line":18}}},{"id":"243","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":15},"start":{"column":38,"line":15}}},{"id":"245","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":19},"start":{"column":38,"line":19}}},{"id":"247","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":23},"start":{"column":28,"line":23}}},{"id":"246","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":45},"start":{"column":52,"line":22}}},{"id":"248","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":23},"start":{"column":28,"line":23}}},{"id":"250","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":23},"start":{"column":37,"line":23}}},{"id":"249","mutatorName":"EqualityOperator","replacement":"type !== 'delete'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":23},"start":{"column":28,"line":23}}},{"id":"252","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":24},"start":{"column":57,"line":24}}},{"id":"251","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":24},"start":{"column":34,"line":24}}},{"id":"253","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":28},"start":{"column":40,"line":25}}},{"id":"254","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":102,"line":29},"start":{"column":57,"line":29}}},{"id":"255","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":29},"start":{"column":58,"line":29}}},{"id":"256","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":29},"start":{"column":65,"line":29}}},{"id":"258","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":88,"line":29},"start":{"column":79,"line":29}}},{"id":"257","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":29},"start":{"column":72,"line":29}}},{"id":"259","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":29},"start":{"column":90,"line":29}}},{"id":"260","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":30},"start":{"column":69,"line":30}}},{"id":"261","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":30},"start":{"column":70,"line":30}}},{"id":"262","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":30},"start":{"column":77,"line":30}}},{"id":"263","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":30},"start":{"column":84,"line":30}}},{"id":"264","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":38},"start":{"column":27,"line":32}}},{"id":"265","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":36},"start":{"column":36,"line":36}}},{"id":"266","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":37},"start":{"column":33,"line":37}}},{"id":"267","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":40},"start":{"column":28,"line":40}}},{"id":"269","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":41},"start":{"column":13,"line":41}}},{"id":"270","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":41},"start":{"column":13,"line":41}}},{"id":"271","mutatorName":"EqualityOperator","replacement":"type !== 'delete'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":41},"start":{"column":13,"line":41}}},{"id":"272","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":41},"start":{"column":22,"line":41}}},{"id":"273","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":43},"start":{"column":32,"line":41}}},{"id":"274","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":42},"start":{"column":37,"line":42}}},{"id":"276","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":48},"start":{"column":45,"line":48}}},{"id":"275","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":96},"start":{"column":46,"line":47}}},{"id":"277","mutatorName":"MethodExpression","replacement":"pids","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":50},"start":{"column":16,"line":50}}},{"id":"278","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":50},"start":{"column":28,"line":50}}},{"id":"279","mutatorName":"BooleanLiteral","replacement":"!postData[index]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":50},"start":{"column":44,"line":50}}},{"id":"280","mutatorName":"BooleanLiteral","replacement":"postData[index]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":50},"start":{"column":45,"line":50}}},{"id":"281","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":51},"start":{"column":20,"line":51}}},{"id":"282","mutatorName":"BooleanLiteral","replacement":"postData.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":52},"start":{"column":13,"line":52}}},{"id":"283","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":52},"start":{"column":13,"line":52}}},{"id":"284","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":52},"start":{"column":13,"line":52}}},{"id":"285","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":54},"start":{"column":31,"line":52}}},{"id":"286","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":55},"start":{"column":46,"line":55}}},{"id":"287","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":56},"start":{"column":66,"line":56}}},{"id":"288","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":56},"start":{"column":67,"line":56}}},{"id":"289","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":56},"start":{"column":74,"line":56}}},{"id":"290","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":89,"line":56},"start":{"column":81,"line":56}}},{"id":"291","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":102,"line":56},"start":{"column":91,"line":56}}},{"id":"292","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":62},"start":{"column":33,"line":59}}},{"id":"293","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":61},"start":{"column":21,"line":61}}},{"id":"294","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":61},"start":{"column":21,"line":61}}},{"id":"295","mutatorName":"LogicalOperator","replacement":"tidToTopic[p.tid] || tidToTopic[p.tid].cid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":61},"start":{"column":21,"line":61}}},{"id":"297","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":65},"start":{"column":64,"line":65}}},{"id":"296","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":119,"line":65},"start":{"column":40,"line":65}}},{"id":"268","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":88,"line":40},"start":{"column":51,"line":40}}},{"id":"298","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":118,"line":65},"start":{"column":85,"line":65}}},{"id":"299","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":68},"start":{"column":34,"line":68}}},{"id":"301","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":70},"start":{"column":32,"line":70}}},{"id":"303","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":84},"start":{"column":33,"line":84}}},{"id":"302","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":85},"start":{"column":27,"line":74}}},{"id":"304","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":84},"start":{"column":34,"line":84}}},{"id":"305","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":84},"start":{"column":47,"line":84}}},{"id":"306","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":84},"start":{"column":62,"line":84}}},{"id":"307","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":90},"start":{"column":34,"line":90}}},{"id":"300","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":72},"start":{"column":56,"line":68}}},{"id":"309","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":90},"start":{"column":79,"line":90}}},{"id":"310","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":93},"start":{"column":28,"line":93}}},{"id":"312","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":95},"start":{"column":41,"line":95}}},{"id":"311","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":93},"start":{"column":50,"line":93}}},{"id":"313","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":95},"start":{"column":46,"line":95}}},{"id":"314","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":146},"start":{"column":62,"line":98}}},{"id":"315","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":99},"start":{"column":28,"line":99}}},{"id":"316","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":106},"start":{"column":33,"line":100}}},{"id":"317","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":101},"start":{"column":29,"line":101}}},{"id":"318","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":101},"start":{"column":30,"line":101}}},{"id":"308","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":77,"line":90},"start":{"column":58,"line":90}}},{"id":"320","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":102},"start":{"column":30,"line":102}}},{"id":"321","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":103},"start":{"column":29,"line":103}}},{"id":"322","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":103},"start":{"column":30,"line":103}}},{"id":"323","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":104},"start":{"column":29,"line":104}}},{"id":"324","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":104},"start":{"column":30,"line":104}}},{"id":"325","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":105},"start":{"column":29,"line":105}}},{"id":"326","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":105},"start":{"column":30,"line":105}}},{"id":"327","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":109},"start":{"column":32,"line":109}}},{"id":"328","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":109},"start":{"column":33,"line":109}}},{"id":"319","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":64,"line":102},"start":{"column":29,"line":102}}},{"id":"330","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":109},"start":{"column":44,"line":109}}},{"id":"331","mutatorName":"UnaryOperator","replacement":"+postData.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":109},"start":{"column":57,"line":109}}},{"id":"332","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":111},"start":{"column":53,"line":111}}},{"id":"333","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":114},"start":{"column":69,"line":112}}},{"id":"334","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":113},"start":{"column":33,"line":113}}},{"id":"335","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":113},"start":{"column":34,"line":113}}},{"id":"336","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":113},"start":{"column":53,"line":113}}},{"id":"337","mutatorName":"UnaryOperator","replacement":"+posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":113},"start":{"column":67,"line":113}}},{"id":"338","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":116},"start":{"column":50,"line":116}}},{"id":"329","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":42,"line":109},"start":{"column":34,"line":109}}},{"id":"340","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":118},"start":{"column":28,"line":118}}},{"id":"341","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":119},"start":{"column":30,"line":119}}},{"id":"342","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":137},"start":{"column":66,"line":120}}},{"id":"343","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":121},"start":{"column":33,"line":121}}},{"id":"344","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":121},"start":{"column":34,"line":121}}},{"id":"345","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":121},"start":{"column":50,"line":121}}},{"id":"346","mutatorName":"UnaryOperator","replacement":"+posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":121},"start":{"column":63,"line":121}}},{"id":"347","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":122},"start":{"column":17,"line":122}}},{"id":"348","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":122},"start":{"column":17,"line":122}}},{"id":"349","mutatorName":"LogicalOperator","replacement":"posts.length || posts[0]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":122},"start":{"column":17,"line":122}}},{"id":"339","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":39,"line":117},"start":{"column":37,"line":117}}},{"id":"351","mutatorName":"ArithmeticOperator","replacement":"topicData.postcount + posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":124},"start":{"column":38,"line":124}}},{"id":"352","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":125},"start":{"column":42,"line":125}}},{"id":"353","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":125},"start":{"column":43,"line":125}}},{"id":"354","mutatorName":"BooleanLiteral","replacement":"topicData.pinned","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":126},"start":{"column":21,"line":126}}},{"id":"355","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":126},"start":{"column":21,"line":126}}},{"id":"356","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":126},"start":{"column":21,"line":126}}},{"id":"357","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":128},"start":{"column":40,"line":126}}},{"id":"358","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":94,"line":127},"start":{"column":39,"line":127}}},{"id":"359","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":127},"start":{"column":40,"line":127}}},{"id":"350","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":14,"line":129},"start":{"column":43,"line":122}}},{"id":"361","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":132},"start":{"column":49,"line":132}}},{"id":"362","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":135},"start":{"column":71,"line":133}}},{"id":"363","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":134},"start":{"column":35,"line":134}}},{"id":"364","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":134},"start":{"column":36,"line":134}}},{"id":"366","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":145},"start":{"column":27,"line":139}}},{"id":"365","mutatorName":"UnaryOperator","replacement":"+uidPosts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":134},"start":{"column":58,"line":134}}},{"id":"367","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":143},"start":{"column":54,"line":143}}},{"id":"368","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":105,"line":144},"start":{"column":51,"line":144}}},{"id":"369","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":105,"line":144},"start":{"column":56,"line":144}}},{"id":"360","mutatorName":"UnaryOperator","replacement":"+posts.length","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":88,"line":127},"start":{"column":75,"line":127}}},{"id":"371","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":149},"start":{"column":46,"line":149}}},{"id":"372","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":150},"start":{"column":35,"line":150}}},{"id":"373","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":150},"start":{"column":42,"line":150}}},{"id":"374","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":151},"start":{"column":53,"line":151}}},{"id":"375","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":164},"start":{"column":41,"line":156}}},{"id":"376","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":163},"start":{"column":27,"line":157}}},{"id":"377","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":162},"start":{"column":26,"line":159}}},{"id":"378","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":160},"start":{"column":29,"line":160}}},{"id":"379","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":160},"start":{"column":36,"line":160}}},{"id":"370","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":153},"start":{"column":60,"line":148}}},{"id":"380","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":176},"start":{"column":51,"line":166}}},{"id":"382","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":98,"line":167},"start":{"column":69,"line":167}}},{"id":"383","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":168},"start":{"column":28,"line":168}}},{"id":"384","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":173},"start":{"column":38,"line":169}}},{"id":"385","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":172},"start":{"column":49,"line":170}}},{"id":"387","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":171},"start":{"column":34,"line":171}}},{"id":"386","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":171},"start":{"column":33,"line":171}}},{"id":"388","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":175},"start":{"column":37,"line":175}}},{"id":"390","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":200},"start":{"column":47,"line":178}}},{"id":"389","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":175},"start":{"column":44,"line":175}}},{"id":"391","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":182},"start":{"column":58,"line":179}}},{"id":"381","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":98,"line":167},"start":{"column":62,"line":167}}},{"id":"393","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":180},"start":{"column":47,"line":180}}},{"id":"394","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":181},"start":{"column":40,"line":181}}},{"id":"396","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":183},"start":{"column":28,"line":183}}},{"id":"395","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":181},"start":{"column":47,"line":181}}},{"id":"397","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":191},"start":{"column":38,"line":184}}},{"id":"398","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":187},"start":{"column":53,"line":185}}},{"id":"399","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":186},"start":{"column":33,"line":186}}},{"id":"400","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":186},"start":{"column":34,"line":186}}},{"id":"402","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":189},"start":{"column":33,"line":189}}},{"id":"401","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":190},"start":{"column":57,"line":188}}},{"id":"392","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":66,"line":180},"start":{"column":40,"line":180}}},{"id":"403","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":189},"start":{"column":34,"line":189}}},{"id":"405","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":198},"start":{"column":26,"line":195}}},{"id":"406","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":196},"start":{"column":29,"line":196}}},{"id":"408","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":197},"start":{"column":29,"line":197}}},{"id":"407","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":196},"start":{"column":36,"line":196}}},{"id":"409","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":197},"start":{"column":36,"line":197}}},{"id":"410","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":220},"start":{"column":48,"line":202}}},{"id":"411","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":203},"start":{"column":77,"line":203}}},{"id":"412","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":203},"start":{"column":82,"line":203}}},{"id":"413","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":210},"start":{"column":26,"line":205}}},{"id":"404","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":199},"start":{"column":27,"line":193}}},{"id":"415","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":207},"start":{"column":41,"line":207}}},{"id":"416","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":207},"start":{"column":57,"line":207}}},{"id":"417","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":207},"start":{"column":58,"line":207}}},{"id":"418","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":209},"start":{"column":39,"line":209}}},{"id":"420","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":212},"start":{"column":34,"line":212}}},{"id":"419","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":209},"start":{"column":44,"line":209}}},{"id":"422","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":213},"start":{"column":49,"line":213}}},{"id":"421","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":212},"start":{"column":50,"line":212}}},{"id":"423","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":213},"start":{"column":54,"line":213}}},{"id":"424","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":213},"start":{"column":55,"line":213}}},{"id":"425","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":217},"start":{"column":56,"line":217}}},{"id":"426","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":218},"start":{"column":63,"line":218}}},{"id":"427","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":218},"start":{"column":70,"line":218}}},{"id":"428","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":219},"start":{"column":47,"line":219}}},{"id":"429","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":219},"start":{"column":63,"line":219}}},{"id":"430","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":219},"start":{"column":64,"line":219}}},{"id":"431","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":105,"line":219},"start":{"column":79,"line":219}}},{"id":"432","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":226},"start":{"column":43,"line":222}}},{"id":"433","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":223},"start":{"column":57,"line":223}}},{"id":"434","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":224},"start":{"column":37,"line":224}}},{"id":"435","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":224},"start":{"column":50,"line":224}}},{"id":"436","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":234},"start":{"column":38,"line":228}}},{"id":"438","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":233},"start":{"column":28,"line":230}}},{"id":"437","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":229},"start":{"column":55,"line":229}}},{"id":"439","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":231},"start":{"column":25,"line":231}}},{"id":"440","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":231},"start":{"column":32,"line":231}}},{"id":"441","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":232},"start":{"column":39,"line":232}}},{"id":"442","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":232},"start":{"column":77,"line":232}}},{"id":"443","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":232},"start":{"column":82,"line":232}}},{"id":"444","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":238},"start":{"column":44,"line":236}}},{"id":"445","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":243},"start":{"column":48,"line":240}}},{"id":"446","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":241},"start":{"column":30,"line":241}}},{"id":"447","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":241},"start":{"column":46,"line":241}}},{"id":"448","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":242},"start":{"column":44,"line":242}}},{"id":"450","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":242},"start":{"column":86,"line":242}}},{"id":"449","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":98,"line":242},"start":{"column":77,"line":242}}},{"id":"414","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":54,"line":207},"start":{"column":34,"line":207}}}],"source":"'use strict';\n\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst topics = require('../topics');\nconst categories = require('../categories');\nconst user = require('../user');\nconst notifications = require('../notifications');\nconst plugins = require('../plugins');\nconst flags = require('../flags');\n\nmodule.exports = function (Posts) {\n    Posts.delete = async function (pid, uid) {\n        return await deleteOrRestore('delete', pid, uid);\n    };\n\n    Posts.restore = async function (pid, uid) {\n        return await deleteOrRestore('restore', pid, uid);\n    };\n\n    async function deleteOrRestore(type, pid, uid) {\n        const isDeleting = type === 'delete';\n        await plugins.hooks.fire(`filter:post.${type}`, { pid: pid, uid: uid });\n        await Posts.setPostFields(pid, {\n            deleted: isDeleting ? 1 : 0,\n            deleterUid: isDeleting ? uid : 0,\n        });\n        const postData = await Posts.getPostFields(pid, ['pid', 'tid', 'uid', 'content', 'timestamp']);\n        const topicData = await topics.getTopicFields(postData.tid, ['tid', 'cid', 'pinned']);\n        postData.cid = topicData.cid;\n        await Promise.all([\n            topics.updateLastPostTimeFromLastPid(postData.tid),\n            topics.updateTeaser(postData.tid),\n            isDeleting ?\n                db.sortedSetRemove(`cid:${topicData.cid}:pids`, pid) :\n                db.sortedSetAdd(`cid:${topicData.cid}:pids`, postData.timestamp, pid),\n        ]);\n        await categories.updateRecentTidForCid(postData.cid);\n        plugins.hooks.fire(`action:post.${type}`, { post: _.clone(postData), uid: uid });\n        if (type === 'delete') {\n            await flags.resolveFlag('post', pid, uid);\n        }\n        return postData;\n    }\n\n    Posts.purge = async function (pids, uid) {\n        pids = Array.isArray(pids) ? pids : [pids];\n        let postData = await Posts.getPostsData(pids);\n        pids = pids.filter((pid, index) => !!postData[index]);\n        postData = postData.filter(Boolean);\n        if (!postData.length) {\n            return;\n        }\n        const uniqTids = _.uniq(postData.map(p => p.tid));\n        const topicData = await topics.getTopicsFields(uniqTids, ['tid', 'cid', 'pinned', 'postcount']);\n        const tidToTopic = _.zipObject(uniqTids, topicData);\n\n        postData.forEach((p) => {\n            p.topic = tidToTopic[p.tid];\n            p.cid = tidToTopic[p.tid] && tidToTopic[p.tid].cid;\n        });\n\n        // deprecated hook\n        await Promise.all(postData.map(p => plugins.hooks.fire('filter:post.purge', { post: p, pid: p.pid, uid: uid })));\n\n        // new hook\n        await plugins.hooks.fire('filter:posts.purge', {\n            posts: postData,\n            pids: postData.map(p => p.pid),\n            uid: uid,\n        });\n\n        await Promise.all([\n            deleteFromTopicUserNotification(postData),\n            deleteFromCategoryRecentPosts(postData),\n            deleteFromUsersBookmarks(pids),\n            deleteFromUsersVotes(pids),\n            deleteFromReplies(postData),\n            deleteFromGroups(pids),\n            deleteEndorsed(pids),\n            deleteDiffs(pids),\n            deleteFromUploads(pids),\n            db.sortedSetsRemove(['posts:pid', 'posts:votes', 'posts:flagged'], pids),\n        ]);\n\n        await resolveFlags(postData, uid);\n\n        // deprecated hook\n        Promise.all(postData.map(p => plugins.hooks.fire('action:post.purge', { post: p, uid: uid })));\n\n        // new hook\n        plugins.hooks.fire('action:posts.purge', { posts: postData, uid: uid });\n\n        await db.deleteAll(postData.map(p => `post:${p.pid}`));\n    };\n\n    async function deleteFromTopicUserNotification(postData) {\n        const bulkRemove = [];\n        postData.forEach((p) => {\n            bulkRemove.push([`tid:${p.tid}:posts`, p.pid]);\n            bulkRemove.push([`tid:${p.tid}:posts:votes`, p.pid]);\n            bulkRemove.push([`uid:${p.uid}:posts`, p.pid]);\n            bulkRemove.push([`cid:${p.cid}:uid:${p.uid}:pids`, p.pid]);\n            bulkRemove.push([`cid:${p.cid}:uid:${p.uid}:pids:votes`, p.pid]);\n        });\n        await db.sortedSetRemoveBulk(bulkRemove);\n\n        const incrObjectBulk = [['global', { postCount: -postData.length }]];\n\n        const postsByCategory = _.groupBy(postData, p => parseInt(p.cid, 10));\n        for (const [cid, posts] of Object.entries(postsByCategory)) {\n            incrObjectBulk.push([`category:${cid}`, { post_count: -posts.length }]);\n        }\n\n        const postsByTopic = _.groupBy(postData, p => parseInt(p.tid, 10));\n        const topicPostCountTasks = [];\n        const topicTasks = [];\n        const zsetIncrBulk = [];\n        for (const [tid, posts] of Object.entries(postsByTopic)) {\n            incrObjectBulk.push([`topic:${tid}`, { postcount: -posts.length }]);\n            if (posts.length && posts[0]) {\n                const topicData = posts[0].topic;\n                const newPostCount = topicData.postcount - posts.length;\n                topicPostCountTasks.push(['topics:posts', newPostCount, tid]);\n                if (!topicData.pinned) {\n                    zsetIncrBulk.push([`cid:${topicData.cid}:tids:posts`, -posts.length, tid]);\n                }\n            }\n            topicTasks.push(topics.updateTeaser(tid));\n            topicTasks.push(topics.updateLastPostTimeFromLastPid(tid));\n            const postsByUid = _.groupBy(posts, p => parseInt(p.uid, 10));\n            for (const [uid, uidPosts] of Object.entries(postsByUid)) {\n                zsetIncrBulk.push([`tid:${tid}:posters`, -uidPosts.length, uid]);\n            }\n            topicTasks.push(db.sortedSetIncrByBulk(zsetIncrBulk));\n        }\n\n        await Promise.all([\n            db.incrObjectFieldByBulk(incrObjectBulk),\n            db.sortedSetAddBulk(topicPostCountTasks),\n            ...topicTasks,\n            user.updatePostCount(_.uniq(postData.map(p => p.uid))),\n            notifications.rescind(...postData.map(p => `new_post:tid:${p.tid}:pid:${p.pid}:uid:${p.uid}`)),\n        ]);\n    }\n\n    async function deleteFromCategoryRecentPosts(postData) {\n        const uniqCids = _.uniq(postData.map(p => p.cid));\n        const sets = uniqCids.map(cid => `cid:${cid}:pids`);\n        await db.sortedSetRemove(sets, postData.map(p => p.pid));\n        await Promise.all(uniqCids.map(categories.updateRecentTidForCid));\n    }\n\n    // TODO: add deleteEndorsed\n    async function deleteEndorsed(pids) {\n        await Promise.all([\n            // db.sortedSetRemoveBulk(bulkRemove),\n            db.deleteAll([\n                ...pids.map(pid => `pid:${pid}:users_endorsed`),\n                // ...pids.map(pid => `pid:${pid}:downvote`),\n            ]),\n        ]);\n    }\n\n    async function deleteFromUsersBookmarks(pids) {\n        const arrayOfUids = await db.getSetsMembers(pids.map(pid => `pid:${pid}:users_bookmarked`));\n        const bulkRemove = [];\n        pids.forEach((pid, index) => {\n            arrayOfUids[index].forEach((uid) => {\n                bulkRemove.push([`uid:${uid}:bookmarks`, pid]);\n            });\n        });\n        await db.sortedSetRemoveBulk(bulkRemove);\n        await db.deleteAll(pids.map(pid => `pid:${pid}:users_bookmarked`));\n    }\n\n    async function deleteFromUsersVotes(pids) {\n        const [upvoters, downvoters] = await Promise.all([\n            db.getSetsMembers(pids.map(pid => `pid:${pid}:upvote`)),\n            db.getSetsMembers(pids.map(pid => `pid:${pid}:downvote`)),\n        ]);\n        const bulkRemove = [];\n        pids.forEach((pid, index) => {\n            upvoters[index].forEach((upvoterUid) => {\n                bulkRemove.push([`uid:${upvoterUid}:upvote`, pid]);\n            });\n            downvoters[index].forEach((downvoterUid) => {\n                bulkRemove.push([`uid:${downvoterUid}:downvote`, pid]);\n            });\n        });\n\n        await Promise.all([\n            db.sortedSetRemoveBulk(bulkRemove),\n            db.deleteAll([\n                ...pids.map(pid => `pid:${pid}:upvote`),\n                ...pids.map(pid => `pid:${pid}:downvote`),\n            ]),\n        ]);\n    }\n\n    async function deleteFromReplies(postData) {\n        const arrayOfReplyPids = await db.getSortedSetsMembers(postData.map(p => `pid:${p.pid}:replies`));\n        const allReplyPids = _.flatten(arrayOfReplyPids);\n        const promises = [\n            db.deleteObjectFields(\n                allReplyPids.map(pid => `post:${pid}`), ['toPid']\n            ),\n            db.deleteAll(postData.map(p => `pid:${p.pid}:replies`)),\n        ];\n\n        const postsWithParents = postData.filter(p => parseInt(p.toPid, 10));\n        const bulkRemove = postsWithParents.map(p => [`pid:${p.toPid}:replies`, p.pid]);\n        promises.push(db.sortedSetRemoveBulk(bulkRemove));\n        await Promise.all(promises);\n\n        const parentPids = _.uniq(postsWithParents.map(p => p.toPid));\n        const counts = await db.sortedSetsCard(parentPids.map(pid => `pid:${pid}:replies`));\n        await db.setObjectBulk(parentPids.map((pid, index) => [`post:${pid}`, { replies: counts[index] }]));\n    }\n\n    async function deleteFromGroups(pids) {\n        const groupNames = await db.getSortedSetMembers('groups:visible:createtime');\n        const keys = groupNames.map(groupName => `group:${groupName}:member:pids`);\n        await db.sortedSetRemove(keys, pids);\n    }\n\n    async function deleteDiffs(pids) {\n        const timestamps = await Promise.all(pids.map(pid => Posts.diffs.list(pid)));\n        await db.deleteAll([\n            ...pids.map(pid => `post:${pid}:diffs`),\n            ..._.flattenDeep(pids.map((pid, index) => timestamps[index].map(t => `diff:${pid}.${t}`))),\n        ]);\n    }\n\n    async function deleteFromUploads(pids) {\n        await Promise.all(pids.map(Posts.uploads.dissociateAll));\n    }\n\n    async function resolveFlags(postData, uid) {\n        const flaggedPosts = postData.filter(p => parseInt(p.flagId, 10));\n        await Promise.all(flaggedPosts.map(p => flags.update(p.flagId, uid, { state: 'resolved' })));\n    }\n};\n"},"src/posts/diffs.js":{"language":"javascript","mutants":[{"id":"451","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":175},"start":{"column":35,"line":12}}},{"id":"452","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":22},"start":{"column":41,"line":15}}},{"id":"453","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":16},"start":{"column":13,"line":16}}},{"id":"454","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":16},"start":{"column":13,"line":16}}},{"id":"455","mutatorName":"EqualityOperator","replacement":"meta.config.enablePostHistory === 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":16},"start":{"column":13,"line":16}}},{"id":"458","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":20},"start":{"column":46,"line":20}}},{"id":"457","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":17},"start":{"column":20,"line":17}}},{"id":"459","mutatorName":"BooleanLiteral","replacement":"!numDiffs","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":21},"start":{"column":16,"line":21}}},{"id":"460","mutatorName":"BooleanLiteral","replacement":"numDiffs","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":21},"start":{"column":17,"line":21}}},{"id":"461","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":34},"start":{"column":45,"line":24}}},{"id":"462","mutatorName":"BooleanLiteral","replacement":"since","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":26},"start":{"column":13,"line":26}}},{"id":"463","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":26},"start":{"column":13,"line":26}}},{"id":"464","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":26},"start":{"column":13,"line":26}}},{"id":"465","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":28},"start":{"column":21,"line":26}}},{"id":"456","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":18},"start":{"column":50,"line":16}}},{"id":"466","mutatorName":"MethodExpression","replacement":"timestamps","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":31},"start":{"column":22,"line":31}}},{"id":"468","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":31},"start":{"column":45,"line":31}}},{"id":"469","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":31},"start":{"column":45,"line":31}}},{"id":"470","mutatorName":"EqualityOperator","replacement":"(parseInt(t, 10) || 0) >= since","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":31},"start":{"column":45,"line":31}}},{"id":"472","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":31},"start":{"column":46,"line":31}}},{"id":"471","mutatorName":"EqualityOperator","replacement":"(parseInt(t, 10) || 0) <"+"= since","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":31},"start":{"column":45,"line":31}}},{"id":"473","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":31},"start":{"column":46,"line":31}}},{"id":"474","mutatorName":"LogicalOperator","replacement":"parseInt(t, 10) && 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":31},"start":{"column":46,"line":31}}},{"id":"475","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":32},"start":{"column":18,"line":32}}},{"id":"467","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":75,"line":31},"start":{"column":40,"line":31}}},{"id":"476","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":32},"start":{"column":23,"line":32}}},{"id":"478","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":37},"start":{"column":38,"line":37}}},{"id":"479","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":37},"start":{"column":62,"line":37}}},{"id":"480","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":60},"start":{"column":40,"line":40}}},{"id":"481","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":42},"start":{"column":31,"line":42}}},{"id":"483","mutatorName":"LogicalOperator","replacement":"edited && Date.now()","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":42},"start":{"column":31,"line":42}}},{"id":"482","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":42},"start":{"column":31,"line":42}}},{"id":"484","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":46},"start":{"column":26,"line":43}}},{"id":"485","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":47},"start":{"column":13,"line":47}}},{"id":"477","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":38},"start":{"column":39,"line":36}}},{"id":"489","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":48},"start":{"column":47,"line":48}}},{"id":"488","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":49},"start":{"column":40,"line":47}}},{"id":"487","mutatorName":"EqualityOperator","replacement":"oldContent === newContent","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":47},"start":{"column":13,"line":47}}},{"id":"490","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":50},"start":{"column":13,"line":50}}},{"id":"491","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":50},"start":{"column":13,"line":50}}},{"id":"492","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":52},"start":{"column":28,"line":50}}},{"id":"494","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":53},"start":{"column":13,"line":53}}},{"id":"495","mutatorName":"LogicalOperator","replacement":"topic.tagsupdated || Array.isArray(topic.oldTags)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":53},"start":{"column":13,"line":53}}},{"id":"493","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":53},"start":{"column":13,"line":53}}},{"id":"496","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":55},"start":{"column":64,"line":53}}},{"id":"497","mutatorName":"MethodExpression","replacement":"topic.oldTags.map(tag => tag && tag.value)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":54},"start":{"column":29,"line":54}}},{"id":"498","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":54},"start":{"column":47,"line":54}}},{"id":"500","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":54},"start":{"column":54,"line":54}}},{"id":"501","mutatorName":"LogicalOperator","replacement":"tag || tag.value","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":54},"start":{"column":54,"line":54}}},{"id":"499","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":54},"start":{"column":54,"line":54}}},{"id":"502","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":54},"start":{"column":93,"line":54}}},{"id":"503","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":59},"start":{"column":27,"line":56}}},{"id":"504","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":57},"start":{"column":28,"line":57}}},{"id":"506","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":70},"start":{"column":51,"line":62}}},{"id":"505","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":26,"line":58}}},{"id":"507","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":65},"start":{"column":31,"line":65}}},{"id":"508","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":65},"start":{"column":31,"line":65}}},{"id":"509","mutatorName":"LogicalOperator","replacement":"post.content && ''","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":65},"start":{"column":31,"line":65}}},{"id":"510","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":65},"start":{"column":47,"line":65}}},{"id":"512","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":88,"line":67},"start":{"column":70,"line":67}}},{"id":"511","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":67},"start":{"column":49,"line":67}}},{"id":"513","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":85},"start":{"column":59,"line":72}}},{"id":"514","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":84},"start":{"column":33,"line":76}}},{"id":"515","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":83},"start":{"column":39,"line":83}}},{"id":"516","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":131},"start":{"column":57,"line":87}}},{"id":"517","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":94},"start":{"column":61,"line":90}}},{"id":"518","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":91},"start":{"column":40,"line":91}}},{"id":"519","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":91},"start":{"column":52,"line":91}}},{"id":"520","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":91},"start":{"column":61,"line":91}}},{"id":"521","mutatorName":"ArithmeticOperator","replacement":"timestamps.length + 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":97},"start":{"column":36,"line":97}}},{"id":"522","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":99},"start":{"column":13,"line":99}}},{"id":"523","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":99},"start":{"column":13,"line":99}}},{"id":"525","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":105},"start":{"column":54,"line":99}}},{"id":"524","mutatorName":"EqualityOperator","replacement":"timestamp !== String(post[0].timestamp)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":99},"start":{"column":13,"line":99}}},{"id":"526","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":104},"start":{"column":32,"line":101}}},{"id":"527","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":102},"start":{"column":27,"line":102}}},{"id":"486","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":38,"line":47},"start":{"column":13,"line":47}}},{"id":"531","mutatorName":"LogicalOperator","replacement":"timestampIndex === 0 && timestampIndex === -1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":13,"line":106}}},{"id":"529","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":13,"line":106}}},{"id":"530","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":13,"line":106}}},{"id":"532","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":106},"start":{"column":13,"line":106}}},{"id":"533","mutatorName":"EqualityOperator","replacement":"timestampIndex !== 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":106},"start":{"column":13,"line":106}}},{"id":"534","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":37,"line":106}}},{"id":"537","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":108},"start":{"column":60,"line":106}}},{"id":"536","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":56,"line":106}}},{"id":"535","mutatorName":"EqualityOperator","replacement":"timestampIndex !== -1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":37,"line":106}}},{"id":"538","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":107},"start":{"column":29,"line":107}}},{"id":"540","mutatorName":"EqualityOperator","replacement":"i <"+"= timestamps.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":112},"start":{"column":48,"line":112}}},{"id":"539","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":112},"start":{"column":48,"line":112}}},{"id":"541","mutatorName":"EqualityOperator","replacement":"i >= timestamps.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":112},"start":{"column":48,"line":112}}},{"id":"543","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":115},"start":{"column":76,"line":112}}},{"id":"542","mutatorName":"UpdateOperator","replacement":"--i","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":112},"start":{"column":71,"line":112}}},{"id":"544","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":118},"start":{"column":42,"line":118}}},{"id":"545","mutatorName":"EqualityOperator","replacement":"i > timestampIndex","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":118},"start":{"column":42,"line":118}}},{"id":"546","mutatorName":"EqualityOperator","replacement":"i <"+" timestampIndex","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":118},"start":{"column":42,"line":118}}},{"id":"548","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":125},"start":{"column":68,"line":118}}},{"id":"547","mutatorName":"UpdateOperator","replacement":"++i","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":118},"start":{"column":63,"line":118}}},{"id":"549","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":120},"start":{"column":37,"line":120}}},{"id":"550","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":120},"start":{"column":37,"line":120}}},{"id":"551","mutatorName":"EqualityOperator","replacement":"i !== timestampIndex","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":120},"start":{"column":37,"line":120}}},{"id":"552","mutatorName":"ArithmeticOperator","replacement":"i + 2","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":120},"start":{"column":60,"line":120}}},{"id":"553","mutatorName":"ArithmeticOperator","replacement":"i + 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":120},"start":{"column":68,"line":120}}},{"id":"554","mutatorName":"ArithmeticOperator","replacement":"newContentIndex - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":121},"start":{"column":39,"line":121}}},{"id":"555","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":122},"start":{"column":32,"line":122}}},{"id":"557","mutatorName":"EqualityOperator","replacement":"newContentIndex <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":122},"start":{"column":32,"line":122}}},{"id":"556","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":122},"start":{"column":32,"line":122}}},{"id":"558","mutatorName":"EqualityOperator","replacement":"newContentIndex >= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":122},"start":{"column":32,"line":122}}},{"id":"559","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":123},"start":{"column":44,"line":123}}},{"id":"560","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":124},"start":{"column":32,"line":124}}},{"id":"561","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":89,"line":124},"start":{"column":80,"line":124}}},{"id":"562","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":130},"start":{"column":28,"line":127}}},{"id":"563","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":128},"start":{"column":23,"line":128}}},{"id":"564","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":129},"start":{"column":30,"line":129}}},{"id":"566","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":138},"start":{"column":49,"line":135}}},{"id":"565","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":154},"start":{"column":50,"line":133}}},{"id":"567","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":136},"start":{"column":40,"line":136}}},{"id":"569","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":136},"start":{"column":61,"line":136}}},{"id":"568","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":136},"start":{"column":52,"line":136}}},{"id":"570","mutatorName":"MethodExpression","replacement":"diffs","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":143},"start":{"column":28,"line":143}}},{"id":"528","mutatorName":"StringLiteral","replacement":"``","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":53,"line":103},"start":{"column":34,"line":103}}},{"id":"572","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":143},"start":{"column":46,"line":143}}},{"id":"573","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":143},"start":{"column":46,"line":143}}},{"id":"574","mutatorName":"LogicalOperator","replacement":"d.hasOwnProperty('title') || d.title","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":143},"start":{"column":46,"line":143}}},{"id":"575","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":143},"start":{"column":63,"line":143}}},{"id":"577","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":144},"start":{"column":13,"line":144}}},{"id":"576","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":144},"start":{"column":13,"line":144}}},{"id":"578","mutatorName":"LogicalOperator","replacement":"titleDiffs.length || post[0].topic","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":144},"start":{"column":13,"line":144}}},{"id":"579","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":146},"start":{"column":49,"line":144}}},{"id":"580","mutatorName":"ArithmeticOperator","replacement":"titleDiffs.length + 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":145},"start":{"column":72,"line":145}}},{"id":"581","mutatorName":"MethodExpression","replacement":"diffs","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":147},"start":{"column":26,"line":147}}},{"id":"582","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":147},"start":{"column":39,"line":147}}},{"id":"583","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":147},"start":{"column":44,"line":147}}},{"id":"584","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":147},"start":{"column":44,"line":147}}},{"id":"585","mutatorName":"LogicalOperator","replacement":"d.hasOwnProperty('tags') || d.tags","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":147},"start":{"column":44,"line":147}}},{"id":"586","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":147},"start":{"column":61,"line":147}}},{"id":"587","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":148},"start":{"column":13,"line":148}}},{"id":"588","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":148},"start":{"column":13,"line":148}}},{"id":"589","mutatorName":"LogicalOperator","replacement":"tagDiffs.length || post[0].topic","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":148},"start":{"column":13,"line":148}}},{"id":"590","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":151},"start":{"column":47,"line":148}}},{"id":"591","mutatorName":"ArithmeticOperator","replacement":"tagDiffs.length + 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":149},"start":{"column":35,"line":149}}},{"id":"593","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":149},"start":{"column":76,"line":149}}},{"id":"592","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":149},"start":{"column":67,"line":149}}},{"id":"594","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":98,"line":149},"start":{"column":84,"line":149}}},{"id":"595","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":164},"start":{"column":47,"line":156}}},{"id":"596","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":159},"start":{"column":13,"line":159}}},{"id":"597","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":159},"start":{"column":13,"line":159}}},{"id":"598","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":161},"start":{"column":31,"line":159}}},{"id":"599","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":160},"start":{"column":29,"line":160}}},{"id":"600","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":174},"start":{"column":41,"line":166}}},{"id":"601","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":167},"start":{"column":13,"line":167}}},{"id":"602","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":167},"start":{"column":13,"line":167}}},{"id":"603","mutatorName":"LogicalOperator","replacement":"aDiff || aDiff.patch","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":167},"start":{"column":13,"line":167}}},{"id":"605","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":170},"start":{"column":66,"line":168}}},{"id":"604","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":172},"start":{"column":35,"line":167}}},{"id":"606","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":171},"start":{"column":20,"line":171}}},{"id":"607","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":171},"start":{"column":20,"line":171}}},{"id":"608","mutatorName":"EqualityOperator","replacement":"typeof result !== 'string'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":171},"start":{"column":20,"line":171}}},{"id":"609","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":171},"start":{"column":38,"line":171}}},{"id":"571","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":82,"line":143},"start":{"column":41,"line":143}}}],"source":"'use strict';\n\nconst validator = require('validator');\nconst diff = require('diff');\n\nconst db = require('../database');\nconst meta = require('../meta');\nconst plugins = require('../plugins');\nconst translator = require('../translator');\nconst topics = require('../topics');\n\nmodule.exports = function (Posts) {\n    const Diffs = {};\n    Posts.diffs = Diffs;\n    Diffs.exists = async function (pid) {\n        if (meta.config.enablePostHistory !== 1) {\n            return false;\n        }\n\n        const numDiffs = await db.listLength(`post:${pid}:diffs`);\n        return !!numDiffs;\n    };\n\n    Diffs.get = async function (pid, since) {\n        const timestamps = await Diffs.list(pid);\n        if (!since) {\n            since = 0;\n        }\n\n        // Pass those made after `since`, and create keys\n        const keys = timestamps.filter(t => (parseInt(t, 10) || 0) > since)\n            .map(t => `diff:${pid}.${t}`);\n        return await db.getObjects(keys);\n    };\n\n    Diffs.list = async function (pid) {\n        return await db.getListRange(`post:${pid}:diffs`, 0, -1);\n    };\n\n    Diffs.save = async function (data) {\n        const { pid, uid, oldContent, newContent, edited, topic } = data;\n        const editTimestamp = edited || Date.now();\n        const diffData = {\n            uid: uid,\n            pid: pid,\n        };\n        if (oldContent !== newContent) {\n            diffData.patch = diff.createPatch('', newContent, oldContent);\n        }\n        if (topic.renamed) {\n            diffData.title = topic.oldTitle;\n        }\n        if (topic.tagsupdated && Array.isArray(topic.oldTags)) {\n            diffData.tags = topic.oldTags.map(tag => tag && tag.value).filter(Boolean).join(',');\n        }\n        await Promise.all([\n            db.listPrepend(`post:${pid}:diffs`, editTimestamp),\n            db.setObject(`diff:${pid}.${editTimestamp}`, diffData),\n        ]);\n    };\n\n    Diffs.load = async function (pid, since, uid) {\n        since = getValidatedTimestamp(since);\n        const post = await postDiffLoad(pid, since, uid);\n        post.content = String(post.content || '');\n\n        const result = await plugins.hooks.fire('filter:parse.post', { postData: post });\n        result.postData.content = translator.escape(result.postData.content);\n        return result.postData;\n    };\n\n    Diffs.restore = async function (pid, since, uid, req) {\n        since = getValidatedTimestamp(since);\n        const post = await postDiffLoad(pid, since, uid);\n\n        return await Posts.edit({\n            uid: uid,\n            pid: pid,\n            content: post.content,\n            req: req,\n            timestamp: since,\n            title: post.topic.title,\n            tags: post.topic.tags.map(tag => tag.value),\n        });\n    };\n\n    Diffs.delete = async function (pid, timestamp, uid) {\n        getValidatedTimestamp(timestamp);\n\n        const [post, diffs, timestamps] = await Promise.all([\n            Posts.getPostSummaryByPids([pid], uid, { parse: false }),\n            Diffs.get(pid),\n            Diffs.list(pid),\n        ]);\n\n        const timestampIndex = timestamps.indexOf(timestamp);\n        const lastTimestampIndex = timestamps.length - 1;\n\n        if (timestamp === String(post[0].timestamp)) {\n            // Deleting oldest diff, so history rewrite is not needed\n            return Promise.all([\n                db.delete(`diff:${pid}.${timestamps[lastTimestampIndex]}`),\n                db.listRemoveAll(`post:${pid}:diffs`, timestamps[lastTimestampIndex]),\n            ]);\n        }\n        if (timestampIndex === 0 || timestampIndex === -1) {\n            throw new Error('[[error:invalid-data]]');\n        }\n\n        const postContent = validator.unescape(post[0].content);\n        const versionContents = {};\n        for (let i = 0, content = postContent; i <"+" timestamps.length; ++i) {\n            versionContents[timestamps[i]] = applyPatch(content, diffs[i]);\n            content = versionContents[timestamps[i]];\n        }\n\n        /* eslint-disable no-await-in-loop */\n        for (let i = lastTimestampIndex; i >= timestampIndex; --i) {\n            // Recreate older diffs with skipping the deleted diff\n            const newContentIndex = i === timestampIndex ? i - 2 : i - 1;\n            const timestampToUpdate = newContentIndex + 1;\n            const newContent = newContentIndex <"+" 0 ? postContent : versionContents[timestamps[newContentIndex]];\n            const patch = diff.createPatch('', newContent, versionContents[timestamps[i]]);\n            await db.setObject(`diff:${pid}.${timestamps[timestampToUpdate]}`, { patch });\n        }\n\n        return Promise.all([\n            db.delete(`diff:${pid}.${timestamp}`),\n            db.listRemoveAll(`post:${pid}:diffs`, timestamp),\n        ]);\n    };\n\n    async function postDiffLoad(pid, since, uid) {\n        // Retrieves all diffs made since `since` and replays them to reconstruct what the post looked like at `since`\n        const [post, diffs] = await Promise.all([\n            Posts.getPostSummaryByPids([pid], uid, { parse: false }),\n            Posts.diffs.get(pid, since),\n        ]);\n\n        // Replace content with re-constructed content from that point in time\n        post[0].content = diffs.reduce(applyPatch, validator.unescape(post[0].content));\n\n        const titleDiffs = diffs.filter(d => d.hasOwnProperty('title') && d.title);\n        if (titleDiffs.length && post[0].topic) {\n            post[0].topic.title = validator.unescape(String(titleDiffs[titleDiffs.length - 1].title));\n        }\n        const tagDiffs = diffs.filter(d => d.hasOwnProperty('tags') && d.tags);\n        if (tagDiffs.length && post[0].topic) {\n            const tags = tagDiffs[tagDiffs.length - 1].tags.split(',').map(tag => ({ value: tag }));\n            post[0].topic.tags = await topics.getTagData(tags);\n        }\n\n        return post[0];\n    }\n\n    function getValidatedTimestamp(timestamp) {\n        timestamp = parseInt(timestamp, 10);\n\n        if (isNaN(timestamp)) {\n            throw new Error('[[error:invalid-data]]');\n        }\n\n        return timestamp;\n    }\n\n    function applyPatch(content, aDiff) {\n        if (aDiff && aDiff.patch) {\n            const result = diff.applyPatch(content, aDiff.patch, {\n                fuzzFactor: 1,\n            });\n            return typeof result === 'string' ? result : content;\n        }\n        return content;\n    }\n};\n"},"src/posts/edit.js":{"language":"javascript","mutants":[{"id":"611","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":18},"start":{"column":15,"line":18}}},{"id":"610","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":217},"start":{"column":35,"line":17}}},{"id":"613","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":104},"start":{"column":40,"line":22}}},{"id":"612","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":20},"start":{"column":37,"line":18}}},{"id":"615","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":24},"start":{"column":13,"line":24}}},{"id":"616","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":24},"start":{"column":13,"line":24}}},{"id":"617","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":26},"start":{"column":28,"line":24}}},{"id":"619","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":28},"start":{"column":13,"line":28}}},{"id":"618","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":28},"start":{"column":13,"line":28}}},{"id":"620","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":28},"start":{"column":13,"line":28}}},{"id":"621","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":30},"start":{"column":24,"line":28}}},{"id":"622","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":29},"start":{"column":29,"line":29}}},{"id":"623","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":34},"start":{"column":69,"line":32}}},{"id":"625","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":33},"start":{"column":20,"line":33}}},{"id":"624","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":33},"start":{"column":13,"line":33}}},{"id":"626","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":33},"start":{"column":31,"line":33}}},{"id":"614","mutatorName":"BooleanLiteral","replacement":"canEdit.flag","statusReason":"Error\n    at Posts.edit (.stryker-tmp/sandbox9230685/src/posts/edit.js:86:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async setupData (.stryker-tmp/sandbox9230685/test/api.js:167:9)\n    at async Context.<"+"anonymous> (.stryker-tmp/sandbox9230685/test/api.js:387:21)","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":26,"line":24},"start":{"column":13,"line":24}}},{"id":"629","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":33},"start":{"column":66,"line":33}}},{"id":"628","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":33},"start":{"column":53,"line":33}}},{"id":"631","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":41},"start":{"column":13,"line":41}}},{"id":"630","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":33},"start":{"column":74,"line":33}}},{"id":"632","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":41},"start":{"column":13,"line":41}}},{"id":"633","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":43},"start":{"column":26,"line":41}}},{"id":"635","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":50},"start":{"column":69,"line":45}}},{"id":"634","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":45},"start":{"column":49,"line":45}}},{"id":"636","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":55},"start":{"column":51,"line":52}}},{"id":"637","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":53},"start":{"column":42,"line":53}}},{"id":"627","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":51,"line":33},"start":{"column":40,"line":33}}},{"id":"639","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":53},"start":{"column":55,"line":53}}},{"id":"640","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":60},"start":{"column":32,"line":58}}},{"id":"641","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":60},"start":{"column":32,"line":58}}},{"id":"643","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":59},"start":{"column":32,"line":58}}},{"id":"642","mutatorName":"LogicalOperator","replacement":"(data.content !== oldContent || topic.renamed) && topic.tagsupdated","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":60},"start":{"column":32,"line":58}}},{"id":"644","mutatorName":"LogicalOperator","replacement":"data.content !== oldContent && topic.renamed","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":59},"start":{"column":32,"line":58}}},{"id":"645","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":58},"start":{"column":32,"line":58}}},{"id":"647","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":62},"start":{"column":13,"line":62}}},{"id":"646","mutatorName":"EqualityOperator","replacement":"data.content === oldContent","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":58},"start":{"column":32,"line":58}}},{"id":"648","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":62},"start":{"column":13,"line":62}}},{"id":"649","mutatorName":"LogicalOperator","replacement":"meta.config.enablePostHistory === 1 || contentChanged","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":62},"start":{"column":13,"line":62}}},{"id":"650","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":62},"start":{"column":13,"line":62}}},{"id":"651","mutatorName":"EqualityOperator","replacement":"meta.config.enablePostHistory !== 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":62},"start":{"column":13,"line":62}}},{"id":"652","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":71},"start":{"column":68,"line":62}}},{"id":"653","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":70},"start":{"column":36,"line":63}}},{"id":"654","mutatorName":"BooleanLiteral","replacement":"!postData.deleted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":75},"start":{"column":28,"line":75}}},{"id":"655","mutatorName":"BooleanLiteral","replacement":"postData.deleted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":75},"start":{"column":29,"line":75}}},{"id":"656","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":77},"start":{"column":32,"line":77}}},{"id":"657","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":89},"start":{"column":64,"line":85}}},{"id":"659","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":87},"start":{"column":43,"line":87}}},{"id":"658","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":86},"start":{"column":19,"line":86}}},{"id":"660","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":88},"start":{"column":18,"line":88}}},{"id":"661","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":92},"start":{"column":28,"line":92}}},{"id":"662","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":108,"line":92},"start":{"column":48,"line":92}}},{"id":"663","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":95},"start":{"column":24,"line":95}}},{"id":"664","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":103},"start":{"column":16,"line":99}}},{"id":"665","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":178},"start":{"column":60,"line":106}}},{"id":"666","mutatorName":"MethodExpression","replacement":"data.title","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":108},"start":{"column":36,"line":108}}},{"id":"667","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":108},"start":{"column":56,"line":108}}},{"id":"668","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":110},"start":{"column":24,"line":110}}},{"id":"669","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":110},"start":{"column":24,"line":110}}},{"id":"671","mutatorName":"BooleanLiteral","replacement":"isMain","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":111},"start":{"column":13,"line":111}}},{"id":"670","mutatorName":"EqualityOperator","replacement":"parseInt(data.pid, 10) !== parseInt(topicData.mainPid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":110},"start":{"column":24,"line":110}}},{"id":"673","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":111},"start":{"column":13,"line":111}}},{"id":"672","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":111},"start":{"column":13,"line":111}}},{"id":"674","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":120},"start":{"column":22,"line":111}}},{"id":"675","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":119},"start":{"column":20,"line":112}}},{"id":"677","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":117},"start":{"column":26,"line":117}}},{"id":"676","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":116},"start":{"column":29,"line":116}}},{"id":"638","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":53,"line":53},"start":{"column":43,"line":53}}},{"id":"679","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":128},"start":{"column":30,"line":122}}},{"id":"680","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":129},"start":{"column":13,"line":129}}},{"id":"681","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":129},"start":{"column":13,"line":129}}},{"id":"682","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":132},"start":{"column":20,"line":129}}},{"id":"683","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":131},"start":{"column":33,"line":131}}},{"id":"684","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":131},"start":{"column":43,"line":131}}},{"id":"685","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":131},"start":{"column":43,"line":131}}},{"id":"686","mutatorName":"LogicalOperator","replacement":"slugify(title) && 'topic'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":131},"start":{"column":43,"line":131}}},{"id":"687","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":131},"start":{"column":61,"line":131}}},{"id":"678","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":35,"line":118},"start":{"column":30,"line":118}}},{"id":"689","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":135},"start":{"column":29,"line":134}}},{"id":"690","mutatorName":"LogicalOperator","replacement":"Array.isArray(data.tags) || !_.isEqual(data.tags, topicData.tags.map(tag => tag.value))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":135},"start":{"column":29,"line":134}}},{"id":"691","mutatorName":"BooleanLiteral","replacement":"_.isEqual(data.tags, topicData.tags.map(tag => tag.value))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":135},"start":{"column":13,"line":135}}},{"id":"692","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":135},"start":{"column":54,"line":135}}},{"id":"694","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":137},"start":{"column":13,"line":137}}},{"id":"693","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":137},"start":{"column":13,"line":137}}},{"id":"695","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":143},"start":{"column":26,"line":137}}},{"id":"696","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":138},"start":{"column":60,"line":138}}},{"id":"697","mutatorName":"BooleanLiteral","replacement":"canTag","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":139},"start":{"column":17,"line":139}}},{"id":"688","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":72,"line":135},"start":{"column":29,"line":134}}},{"id":"700","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":141},"start":{"column":26,"line":139}}},{"id":"699","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":139},"start":{"column":17,"line":139}}},{"id":"701","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":140},"start":{"column":33,"line":140}}},{"id":"702","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":145},"start":{"column":50,"line":145}}},{"id":"703","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":149},"start":{"column":71,"line":145}}},{"id":"704","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":150},"start":{"column":28,"line":150}}},{"id":"705","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":151},"start":{"column":13,"line":151}}},{"id":"706","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":151},"start":{"column":13,"line":151}}},{"id":"707","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":153},"start":{"column":26,"line":151}}},{"id":"698","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":24,"line":139},"start":{"column":17,"line":139}}},{"id":"708","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":156},"start":{"column":13,"line":156}}},{"id":"710","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":158},"start":{"column":44,"line":156}}},{"id":"711","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":162},"start":{"column":25,"line":162}}},{"id":"712","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":162},"start":{"column":25,"line":162}}},{"id":"713","mutatorName":"LogicalOperator","replacement":"title || translator.escape(validator.escape(String(title))) !== topicData.title","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":162},"start":{"column":25,"line":162}}},{"id":"714","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":162},"start":{"column":34,"line":162}}},{"id":"715","mutatorName":"EqualityOperator","replacement":"translator.escape(validator.escape(String(title))) === topicData.title","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":162},"start":{"column":34,"line":162}}},{"id":"716","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":163},"start":{"column":28,"line":163}}},{"id":"717","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":163},"start":{"column":49,"line":163}}},{"id":"709","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":42,"line":156},"start":{"column":13,"line":156}}},{"id":"718","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":177},"start":{"column":16,"line":164}}},{"id":"720","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":170},"start":{"column":19,"line":170}}},{"id":"721","mutatorName":"LogicalOperator","replacement":"newTopicData.slug && topicData.slug","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":170},"start":{"column":19,"line":170}}},{"id":"722","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":171},"start":{"column":25,"line":171}}},{"id":"725","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":181},"start":{"column":13,"line":181}}},{"id":"723","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":192},"start":{"column":57,"line":180}}},{"id":"724","mutatorName":"BooleanLiteral","replacement":"topicData.scheduled","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":181},"start":{"column":13,"line":181}}},{"id":"726","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":181},"start":{"column":13,"line":181}}},{"id":"727","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":183},"start":{"column":35,"line":181}}},{"id":"728","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":184},"start":{"column":61,"line":184}}},{"id":"719","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":54,"line":170},"start":{"column":19,"line":170}}},{"id":"730","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":185},"start":{"column":13,"line":185}}},{"id":"731","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":185},"start":{"column":13,"line":185}}},{"id":"732","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":187},"start":{"column":27,"line":185}}},{"id":"733","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":186},"start":{"column":29,"line":186}}},{"id":"735","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":188},"start":{"column":24,"line":188}}},{"id":"734","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":188},"start":{"column":24,"line":188}}},{"id":"736","mutatorName":"EqualityOperator","replacement":"parseInt(data.pid, 10) !== parseInt(topicData.mainPid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":188},"start":{"column":24,"line":188}}},{"id":"737","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":189},"start":{"column":13,"line":189}}},{"id":"738","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":189},"start":{"column":13,"line":189}}},{"id":"729","mutatorName":"BooleanLiteral","replacement":"canSchedule","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":25,"line":185},"start":{"column":13,"line":185}}},{"id":"741","mutatorName":"LogicalOperator","replacement":"isNaN(data.timestamp) && data.timestamp <"+" Date.now()","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":189},"start":{"column":24,"line":189}}},{"id":"740","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":189},"start":{"column":24,"line":189}}},{"id":"742","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":189},"start":{"column":49,"line":189}}},{"id":"743","mutatorName":"EqualityOperator","replacement":"data.timestamp <"+"= Date.now()","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":189},"start":{"column":49,"line":189}}},{"id":"744","mutatorName":"EqualityOperator","replacement":"data.timestamp >= Date.now()","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":189},"start":{"column":49,"line":189}}},{"id":"745","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":191},"start":{"column":79,"line":189}}},{"id":"747","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":211},"start":{"column":57,"line":194}}},{"id":"746","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":190},"start":{"column":29,"line":190}}},{"id":"748","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":198},"start":{"column":30,"line":195}}},{"id":"749","mutatorName":"ArithmeticOperator","replacement":"(postData.edited || postData.timestamp) - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":201},"start":{"column":53,"line":201}}},{"id":"739","mutatorName":"LogicalOperator","replacement":"isMain || isNaN(data.timestamp) || data.timestamp <"+" Date.now()","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":77,"line":189},"start":{"column":13,"line":189}}},{"id":"751","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":201},"start":{"column":54,"line":201}}},{"id":"753","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":13,"line":204}}},{"id":"752","mutatorName":"LogicalOperator","replacement":"postData.edited && postData.timestamp","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":201},"start":{"column":54,"line":201}}},{"id":"754","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":13,"line":204}}},{"id":"755","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":208},"start":{"column":44,"line":204}}},{"id":"756","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":216},"start":{"column":44,"line":213}}},{"id":"757","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":214},"start":{"column":24,"line":214}}},{"id":"758","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":214},"start":{"column":24,"line":214}}},{"id":"759","mutatorName":"EqualityOperator","replacement":"parseInt(data.pid, 10) !== parseInt(topicData.mainPid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":214},"start":{"column":24,"line":214}}},{"id":"750","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":91,"line":201},"start":{"column":54,"line":201}}},{"id":"760","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":215},"start":{"column":16,"line":215}}},{"id":"762","mutatorName":"LogicalOperator","replacement":"isMain && topicData.scheduled || topicData.timestamp !== data.timestamp","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":215},"start":{"column":16,"line":215}}},{"id":"763","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":215},"start":{"column":16,"line":215}}},{"id":"764","mutatorName":"LogicalOperator","replacement":"isMain || topicData.scheduled","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":215},"start":{"column":16,"line":215}}},{"id":"765","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":215},"start":{"column":49,"line":215}}},{"id":"766","mutatorName":"EqualityOperator","replacement":"topicData.timestamp === data.timestamp","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":215},"start":{"column":49,"line":215}}},{"id":"761","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":87,"line":215},"start":{"column":16,"line":215}}}],"source":"'use strict';\n\nconst validator = require('validator');\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst meta = require('../meta');\nconst topics = require('../topics');\nconst user = require('../user');\nconst privileges = require('../privileges');\nconst plugins = require('../plugins');\nconst pubsub = require('../pubsub');\nconst utils = require('../utils');\nconst slugify = require('../slugify');\nconst translator = require('../translator');\n\nmodule.exports = function (Posts) {\n    pubsub.on('post:edit', (pid) => {\n        require('./cache').del(pid);\n    });\n\n    Posts.edit = async function (data) {\n        const canEdit = await privileges.posts.canEdit(data.pid, data.uid);\n        if (!canEdit.flag) {\n            throw new Error(canEdit.message);\n        }\n        const postData = await Posts.getPostData(data.pid);\n        if (!postData) {\n            throw new Error('[[error:no-post]]');\n        }\n\n        const topicData = await topics.getTopicFields(postData.tid, [\n            'cid', 'mainPid', 'title', 'timestamp', 'scheduled', 'slug', 'tags',\n        ]);\n\n        await scheduledTopicCheck(data, topicData);\n\n        const oldContent = postData.content; // for diffing purposes\n        const editPostData = getEditPostData(data, topicData, postData);\n\n        if (data.handle) {\n            editPostData.handle = data.handle;\n        }\n\n        const result = await plugins.hooks.fire('filter:post.edit', {\n            req: data.req,\n            post: editPostData,\n            data: data,\n            uid: data.uid,\n        });\n\n        const [editor, topic] = await Promise.all([\n            user.getUserFields(data.uid, ['username', 'userslug']),\n            editMainPost(data, postData, topicData),\n        ]);\n\n        await Posts.setPostFields(data.pid, result.post);\n        const contentChanged = data.content !== oldContent ||\n            topic.renamed ||\n            topic.tagsupdated;\n\n        if (meta.config.enablePostHistory === 1 && contentChanged) {\n            await Posts.diffs.save({\n                pid: data.pid,\n                uid: data.uid,\n                oldContent: oldContent,\n                newContent: data.content,\n                edited: editPostData.edited,\n                topic,\n            });\n        }\n        await Posts.uploads.sync(data.pid);\n\n        // Normalize data prior to constructing returnPostData (match types with getPostSummaryByPids)\n        postData.deleted = !!postData.deleted;\n\n        const returnPostData = { ...postData, ...result.post };\n        returnPostData.cid = topic.cid;\n        returnPostData.topic = topic;\n        returnPostData.editedISO = utils.toISOString(editPostData.edited);\n        returnPostData.changed = contentChanged;\n        returnPostData.oldContent = oldContent;\n        returnPostData.newContent = data.content;\n\n        await topics.notifyFollowers(returnPostData, data.uid, {\n            type: 'post-edit',\n            bodyShort: translator.compile('notifications:user_edited_post', editor.username, topic.title),\n            nid: `edit_post:${data.pid}:uid:${data.uid}`,\n        });\n        await topics.syncBacklinks(returnPostData);\n\n        plugins.hooks.fire('action:post.edit', { post: _.clone(returnPostData), data: data, uid: data.uid });\n\n        require('./cache').del(String(postData.pid));\n        pubsub.publish('post:edit', String(postData.pid));\n\n        await Posts.parsePost(returnPostData);\n\n        return {\n            topic: topic,\n            editor: editor,\n            post: returnPostData,\n        };\n    };\n\n    async function editMainPost(data, postData, topicData) {\n        const { tid } = postData;\n        const title = data.title ? data.title.trim() : '';\n\n        const isMain = parseInt(data.pid, 10) === parseInt(topicData.mainPid, 10);\n        if (!isMain) {\n            return {\n                tid: tid,\n                cid: topicData.cid,\n                title: validator.escape(String(topicData.title)),\n                isMainPost: false,\n                renamed: false,\n                tagsupdated: false,\n            };\n        }\n\n        const newTopicData = {\n            tid: tid,\n            cid: topicData.cid,\n            uid: postData.uid,\n            mainPid: data.pid,\n            timestamp: rescheduling(data, topicData) ? data.timestamp : topicData.timestamp,\n        };\n        if (title) {\n            newTopicData.title = title;\n            newTopicData.slug = `${tid}/${slugify(title) || 'topic'}`;\n        }\n\n        const tagsupdated = Array.isArray(data.tags) &&\n            !_.isEqual(data.tags, topicData.tags.map(tag => tag.value));\n\n        if (tagsupdated) {\n            const canTag = await privileges.categories.can('topics:tag', topicData.cid, data.uid);\n            if (!canTag) {\n                throw new Error('[[error:no-privileges]]');\n            }\n            await topics.validateTags(data.tags, topicData.cid, data.uid, tid);\n        }\n\n        const results = await plugins.hooks.fire('filter:topic.edit', {\n            req: data.req,\n            topic: newTopicData,\n            data: data,\n        });\n        await db.setObject(`topic:${tid}`, results.topic);\n        if (tagsupdated) {\n            await topics.updateTopicTags(tid, data.tags);\n        }\n        const tags = await topics.getTopicTagsObjects(tid);\n\n        if (rescheduling(data, topicData)) {\n            await topics.scheduled.reschedule(newTopicData);\n        }\n\n        newTopicData.tags = data.tags;\n        newTopicData.oldTitle = topicData.title;\n        const renamed = title && translator.escape(validator.escape(String(title))) !== topicData.title;\n        plugins.hooks.fire('action:topic.edit', { topic: newTopicData, uid: data.uid });\n        return {\n            tid: tid,\n            cid: newTopicData.cid,\n            uid: postData.uid,\n            title: validator.escape(String(title)),\n            oldTitle: topicData.title,\n            slug: newTopicData.slug || topicData.slug,\n            isMainPost: true,\n            renamed: renamed,\n            tagsupdated: tagsupdated,\n            tags: tags,\n            oldTags: topicData.tags,\n            rescheduled: rescheduling(data, topicData),\n        };\n    }\n\n    async function scheduledTopicCheck(data, topicData) {\n        if (!topicData.scheduled) {\n            return;\n        }\n        const canSchedule = await privileges.categories.can('topics:schedule', topicData.cid, data.uid);\n        if (!canSchedule) {\n            throw new Error('[[error:no-privileges]]');\n        }\n        const isMain = parseInt(data.pid, 10) === parseInt(topicData.mainPid, 10);\n        if (isMain && (isNaN(data.timestamp) || data.timestamp <"+" Date.now())) {\n            throw new Error('[[error:invalid-data]]');\n        }\n    }\n\n    function getEditPostData(data, topicData, postData) {\n        const editPostData = {\n            content: data.content,\n            editor: data.uid,\n        };\n\n        // For posts in scheduled topics, if edited before, use edit timestamp\n        editPostData.edited = topicData.scheduled ? (postData.edited || postData.timestamp) + 1 : Date.now();\n\n        // if rescheduling the main post\n        if (rescheduling(data, topicData)) {\n            // For main posts, use timestamp coming from user (otherwise, it is ignored)\n            editPostData.edited = data.timestamp;\n            editPostData.timestamp = data.timestamp;\n        }\n\n        return editPostData;\n    }\n\n    function rescheduling(data, topicData) {\n        const isMain = parseInt(data.pid, 10) === parseInt(topicData.mainPid, 10);\n        return isMain && topicData.scheduled && topicData.timestamp !== data.timestamp;\n    }\n};\n"},"src/posts/endorse.js":{"language":"javascript","mutants":[{"id":"767","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":71},"start":{"column":35,"line":10}}},{"id":"768","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":33},"start":{"column":50,"line":11}}},{"id":"769","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":12},"start":{"column":24,"line":12}}},{"id":"771","mutatorName":"EqualityOperator","replacement":"typeof type !== 'string'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":12},"start":{"column":24,"line":12}}},{"id":"770","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":12},"start":{"column":24,"line":12}}},{"id":"772","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":12},"start":{"column":40,"line":12}}},{"id":"774","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":13},"start":{"column":24,"line":13}}},{"id":"775","mutatorName":"EqualityOperator","replacement":"typeof uid !== 'number'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":13},"start":{"column":24,"line":13}}},{"id":"776","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":13},"start":{"column":39,"line":13}}},{"id":"777","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":15},"start":{"column":13,"line":15}}},{"id":"778","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":15},"start":{"column":13,"line":15}}},{"id":"779","mutatorName":"EqualityOperator","replacement":"parseInt(String(uid), 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":15},"start":{"column":13,"line":15}}},{"id":"781","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":17},"start":{"column":45,"line":15}}},{"id":"780","mutatorName":"EqualityOperator","replacement":"parseInt(String(uid), 10) > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":15},"start":{"column":13,"line":15}}},{"id":"773","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":47,"line":13},"start":{"column":24,"line":13}}},{"id":"783","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":19},"start":{"column":29,"line":19}}},{"id":"784","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":19},"start":{"column":29,"line":19}}},{"id":"785","mutatorName":"EqualityOperator","replacement":"type !== 'endorse'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":19},"start":{"column":29,"line":19}}},{"id":"787","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":20},"start":{"column":57,"line":20}}},{"id":"786","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":19},"start":{"column":38,"line":19}}},{"id":"788","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":20},"start":{"column":58,"line":20}}},{"id":"789","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":20},"start":{"column":65,"line":20}}},{"id":"791","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":22},"start":{"column":43,"line":22}}},{"id":"790","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":22},"start":{"column":32,"line":22}}},{"id":"782","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":54,"line":16},"start":{"column":29,"line":16}}},{"id":"793","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":26},"start":{"column":47,"line":26}}},{"id":"794","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":27},"start":{"column":39,"line":27}}},{"id":"795","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":32},"start":{"column":16,"line":29}}},{"id":"796","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":47},"start":{"column":47,"line":35}}},{"id":"797","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":36},"start":{"column":24,"line":36}}},{"id":"798","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":36},"start":{"column":24,"line":36}}},{"id":"799","mutatorName":"EqualityOperator","replacement":"typeof uid !== 'number'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":36},"start":{"column":24,"line":36}}},{"id":"800","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":36},"start":{"column":39,"line":36}}},{"id":"801","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":40},"start":{"column":13,"line":40}}},{"id":"792","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":40,"line":23},"start":{"column":13,"line":23}}},{"id":"802","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":40},"start":{"column":13,"line":40}}},{"id":"804","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":43},"start":{"column":33,"line":40}}},{"id":"805","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":41},"start":{"column":48,"line":41}}},{"id":"806","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":44},"start":{"column":13,"line":44}}},{"id":"807","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":44},"start":{"column":13,"line":44}}},{"id":"808","mutatorName":"LogicalOperator","replacement":"!isInstr || !isAdmin","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":44},"start":{"column":13,"line":44}}},{"id":"809","mutatorName":"BooleanLiteral","replacement":"isInstr","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":44},"start":{"column":13,"line":44}}},{"id":"810","mutatorName":"BooleanLiteral","replacement":"isAdmin","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":44},"start":{"column":25,"line":44}}},{"id":"811","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":46},"start":{"column":35,"line":44}}},{"id":"812","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":45},"start":{"column":29,"line":45}}},{"id":"803","mutatorName":"LogicalOperator","replacement":"isInstr && isAdmin","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":31,"line":40},"start":{"column":13,"line":40}}},{"id":"814","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":50},"start":{"column":24,"line":50}}},{"id":"815","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":50},"start":{"column":24,"line":50}}},{"id":"816","mutatorName":"EqualityOperator","replacement":"typeof uid !== 'number'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":50},"start":{"column":24,"line":50}}},{"id":"817","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":50},"start":{"column":39,"line":50}}},{"id":"818","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":54},"start":{"column":13,"line":54}}},{"id":"819","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":54},"start":{"column":13,"line":54}}},{"id":"820","mutatorName":"LogicalOperator","replacement":"isInstr && isAdmin","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":54},"start":{"column":13,"line":54}}},{"id":"821","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":57},"start":{"column":33,"line":54}}},{"id":"822","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":55},"start":{"column":48,"line":55}}},{"id":"823","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":58},"start":{"column":13,"line":58}}},{"id":"813","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":61},"start":{"column":49,"line":49}}},{"id":"825","mutatorName":"LogicalOperator","replacement":"!isInstr || !isAdmin","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":58},"start":{"column":13,"line":58}}},{"id":"826","mutatorName":"BooleanLiteral","replacement":"isInstr","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":58},"start":{"column":13,"line":58}}},{"id":"827","mutatorName":"BooleanLiteral","replacement":"isAdmin","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":58},"start":{"column":25,"line":58}}},{"id":"828","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":60},"start":{"column":35,"line":58}}},{"id":"830","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":70},"start":{"column":51,"line":63}}},{"id":"829","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":59},"start":{"column":29,"line":59}}},{"id":"831","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":64},"start":{"column":13,"line":64}}},{"id":"832","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":64},"start":{"column":13,"line":64}}},{"id":"833","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":67},"start":{"column":33,"line":64}}},{"id":"834","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":65},"start":{"column":34,"line":65}}},{"id":"824","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":33,"line":58},"start":{"column":13,"line":58}}},{"id":"835","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":65},"start":{"column":41,"line":65}}},{"id":"836","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":64,"line":69},"start":{"column":37,"line":69}}}],"source":"'use strict';\n\nconst db = require('../database');\nconst user = require('../user');\n\n// For the functions below type signatures are:\n// type is string 'endorse' or 'unendorse'\n// pid is non-deterministic (could be array or a single object)\n// uid is number for the user ID\nmodule.exports = function (Posts) {\n    async function toggleEndorse(type, pid, uid) {\n        console.assert(typeof type === 'string');\n        console.assert(typeof uid === 'number');\n\n        if (parseInt(String(uid), 10) <"+"= 0) {\n            throw new Error('[[error:not-logged-in]]');\n        }\n\n        const isEndorsing = type === 'endorse';\n        const postData = await Posts.getPostFields(pid, ['pid', 'endorsed']);\n\n        await db[isEndorsing ? 'setAdd' : 'setRemove'](\n            `pid:${pid}:users_endorsed`,\n            uid\n        );\n        postData.endorsed = await db.setCount(`pid:${pid}:users_endorsed`);\n        await Posts.setPostField(pid, 'endorsed', postData.endorsed);\n\n        return {\n            post: postData,\n            isEndorsed: isEndorsing,\n        };\n    }\n\n    Posts.endorse = async function (pid, uid) {\n        console.assert(typeof uid === 'number');\n\n        const isInstr = await user.isInstructor(uid);\n        const isAdmin = await user.isAdministrator(uid);\n        if (isInstr || isAdmin) {\n            const result = await toggleEndorse('endorse', pid, uid);\n            return result;\n        }\n        if (!isInstr && !isAdmin) {\n            throw new Error('[[error:not-instructor]]');\n        }\n    };\n\n    Posts.unendorse = async function (pid, uid) {\n        console.assert(typeof uid === 'number');\n\n        const isInstr = await user.isInstructor(uid);\n        const isAdmin = await user.isAdministrator(uid);\n        if (isInstr || isAdmin) {\n            const result = await toggleEndorse('unendorse', pid, uid);\n            return result;\n        }\n        if (!isInstr && !isAdmin) {\n            throw new Error('[[error:not-instructor]]');\n        }\n    };\n\n    Posts.hasEndorsed = async function (pid, uid) {\n        if (Array.isArray(pid)) {\n            const sets = pid.map(pid => `pid:${pid}:users_endorsed`);\n            return await db.isMemberOfSets(sets, uid);\n        }\n\n        return await db.isSetMember(`pid:${pid}:users_endorsed`, uid);\n    };\n};\n"},"src/posts/index.js":{"language":"javascript","mutants":[{"id":"837","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":35},"start":{"column":38,"line":31}}},{"id":"838","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":33},"start":{"column":40,"line":33}}},{"id":"839","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":33},"start":{"column":47,"line":33}}},{"id":"841","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":42},"start":{"column":67,"line":37}}},{"id":"840","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":33},"start":{"column":64,"line":33}}},{"id":"842","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":38},"start":{"column":9,"line":38}}},{"id":"843","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":38},"start":{"column":9,"line":38}}},{"id":"844","mutatorName":"LogicalOperator","replacement":"isNaN(start) && isNaN(stop)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":38},"start":{"column":9,"line":38}}},{"id":"845","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":40},"start":{"column":38,"line":38}}},{"id":"846","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":39},"start":{"column":16,"line":39}}},{"id":"848","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":41},"start":{"column":56,"line":41}}},{"id":"849","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":55},"start":{"column":51,"line":44}}},{"id":"850","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":45},"start":{"column":9,"line":45}}},{"id":"851","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":45},"start":{"column":9,"line":45}}},{"id":"852","mutatorName":"LogicalOperator","replacement":"!Array.isArray(pids) && !pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":45},"start":{"column":9,"line":45}}},{"id":"853","mutatorName":"BooleanLiteral","replacement":"Array.isArray(pids)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":45},"start":{"column":9,"line":45}}},{"id":"854","mutatorName":"BooleanLiteral","replacement":"pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":45},"start":{"column":33,"line":45}}},{"id":"855","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":47},"start":{"column":47,"line":45}}},{"id":"856","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":46},"start":{"column":16,"line":46}}},{"id":"847","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":53,"line":41},"start":{"column":31,"line":41}}},{"id":"858","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":50},"start":{"column":67,"line":50}}},{"id":"859","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":51},"start":{"column":9,"line":51}}},{"id":"860","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":51},"start":{"column":9,"line":51}}},{"id":"861","mutatorName":"LogicalOperator","replacement":"!data && !Array.isArray(data.posts)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":51},"start":{"column":9,"line":51}}},{"id":"863","mutatorName":"BooleanLiteral","replacement":"Array.isArray(data.posts)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":51},"start":{"column":18,"line":51}}},{"id":"862","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":51},"start":{"column":9,"line":51}}},{"id":"864","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":53},"start":{"column":46,"line":51}}},{"id":"865","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":52},"start":{"column":16,"line":52}}},{"id":"866","mutatorName":"MethodExpression","replacement":"data.posts","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":54},"start":{"column":12,"line":54}}},{"id":"857","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":65,"line":50},"start":{"column":43,"line":50}}},{"id":"869","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":59},"start":{"column":42,"line":59}}},{"id":"868","mutatorName":"MethodExpression","replacement":"privileges.posts","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":59},"start":{"column":18,"line":59}}},{"id":"870","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":60},"start":{"column":63,"line":60}}},{"id":"871","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":60},"start":{"column":76,"line":60}}},{"id":"872","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":61},"start":{"column":12,"line":61}}},{"id":"873","mutatorName":"ArithmeticOperator","replacement":"stop - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":61},"start":{"column":39,"line":61}}},{"id":"874","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":72},"start":{"column":62,"line":64}}},{"id":"875","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":65},"start":{"column":17,"line":65}}},{"id":"876","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":65},"start":{"column":17,"line":65}}},{"id":"877","mutatorName":"EqualityOperator","replacement":"topicPostSort !== 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":65},"start":{"column":17,"line":65}}},{"id":"867","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":2,"line":62},"start":{"column":72,"line":57}}},{"id":"879","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":65},"start":{"column":50,"line":65}}},{"id":"880","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":65},"start":{"column":77,"line":65}}},{"id":"881","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":66},"start":{"column":21,"line":66}}},{"id":"882","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":66},"start":{"column":21,"line":66}}},{"id":"883","mutatorName":"LogicalOperator","replacement":"topicPostSort === 'newest_to_oldest' && topicPostSort === 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":66},"start":{"column":21,"line":66}}},{"id":"884","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":66},"start":{"column":21,"line":66}}},{"id":"885","mutatorName":"EqualityOperator","replacement":"topicPostSort !== 'newest_to_oldest'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":66},"start":{"column":21,"line":66}}},{"id":"886","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":66},"start":{"column":39,"line":66}}},{"id":"887","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":66},"start":{"column":61,"line":66}}},{"id":"878","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":47,"line":65},"start":{"column":35,"line":65}}},{"id":"888","mutatorName":"EqualityOperator","replacement":"topicPostSort !== 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":66},"start":{"column":61,"line":66}}},{"id":"890","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":67},"start":{"column":38,"line":67}}},{"id":"891","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":67},"start":{"column":59,"line":67}}},{"id":"892","mutatorName":"BooleanLiteral","replacement":"utils.isNumber(index)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":68},"start":{"column":9,"line":68}}},{"id":"893","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":68},"start":{"column":9,"line":68}}},{"id":"894","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":68},"start":{"column":9,"line":68}}},{"id":"895","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":70},"start":{"column":33,"line":68}}},{"id":"896","mutatorName":"ArithmeticOperator","replacement":"parseInt(index, 10) - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":71},"start":{"column":36,"line":71}}},{"id":"897","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":94},"start":{"column":52,"line":74}}},{"id":"898","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":75},"start":{"column":9,"line":75}}},{"id":"899","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":75},"start":{"column":9,"line":75}}},{"id":"889","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":91,"line":66},"start":{"column":79,"line":66}}},{"id":"901","mutatorName":"BooleanLiteral","replacement":"Array.isArray(posts)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":75},"start":{"column":9,"line":75}}},{"id":"902","mutatorName":"BooleanLiteral","replacement":"posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":75},"start":{"column":34,"line":75}}},{"id":"903","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":77},"start":{"column":49,"line":75}}},{"id":"904","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":76},"start":{"column":16,"line":76}}},{"id":"905","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":80},"start":{"column":21,"line":80}}},{"id":"906","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":80},"start":{"column":21,"line":80}}},{"id":"907","mutatorName":"EqualityOperator","replacement":"settings.topicPostSort !== 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":80},"start":{"column":21,"line":80}}},{"id":"908","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":80},"start":{"column":48,"line":80}}},{"id":"909","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":81},"start":{"column":26,"line":81}}},{"id":"911","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":81},"start":{"column":71,"line":81}}},{"id":"910","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":81},"start":{"column":42,"line":81}}},{"id":"912","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":21,"line":82}}},{"id":"913","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":21,"line":82}}},{"id":"914","mutatorName":"LogicalOperator","replacement":"settings.topicPostSort === 'newest_to_oldest' && settings.topicPostSort === 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":21,"line":82}}},{"id":"915","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":82},"start":{"column":21,"line":82}}},{"id":"916","mutatorName":"EqualityOperator","replacement":"settings.topicPostSort !== 'newest_to_oldest'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":82},"start":{"column":21,"line":82}}},{"id":"917","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":82},"start":{"column":48,"line":82}}},{"id":"918","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":70,"line":82}}},{"id":"919","mutatorName":"EqualityOperator","replacement":"settings.topicPostSort !== 'most_votes'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":70,"line":82}}},{"id":"920","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":82},"start":{"column":97,"line":82}}},{"id":"921","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":85},"start":{"column":28,"line":85}}},{"id":"923","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":86},"start":{"column":9,"line":86}}},{"id":"922","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":85},"start":{"column":51,"line":85}}},{"id":"924","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":86},"start":{"column":9,"line":86}}},{"id":"925","mutatorName":"EqualityOperator","replacement":"uniqueSets.length !== 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":86},"start":{"column":9,"line":86}}},{"id":"927","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":87},"start":{"column":28,"line":87}}},{"id":"926","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":89},"start":{"column":34,"line":86}}},{"id":"928","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":87},"start":{"column":50,"line":87}}},{"id":"929","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":91},"start":{"column":28,"line":91}}},{"id":"930","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":93},"start":{"column":24,"line":93}}},{"id":"931","mutatorName":"ArithmeticOperator","replacement":"parseInt(index, 10) - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":93},"start":{"column":58,"line":93}}},{"id":"932","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":103},"start":{"column":59,"line":96}}},{"id":"933","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":97},"start":{"column":9,"line":97}}},{"id":"934","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":97},"start":{"column":9,"line":97}}},{"id":"935","mutatorName":"LogicalOperator","replacement":"post && post.deleted || !(post.selfPost || privileges['posts:view_deleted'])","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":97},"start":{"column":9,"line":97}}},{"id":"936","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":97},"start":{"column":9,"line":97}}},{"id":"937","mutatorName":"LogicalOperator","replacement":"post || post.deleted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":97},"start":{"column":9,"line":97}}},{"id":"938","mutatorName":"BooleanLiteral","replacement":"post.selfPost || privileges['posts:view_deleted']","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":97},"start":{"column":33,"line":97}}},{"id":"939","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":97},"start":{"column":35,"line":97}}},{"id":"940","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":97},"start":{"column":35,"line":97}}},{"id":"941","mutatorName":"LogicalOperator","replacement":"post.selfPost && privileges['posts:view_deleted']","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":97},"start":{"column":35,"line":97}}},{"id":"942","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":97},"start":{"column":63,"line":97}}},{"id":"900","mutatorName":"LogicalOperator","replacement":"!Array.isArray(posts) && !posts.length","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":47,"line":75},"start":{"column":9,"line":75}}},{"id":"944","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":98},"start":{"column":24,"line":98}}},{"id":"945","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":99},"start":{"column":13,"line":99}}},{"id":"946","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":99},"start":{"column":13,"line":99}}},{"id":"948","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":100},"start":{"column":35,"line":100}}},{"id":"947","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":101},"start":{"column":24,"line":99}}},{"id":"943","mutatorName":"BlockStatement","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":6,"line":102},"start":{"column":87,"line":97}}}],"source":"'use strict';\n\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst utils = require('../utils');\nconst user = require('../user');\nconst privileges = require('../privileges');\nconst plugins = require('../plugins');\n\nconst Posts = module.exports;\n\nrequire('./data')(Posts);\nrequire('./create')(Posts);\nrequire('./delete')(Posts);\nrequire('./edit')(Posts);\nrequire('./parse')(Posts);\nrequire('./user')(Posts);\nrequire('./topics')(Posts);\nrequire('./category')(Posts);\nrequire('./summary')(Posts);\nrequire('./recent')(Posts);\nrequire('./tools')(Posts);\nrequire('./votes')(Posts);\nrequire('./bookmarks')(Posts);\nrequire('./queue')(Posts);\nrequire('./diffs')(Posts);\nrequire('./uploads')(Posts);\nrequire('./endorse')(Posts);\n\nPosts.exists = async function (pids) {\n    return await db.exists(\n        Array.isArray(pids) ? pids.map(pid => `post:${pid}`) : `post:${pids}`\n    );\n};\n\nPosts.getPidsFromSet = async function (set, start, stop, reverse) {\n    if (isNaN(start) || isNaN(stop)) {\n        return [];\n    }\n    return await db[reverse ? 'getSortedSetRevRange' : 'getSortedSetRange'](set, start, stop);\n};\n\nPosts.getPostsByPids = async function (pids, uid) {\n    if (!Array.isArray(pids) || !pids.length) {\n        return [];\n    }\n    let posts = await Posts.getPostsData(pids);\n    posts = await Promise.all(posts.map(Posts.parsePost));\n    const data = await plugins.hooks.fire('filter:post.getPosts', { posts: posts, uid: uid });\n    if (!data || !Array.isArray(data.posts)) {\n        return [];\n    }\n    return data.posts.filter(Boolean);\n};\n\nPosts.getPostSummariesFromSet = async function (set, uid, start, stop) {\n    let pids = await db.getSortedSetRevRange(set, start, stop);\n    pids = await privileges.posts.filter('topics:read', pids, uid);\n    const posts = await Posts.getPostSummaryByPids(pids, uid, { stripTags: false });\n    return { posts: posts, nextStart: stop + 1 };\n};\n\nPosts.getPidIndex = async function (pid, tid, topicPostSort) {\n    const set = topicPostSort === 'most_votes' ? `tid:${tid}:posts:votes` : `tid:${tid}:posts`;\n    const reverse = topicPostSort === 'newest_to_oldest' || topicPostSort === 'most_votes';\n    const index = await db[reverse ? 'sortedSetRevRank' : 'sortedSetRank'](set, pid);\n    if (!utils.isNumber(index)) {\n        return 0;\n    }\n    return utils.isNumber(index) ? parseInt(index, 10) + 1 : 0;\n};\n\nPosts.getPostIndices = async function (posts, uid) {\n    if (!Array.isArray(posts) || !posts.length) {\n        return [];\n    }\n    const settings = await user.getSettings(uid);\n\n    const byVotes = settings.topicPostSort === 'most_votes';\n    let sets = posts.map(p => (byVotes ? `tid:${p.tid}:posts:votes` : `tid:${p.tid}:posts`));\n    const reverse = settings.topicPostSort === 'newest_to_oldest' || settings.topicPostSort === 'most_votes';\n\n    const uniqueSets = _.uniq(sets);\n    let method = reverse ? 'sortedSetsRevRanks' : 'sortedSetsRanks';\n    if (uniqueSets.length === 1) {\n        method = reverse ? 'sortedSetRevRanks' : 'sortedSetRanks';\n        sets = uniqueSets[0];\n    }\n\n    const pids = posts.map(post => post.pid);\n    const indices = await db[method](sets, pids);\n    return indices.map(index => (utils.isNumber(index) ? parseInt(index, 10) + 1 : 0));\n};\n\nPosts.modifyPostByPrivilege = function (post, privileges) {\n    if (post && post.deleted && !(post.selfPost || privileges['posts:view_deleted'])) {\n        post.content = '[[topic:post_is_deleted]]';\n        if (post.user) {\n            post.user.signature = '';\n        }\n    }\n};\n\nrequire('../promisify')(Posts);\n"},"src/posts/parse.js":{"language":"javascript","mutants":[{"id":"949","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"Cannot read properties of undefined (reading 'forEach')","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":37},"start":{"column":22,"line":14}}},{"id":"950","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":20},"start":{"column":55,"line":15}}},{"id":"951","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":17},"start":{"column":9,"line":17}}},{"id":"952","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":17},"start":{"column":16,"line":17}}},{"id":"954","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":17},"start":{"column":30,"line":17}}},{"id":"953","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":17},"start":{"column":23,"line":17}}},{"id":"955","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":17},"start":{"column":37,"line":17}}},{"id":"956","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":16,"line":18},"start":{"column":9,"line":18}}},{"id":"957","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":18},"start":{"column":18,"line":18}}},{"id":"958","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":18},"start":{"column":27,"line":18}}},{"id":"960","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":29},"start":{"column":24,"line":21}}},{"id":"959","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":18},"start":{"column":37,"line":18}}},{"id":"961","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":23},"start":{"column":12,"line":23}}},{"id":"962","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":23},"start":{"column":13,"line":23}}},{"id":"963","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":23},"start":{"column":21,"line":23}}},{"id":"965","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":23},"start":{"column":41,"line":23}}},{"id":"964","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":23},"start":{"column":29,"line":23}}},{"id":"966","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":23},"start":{"column":50,"line":23}}},{"id":"967","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":23},"start":{"column":57,"line":23}}},{"id":"968","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":23},"start":{"column":67,"line":23}}},{"id":"970","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":24},"start":{"column":15,"line":24}}},{"id":"969","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":24},"start":{"column":14,"line":24}}},{"id":"971","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":24},"start":{"column":22,"line":24}}},{"id":"972","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":24},"start":{"column":32,"line":24}}},{"id":"973","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":24},"start":{"column":41,"line":24}}},{"id":"974","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":24},"start":{"column":48,"line":24}}},{"id":"977","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":25},"start":{"column":17,"line":25}}},{"id":"976","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":24},"start":{"column":67,"line":24}}},{"id":"975","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":24},"start":{"column":58,"line":24}}},{"id":"978","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":25},"start":{"column":18,"line":25}}},{"id":"979","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":25},"start":{"column":28,"line":25}}},{"id":"980","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":25},"start":{"column":36,"line":25}}},{"id":"981","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":25},"start":{"column":43,"line":25}}},{"id":"982","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":26},"start":{"column":16,"line":26}}},{"id":"983","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":26},"start":{"column":17,"line":26}}},{"id":"984","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":26},"start":{"column":29,"line":26}}},{"id":"986","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":26},"start":{"column":51,"line":26}}},{"id":"990","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":94,"line":26},"start":{"column":89,"line":26}}},{"id":"988","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":26},"start":{"column":68,"line":26}}},{"id":"989","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":26},"start":{"column":78,"line":26}}},{"id":"987","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":26},"start":{"column":59,"line":26}}},{"id":"991","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":26},"start":{"column":96,"line":26}}},{"id":"992","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":27},"start":{"column":16,"line":27}}},{"id":"993","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":27},"start":{"column":17,"line":27}}},{"id":"995","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":27},"start":{"column":41,"line":27}}},{"id":"994","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":27},"start":{"column":29,"line":27}}},{"id":"996","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":27},"start":{"column":49,"line":27}}},{"id":"985","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":49,"line":26},"start":{"column":41,"line":26}}},{"id":"998","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":27},"start":{"column":69,"line":27}}},{"id":"999","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":28},"start":{"column":16,"line":28}}},{"id":"1001","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":28},"start":{"column":27,"line":28}}},{"id":"1000","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":28},"start":{"column":17,"line":28}}},{"id":"1002","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":28},"start":{"column":34,"line":28}}},{"id":"1003","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":28},"start":{"column":42,"line":28}}},{"id":"1004","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":33},"start":{"column":23,"line":30}}},{"id":"1006","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":30},"start":{"column":37,"line":30}}},{"id":"1007","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":30},"start":{"column":46,"line":30}}},{"id":"1005","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":30},"start":{"column":24,"line":30}}},{"id":"1008","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":30},"start":{"column":65,"line":30}}},{"id":"1009","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":31},"start":{"column":9,"line":31}}},{"id":"1010","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":31},"start":{"column":22,"line":31}}},{"id":"1011","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":31},"start":{"column":34,"line":31}}},{"id":"1013","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":31},"start":{"column":50,"line":31}}},{"id":"1012","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":31},"start":{"column":44,"line":31}}},{"id":"1014","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":31},"start":{"column":58,"line":31}}},{"id":"1015","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":31},"start":{"column":72,"line":31}}},{"id":"1016","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":32},"start":{"column":9,"line":32}}},{"id":"1017","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":32},"start":{"column":21,"line":32}}},{"id":"1019","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":32},"start":{"column":43,"line":32}}},{"id":"1018","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":32},"start":{"column":30,"line":32}}},{"id":"1020","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":32},"start":{"column":60,"line":32}}},{"id":"1021","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":36},"start":{"column":21,"line":34}}},{"id":"1022","mutatorName":"BlockStatement","replacement":"{}","statusReason":"posts.registerHooks is not a function","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":174},"start":{"column":35,"line":39}}},{"id":"1023","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":43},"start":{"column":22,"line":40}}},{"id":"1026","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":48},"start":{"column":22,"line":45}}},{"id":"1024","mutatorName":"Regex","replacement":"/href=\"([^\"])\"/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":41},"start":{"column":16,"line":41}}},{"id":"1027","mutatorName":"Regex","replacement":"/src=\"([^\"])\"/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":46},"start":{"column":16,"line":46}}},{"id":"1025","mutatorName":"Regex","replacement":"/href=\"([\"]+)\"/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":41},"start":{"column":16,"line":41}}},{"id":"1028","mutatorName":"Regex","replacement":"/src=\"([\"]+)\"/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":46},"start":{"column":16,"line":46}}},{"id":"1029","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":69},"start":{"column":49,"line":50}}},{"id":"1030","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":51},"start":{"column":13,"line":51}}},{"id":"1033","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":53},"start":{"column":24,"line":51}}},{"id":"1031","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":51},"start":{"column":13,"line":51}}},{"id":"1032","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":51},"start":{"column":13,"line":51}}},{"id":"997","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":67,"line":27},"start":{"column":58,"line":27}}},{"id":"1035","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":54},"start":{"column":35,"line":54}}},{"id":"1037","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":54},"start":{"column":55,"line":54}}},{"id":"1036","mutatorName":"LogicalOperator","replacement":"postData.content && ''","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":54},"start":{"column":35,"line":54}}},{"id":"1038","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":13,"line":58}}},{"id":"1039","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":13,"line":58}}},{"id":"1040","mutatorName":"LogicalOperator","replacement":"postData.pid || cachedContent !== undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":13,"line":58}}},{"id":"1041","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":29,"line":58}}},{"id":"1043","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":61},"start":{"column":58,"line":58}}},{"id":"1042","mutatorName":"EqualityOperator","replacement":"cachedContent === undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":58},"start":{"column":29,"line":58}}},{"id":"1044","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":63},"start":{"column":47,"line":63}}},{"id":"1045","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":63},"start":{"column":68,"line":63}}},{"id":"1034","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"Cannot destructure property 'flagId' of '(intermediate value)' as it is undefined.","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":57,"line":54},"start":{"column":35,"line":54}}},{"id":"1047","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":65},"start":{"column":13,"line":65}}},{"id":"1048","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":67},"start":{"column":32,"line":65}}},{"id":"1049","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":74},"start":{"column":59,"line":71}}},{"id":"1050","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":72},"start":{"column":48,"line":72}}},{"id":"1051","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":72},"start":{"column":48,"line":72}}},{"id":"1052","mutatorName":"LogicalOperator","replacement":"userData.signature && ''","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":72},"start":{"column":48,"line":72}}},{"id":"1053","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":72},"start":{"column":70,"line":72}}},{"id":"1055","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":73},"start":{"column":67,"line":73}}},{"id":"1054","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":73},"start":{"column":41,"line":73}}},{"id":"1056","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":109},"start":{"column":58,"line":76}}},{"id":"1057","mutatorName":"BooleanLiteral","replacement":"content","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":78},"start":{"column":13,"line":78}}},{"id":"1046","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":30,"line":65},"start":{"column":13,"line":65}}},{"id":"1059","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":78},"start":{"column":13,"line":78}}},{"id":"1061","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":84},"start":{"column":16,"line":84}}},{"id":"1060","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":80},"start":{"column":23,"line":78}}},{"id":"1062","mutatorName":"EqualityOperator","replacement":"current === null","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":84},"start":{"column":16,"line":84}}},{"id":"1063","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":106},"start":{"column":34,"line":84}}},{"id":"1064","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":85},"start":{"column":17,"line":85}}},{"id":"1065","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":85},"start":{"column":17,"line":85}}},{"id":"1067","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":101},"start":{"column":21,"line":86}}},{"id":"1066","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":104},"start":{"column":29,"line":85}}},{"id":"1068","mutatorName":"BooleanLiteral","replacement":"parsed.protocol","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":88},"start":{"column":25,"line":88}}},{"id":"1069","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":88},"start":{"column":25,"line":88}}},{"id":"1058","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":21,"line":78},"start":{"column":13,"line":78}}},{"id":"1071","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":100},"start":{"column":43,"line":88}}},{"id":"1073","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":89},"start":{"column":29,"line":89}}},{"id":"1072","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":89},"start":{"column":29,"line":89}}},{"id":"1074","mutatorName":"MethodExpression","replacement":"current[1].endsWith('/')","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":89},"start":{"column":29,"line":89}}},{"id":"1075","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":89},"start":{"column":51,"line":89}}},{"id":"1076","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":92},"start":{"column":57,"line":89}}},{"id":"1077","mutatorName":"ArithmeticOperator","replacement":"nconf.get('base_url') - current[1]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":91},"start":{"column":40,"line":91}}},{"id":"1080","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":94},"start":{"column":40,"line":94}}},{"id":"1079","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":95},"start":{"column":32,"line":92}}},{"id":"1078","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":91},"start":{"column":50,"line":91}}},{"id":"1070","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":41,"line":88},"start":{"column":25,"line":88}}},{"id":"1082","mutatorName":"ArithmeticOperator","replacement":"content.slice(0, current.index + regex.length) - absolute","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":98},"start":{"column":35,"line":97}}},{"id":"1083","mutatorName":"MethodExpression","replacement":"content","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":97},"start":{"column":35,"line":97}}},{"id":"1084","mutatorName":"ArithmeticOperator","replacement":"current.index - regex.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":97},"start":{"column":52,"line":97}}},{"id":"1085","mutatorName":"MethodExpression","replacement":"content","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":88,"line":99},"start":{"column":25,"line":99}}},{"id":"1087","mutatorName":"ArithmeticOperator","replacement":"current.index - regex.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":99},"start":{"column":39,"line":99}}},{"id":"1086","mutatorName":"ArithmeticOperator","replacement":"current.index + regex.length - current[1].length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":99},"start":{"column":39,"line":99}}},{"id":"1088","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":103},"start":{"column":31,"line":101}}},{"id":"1081","mutatorName":"ArithmeticOperator","replacement":"content.slice(0, current.index + regex.length) + absolute - content.slice(current.index + regex.length + current[1].length)","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":88,"line":99},"start":{"column":35,"line":97}}},{"id":"1089","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":117},"start":{"column":41,"line":111}}},{"id":"1091","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":130},"start":{"column":43,"line":119}}},{"id":"1092","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":126},"start":{"column":53,"line":121}}},{"id":"1093","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":129},"start":{"column":51,"line":129}}},{"id":"1094","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":158},"start":{"column":33,"line":132}}},{"id":"1095","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":133},"start":{"column":32,"line":133}}},{"id":"1097","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":134},"start":{"column":19,"line":134}}},{"id":"1096","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":139},"start":{"column":40,"line":133}}},{"id":"1098","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":138},"start":{"column":37,"line":135}}},{"id":"1099","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":141},"start":{"column":32,"line":141}}},{"id":"1100","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":144},"start":{"column":40,"line":141}}},{"id":"1090","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":116},"start":{"column":34,"line":112}}},{"id":"1102","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":143},"start":{"column":21,"line":143}}},{"id":"1103","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":146},"start":{"column":32,"line":146}}},{"id":"1104","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":149},"start":{"column":40,"line":146}}},{"id":"1105","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":147},"start":{"column":19,"line":147}}},{"id":"1106","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":148},"start":{"column":21,"line":148}}},{"id":"1107","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":151},"start":{"column":32,"line":151}}},{"id":"1109","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":152},"start":{"column":19,"line":152}}},{"id":"1110","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":156},"start":{"column":37,"line":153}}},{"id":"1108","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":157},"start":{"column":40,"line":151}}},{"id":"1111","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":173},"start":{"column":43,"line":160}}},{"id":"1101","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":37,"line":142},"start":{"column":19,"line":142}}},{"id":"1113","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":164},"start":{"column":13,"line":164}}},{"id":"1114","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":164},"start":{"column":13,"line":164}}},{"id":"1116","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":166},"start":{"column":53,"line":164}}},{"id":"1115","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":164},"start":{"column":25,"line":164}}},{"id":"1117","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":165},"start":{"column":30,"line":165}}},{"id":"1118","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":168},"start":{"column":13,"line":168}}},{"id":"1119","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":168},"start":{"column":13,"line":168}}},{"id":"1122","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":169},"start":{"column":30,"line":169}}},{"id":"1120","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":168},"start":{"column":25,"line":168}}},{"id":"1121","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":170},"start":{"column":54,"line":168}}},{"id":"1112","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":31,"line":162},"start":{"column":29,"line":162}}}],"source":"'use strict';\n\nconst nconf = require('nconf');\nconst url = require('url');\nconst winston = require('winston');\nconst sanitize = require('sanitize-html');\nconst _ = require('lodash');\n\nconst meta = require('../meta');\nconst plugins = require('../plugins');\nconst translator = require('../translator');\nconst utils = require('../utils');\n\nlet sanitizeConfig = {\n    allowedTags: sanitize.defaults.allowedTags.concat([\n        // Some safe-to-use tags to add\n        'sup', 'ins', 'del', 'img', 'button',\n        'video', 'audio', 'iframe', 'embed',\n        // 'sup' still necessary until https://github.com/apostrophecms/sanitize-html/pull/422 merged\n    ]),\n    allowedAttributes: {\n        ...sanitize.defaults.allowedAttributes,\n        a: ['href', 'name', 'hreflang', 'media', 'rel', 'target', 'type'],\n        img: ['alt', 'height', 'ismap', 'src', 'usemap', 'width', 'srcset'],\n        iframe: ['height', 'name', 'src', 'width'],\n        video: ['autoplay', 'controls', 'height', 'loop', 'muted', 'poster', 'preload', 'src', 'width'],\n        audio: ['autoplay', 'controls', 'loop', 'muted', 'preload', 'src'],\n        embed: ['height', 'src', 'type', 'width'],\n    },\n    globalAttributes: ['accesskey', 'class', 'contenteditable', 'dir',\n        'draggable', 'dropzone', 'hidden', 'id', 'lang', 'spellcheck', 'style',\n        'tabindex', 'title', 'translate', 'aria-expanded', 'data-*',\n    ],\n    allowedClasses: {\n        ...sanitize.defaults.allowedClasses,\n    },\n};\n\nmodule.exports = function (Posts) {\n    Posts.urlRegex = {\n        regex: /href=\"([^\"]+)\"/g,\n        length: 6,\n    };\n\n    Posts.imgRegex = {\n        regex: /src=\"([^\"]+)\"/g,\n        length: 5,\n    };\n\n    Posts.parsePost = async function (postData) {\n        if (!postData) {\n            return postData;\n        }\n        postData.content = String(postData.content || '');\n        const cache = require('./cache');\n        const pid = String(postData.pid);\n        const cachedContent = cache.get(pid);\n        if (postData.pid && cachedContent !== undefined) {\n            postData.content = cachedContent;\n            return postData;\n        }\n\n        const data = await plugins.hooks.fire('filter:parse.post', { postData: postData });\n        data.postData.content = translator.escape(data.postData.content);\n        if (data.postData.pid) {\n            cache.set(pid, data.postData.content);\n        }\n        return data.postData;\n    };\n\n    Posts.parseSignature = async function (userData, uid) {\n        userData.signature = sanitizeSignature(userData.signature || '');\n        return await plugins.hooks.fire('filter:parse.signature', { userData: userData, uid: uid });\n    };\n\n    Posts.relativeToAbsolute = function (content, regex) {\n        // Turns relative links in content to absolute urls\n        if (!content) {\n            return content;\n        }\n        let parsed;\n        let current = regex.regex.exec(content);\n        let absolute;\n        while (current !== null) {\n            if (current[1]) {\n                try {\n                    parsed = url.parse(current[1]);\n                    if (!parsed.protocol) {\n                        if (current[1].startsWith('/')) {\n                            // Internal link\n                            absolute = nconf.get('base_url') + current[1];\n                        } else {\n                            // External link\n                            absolute = `//${current[1]}`;\n                        }\n\n                        content = content.slice(0, current.index + regex.length) +\n                        absolute +\n                        content.slice(current.index + regex.length + current[1].length);\n                    }\n                } catch (err) {\n                    winston.verbose(err.messsage);\n                }\n            }\n            current = regex.regex.exec(content);\n        }\n\n        return content;\n    };\n\n    Posts.sanitize = function (content) {\n        return sanitize(content, {\n            allowedTags: sanitizeConfig.allowedTags,\n            allowedAttributes: sanitizeConfig.allowedAttributes,\n            allowedClasses: sanitizeConfig.allowedClasses,\n        });\n    };\n\n    Posts.configureSanitize = async () => {\n        // Each allowed tags should have some common global attributes...\n        sanitizeConfig.allowedTags.forEach((tag) => {\n            sanitizeConfig.allowedAttributes[tag] = _.union(\n                sanitizeConfig.allowedAttributes[tag],\n                sanitizeConfig.globalAttributes\n            );\n        });\n\n        // Some plugins might need to adjust or whitelist their own tags...\n        sanitizeConfig = await plugins.hooks.fire('filter:sanitize.config', sanitizeConfig);\n    };\n\n    Posts.registerHooks = () => {\n        plugins.hooks.register('core', {\n            hook: 'filter:parse.post',\n            method: async (data) => {\n                data.postData.content = Posts.sanitize(data.postData.content);\n                return data;\n            },\n        });\n\n        plugins.hooks.register('core', {\n            hook: 'filter:parse.raw',\n            method: async content => Posts.sanitize(content),\n        });\n\n        plugins.hooks.register('core', {\n            hook: 'filter:parse.aboutme',\n            method: async content => Posts.sanitize(content),\n        });\n\n        plugins.hooks.register('core', {\n            hook: 'filter:parse.signature',\n            method: async (data) => {\n                data.userData.signature = Posts.sanitize(data.userData.signature);\n                return data;\n            },\n        });\n    };\n\n    function sanitizeSignature(signature) {\n        signature = translator.escape(signature);\n        const tagsToStrip = [];\n\n        if (meta.config['signatures:disableLinks']) {\n            tagsToStrip.push('a');\n        }\n\n        if (meta.config['signatures:disableImages']) {\n            tagsToStrip.push('img');\n        }\n\n        return utils.stripHTMLTags(signature, tagsToStrip);\n    }\n};\n"},"src/posts/queue.js":{"language":"javascript","mutants":[{"id":"1123","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":367},"start":{"column":35,"line":20}}},{"id":"1125","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":22},"start":{"column":19,"line":22}}},{"id":"1128","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":24},"start":{"column":13,"line":24}}},{"id":"1126","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":22},"start":{"column":31,"line":22}}},{"id":"1127","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":23},"start":{"column":46,"line":23}}},{"id":"1129","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":24},"start":{"column":13,"line":24}}},{"id":"1130","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":24},"start":{"column":13,"line":24}}},{"id":"1131","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":44},"start":{"column":24,"line":24}}},{"id":"1134","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":26},"start":{"column":34,"line":26}}},{"id":"1132","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":25},"start":{"column":52,"line":25}}},{"id":"1133","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":25},"start":{"column":69,"line":25}}},{"id":"1124","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":64},"start":{"column":65,"line":21}}},{"id":"1136","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":33},"start":{"column":40,"line":28}}},{"id":"1137","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":29},"start":{"column":21,"line":29}}},{"id":"1140","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":34},"start":{"column":39,"line":34}}},{"id":"1139","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":32},"start":{"column":27,"line":29}}},{"id":"1138","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":29},"start":{"column":21,"line":29}}},{"id":"1141","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":34},"start":{"column":47,"line":34}}},{"id":"1142","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":34},"start":{"column":47,"line":34}}},{"id":"1143","mutatorName":"LogicalOperator","replacement":"data || data.uid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":34},"start":{"column":47,"line":34}}},{"id":"1145","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":35},"start":{"column":63,"line":35}}},{"id":"1144","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":97,"line":35},"start":{"column":62,"line":35}}},{"id":"1146","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":35},"start":{"column":75,"line":35}}},{"id":"1135","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":58,"line":26},"start":{"column":40,"line":26}}},{"id":"1148","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":42},"start":{"column":51,"line":36}}},{"id":"1149","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":37},"start":{"column":21,"line":37}}},{"id":"1150","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":37},"start":{"column":21,"line":37}}},{"id":"1152","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":40},"start":{"column":67,"line":40}}},{"id":"1151","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":41},"start":{"column":31,"line":37}}},{"id":"1153","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":40},"start":{"column":67,"line":40}}},{"id":"1154","mutatorName":"LogicalOperator","replacement":"postData.data.title && ''","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":40},"start":{"column":67,"line":40}}},{"id":"1155","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":40},"start":{"column":90,"line":40}}},{"id":"1157","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":45},"start":{"column":13,"line":45}}},{"id":"1156","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":43},"start":{"column":23,"line":43}}},{"id":"1158","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":45},"start":{"column":13,"line":45}}},{"id":"1159","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":47},"start":{"column":24,"line":45}}},{"id":"1160","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":46},"start":{"column":24,"line":46}}},{"id":"1161","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":46},"start":{"column":40,"line":46}}},{"id":"1163","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":46},"start":{"column":45,"line":46}}},{"id":"1162","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":46},"start":{"column":45,"line":46}}},{"id":"1164","mutatorName":"EqualityOperator","replacement":"p.id !== filter.id","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":46},"start":{"column":45,"line":46}}},{"id":"1165","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":48},"start":{"column":13,"line":48}}},{"id":"1166","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":48},"start":{"column":13,"line":48}}},{"id":"1168","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":49},"start":{"column":44,"line":49}}},{"id":"1167","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":50},"start":{"column":31,"line":48}}},{"id":"1169","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":53},"start":{"column":13,"line":53}}},{"id":"1170","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":53},"start":{"column":13,"line":53}}},{"id":"1171","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":56},"start":{"column":41,"line":53}}},{"id":"1172","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":55},"start":{"column":24,"line":55}}},{"id":"1174","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":48,"line":55}}},{"id":"1173","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":40,"line":55}}},{"id":"1175","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":48,"line":55}}},{"id":"1176","mutatorName":"LogicalOperator","replacement":"item.data.tid || parseInt(item.data.tid, 10) === tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":48,"line":55}}},{"id":"1177","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":65,"line":55}}},{"id":"1178","mutatorName":"EqualityOperator","replacement":"parseInt(item.data.tid, 10) !== tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":55},"start":{"column":65,"line":55}}},{"id":"1179","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":56},"start":{"column":20,"line":56}}},{"id":"1180","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":56},"start":{"column":20,"line":56}}},{"id":"1181","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":61},"start":{"column":47,"line":56}}},{"id":"1182","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":57},"start":{"column":41,"line":57}}},{"id":"1183","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":60},"start":{"column":24,"line":58}}},{"id":"1184","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":59},"start":{"column":17,"line":59}}},{"id":"1185","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":59},"start":{"column":25,"line":59}}},{"id":"1186","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":59},"start":{"column":25,"line":59}}},{"id":"1187","mutatorName":"LogicalOperator","replacement":"item.data.tid || tids.includes(parseInt(item.data.tid, 10))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":59},"start":{"column":25,"line":59}}},{"id":"1188","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":79},"start":{"column":42,"line":66}}},{"id":"1147","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":96,"line":35},"start":{"column":87,"line":35}}},{"id":"1190","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":67},"start":{"column":13,"line":67}}},{"id":"1192","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":69},"start":{"column":24,"line":67}}},{"id":"1191","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":67},"start":{"column":13,"line":67}}},{"id":"1193","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":70},"start":{"column":26,"line":70}}},{"id":"1194","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":71},"start":{"column":13,"line":71}}},{"id":"1195","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":71},"start":{"column":13,"line":71}}},{"id":"1196","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":73},"start":{"column":32,"line":71}}},{"id":"1198","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":73},"start":{"column":20,"line":73}}},{"id":"1197","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":72},"start":{"column":30,"line":72}}},{"id":"1199","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":73},"start":{"column":20,"line":73}}},{"id":"1189","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":22,"line":67},"start":{"column":13,"line":67}}},{"id":"1201","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":74},"start":{"column":77,"line":74}}},{"id":"1202","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":74},"start":{"column":78,"line":74}}},{"id":"1204","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":77},"start":{"column":49,"line":77}}},{"id":"1203","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":74},"start":{"column":87,"line":74}}},{"id":"1205","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":97,"line":77},"start":{"column":70,"line":77}}},{"id":"1206","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":98},"start":{"column":52,"line":81}}},{"id":"1207","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":86},"start":{"column":86,"line":82}}},{"id":"1208","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":83},"start":{"column":37,"line":83}}},{"id":"1200","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":75},"start":{"column":39,"line":73}}},{"id":"1209","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":83},"start":{"column":38,"line":83}}},{"id":"1211","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":83},"start":{"column":59,"line":83}}},{"id":"1212","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":91},"start":{"column":29,"line":88}}},{"id":"1213","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":91},"start":{"column":29,"line":88}}},{"id":"1214","mutatorName":"LogicalOperator","replacement":"meta.config.postQueue && categoryQueueEnabled && !isMemberOfExempt || !userData.uid || userData.reputation <"+" meta.config.postQueueReputationThreshold || userData.postcount <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":91},"start":{"column":29,"line":88}}},{"id":"1215","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":89},"start":{"column":29,"line":88}}},{"id":"1216","mutatorName":"LogicalOperator","replacement":"meta.config.postQueue && categoryQueueEnabled || !isMemberOfExempt","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":89},"start":{"column":29,"line":88}}},{"id":"1218","mutatorName":"LogicalOperator","replacement":"meta.config.postQueue || categoryQueueEnabled","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":88},"start":{"column":29,"line":88}}},{"id":"1217","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":88},"start":{"column":29,"line":88}}},{"id":"1210","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":57,"line":83},"start":{"column":45,"line":83}}},{"id":"1221","mutatorName":"LogicalOperator","replacement":"(!userData.uid || userData.reputation <"+" meta.config.postQueueReputationThreshold) && userData.postcount <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":91},"start":{"column":14,"line":90}}},{"id":"1220","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":91},"start":{"column":14,"line":90}}},{"id":"1222","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":90},"start":{"column":14,"line":90}}},{"id":"1223","mutatorName":"LogicalOperator","replacement":"!userData.uid && userData.reputation <"+" meta.config.postQueueReputationThreshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":90},"start":{"column":14,"line":90}}},{"id":"1224","mutatorName":"BooleanLiteral","replacement":"userData.uid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":90},"start":{"column":14,"line":90}}},{"id":"1225","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":90},"start":{"column":31,"line":90}}},{"id":"1226","mutatorName":"EqualityOperator","replacement":"userData.reputation <"+"= meta.config.postQueueReputationThreshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":90},"start":{"column":31,"line":90}}},{"id":"1227","mutatorName":"EqualityOperator","replacement":"userData.reputation >= meta.config.postQueueReputationThreshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":90},"start":{"column":31,"line":90}}},{"id":"1228","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":91},"start":{"column":17,"line":91}}},{"id":"1230","mutatorName":"EqualityOperator","replacement":"userData.postcount > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":91},"start":{"column":17,"line":91}}},{"id":"1229","mutatorName":"EqualityOperator","replacement":"userData.postcount <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":91},"start":{"column":17,"line":91}}},{"id":"1219","mutatorName":"BooleanLiteral","replacement":"isMemberOfExempt","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":30,"line":89},"start":{"column":13,"line":89}}},{"id":"1233","mutatorName":"BooleanLiteral","replacement":"!shouldQueue","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":93},"start":{"column":26,"line":93}}},{"id":"1232","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":96},"start":{"column":76,"line":92}}},{"id":"1234","mutatorName":"BooleanLiteral","replacement":"shouldQueue","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":93},"start":{"column":27,"line":93}}},{"id":"1235","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":107},"start":{"column":49,"line":100}}},{"id":"1236","mutatorName":"BooleanLiteral","replacement":"cid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":103},"start":{"column":13,"line":103}}},{"id":"1237","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":103},"start":{"column":13,"line":103}}},{"id":"1238","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":103},"start":{"column":13,"line":103}}},{"id":"1239","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":105},"start":{"column":19,"line":103}}},{"id":"1240","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":104},"start":{"column":29,"line":104}}},{"id":"1241","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":106},"start":{"column":55,"line":106}}},{"id":"1242","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":116},"start":{"column":28,"line":109}}},{"id":"1231","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":74,"line":92},"start":{"column":49,"line":92}}},{"id":"1245","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":110},"start":{"column":33,"line":110}}},{"id":"1244","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":110},"start":{"column":13,"line":110}}},{"id":"1246","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":112},"start":{"column":41,"line":110}}},{"id":"1247","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":111},"start":{"column":20,"line":111}}},{"id":"1248","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":112},"start":{"column":20,"line":112}}},{"id":"1249","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":112},"start":{"column":20,"line":112}}},{"id":"1250","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":112},"start":{"column":40,"line":112}}},{"id":"1251","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":114},"start":{"column":48,"line":112}}},{"id":"1252","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":113},"start":{"column":20,"line":113}}},{"id":"1253","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":115},"start":{"column":25,"line":115}}},{"id":"1254","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":127},"start":{"column":48,"line":118}}},{"id":"1255","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":119},"start":{"column":37,"line":119}}},{"id":"1256","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":121},"start":{"column":13,"line":121}}},{"id":"1258","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":121},"start":{"column":13,"line":121}}},{"id":"1257","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":121},"start":{"column":13,"line":121}}},{"id":"1259","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":123},"start":{"column":20,"line":121}}},{"id":"1261","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":135},"start":{"column":45,"line":129}}},{"id":"1260","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":126},"start":{"column":22,"line":126}}},{"id":"1262","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":133},"start":{"column":43,"line":130}}},{"id":"1263","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":131},"start":{"column":39,"line":131}}},{"id":"1264","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":131},"start":{"column":40,"line":131}}},{"id":"1265","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":131},"start":{"column":58,"line":131}}},{"id":"1266","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":132},"start":{"column":41,"line":132}}},{"id":"1267","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":176},"start":{"column":46,"line":137}}},{"id":"1268","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":140},"start":{"column":20,"line":140}}},{"id":"1270","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":149},"start":{"column":44,"line":149}}},{"id":"1269","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":148},"start":{"column":23,"line":143}}},{"id":"1271","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":152},"start":{"column":31,"line":152}}},{"id":"1273","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":154},"start":{"column":43,"line":154}}},{"id":"1272","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":153},"start":{"column":28,"line":153}}},{"id":"1274","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":155},"start":{"column":19,"line":155}}},{"id":"1276","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":162},"start":{"column":19,"line":162}}},{"id":"1275","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":168},"start":{"column":53,"line":161}}},{"id":"1277","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":163},"start":{"column":18,"line":163}}},{"id":"1279","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":165},"start":{"column":24,"line":165}}},{"id":"1278","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":164},"start":{"column":22,"line":164}}},{"id":"1280","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":167},"start":{"column":19,"line":167}}},{"id":"1281","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":175},"start":{"column":16,"line":170}}},{"id":"1282","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":173},"start":{"column":21,"line":173}}},{"id":"1283","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":174},"start":{"column":22,"line":174}}},{"id":"1243","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":39,"line":110},"start":{"column":13,"line":110}}},{"id":"1285","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":179},"start":{"column":31,"line":179}}},{"id":"1287","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":181},"start":{"column":32,"line":181}}},{"id":"1286","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":184},"start":{"column":65,"line":180}}},{"id":"1288","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":182},"start":{"column":47,"line":182}}},{"id":"1289","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":182},"start":{"column":48,"line":182}}},{"id":"1290","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":182},"start":{"column":56,"line":182}}},{"id":"1291","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":183},"start":{"column":42,"line":183}}},{"id":"1284","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":203},"start":{"column":51,"line":178}}},{"id":"1292","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":183},"start":{"column":43,"line":183}}},{"id":"1294","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":186},"start":{"column":24,"line":186}}},{"id":"1295","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":187},"start":{"column":13,"line":187}}},{"id":"1296","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":187},"start":{"column":13,"line":187}}},{"id":"1297","mutatorName":"EqualityOperator","replacement":"userData.uid >= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":187},"start":{"column":13,"line":187}}},{"id":"1298","mutatorName":"EqualityOperator","replacement":"userData.uid <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":187},"start":{"column":13,"line":187}}},{"id":"1300","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":188},"start":{"column":28,"line":188}}},{"id":"1299","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":189},"start":{"column":31,"line":187}}},{"id":"1301","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":191},"start":{"column":23,"line":191}}},{"id":"1302","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":192},"start":{"column":13,"line":192}}},{"id":"1303","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":192},"start":{"column":13,"line":192}}},{"id":"1304","mutatorName":"EqualityOperator","replacement":"type !== 'reply'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":192},"start":{"column":13,"line":192}}},{"id":"1305","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":192},"start":{"column":22,"line":192}}},{"id":"1306","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":195},"start":{"column":31,"line":192}}},{"id":"1307","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":193},"start":{"column":64,"line":193}}},{"id":"1308","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":194},"start":{"column":25,"line":194}}},{"id":"1309","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":197},"start":{"column":38,"line":197}}},{"id":"1312","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":206},"start":{"column":13,"line":206}}},{"id":"1310","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":202},"start":{"column":73,"line":197}}},{"id":"1313","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":206},"start":{"column":13,"line":206}}},{"id":"1311","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":212},"start":{"column":39,"line":205}}},{"id":"1314","mutatorName":"EqualityOperator","replacement":"type !== 'topic'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":206},"start":{"column":13,"line":206}}},{"id":"1315","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":206},"start":{"column":22,"line":206}}},{"id":"1316","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":208},"start":{"column":31,"line":206}}},{"id":"1319","mutatorName":"EqualityOperator","replacement":"type !== 'reply'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":208},"start":{"column":20,"line":208}}},{"id":"1318","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":208},"start":{"column":20,"line":208}}},{"id":"1317","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":208},"start":{"column":20,"line":208}}},{"id":"1320","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":208},"start":{"column":29,"line":208}}},{"id":"1321","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":210},"start":{"column":38,"line":208}}},{"id":"1323","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":236},"start":{"column":40,"line":214}}},{"id":"1322","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":209},"start":{"column":57,"line":209}}},{"id":"1324","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":219},"start":{"column":33,"line":216}}},{"id":"1325","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":217},"start":{"column":20,"line":217}}},{"id":"1326","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":218},"start":{"column":20,"line":218}}},{"id":"1327","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":222},"start":{"column":13,"line":222}}},{"id":"1328","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":222},"start":{"column":13,"line":222}}},{"id":"1330","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":222},"start":{"column":22,"line":222}}},{"id":"1331","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":227},"start":{"column":31,"line":222}}},{"id":"1329","mutatorName":"EqualityOperator","replacement":"type !== 'topic'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":222},"start":{"column":13,"line":222}}},{"id":"1332","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":224},"start":{"column":17,"line":224}}},{"id":"1333","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":224},"start":{"column":17,"line":224}}},{"id":"1293","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":60,"line":183},"start":{"column":50,"line":183}}},{"id":"1336","mutatorName":"BooleanLiteral","replacement":"canPost","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":233},"start":{"column":13,"line":233}}},{"id":"1335","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":232},"start":{"column":45,"line":229}}},{"id":"1337","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":233},"start":{"column":13,"line":233}}},{"id":"1338","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":233},"start":{"column":13,"line":233}}},{"id":"1339","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":235},"start":{"column":23,"line":233}}},{"id":"1340","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":234},"start":{"column":29,"line":234}}},{"id":"1343","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":240},"start":{"column":13,"line":240}}},{"id":"1342","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":240},"start":{"column":13,"line":240}}},{"id":"1341","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":247},"start":{"column":49,"line":238}}},{"id":"1344","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":240},"start":{"column":13,"line":240}}},{"id":"1345","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":242},"start":{"column":20,"line":240}}},{"id":"1346","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":243},"start":{"column":49,"line":243}}},{"id":"1347","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":243},"start":{"column":86,"line":243}}},{"id":"1348","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":245},"start":{"column":28,"line":245}}},{"id":"1349","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":245},"start":{"column":65,"line":245}}},{"id":"1350","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":254},"start":{"column":40,"line":249}}},{"id":"1351","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":251},"start":{"column":34,"line":251}}},{"id":"1352","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":252},"start":{"column":25,"line":252}}},{"id":"1353","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":253},"start":{"column":19,"line":253}}},{"id":"1355","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":258},"start":{"column":13,"line":258}}},{"id":"1354","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":273},"start":{"column":49,"line":256}}},{"id":"1356","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":258},"start":{"column":13,"line":258}}},{"id":"1357","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":258},"start":{"column":13,"line":258}}},{"id":"1358","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":260},"start":{"column":20,"line":258}}},{"id":"1359","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":261},"start":{"column":49,"line":261}}},{"id":"1360","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":261},"start":{"column":86,"line":261}}},{"id":"1361","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":263},"start":{"column":13,"line":263}}},{"id":"1362","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":263},"start":{"column":13,"line":263}}},{"id":"1363","mutatorName":"EqualityOperator","replacement":"data.type !== 'topic'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":263},"start":{"column":13,"line":263}}},{"id":"1364","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":263},"start":{"column":27,"line":263}}},{"id":"1365","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":266},"start":{"column":36,"line":263}}},{"id":"1366","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":266},"start":{"column":20,"line":266}}},{"id":"1367","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":266},"start":{"column":20,"line":266}}},{"id":"1368","mutatorName":"EqualityOperator","replacement":"data.type !== 'reply'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":266},"start":{"column":20,"line":266}}},{"id":"1369","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":266},"start":{"column":34,"line":266}}},{"id":"1370","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":269},"start":{"column":43,"line":266}}},{"id":"1371","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":271},"start":{"column":28,"line":271}}},{"id":"1373","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":277},"start":{"column":46,"line":275}}},{"id":"1372","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":271},"start":{"column":65,"line":271}}},{"id":"1374","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":287},"start":{"column":40,"line":279}}},{"id":"1375","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":280},"start":{"column":41,"line":280}}},{"id":"1334","mutatorName":"BlockStatement","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":14,"line":226},"start":{"column":28,"line":224}}},{"id":"1376","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":281},"start":{"column":13,"line":281}}},{"id":"1379","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":283},"start":{"column":20,"line":281}}},{"id":"1378","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":281},"start":{"column":13,"line":281}}},{"id":"1380","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":285},"start":{"column":31,"line":285}}},{"id":"1381","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":293},"start":{"column":38,"line":289}}},{"id":"1383","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":108,"line":291},"start":{"column":55,"line":291}}},{"id":"1382","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":291},"start":{"column":43,"line":291}}},{"id":"1384","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":291},"start":{"column":64,"line":291}}},{"id":"1385","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":304},"start":{"column":38,"line":295}}},{"id":"1386","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":301},"start":{"column":24,"line":297}}},{"id":"1387","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":298},"start":{"column":20,"line":298}}},{"id":"1377","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":18,"line":281},"start":{"column":13,"line":281}}},{"id":"1389","mutatorName":"BooleanLiteral","replacement":"meta.config['reputation:disabled']","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":299},"start":{"column":37,"line":299}}},{"id":"1391","mutatorName":"BooleanLiteral","replacement":"!meta.config['downvote:disabled']","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":300},"start":{"column":34,"line":300}}},{"id":"1390","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":299},"start":{"column":50,"line":299}}},{"id":"1393","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":300},"start":{"column":48,"line":300}}},{"id":"1392","mutatorName":"BooleanLiteral","replacement":"meta.config['downvote:disabled']","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":300},"start":{"column":35,"line":300}}},{"id":"1394","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":302},"start":{"column":43,"line":302}}},{"id":"1395","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":326},"start":{"column":62,"line":306}}},{"id":"1396","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":307},"start":{"column":70,"line":307}}},{"id":"1397","mutatorName":"BooleanLiteral","replacement":"canEditQueue","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":308},"start":{"column":13,"line":308}}},{"id":"1388","mutatorName":"BooleanLiteral","replacement":"!meta.config['reputation:disabled']","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":72,"line":299},"start":{"column":36,"line":299}}},{"id":"1399","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":308},"start":{"column":13,"line":308}}},{"id":"1400","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":310},"start":{"column":28,"line":308}}},{"id":"1401","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":309},"start":{"column":29,"line":309}}},{"id":"1402","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":312},"start":{"column":13,"line":312}}},{"id":"1403","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":312},"start":{"column":13,"line":312}}},{"id":"1404","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":312},"start":{"column":13,"line":312}}},{"id":"1405","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":314},"start":{"column":20,"line":312}}},{"id":"1406","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":315},"start":{"column":13,"line":315}}},{"id":"1407","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":315},"start":{"column":13,"line":315}}},{"id":"1408","mutatorName":"EqualityOperator","replacement":"editData.content === undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":315},"start":{"column":13,"line":315}}},{"id":"1398","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":26,"line":308},"start":{"column":13,"line":308}}},{"id":"1410","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":318},"start":{"column":13,"line":318}}},{"id":"1411","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":318},"start":{"column":13,"line":318}}},{"id":"1412","mutatorName":"EqualityOperator","replacement":"editData.title === undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":318},"start":{"column":13,"line":318}}},{"id":"1413","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":320},"start":{"column":43,"line":318}}},{"id":"1415","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":321},"start":{"column":13,"line":321}}},{"id":"1414","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":321},"start":{"column":13,"line":321}}},{"id":"1416","mutatorName":"EqualityOperator","replacement":"editData.cid === undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":321},"start":{"column":13,"line":321}}},{"id":"1418","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":324},"start":{"column":33,"line":324}}},{"id":"1417","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":323},"start":{"column":41,"line":321}}},{"id":"1409","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":317},"start":{"column":45,"line":315}}},{"id":"1420","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":325},"start":{"column":19,"line":325}}},{"id":"1421","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":353},"start":{"column":65,"line":328}}},{"id":"1422","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":332},"start":{"column":62,"line":329}}},{"id":"1423","mutatorName":"BooleanLiteral","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":333},"start":{"column":13,"line":333}}},{"id":"1424","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":333},"start":{"column":13,"line":333}}},{"id":"1425","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":333},"start":{"column":13,"line":333}}},{"id":"1426","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":335},"start":{"column":20,"line":333}}},{"id":"1427","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":334},"start":{"column":20,"line":334}}},{"id":"1428","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":336},"start":{"column":26,"line":336}}},{"id":"1419","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":68,"line":324},"start":{"column":62,"line":324}}},{"id":"1430","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) !== parseInt(data.uid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":336},"start":{"column":26,"line":336}}},{"id":"1431","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":337},"start":{"column":13,"line":337}}},{"id":"1433","mutatorName":"LogicalOperator","replacement":"isAdminOrGlobalMod && (action === 'reject' || action === 'edit') && selfPost","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":337},"start":{"column":13,"line":337}}},{"id":"1432","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":337},"start":{"column":13,"line":337}}},{"id":"1434","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":337},"start":{"column":36,"line":337}}},{"id":"1435","mutatorName":"LogicalOperator","replacement":"action === 'reject' || action === 'edit' || selfPost","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":337},"start":{"column":36,"line":337}}},{"id":"1436","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":337},"start":{"column":37,"line":337}}},{"id":"1437","mutatorName":"LogicalOperator","replacement":"action === 'reject' && action === 'edit'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":337},"start":{"column":37,"line":337}}},{"id":"1438","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":337},"start":{"column":37,"line":337}}},{"id":"1439","mutatorName":"EqualityOperator","replacement":"action !== 'reject'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":337},"start":{"column":37,"line":337}}},{"id":"1440","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":337},"start":{"column":48,"line":337}}},{"id":"1429","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":70,"line":336},"start":{"column":26,"line":336}}},{"id":"1442","mutatorName":"EqualityOperator","replacement":"action !== 'edit'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":337},"start":{"column":60,"line":337}}},{"id":"1443","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":337},"start":{"column":71,"line":337}}},{"id":"1445","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":338},"start":{"column":20,"line":338}}},{"id":"1444","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":339},"start":{"column":93,"line":337}}},{"id":"1446","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":342},"start":{"column":13,"line":342}}},{"id":"1447","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":342},"start":{"column":13,"line":342}}},{"id":"1448","mutatorName":"EqualityOperator","replacement":"data.type !== 'topic'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":342},"start":{"column":13,"line":342}}},{"id":"1449","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":342},"start":{"column":27,"line":342}}},{"id":"1450","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":344},"start":{"column":36,"line":342}}},{"id":"1451","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":344},"start":{"column":20,"line":344}}},{"id":"1452","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":344},"start":{"column":20,"line":344}}},{"id":"1453","mutatorName":"EqualityOperator","replacement":"data.type !== 'reply'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":344},"start":{"column":20,"line":344}}},{"id":"1454","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":344},"start":{"column":34,"line":344}}},{"id":"1455","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":346},"start":{"column":43,"line":344}}},{"id":"1456","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":345},"start":{"column":61,"line":345}}},{"id":"1457","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":348},"start":{"column":38,"line":348}}},{"id":"1458","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":349},"start":{"column":13,"line":349}}},{"id":"1459","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":349},"start":{"column":13,"line":349}}},{"id":"1460","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":351},"start":{"column":27,"line":349}}},{"id":"1461","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":352},"start":{"column":16,"line":352}}},{"id":"1463","mutatorName":"LogicalOperator","replacement":"isModerator || isModeratorOfTargetCid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":352},"start":{"column":16,"line":352}}},{"id":"1462","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":352},"start":{"column":16,"line":352}}},{"id":"1465","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":356},"start":{"column":53,"line":356}}},{"id":"1464","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":366},"start":{"column":66,"line":355}}},{"id":"1466","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":356},"start":{"column":68,"line":356}}},{"id":"1467","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":356},"start":{"column":80,"line":356}}},{"id":"1468","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":357},"start":{"column":13,"line":357}}},{"id":"1469","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":357},"start":{"column":13,"line":357}}},{"id":"1470","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":365},"start":{"column":30,"line":357}}},{"id":"1471","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":360},"start":{"column":40,"line":358}}},{"id":"1472","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":362},"start":{"column":30,"line":362}}},{"id":"1473","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":362},"start":{"column":35,"line":362}}},{"id":"1475","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":362},"start":{"column":58,"line":362}}},{"id":"1474","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":362},"start":{"column":36,"line":362}}},{"id":"1476","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":364},"start":{"column":23,"line":364}}},{"id":"1441","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":77,"line":337},"start":{"column":60,"line":337}}}],"source":"'use strict';\n\nconst _ = require('lodash');\nconst validator = require('validator');\nconst nconf = require('nconf');\n\nconst db = require('../database');\nconst user = require('../user');\nconst meta = require('../meta');\nconst groups = require('../groups');\nconst topics = require('../topics');\nconst categories = require('../categories');\nconst notifications = require('../notifications');\nconst privileges = require('../privileges');\nconst plugins = require('../plugins');\nconst utils = require('../utils');\nconst cache = require('../cache');\nconst socketHelpers = require('../socket.io/helpers');\n\nmodule.exports = function (Posts) {\n    Posts.getQueuedPosts = async (filter = {}, options = {}) => {\n        options = { metadata: true, ...options }; // defaults\n        let postData = _.cloneDeep(cache.get('post-queue'));\n        if (!postData) {\n            const ids = await db.getSortedSetRange('post:queue', 0, -1);\n            const keys = ids.map(id => `post:queue:${id}`);\n            postData = await db.getObjects(keys);\n            postData.forEach((data) => {\n                if (data) {\n                    data.data = JSON.parse(data.data);\n                    data.data.timestampISO = utils.toISOString(data.data.timestamp);\n                }\n            });\n            const uids = postData.map(data => data && data.uid);\n            const userData = await user.getUsersFields(uids, ['username', 'userslug', 'picture']);\n            postData.forEach((postData, index) => {\n                if (postData) {\n                    postData.user = userData[index];\n                    postData.data.rawContent = validator.escape(String(postData.data.content));\n                    postData.data.title = validator.escape(String(postData.data.title || ''));\n                }\n            });\n            cache.set('post-queue', _.cloneDeep(postData));\n        }\n        if (filter.id) {\n            postData = postData.filter(p => p.id === filter.id);\n        }\n        if (options.metadata) {\n            await Promise.all(postData.map(p => addMetaData(p)));\n        }\n\n        // Filter by tid if present\n        if (utils.isNumber(filter.tid)) {\n            const tid = parseInt(filter.tid, 10);\n            postData = postData.filter(item => item.data.tid && parseInt(item.data.tid, 10) === tid);\n        } else if (Array.isArray(filter.tid)) {\n            const tids = filter.tid.map(tid => parseInt(tid, 10));\n            postData = postData.filter(\n                item => item.data.tid && tids.includes(parseInt(item.data.tid, 10))\n            );\n        }\n\n        return postData;\n    };\n\n    async function addMetaData(postData) {\n        if (!postData) {\n            return;\n        }\n        postData.topic = { cid: 0 };\n        if (postData.data.cid) {\n            postData.topic = { cid: parseInt(postData.data.cid, 10) };\n        } else if (postData.data.tid) {\n            postData.topic = await topics.getTopicFields(postData.data.tid, ['title', 'cid']);\n        }\n        postData.category = await categories.getCategoryData(postData.topic.cid);\n        const result = await plugins.hooks.fire('filter:parse.post', { postData: postData.data });\n        postData.data.content = result.postData.content;\n    }\n\n    Posts.shouldQueue = async function (uid, data) {\n        const [userData, isMemberOfExempt, categoryQueueEnabled] = await Promise.all([\n            user.getUserFields(uid, ['uid', 'reputation', 'postcount']),\n            groups.isMemberOfAny(uid, meta.config.groupsExemptFromPostQueue),\n            isCategoryQueueEnabled(data),\n        ]);\n\n        const shouldQueue = meta.config.postQueue && categoryQueueEnabled &&\n            !isMemberOfExempt &&\n            (!userData.uid || userData.reputation <"+" meta.config.postQueueReputationThreshold ||\n                userData.postcount <"+"= 0);\n        const result = await plugins.hooks.fire('filter:post.shouldQueue', {\n            shouldQueue: !!shouldQueue,\n            uid: uid,\n            data: data,\n        });\n        return result.shouldQueue;\n    };\n\n    async function isCategoryQueueEnabled(data) {\n        const type = getType(data);\n        const cid = await getCid(type, data);\n        if (!cid) {\n            throw new Error('[[error:invalid-cid]]');\n        }\n        return await categories.getCategoryField(cid, 'postQueue');\n    }\n\n    function getType(data) {\n        if (data.hasOwnProperty('tid')) {\n            return 'reply';\n        } else if (data.hasOwnProperty('cid')) {\n            return 'topic';\n        }\n        throw new Error('[[error:invalid-type]]');\n    }\n\n    async function removeQueueNotification(id) {\n        await notifications.rescind(`post-queue-${id}`);\n        const data = await getParsedObject(id);\n        if (!data) {\n            return;\n        }\n        const cid = await getCid(data.type, data);\n        const uids = await getNotificationUids(cid);\n        uids.forEach(uid => user.notifications.pushCount(uid));\n    }\n\n    async function getNotificationUids(cid) {\n        const results = await Promise.all([\n            groups.getMembersOfGroups(['administrators', 'Global Moderators']),\n            categories.getModeratorUids([cid]),\n        ]);\n        return _.uniq(_.flattenDeep(results));\n    }\n\n    Posts.addToQueue = async function (data) {\n        const type = getType(data);\n        const now = Date.now();\n        const id = `${type}-${now}`;\n        await canPost(type, data);\n\n        let payload = {\n            id: id,\n            uid: data.uid,\n            type: type,\n            data: data,\n        };\n        payload = await plugins.hooks.fire('filter:post-queue.save', payload);\n        payload.data = JSON.stringify(data);\n\n        await db.sortedSetAdd('post:queue', now, id);\n        await db.setObject(`post:queue:${id}`, payload);\n        await user.setUserField(data.uid, 'lastqueuetime', now);\n        cache.del('post-queue');\n\n        const cid = await getCid(type, data);\n        const uids = await getNotificationUids(cid);\n        const bodyLong = await parseBodyLong(cid, type, data);\n\n        const notifObj = await notifications.create({\n            type: 'post-queue',\n            nid: `post-queue-${id}`,\n            mergeId: 'post-queue',\n            bodyShort: '[[notifications:post_awaiting_review]]',\n            bodyLong: bodyLong,\n            path: `/post-queue/${id}`,\n        });\n        await notifications.push(notifObj, uids);\n        return {\n            id: id,\n            type: type,\n            queued: true,\n            message: '[[success:post-queued]]',\n        };\n    };\n\n    async function parseBodyLong(cid, type, data) {\n        const url = nconf.get('url');\n        const [content, category, userData] = await Promise.all([\n            plugins.hooks.fire('filter:parse.raw', data.content),\n            categories.getCategoryFields(cid, ['name', 'slug']),\n            user.getUserFields(data.uid, ['uid', 'username']),\n        ]);\n\n        category.url = `${url}/category/${category.slug}`;\n        if (userData.uid > 0) {\n            userData.url = `${url}/uid/${userData.uid}`;\n        }\n\n        const topic = { cid: cid, title: data.title, tid: data.tid };\n        if (type === 'reply') {\n            topic.title = await topics.getTopicField(data.tid, 'title');\n            topic.url = `${url}/topic/${data.tid}`;\n        }\n        const { app } = require('../webserver');\n        return await app.renderAsync('emails/partials/post-queue-body', {\n            content: content,\n            category: category,\n            user: userData,\n            topic: topic,\n        });\n    }\n\n    async function getCid(type, data) {\n        if (type === 'topic') {\n            return data.cid;\n        } else if (type === 'reply') {\n            return await topics.getTopicField(data.tid, 'cid');\n        }\n        return null;\n    }\n\n    async function canPost(type, data) {\n        const cid = await getCid(type, data);\n        const typeToPrivilege = {\n            topic: 'topics:create',\n            reply: 'topics:reply',\n        };\n\n        topics.checkContent(data.content);\n        if (type === 'topic') {\n            topics.checkTitle(data.title);\n            if (data.tags) {\n                await topics.validateTags(data.tags, cid, data.uid);\n            }\n        }\n\n        const [canPost] = await Promise.all([\n            privileges.categories.can(typeToPrivilege[type], cid, data.uid),\n            user.isReadyToQueue(data.uid, cid),\n        ]);\n        if (!canPost) {\n            throw new Error('[[error:no-privileges]]');\n        }\n    }\n\n    Posts.removeFromQueue = async function (id) {\n        const data = await getParsedObject(id);\n        if (!data) {\n            return null;\n        }\n        const result = await plugins.hooks.fire('filter:post-queue:removeFromQueue', { data: data });\n        await removeFromQueue(id);\n        plugins.hooks.fire('action:post-queue:removeFromQueue', { data: result.data });\n        return result.data;\n    };\n\n    async function removeFromQueue(id) {\n        await removeQueueNotification(id);\n        await db.sortedSetRemove('post:queue', id);\n        await db.delete(`post:queue:${id}`);\n        cache.del('post-queue');\n    }\n\n    Posts.submitFromQueue = async function (id) {\n        let data = await getParsedObject(id);\n        if (!data) {\n            return null;\n        }\n        const result = await plugins.hooks.fire('filter:post-queue:submitFromQueue', { data: data });\n        data = result.data;\n        if (data.type === 'topic') {\n            const result = await createTopic(data.data);\n            data.pid = result.postData.pid;\n        } else if (data.type === 'reply') {\n            const result = await createReply(data.data);\n            data.pid = result.pid;\n        }\n        await removeFromQueue(id);\n        plugins.hooks.fire('action:post-queue:submitFromQueue', { data: data });\n        return data;\n    };\n\n    Posts.getFromQueue = async function (id) {\n        return await getParsedObject(id);\n    };\n\n    async function getParsedObject(id) {\n        const data = await db.getObject(`post:queue:${id}`);\n        if (!data) {\n            return null;\n        }\n        data.data = JSON.parse(data.data);\n        data.data.fromQueue = true;\n        return data;\n    }\n\n    async function createTopic(data) {\n        const result = await topics.post(data);\n        socketHelpers.notifyNew(data.uid, 'newTopic', { posts: [result.postData], topic: result.topicData });\n        return result;\n    }\n\n    async function createReply(data) {\n        const postData = await topics.reply(data);\n        const result = {\n            posts: [postData],\n            'reputation:disabled': !!meta.config['reputation:disabled'],\n            'downvote:disabled': !!meta.config['downvote:disabled'],\n        };\n        socketHelpers.notifyNew(data.uid, 'newPost', result);\n        return postData;\n    }\n\n    Posts.editQueuedContent = async function (uid, editData) {\n        const canEditQueue = await Posts.canEditQueue(uid, editData, 'edit');\n        if (!canEditQueue) {\n            throw new Error('[[error:no-privileges]]');\n        }\n        const data = await getParsedObject(editData.id);\n        if (!data) {\n            return;\n        }\n        if (editData.content !== undefined) {\n            data.data.content = editData.content;\n        }\n        if (editData.title !== undefined) {\n            data.data.title = editData.title;\n        }\n        if (editData.cid !== undefined) {\n            data.data.cid = editData.cid;\n        }\n        await db.setObjectField(`post:queue:${editData.id}`, 'data', JSON.stringify(data.data));\n        cache.del('post-queue');\n    };\n\n    Posts.canEditQueue = async function (uid, editData, action) {\n        const [isAdminOrGlobalMod, data] = await Promise.all([\n            user.isAdminOrGlobalMod(uid),\n            getParsedObject(editData.id),\n        ]);\n        if (!data) {\n            return false;\n        }\n        const selfPost = parseInt(uid, 10) === parseInt(data.uid, 10);\n        if (isAdminOrGlobalMod || ((action === 'reject' || action === 'edit') && selfPost)) {\n            return true;\n        }\n\n        let cid;\n        if (data.type === 'topic') {\n            cid = data.data.cid;\n        } else if (data.type === 'reply') {\n            cid = await topics.getTopicField(data.data.tid, 'cid');\n        }\n        const isModerator = await user.isModerator(uid, cid);\n        let isModeratorOfTargetCid = true;\n        if (editData.cid) {\n            isModeratorOfTargetCid = await user.isModerator(uid, editData.cid);\n        }\n        return isModerator && isModeratorOfTargetCid;\n    };\n\n    Posts.updateQueuedPostsTopic = async function (newTid, tids) {\n        const postData = await Posts.getQueuedPosts({ tid: tids }, { metadata: false });\n        if (postData.length) {\n            postData.forEach((post) => {\n                post.data.tid = newTid;\n            });\n            await db.setObjectBulk(\n                postData.map(p => [`post:queue:${p.id}`, { data: JSON.stringify(p.data) }]),\n            );\n            cache.del('post-queue');\n        }\n    };\n};\n"},"src/posts/recent.js":{"language":"javascript","mutants":[{"id":"1477","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":33},"start":{"column":35,"line":9}}},{"id":"1478","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":14},"start":{"column":19,"line":10}}},{"id":"1479","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":26},"start":{"column":68,"line":16}}},{"id":"1481","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":18},"start":{"column":13,"line":18}}},{"id":"1480","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":18},"start":{"column":13,"line":18}}},{"id":"1483","mutatorName":"ArithmeticOperator","replacement":"Date.now() + terms[term]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":19},"start":{"column":19,"line":19}}},{"id":"1482","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":20},"start":{"column":26,"line":18}}},{"id":"1485","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":22},"start":{"column":23,"line":22}}},{"id":"1486","mutatorName":"EqualityOperator","replacement":"parseInt(stop, 10) !== -1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":22},"start":{"column":23,"line":22}}},{"id":"1487","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":22},"start":{"column":46,"line":22}}},{"id":"1489","mutatorName":"ArithmeticOperator","replacement":"stop + start","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":22},"start":{"column":58,"line":22}}},{"id":"1488","mutatorName":"ArithmeticOperator","replacement":"stop - start - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":22},"start":{"column":58,"line":22}}},{"id":"1490","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":23},"start":{"column":57,"line":23}}},{"id":"1491","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":23},"start":{"column":84,"line":23}}},{"id":"1493","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":24},"start":{"column":46,"line":24}}},{"id":"1492","mutatorName":"MethodExpression","replacement":"privileges.posts","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":24},"start":{"column":22,"line":24}}},{"id":"1484","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":48,"line":22},"start":{"column":23,"line":22}}},{"id":"1495","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":25},"start":{"column":73,"line":25}}},{"id":"1496","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":32},"start":{"column":62,"line":28}}},{"id":"1497","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":29},"start":{"column":52,"line":29}}},{"id":"1498","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":30},"start":{"column":59,"line":30}}},{"id":"1499","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":30},"start":{"column":60,"line":30}}},{"id":"1500","mutatorName":"MethodExpression","replacement":"postData.map(p => p && p.uid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":31},"start":{"column":23,"line":31}}},{"id":"1501","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":31},"start":{"column":36,"line":31}}},{"id":"1502","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":31},"start":{"column":41,"line":31}}},{"id":"1503","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":31},"start":{"column":41,"line":31}}},{"id":"1494","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":79,"line":25},"start":{"column":60,"line":25}}},{"id":"1505","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":31},"start":{"column":60,"line":31}}},{"id":"1504","mutatorName":"LogicalOperator","replacement":"p || p.uid","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":51,"line":31},"start":{"column":41,"line":31}}}],"source":"'use strict';\n\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst privileges = require('../privileges');\n\n\nmodule.exports = function (Posts) {\n    const terms = {\n        day: 86400000,\n        week: 604800000,\n        month: 2592000000,\n    };\n\n    Posts.getRecentPosts = async function (uid, start, stop, term) {\n        let min = 0;\n        if (terms[term]) {\n            min = Date.now() - terms[term];\n        }\n\n        const count = parseInt(stop, 10) === -1 ? stop : stop - start + 1;\n        let pids = await db.getSortedSetRevRangeByScore('posts:pid', start, count, '+inf', min);\n        pids = await privileges.posts.filter('topics:read', pids, uid);\n        return await Posts.getPostSummaryByPids(pids, uid, { stripTags: true });\n    };\n\n    Posts.getRecentPosterUids = async function (start, stop) {\n        const pids = await db.getSortedSetRevRange('posts:pid', start, stop);\n        const postData = await Posts.getPostsFields(pids, ['uid']);\n        return _.uniq(postData.map(p => p && p.uid).filter(uid => parseInt(uid, 10)));\n    };\n};\n"},"src/posts/summary.js":{"language":"javascript","mutants":[{"id":"1506","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":105},"start":{"column":35,"line":13}}},{"id":"1507","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":62},"start":{"column":70,"line":14}}},{"id":"1508","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"1509","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"1510","mutatorName":"LogicalOperator","replacement":"!Array.isArray(pids) && !pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":13,"line":15}}},{"id":"1511","mutatorName":"BooleanLiteral","replacement":"Array.isArray(pids)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":15},"start":{"column":13,"line":15}}},{"id":"1512","mutatorName":"BooleanLiteral","replacement":"pids.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":15},"start":{"column":37,"line":15}}},{"id":"1513","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":17},"start":{"column":51,"line":15}}},{"id":"1514","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":16},"start":{"column":20,"line":16}}},{"id":"1516","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":19},"start":{"column":87,"line":19}}},{"id":"1517","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":20},"start":{"column":48,"line":20}}},{"id":"1518","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":20},"start":{"column":75,"line":20}}},{"id":"1520","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":21},"start":{"column":93,"line":21}}},{"id":"1519","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":21},"start":{"column":54,"line":21}}},{"id":"1521","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":125,"line":23},"start":{"column":24,"line":23}}},{"id":"1522","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":23},"start":{"column":25,"line":23}}},{"id":"1524","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":23},"start":{"column":39,"line":23}}},{"id":"1523","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":23},"start":{"column":32,"line":23}}},{"id":"1526","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":23},"start":{"column":57,"line":23}}},{"id":"1525","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":23},"start":{"column":50,"line":23}}},{"id":"1515","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-topic]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":63,"line":19},"start":{"column":52,"line":19}}},{"id":"1528","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":23},"start":{"column":81,"line":23}}},{"id":"1530","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":114,"line":23},"start":{"column":105,"line":23}}},{"id":"1529","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":23},"start":{"column":92,"line":23}}},{"id":"1531","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":124,"line":23},"start":{"column":116,"line":23}}},{"id":"1532","mutatorName":"MethodExpression","replacement":"posts","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":26},"start":{"column":17,"line":26}}},{"id":"1533","mutatorName":"MethodExpression","replacement":"user.blocks","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":27},"start":{"column":23,"line":27}}},{"id":"1534","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":29},"start":{"column":39,"line":29}}},{"id":"1536","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":29},"start":{"column":44,"line":29}}},{"id":"1535","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":29},"start":{"column":44,"line":29}}},{"id":"1527","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":79,"line":23},"start":{"column":70,"line":23}}},{"id":"1538","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":30},"start":{"column":39,"line":30}}},{"id":"1539","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":30},"start":{"column":44,"line":30}}},{"id":"1540","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":30},"start":{"column":44,"line":30}}},{"id":"1541","mutatorName":"LogicalOperator","replacement":"p || p.tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":30},"start":{"column":44,"line":30}}},{"id":"1542","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":35},"start":{"column":64,"line":32}}},{"id":"1543","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":33},"start":{"column":39,"line":33}}},{"id":"1544","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":33},"start":{"column":40,"line":33}}},{"id":"1545","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":33},"start":{"column":47,"line":33}}},{"id":"1546","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":33},"start":{"column":59,"line":33}}},{"id":"1547","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":33},"start":{"column":71,"line":33}}},{"id":"1548","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":33},"start":{"column":82,"line":33}}},{"id":"1537","mutatorName":"LogicalOperator","replacement":"p || p.uid","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":54,"line":29},"start":{"column":44,"line":29}}},{"id":"1550","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":38},"start":{"column":37,"line":38}}},{"id":"1551","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":39},"start":{"column":40,"line":39}}},{"id":"1553","mutatorName":"BooleanLiteral","replacement":"uidToUser.hasOwnProperty(post.uid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":44},"start":{"column":17,"line":44}}},{"id":"1552","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":55},"start":{"column":33,"line":41}}},{"id":"1554","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":44},"start":{"column":17,"line":44}}},{"id":"1555","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":44},"start":{"column":17,"line":44}}},{"id":"1556","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":46},"start":{"column":54,"line":44}}},{"id":"1557","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":51},"start":{"column":29,"line":51}}},{"id":"1549","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":41,"line":37},"start":{"column":36,"line":37}}},{"id":"1559","mutatorName":"LogicalOperator","replacement":"post.topic || cidToCategory[post.topic.cid]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":51},"start":{"column":29,"line":51}}},{"id":"1560","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":52},"start":{"column":31,"line":52}}},{"id":"1561","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":52},"start":{"column":31,"line":52}}},{"id":"1562","mutatorName":"LogicalOperator","replacement":"post.topic || post.pid === post.topic.mainPid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":52},"start":{"column":31,"line":52}}},{"id":"1563","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":52},"start":{"column":45,"line":52}}},{"id":"1564","mutatorName":"EqualityOperator","replacement":"post.pid !== post.topic.mainPid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":52},"start":{"column":45,"line":52}}},{"id":"1565","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":53},"start":{"column":28,"line":53}}},{"id":"1566","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":53},"start":{"column":28,"line":53}}},{"id":"1567","mutatorName":"EqualityOperator","replacement":"post.deleted !== 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":53},"start":{"column":28,"line":53}}},{"id":"1568","mutatorName":"MethodExpression","replacement":"posts","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":57},"start":{"column":17,"line":57}}},{"id":"1558","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":72,"line":51},"start":{"column":29,"line":51}}},{"id":"1570","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":60},"start":{"column":49,"line":60}}},{"id":"1571","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":111,"line":60},"start":{"column":85,"line":60}}},{"id":"1572","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":76},"start":{"column":47,"line":64}}},{"id":"1573","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":75},"start":{"column":60,"line":65}}},{"id":"1574","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":66},"start":{"column":17,"line":66}}},{"id":"1575","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":66},"start":{"column":17,"line":66}}},{"id":"1576","mutatorName":"LogicalOperator","replacement":"!post.content && !options.parse","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":66},"start":{"column":17,"line":66}}},{"id":"1577","mutatorName":"BooleanLiteral","replacement":"post.content","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":66},"start":{"column":17,"line":66}}},{"id":"1578","mutatorName":"BooleanLiteral","replacement":"options.parse","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":66},"start":{"column":34,"line":66}}},{"id":"1579","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":69},"start":{"column":50,"line":66}}},{"id":"1569","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":58,"line":57},"start":{"column":30,"line":57}}},{"id":"1581","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":71},"start":{"column":17,"line":71}}},{"id":"1582","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":73},"start":{"column":36,"line":71}}},{"id":"1584","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":82},"start":{"column":63,"line":79}}},{"id":"1583","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":89},"start":{"column":48,"line":78}}},{"id":"1585","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":80},"start":{"column":13,"line":80}}},{"id":"1586","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":80},"start":{"column":20,"line":80}}},{"id":"1587","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":80},"start":{"column":27,"line":80}}},{"id":"1588","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":80},"start":{"column":36,"line":80}}},{"id":"1589","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":80},"start":{"column":43,"line":80}}},{"id":"1590","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":80},"start":{"column":51,"line":80}}},{"id":"1591","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":81},"start":{"column":13,"line":81}}},{"id":"1580","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":34,"line":71},"start":{"column":17,"line":71}}},{"id":"1593","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":81},"start":{"column":37,"line":81}}},{"id":"1594","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":81},"start":{"column":50,"line":81}}},{"id":"1595","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":81},"start":{"column":61,"line":81}}},{"id":"1596","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":83},"start":{"column":44,"line":83}}},{"id":"1597","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":83},"start":{"column":53,"line":83}}},{"id":"1598","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":83},"start":{"column":53,"line":83}}},{"id":"1599","mutatorName":"LogicalOperator","replacement":"topic || topic.cid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":83},"start":{"column":53,"line":83}}},{"id":"1600","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":87},"start":{"column":75,"line":84}}},{"id":"1601","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":85},"start":{"column":13,"line":85}}},{"id":"1602","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":85},"start":{"column":20,"line":85}}},{"id":"1603","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":85},"start":{"column":28,"line":85}}},{"id":"1592","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":35,"line":81},"start":{"column":24,"line":81}}},{"id":"1605","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":85},"start":{"column":44,"line":85}}},{"id":"1606","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":86},"start":{"column":13,"line":86}}},{"id":"1608","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":86},"start":{"column":33,"line":86}}},{"id":"1609","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":86},"start":{"column":52,"line":86}}},{"id":"1607","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":86},"start":{"column":24,"line":86}}},{"id":"1610","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":88},"start":{"column":16,"line":88}}},{"id":"1611","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":97},"start":{"column":34,"line":91}}},{"id":"1612","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":93},"start":{"column":25,"line":93}}},{"id":"1604","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":42,"line":85},"start":{"column":36,"line":85}}},{"id":"1615","mutatorName":"AssignmentOperator","replacement":"i -= 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":93},"start":{"column":42,"line":93}}},{"id":"1614","mutatorName":"EqualityOperator","replacement":"i >= data.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":93},"start":{"column":25,"line":93}}},{"id":"1616","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":95},"start":{"column":50,"line":93}}},{"id":"1617","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":104},"start":{"column":33,"line":99}}},{"id":"1618","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":100},"start":{"column":13,"line":100}}},{"id":"1619","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":100},"start":{"column":13,"line":100}}},{"id":"1620","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":102},"start":{"column":22,"line":100}}},{"id":"1613","mutatorName":"EqualityOperator","replacement":"i <"+"= data.length","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":40,"line":93},"start":{"column":25,"line":93}}}],"source":"\n'use strict';\n\nconst validator = require('validator');\nconst _ = require('lodash');\n\nconst topics = require('../topics');\nconst user = require('../user');\nconst plugins = require('../plugins');\nconst categories = require('../categories');\nconst utils = require('../utils');\n\nmodule.exports = function (Posts) {\n    Posts.getPostSummaryByPids = async function (pids, uid, options) {\n        if (!Array.isArray(pids) || !pids.length) {\n            return [];\n        }\n\n        options.stripTags = options.hasOwnProperty('stripTags') ? options.stripTags : false;\n        options.parse = options.hasOwnProperty('parse') ? options.parse : true;\n        options.extraFields = options.hasOwnProperty('extraFields') ? options.extraFields : [];\n\n        const fields = ['pid', 'tid', 'content', 'uid', 'timestamp', 'deleted', 'upvotes', 'downvotes', 'replies', 'handle'].concat(options.extraFields);\n\n        let posts = await Posts.getPostsFields(pids, fields);\n        posts = posts.filter(Boolean);\n        posts = await user.blocks.filter(uid, posts);\n\n        const uids = _.uniq(posts.map(p => p && p.uid));\n        const tids = _.uniq(posts.map(p => p && p.tid));\n\n        const [users, topicsAndCategories] = await Promise.all([\n            user.getUsersFields(uids, ['uid', 'username', 'userslug', 'picture', 'status']),\n            getTopicAndCategories(tids),\n        ]);\n\n        const uidToUser = toObject('uid', users);\n        const tidToTopic = toObject('tid', topicsAndCategories.topics);\n        const cidToCategory = toObject('cid', topicsAndCategories.categories);\n\n        posts.forEach((post) => {\n            // If the post author isn't represented in the retrieved users' data,\n            // then it means they were deleted, assume guest.\n            if (!uidToUser.hasOwnProperty(post.uid)) {\n                post.uid = 0;\n            }\n            post.user = uidToUser[post.uid];\n            Posts.overrideGuestHandle(post, post.handle);\n            post.handle = undefined;\n            post.topic = tidToTopic[post.tid];\n            post.category = post.topic && cidToCategory[post.topic.cid];\n            post.isMainPost = post.topic && post.pid === post.topic.mainPid;\n            post.deleted = post.deleted === 1;\n            post.timestampISO = utils.toISOString(post.timestamp);\n        });\n\n        posts = posts.filter(post => tidToTopic[post.tid]);\n\n        posts = await parsePosts(posts, options);\n        const result = await plugins.hooks.fire('filter:post.getPostSummaryByPids', { posts: posts, uid: uid });\n        return result.posts;\n    };\n\n    async function parsePosts(posts, options) {\n        return await Promise.all(posts.map(async (post) => {\n            if (!post.content || !options.parse) {\n                post.content = post.content ? validator.escape(String(post.content)) : post.content;\n                return post;\n            }\n            post = await Posts.parsePost(post);\n            if (options.stripTags) {\n                post.content = stripTags(post.content);\n            }\n            return post;\n        }));\n    }\n\n    async function getTopicAndCategories(tids) {\n        const topicsData = await topics.getTopicsFields(tids, [\n            'uid', 'tid', 'title', 'cid', 'tags', 'slug',\n            'deleted', 'scheduled', 'postcount', 'mainPid', 'teaserPid',\n        ]);\n        const cids = _.uniq(topicsData.map(topic => topic && topic.cid));\n        const categoriesData = await categories.getCategoriesFields(cids, [\n            'cid', 'name', 'icon', 'slug', 'parentCid',\n            'bgColor', 'color', 'backgroundImage', 'imageClass',\n        ]);\n        return { topics: topicsData, categories: categoriesData };\n    }\n\n    function toObject(key, data) {\n        const obj = {};\n        for (let i = 0; i <"+" data.length; i += 1) {\n            obj[data[i][key]] = data[i];\n        }\n        return obj;\n    }\n\n    function stripTags(content) {\n        if (content) {\n            return utils.stripHTMLTags(content, utils.stripTags);\n        }\n        return content;\n    }\n};\n"},"src/posts/tools.js":{"language":"javascript","mutants":[{"id":"1621","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":44},"start":{"column":35,"line":5}}},{"id":"1622","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":10},"start":{"column":52,"line":8}}},{"id":"1624","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":14},"start":{"column":53,"line":12}}},{"id":"1625","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":13},"start":{"column":49,"line":13}}},{"id":"1627","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":20},"start":{"column":57,"line":17}}},{"id":"1626","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":43},"start":{"column":57,"line":16}}},{"id":"1628","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":21},"start":{"column":13,"line":21}}},{"id":"1629","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":21},"start":{"column":13,"line":21}}},{"id":"1630","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":21},"start":{"column":13,"line":21}}},{"id":"1631","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":23},"start":{"column":24,"line":21}}},{"id":"1632","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":22},"start":{"column":29,"line":22}}},{"id":"1633","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":25},"start":{"column":13,"line":25}}},{"id":"1634","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":25},"start":{"column":13,"line":25}}},{"id":"1635","mutatorName":"LogicalOperator","replacement":"postData.deleted || isDelete","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":25},"start":{"column":13,"line":25}}},{"id":"1636","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":27},"start":{"column":43,"line":25}}},{"id":"1637","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":26},"start":{"column":29,"line":26}}},{"id":"1639","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":27},"start":{"column":20,"line":27}}},{"id":"1638","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":27},"start":{"column":20,"line":27}}},{"id":"1640","mutatorName":"LogicalOperator","replacement":"!postData.deleted || !isDelete","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":27},"start":{"column":20,"line":27}}},{"id":"1641","mutatorName":"BooleanLiteral","replacement":"postData.deleted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":27},"start":{"column":20,"line":27}}},{"id":"1642","mutatorName":"BooleanLiteral","replacement":"isDelete","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":27},"start":{"column":41,"line":27}}},{"id":"1643","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":29},"start":{"column":52,"line":27}}},{"id":"1644","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":28},"start":{"column":29,"line":28}}},{"id":"1646","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":31},"start":{"column":13,"line":31}}},{"id":"1645","mutatorName":"BooleanLiteral","replacement":"canDelete.flag","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":31},"start":{"column":13,"line":31}}},{"id":"1647","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":31},"start":{"column":13,"line":31}}},{"id":"1648","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":33},"start":{"column":30,"line":31}}},{"id":"1649","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":35},"start":{"column":13,"line":35}}},{"id":"1650","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":35},"start":{"column":13,"line":35}}},{"id":"1651","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":38},"start":{"column":23,"line":35}}},{"id":"1652","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":41},"start":{"column":16,"line":38}}},{"id":"1623","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":53,"line":9},"start":{"column":49,"line":9}}}],"source":"'use strict';\n\nconst privileges = require('../privileges');\n\nmodule.exports = function (Posts) {\n    Posts.tools = {};\n\n    Posts.tools.delete = async function (uid, pid) {\n        return await togglePostDelete(uid, pid, true);\n    };\n\n    Posts.tools.restore = async function (uid, pid) {\n        return await togglePostDelete(uid, pid, false);\n    };\n\n    async function togglePostDelete(uid, pid, isDelete) {\n        const [postData, canDelete] = await Promise.all([\n            Posts.getPostData(pid),\n            privileges.posts.canDelete(pid, uid),\n        ]);\n        if (!postData) {\n            throw new Error('[[error:no-post]]');\n        }\n\n        if (postData.deleted && isDelete) {\n            throw new Error('[[error:post-already-deleted]]');\n        } else if (!postData.deleted && !isDelete) {\n            throw new Error('[[error:post-already-restored]]');\n        }\n\n        if (!canDelete.flag) {\n            throw new Error(canDelete.message);\n        }\n        let post;\n        if (isDelete) {\n            require('./cache').del(pid);\n            post = await Posts.delete(pid, uid);\n        } else {\n            post = await Posts.restore(pid, uid);\n            post = await Posts.parsePost(post);\n        }\n        return post;\n    }\n};\n"},"src/posts/topics.js":{"language":"javascript","mutants":[{"id":"1653","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":54},"start":{"column":35,"line":8}}},{"id":"1654","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":13},"start":{"column":77,"line":9}}},{"id":"1655","mutatorName":"MethodExpression","replacement":"user.blocks","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":12},"start":{"column":22,"line":12}}},{"id":"1657","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":17},"start":{"column":33,"line":17}}},{"id":"1658","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":18},"start":{"column":59,"line":18}}},{"id":"1656","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":22},"start":{"column":42,"line":15}}},{"id":"1659","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":18},"start":{"column":60,"line":18}}},{"id":"1660","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":19},"start":{"column":69,"line":19}}},{"id":"1661","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":19},"start":{"column":82,"line":19}}},{"id":"1664","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":20},"start":{"column":45,"line":20}}},{"id":"1663","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":20},"start":{"column":33,"line":20}}},{"id":"1662","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":19},"start":{"column":83,"line":19}}},{"id":"1666","mutatorName":"EqualityOperator","replacement":"parseInt(pid, 10) !== parseInt(topicData[i].mainPid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":20},"start":{"column":45,"line":20}}},{"id":"1667","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":27},"start":{"column":57,"line":24}}},{"id":"1669","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":32},"start":{"column":56,"line":29}}},{"id":"1670","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":30},"start":{"column":53,"line":30}}},{"id":"1668","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":25},"start":{"column":51,"line":25}}},{"id":"1671","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":31},"start":{"column":16,"line":31}}},{"id":"1672","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":31},"start":{"column":16,"line":31}}},{"id":"1673","mutatorName":"LogicalOperator","replacement":"Array.isArray(paths) || paths.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":31},"start":{"column":16,"line":31}}},{"id":"1675","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":35},"start":{"column":59,"line":35}}},{"id":"1674","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":53},"start":{"column":58,"line":34}}},{"id":"1676","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":35},"start":{"column":60,"line":35}}},{"id":"1677","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":35},"start":{"column":67,"line":35}}},{"id":"1678","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":36},"start":{"column":35,"line":36}}},{"id":"1679","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":36},"start":{"column":43,"line":36}}},{"id":"1680","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":36},"start":{"column":43,"line":36}}},{"id":"1681","mutatorName":"LogicalOperator","replacement":"post || post.tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":36},"start":{"column":43,"line":36}}},{"id":"1682","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":40},"start":{"column":56,"line":37}}},{"id":"1683","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":39},"start":{"column":42,"line":39}}},{"id":"1685","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":50},"start":{"column":48,"line":42}}},{"id":"1684","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":39},"start":{"column":43,"line":39}}},{"id":"1687","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":46},"start":{"column":17,"line":46}}},{"id":"1686","mutatorName":"ArithmeticOperator","replacement":"parseInt(indices[index], 10) - 1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":44},"start":{"column":64,"line":44}}},{"id":"1688","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":46},"start":{"column":17,"line":46}}},{"id":"1689","mutatorName":"LogicalOperator","replacement":"slug || postIndex","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":46},"start":{"column":17,"line":46}}},{"id":"1691","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":47},"start":{"column":24,"line":47}}},{"id":"1690","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":48},"start":{"column":36,"line":46}}},{"id":"1665","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":101,"line":20},"start":{"column":45,"line":20}}}],"source":"\n'use strict';\n\nconst topics = require('../topics');\nconst user = require('../user');\nconst utils = require('../utils');\n\nmodule.exports = function (Posts) {\n    Posts.getPostsFromSet = async function (set, start, stop, uid, reverse) {\n        const pids = await Posts.getPidsFromSet(set, start, stop, reverse);\n        const posts = await Posts.getPostsByPids(pids, uid);\n        return await user.blocks.filter(uid, posts);\n    };\n\n    Posts.isMain = async function (pids) {\n        const isArray = Array.isArray(pids);\n        pids = isArray ? pids : [pids];\n        const postData = await Posts.getPostsFields(pids, ['tid']);\n        const topicData = await topics.getTopicsFields(postData.map(t => t.tid), ['mainPid']);\n        const result = pids.map((pid, i) => parseInt(pid, 10) === parseInt(topicData[i].mainPid, 10));\n        return isArray ? result : result[0];\n    };\n\n    Posts.getTopicFields = async function (pid, fields) {\n        const tid = await Posts.getPostField(pid, 'tid');\n        return await topics.getTopicFields(tid, fields);\n    };\n\n    Posts.generatePostPath = async function (pid, uid) {\n        const paths = await Posts.generatePostPaths([pid], uid);\n        return Array.isArray(paths) && paths.length ? paths[0] : null;\n    };\n\n    Posts.generatePostPaths = async function (pids, uid) {\n        const postData = await Posts.getPostsFields(pids, ['pid', 'tid']);\n        const tids = postData.map(post => post && post.tid);\n        const [indices, topicData] = await Promise.all([\n            Posts.getPostIndices(postData, uid),\n            topics.getTopicsFields(tids, ['slug']),\n        ]);\n\n        const paths = pids.map((pid, index) => {\n            const slug = topicData[index] ? topicData[index].slug : null;\n            const postIndex = utils.isNumber(indices[index]) ? parseInt(indices[index], 10) + 1 : null;\n\n            if (slug && postIndex) {\n                return `/topic/${slug}/${postIndex}`;\n            }\n            return null;\n        });\n\n        return paths;\n    };\n};\n"},"src/posts/uploads.js":{"language":"javascript","mutants":[{"id":"1692","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":231},"start":{"column":35,"line":20}}},{"id":"1693","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":23},"start":{"column":17,"line":23}}},{"id":"1694","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":23},"start":{"column":47,"line":23}}},{"id":"1696","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"TypeError: ERR_INVALID_ARG_TYPE (undefined) TypeError [ERR_INVALID_ARG_TYPE]: The \"path\" argument must be of type string. Received undefined\n    at new NodeError (node:internal/errors:405:5)\n    at validateString (node:internal/validators:162:11)\n    at Object.join (node:path:1175:7)\n    at module.exports (/Users/senfeng/Documents/CMU 2023-2024/17313/fall23-nodebb-softwear/.stryker-tmp/sandbox9230685/src/posts/uploads.js:75:29)\n    at Object.<"+"anonymous> (/Users/senfeng/Documents/CMU 2023-2024/17313/fall23-nodebb-softwear/.stryker-tmp/sandbox9230685/src/posts/index.js:72:21)\n    at Module._compile (node:internal/modules/cjs/loader:1233:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1287:10)\n    at Module.load (node:internal/modules/cjs/loader:1091:32)\n    at Module._load (node:internal/modules/cjs/loader:938:12)\n    at Module.require (node:internal/modules/cjs/loader:1115:19)","status":"RuntimeError","location":{"end":{"column":57,"line":24},"start":{"column":44,"line":24}}},{"id":"1695","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":23},"start":{"column":78,"line":23}}},{"id":"1697","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\s\")]\\.?[\\w]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1698","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[\\s\")]+\\.?[\\w]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1699","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\S\")]+\\.?[\\w]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1700","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\s\")]+\\.[\\w]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1701","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\s\")]+\\.?[\\w])/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1702","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\s\")]+\\.?[^\\w]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1703","mutatorName":"Regex","replacement":"/\\/assets\\/uploads\\/(files\\/[^\\s\")]+\\.?[\\W]*)/g","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":25},"start":{"column":25,"line":25}}},{"id":"1704","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":27},"start":{"column":26,"line":27}}},{"id":"1705","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":31},"start":{"column":31,"line":28}}},{"id":"1706","mutatorName":"MethodExpression","replacement":"await Promise.all(filePaths.map(async filePath => {\n  const fullPath = _getFullPath(filePath);\n  return fullPath.startsWith(pathPrefix) && (await file.exists(fullPath)) ? filePath : false;\n}))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":31},"start":{"column":50,"line":28}}},{"id":"1707","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":31},"start":{"column":103,"line":28}}},{"id":"1708","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":30},"start":{"column":16,"line":30}}},{"id":"1710","mutatorName":"LogicalOperator","replacement":"fullPath.startsWith(pathPrefix) || (await file.exists(fullPath))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":30},"start":{"column":16,"line":30}}},{"id":"1711","mutatorName":"MethodExpression","replacement":"fullPath.endsWith(pathPrefix)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":30},"start":{"column":16,"line":30}}},{"id":"1712","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":97,"line":30},"start":{"column":92,"line":30}}},{"id":"1713","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":33},"start":{"column":31,"line":33}}},{"id":"1714","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":16,"line":34},"start":{"column":9,"line":34}}},{"id":"1715","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":16,"line":34},"start":{"column":9,"line":34}}},{"id":"1716","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":44},"start":{"column":18,"line":34}}},{"id":"1717","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":35},"start":{"column":21,"line":35}}},{"id":"1718","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":43},"start":{"column":46,"line":35}}},{"id":"1719","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":37},"start":{"column":17,"line":37}}},{"id":"1720","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":37},"start":{"column":17,"line":37}}},{"id":"1721","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":42},"start":{"column":33,"line":37}}},{"id":"1723","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":41},"start":{"column":46,"line":39}}},{"id":"1722","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":94,"line":38},"start":{"column":30,"line":38}}},{"id":"1724","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":40},"start":{"column":42,"line":40}}},{"id":"1725","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":40},"start":{"column":55,"line":40}}},{"id":"1726","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":43},"start":{"column":18,"line":43}}},{"id":"1727","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":81},"start":{"column":47,"line":46}}},{"id":"1728","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":53},"start":{"column":73,"line":49}}},{"id":"1729","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":50},"start":{"column":37,"line":50}}},{"id":"1730","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":57},"start":{"column":25,"line":57}}},{"id":"1731","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":58},"start":{"column":16,"line":58}}},{"id":"1732","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":61},"start":{"column":23,"line":58}}},{"id":"1733","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":59},"start":{"column":43,"line":59}}},{"id":"1735","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":64},"start":{"column":13,"line":64}}},{"id":"1734","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":59},"start":{"column":55,"line":59}}},{"id":"1736","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":64},"start":{"column":13,"line":64}}},{"id":"1737","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":72},"start":{"column":25,"line":64}}},{"id":"1739","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":67},"start":{"column":49,"line":67}}},{"id":"1738","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":65},"start":{"column":55,"line":65}}},{"id":"1740","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":67},"start":{"column":62,"line":67}}},{"id":"1741","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":67},"start":{"column":91,"line":67}}},{"id":"1742","mutatorName":"MethodExpression","replacement":"thumbs.map(thumb => thumb.url.replace(replacePath, ''))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":16,"line":70},"start":{"column":22,"line":68}}},{"id":"1743","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":68},"start":{"column":33,"line":68}}},{"id":"1744","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":68},"start":{"column":73,"line":68}}},{"id":"1745","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":15,"line":70},"start":{"column":85,"line":68}}},{"id":"1746","mutatorName":"BooleanLiteral","replacement":"validator.isURL(path, {\n  require_protocol: true\n})","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":15,"line":70},"start":{"column":93,"line":68}}},{"id":"1747","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":70},"start":{"column":116,"line":68}}},{"id":"1749","mutatorName":"MethodExpression","replacement":"uploads","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":75},"start":{"column":21,"line":75}}},{"id":"1748","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":69},"start":{"column":35,"line":69}}},{"id":"1709","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":78,"line":30},"start":{"column":16,"line":30}}},{"id":"1751","mutatorName":"BooleanLiteral","replacement":"currentUploads.includes(path)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":75},"start":{"column":44,"line":75}}},{"id":"1752","mutatorName":"MethodExpression","replacement":"currentUploads","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":76},"start":{"column":24,"line":76}}},{"id":"1753","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":76},"start":{"column":46,"line":76}}},{"id":"1754","mutatorName":"BooleanLiteral","replacement":"uploads.includes(path)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":76},"start":{"column":54,"line":76}}},{"id":"1755","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":80},"start":{"column":27,"line":77}}},{"id":"1756","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":85},"start":{"column":47,"line":83}}},{"id":"1757","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":84},"start":{"column":45,"line":84}}},{"id":"1758","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":95},"start":{"column":56,"line":87}}},{"id":"1759","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":89},"start":{"column":23,"line":89}}},{"id":"1760","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":89},"start":{"column":23,"line":89}}},{"id":"1761","mutatorName":"LogicalOperator","replacement":"(await db.getObjects(paths.map(path => `upload:${md5(path)}`))) && []","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":89},"start":{"column":23,"line":89}}},{"id":"1750","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":74,"line":75},"start":{"column":36,"line":75}}},{"id":"1763","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":89},"start":{"column":61,"line":89}}},{"id":"1764","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":90,"line":89},"start":{"column":88,"line":89}}},{"id":"1765","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":11,"line":94},"start":{"column":26,"line":91}}},{"id":"1767","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":109},"start":{"column":44,"line":97}}},{"id":"1766","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":94},"start":{"column":45,"line":91}}},{"id":"1768","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":98},"start":{"column":51,"line":98}}},{"id":"1769","mutatorName":"MethodExpression","replacement":"files","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":99},"start":{"column":17,"line":99}}},{"id":"1771","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":99},"start":{"column":42,"line":99}}},{"id":"1770","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":99},"start":{"column":30,"line":99}}},{"id":"1762","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":82,"line":89},"start":{"column":53,"line":89}}},{"id":"1772","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":99},"start":{"column":42,"line":99}}},{"id":"1774","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":99},"start":{"column":55,"line":99}}},{"id":"1775","mutatorName":"Regex","replacement":"/\\d{13}-/","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":102},"start":{"column":26,"line":102}}},{"id":"1776","mutatorName":"Regex","replacement":"/^\\d-/","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":102},"start":{"column":26,"line":102}}},{"id":"1777","mutatorName":"Regex","replacement":"/^\\D{13}-/","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":102},"start":{"column":26,"line":102}}},{"id":"1778","mutatorName":"MethodExpression","replacement":"files","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":103},"start":{"column":17,"line":103}}},{"id":"1779","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":103},"start":{"column":30,"line":103}}},{"id":"1780","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":143,"line":105},"start":{"column":45,"line":105}}},{"id":"1781","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":112,"line":105},"start":{"column":93,"line":105}}},{"id":"1773","mutatorName":"EqualityOperator","replacement":"filename === '.gitignore'","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":67,"line":99},"start":{"column":42,"line":99}}},{"id":"1783","mutatorName":"MethodExpression","replacement":"files","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":106},"start":{"column":17,"line":106}}},{"id":"1785","mutatorName":"ArithmeticOperator","replacement":"now + 1000 * 60 * 60 * 24 * meta.config.orphanExpiryDays","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":113},"start":{"column":28,"line":113}}},{"id":"1784","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":133},"start":{"column":46,"line":111}}},{"id":"1786","mutatorName":"ArithmeticOperator","replacement":"1000 * 60 * 60 * 24 / meta.config.orphanExpiryDays","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":113},"start":{"column":35,"line":113}}},{"id":"1787","mutatorName":"ArithmeticOperator","replacement":"1000 * 60 * 60 / 24","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":113},"start":{"column":35,"line":113}}},{"id":"1788","mutatorName":"ArithmeticOperator","replacement":"1000 * 60 / 60","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":113},"start":{"column":35,"line":113}}},{"id":"1789","mutatorName":"ArithmeticOperator","replacement":"1000 / 60","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":113},"start":{"column":35,"line":113}}},{"id":"1791","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":115},"start":{"column":13,"line":115}}},{"id":"1790","mutatorName":"BooleanLiteral","replacement":"days","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":115},"start":{"column":13,"line":115}}},{"id":"1792","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":115},"start":{"column":13,"line":115}}},{"id":"1782","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":135,"line":105},"start":{"column":116,"line":105}}},{"id":"1794","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":116},"start":{"column":20,"line":116}}},{"id":"1795","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":124},"start":{"column":68,"line":121}}},{"id":"1796","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":123},"start":{"column":20,"line":123}}},{"id":"1797","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":123},"start":{"column":20,"line":123}}},{"id":"1798","mutatorName":"EqualityOperator","replacement":"mtimeMs <"+"= expiration","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":123},"start":{"column":20,"line":123}}},{"id":"1799","mutatorName":"EqualityOperator","replacement":"mtimeMs >= expiration","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":123},"start":{"column":20,"line":123}}},{"id":"1800","mutatorName":"MethodExpression","replacement":"orphans","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":125},"start":{"column":19,"line":125}}},{"id":"1801","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":130},"start":{"column":38,"line":128}}},{"id":"1802","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":138},"start":{"column":56,"line":135}}},{"id":"1793","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":117},"start":{"column":20,"line":115}}},{"id":"1804","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":137},"start":{"column":16,"line":137}}},{"id":"1805","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":137},"start":{"column":16,"line":137}}},{"id":"1806","mutatorName":"EqualityOperator","replacement":"length !== 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":137},"start":{"column":16,"line":137}}},{"id":"1807","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":148},"start":{"column":57,"line":140}}},{"id":"1808","mutatorName":"BooleanLiteral","replacement":"Array.isArray(filePaths)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":142},"start":{"column":13,"line":142}}},{"id":"1809","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":142},"start":{"column":13,"line":142}}},{"id":"1810","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":142},"start":{"column":13,"line":142}}},{"id":"1811","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":144},"start":{"column":40,"line":142}}},{"id":"1812","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":143},"start":{"column":25,"line":143}}},{"id":"1803","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":77,"line":136},"start":{"column":47,"line":136}}},{"id":"1813","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":105,"line":146},"start":{"column":36,"line":146}}},{"id":"1815","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":146},"start":{"column":82,"line":146}}},{"id":"1816","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":146},"start":{"column":94,"line":146}}},{"id":"1817","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":147},"start":{"column":43,"line":147}}},{"id":"1818","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":147},"start":{"column":75,"line":147}}},{"id":"1819","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":168},"start":{"column":63,"line":150}}},{"id":"1820","mutatorName":"BooleanLiteral","replacement":"Array.isArray(filePaths)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":152},"start":{"column":21,"line":152}}},{"id":"1821","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":152},"start":{"column":49,"line":152}}},{"id":"1822","mutatorName":"BooleanLiteral","replacement":"filePaths.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":153},"start":{"column":13,"line":153}}},{"id":"1823","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":153},"start":{"column":13,"line":153}}},{"id":"1824","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":153},"start":{"column":13,"line":153}}},{"id":"1825","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":155},"start":{"column":32,"line":153}}},{"id":"1826","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":161},"start":{"column":38,"line":161}}},{"id":"1827","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":162},"start":{"column":39,"line":162}}},{"id":"1828","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":162},"start":{"column":47,"line":162}}},{"id":"1829","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":162},"start":{"column":48,"line":162}}},{"id":"1830","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":167},"start":{"column":27,"line":163}}},{"id":"1831","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":164},"start":{"column":29,"line":164}}},{"id":"1832","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":196},"start":{"column":64,"line":170}}},{"id":"1833","mutatorName":"BooleanLiteral","replacement":"Array.isArray(filePaths)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":172},"start":{"column":21,"line":172}}},{"id":"1834","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":172},"start":{"column":49,"line":172}}},{"id":"1835","mutatorName":"BooleanLiteral","replacement":"filePaths.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":173},"start":{"column":13,"line":173}}},{"id":"1836","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":173},"start":{"column":13,"line":173}}},{"id":"1837","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":173},"start":{"column":13,"line":173}}},{"id":"1839","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":177},"start":{"column":42,"line":177}}},{"id":"1838","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":175},"start":{"column":32,"line":173}}},{"id":"1840","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":177},"start":{"column":50,"line":177}}},{"id":"1841","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":177},"start":{"column":51,"line":177}}},{"id":"1843","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":179},"start":{"column":32,"line":179}}},{"id":"1842","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":181},"start":{"column":26,"line":178}}},{"id":"1844","mutatorName":"BooleanLiteral","replacement":"meta.config.preserveOrphanedUploads","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":185},"start":{"column":13,"line":185}}},{"id":"1845","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":185},"start":{"column":13,"line":185}}},{"id":"1846","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":185},"start":{"column":13,"line":185}}},{"id":"1847","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":195},"start":{"column":51,"line":185}}},{"id":"1848","mutatorName":"MethodExpression","replacement":"await Promise.all(filePaths.map(async filePath => (await Posts.uploads.isOrphan(filePath)) ? filePath : false))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":188},"start":{"column":33,"line":186}}},{"id":"1849","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":108,"line":187},"start":{"column":31,"line":187}}},{"id":"1850","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":187},"start":{"column":102,"line":187}}},{"id":"1851","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":190},"start":{"column":77,"line":190}}},{"id":"1852","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":190},"start":{"column":85,"line":190}}},{"id":"1853","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":190},"start":{"column":108,"line":190}}},{"id":"1814","mutatorName":"StringLiteral","replacement":"``","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":105,"line":146},"start":{"column":47,"line":146}}},{"id":"1854","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":114,"line":190},"start":{"column":109,"line":190}}},{"id":"1856","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":146,"line":190},"start":{"column":133,"line":190}}},{"id":"1857","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":146,"line":190},"start":{"column":133,"line":190}}},{"id":"1858","mutatorName":"LogicalOperator","replacement":"o.uid && null","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":146,"line":190},"start":{"column":133,"line":190}}},{"id":"1859","mutatorName":"MethodExpression","replacement":"uploaderUids.map((uid, idx) => uid && isFinite(uid) ? user.deleteUpload(uid, uid, deletePaths[idx]) : null)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":193},"start":{"column":31,"line":191}}},{"id":"1860","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":193},"start":{"column":48,"line":191}}},{"id":"1861","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":192},"start":{"column":17,"line":192}}},{"id":"1862","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":192},"start":{"column":17,"line":192}}},{"id":"1863","mutatorName":"LogicalOperator","replacement":"uid || isFinite(uid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":192},"start":{"column":17,"line":192}}},{"id":"1864","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":201},"start":{"column":50,"line":198}}},{"id":"1865","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":212},"start":{"column":57,"line":203}}},{"id":"1866","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":13,"line":204}}},{"id":"1867","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":13,"line":204}}},{"id":"1868","mutatorName":"EqualityOperator","replacement":"typeof filePaths !== 'string'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":13,"line":204}}},{"id":"1869","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":204},"start":{"column":34,"line":204}}},{"id":"1870","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":206},"start":{"column":44,"line":204}}},{"id":"1871","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":205},"start":{"column":25,"line":205}}},{"id":"1872","mutatorName":"BooleanLiteral","replacement":"Array.isArray(filePaths)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":206},"start":{"column":20,"line":206}}},{"id":"1873","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":206},"start":{"column":20,"line":206}}},{"id":"1874","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":206},"start":{"column":20,"line":206}}},{"id":"1876","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":100,"line":207},"start":{"column":29,"line":207}}},{"id":"1875","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":208},"start":{"column":47,"line":206}}},{"id":"1877","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":230},"start":{"column":51,"line":214}}},{"id":"1879","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":218},"start":{"column":52,"line":215}}},{"id":"1878","mutatorName":"MethodExpression","replacement":"filePaths","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":11,"line":218},"start":{"column":21,"line":215}}},{"id":"1880","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":217},"start":{"column":20,"line":217}}},{"id":"1881","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":217},"start":{"column":20,"line":217}}},{"id":"1882","mutatorName":"LogicalOperator","replacement":"type || type.match(/image./)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":217},"start":{"column":20,"line":217}}},{"id":"1883","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":229},"start":{"column":61,"line":219}}},{"id":"1884","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":226},"start":{"column":17,"line":220}}},{"id":"1885","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":222},"start":{"column":36,"line":222}}},{"id":"1886","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":225},"start":{"column":63,"line":222}}},{"id":"1887","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":228},"start":{"column":27,"line":226}}},{"id":"1888","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":227},"start":{"column":31,"line":227}}},{"id":"1855","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":154,"line":190},"start":{"column":123,"line":190}}}],"source":"'use strict';\n\nconst nconf = require('nconf');\nconst fs = require('fs').promises;\nconst crypto = require('crypto');\nconst path = require('path');\nconst winston = require('winston');\nconst mime = require('mime');\nconst validator = require('validator');\nconst cronJob = require('cron').CronJob;\nconst chalk = require('chalk');\n\nconst db = require('../database');\nconst image = require('../image');\nconst user = require('../user');\nconst topics = require('../topics');\nconst file = require('../file');\nconst meta = require('../meta');\n\nmodule.exports = function (Posts) {\n    Posts.uploads = {};\n\n    const md5 = filename => crypto.createHash('md5').update(filename).digest('hex');\n    const pathPrefix = path.join(nconf.get('upload_path'));\n    const searchRegex = /\\/assets\\/uploads\\/(files\\/[^\\s\")]+\\.?[\\w]*)/g;\n\n    const _getFullPath = relativePath => path.join(pathPrefix, relativePath);\n    const _filterValidPaths = async filePaths => (await Promise.all(filePaths.map(async (filePath) => {\n        const fullPath = _getFullPath(filePath);\n        return fullPath.startsWith(pathPrefix) && await file.exists(fullPath) ? filePath : false;\n    }))).filter(Boolean);\n\n    const runJobs = nconf.get('runJobs');\n    if (runJobs) {\n        new cronJob('0 2 * * 0', async () => {\n            const orphans = await Posts.uploads.cleanOrphans();\n            if (orphans.length) {\n                winston.info(`[posts/uploads] Deleting ${orphans.length} orphaned uploads...`);\n                orphans.forEach((relPath) => {\n                    process.stdout.write(`${chalk.red('  - ')} ${relPath}`);\n                });\n            }\n        }, null, true);\n    }\n\n    Posts.uploads.sync = async function (pid) {\n        // Scans a post's content and updates sorted set of uploads\n\n        const [content, currentUploads, isMainPost] = await Promise.all([\n            Posts.getPostField(pid, 'content'),\n            Posts.uploads.list(pid),\n            Posts.isMain(pid),\n        ]);\n\n        // Extract upload file paths from post content\n        let match = searchRegex.exec(content);\n        const uploads = [];\n        while (match) {\n            uploads.push(match[1].replace('-resized', ''));\n            match = searchRegex.exec(content);\n        }\n\n        // Main posts can contain topic thumbs, which are also tracked by pid\n        if (isMainPost) {\n            const tid = await Posts.getPostField(pid, 'tid');\n            let thumbs = await topics.thumbs.get(tid);\n            const replacePath = path.posix.join(`${nconf.get('relative_path')}${nconf.get('upload_url')}/`);\n            thumbs = thumbs.map(thumb => thumb.url.replace(replacePath, '')).filter(path => !validator.isURL(path, {\n                require_protocol: true,\n            }));\n            uploads.push(...thumbs);\n        }\n\n        // Create add/remove sets\n        const add = uploads.filter(path => !currentUploads.includes(path));\n        const remove = currentUploads.filter(path => !uploads.includes(path));\n        await Promise.all([\n            Posts.uploads.associate(pid, add),\n            Posts.uploads.dissociate(pid, remove),\n        ]);\n    };\n\n    Posts.uploads.list = async function (pid) {\n        return await db.getSortedSetMembers(`post:${pid}:uploads`);\n    };\n\n    Posts.uploads.listWithSizes = async function (pid) {\n        const paths = await Posts.uploads.list(pid);\n        const sizes = await db.getObjects(paths.map(path => `upload:${md5(path)}`)) || [];\n\n        return sizes.map((sizeObj, idx) => ({\n            ...sizeObj,\n            name: paths[idx],\n        }));\n    };\n\n    Posts.uploads.getOrphans = async () => {\n        let files = await fs.readdir(_getFullPath('/files'));\n        files = files.filter(filename => filename !== '.gitignore');\n\n        // Exclude non-timestamped files (e.g. group covers; see gh#10783/gh#10705)\n        const tsPrefix = /^\\d{13}-/;\n        files = files.filter(filename => tsPrefix.test(filename));\n\n        files = await Promise.all(files.map(async filename => (await Posts.uploads.isOrphan(`files/${filename}`) ? `files/${filename}` : null)));\n        files = files.filter(Boolean);\n\n        return files;\n    };\n\n    Posts.uploads.cleanOrphans = async () => {\n        const now = Date.now();\n        const expiration = now - (1000 * 60 * 60 * 24 * meta.config.orphanExpiryDays);\n        const days = meta.config.orphanExpiryDays;\n        if (!days) {\n            return [];\n        }\n\n        let orphans = await Posts.uploads.getOrphans();\n\n        orphans = await Promise.all(orphans.map(async (relPath) => {\n            const { mtimeMs } = await fs.stat(_getFullPath(relPath));\n            return mtimeMs <"+" expiration ? relPath : null;\n        }));\n        orphans = orphans.filter(Boolean);\n\n        // Note: no await. Deletion not guaranteed by method end.\n        orphans.forEach((relPath) => {\n            file.delete(_getFullPath(relPath));\n        });\n\n        return orphans;\n    };\n\n    Posts.uploads.isOrphan = async function (filePath) {\n        const length = await db.sortedSetCard(`upload:${md5(filePath)}:pids`);\n        return length === 0;\n    };\n\n    Posts.uploads.getUsage = async function (filePaths) {\n        // Given an array of file names, determines which pids they are used in\n        if (!Array.isArray(filePaths)) {\n            filePaths = [filePaths];\n        }\n\n        const keys = filePaths.map(fileObj => `upload:${md5(fileObj.path.replace('-resized', ''))}:pids`);\n        return await Promise.all(keys.map(k => db.getSortedSetRange(k, 0, -1)));\n    };\n\n    Posts.uploads.associate = async function (pid, filePaths) {\n        // Adds an upload to a post's sorted set of uploads\n        filePaths = !Array.isArray(filePaths) ? [filePaths] : filePaths;\n        if (!filePaths.length) {\n            return;\n        }\n\n        // Only process files that exist and are within uploads directory\n        filePaths = await _filterValidPaths(filePaths);\n\n        const now = Date.now();\n        const scores = filePaths.map(() => now);\n        const bulkAdd = filePaths.map(path => [`upload:${md5(path)}:pids`, now, pid]);\n        await Promise.all([\n            db.sortedSetAdd(`post:${pid}:uploads`, scores, filePaths),\n            db.sortedSetAddBulk(bulkAdd),\n            Posts.uploads.saveSize(filePaths),\n        ]);\n    };\n\n    Posts.uploads.dissociate = async function (pid, filePaths) {\n        // Removes an upload from a post's sorted set of uploads\n        filePaths = !Array.isArray(filePaths) ? [filePaths] : filePaths;\n        if (!filePaths.length) {\n            return;\n        }\n\n        const bulkRemove = filePaths.map(path => [`upload:${md5(path)}:pids`, pid]);\n        const promises = [\n            db.sortedSetRemove(`post:${pid}:uploads`, filePaths),\n            db.sortedSetRemoveBulk(bulkRemove),\n        ];\n\n        await Promise.all(promises);\n\n        if (!meta.config.preserveOrphanedUploads) {\n            const deletePaths = (await Promise.all(\n                filePaths.map(async filePath => (await Posts.uploads.isOrphan(filePath) ? filePath : false))\n            )).filter(Boolean);\n\n            const uploaderUids = (await db.getObjectsFields(deletePaths.map(path => `upload:${md5(path)}`, ['uid']))).map(o => (o ? o.uid || null : null));\n            await Promise.all(uploaderUids.map((uid, idx) => (\n                uid && isFinite(uid) ? user.deleteUpload(uid, uid, deletePaths[idx]) : null\n            )).filter(Boolean));\n            await Posts.uploads.deleteFromDisk(deletePaths);\n        }\n    };\n\n    Posts.uploads.dissociateAll = async (pid) => {\n        const current = await Posts.uploads.list(pid);\n        await Posts.uploads.dissociate(pid, current);\n    };\n\n    Posts.uploads.deleteFromDisk = async (filePaths) => {\n        if (typeof filePaths === 'string') {\n            filePaths = [filePaths];\n        } else if (!Array.isArray(filePaths)) {\n            throw new Error(`[[error:wrong-parameter-type, filePaths, ${typeof filePaths}, array]]`);\n        }\n\n        filePaths = (await _filterValidPaths(filePaths)).map(_getFullPath);\n        await Promise.all(filePaths.map(file.delete));\n    };\n\n    Posts.uploads.saveSize = async (filePaths) => {\n        filePaths = filePaths.filter((fileName) => {\n            const type = mime.getType(fileName);\n            return type && type.match(/image./);\n        });\n        await Promise.all(filePaths.map(async (fileName) => {\n            try {\n                const size = await image.size(_getFullPath(fileName));\n                await db.setObject(`upload:${md5(fileName)}`, {\n                    width: size.width,\n                    height: size.height,\n                });\n            } catch (err) {\n                winston.error(`[posts/uploads] Error while saving post upload sizes (${fileName}): ${err.message}`);\n            }\n        }));\n    };\n};\n"},"src/posts/user.js":{"language":"javascript","mutants":[{"id":"1889","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":261},"start":{"column":35,"line":15}}},{"id":"1890","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":56},"start":{"column":60,"line":16}}},{"id":"1891","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":21},"start":{"column":75,"line":17}}},{"id":"1892","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":20},"start":{"column":42,"line":20}}},{"id":"1893","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":22},"start":{"column":60,"line":22}}},{"id":"1894","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":33},"start":{"column":47,"line":25}}},{"id":"1895","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":26},"start":{"column":58,"line":26}}},{"id":"1896","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":26},"start":{"column":58,"line":26}}},{"id":"1898","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":26},"start":{"column":80,"line":26}}},{"id":"1899","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":27},"start":{"column":92,"line":27}}},{"id":"1900","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":27},"start":{"column":92,"line":27}}},{"id":"1901","mutatorName":"LogicalOperator","replacement":"userData.fullname && ''","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":27},"start":{"column":92,"line":27}}},{"id":"1902","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":27},"start":{"column":113,"line":27}}},{"id":"1903","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":28},"start":{"column":39,"line":28}}},{"id":"1905","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":30},"start":{"column":17,"line":30}}},{"id":"1904","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":30},"start":{"column":17,"line":30}}},{"id":"1906","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":32},"start":{"column":43,"line":30}}},{"id":"1897","mutatorName":"LogicalOperator","replacement":"userData.signature && ''","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":82,"line":26},"start":{"column":58,"line":26}}},{"id":"1908","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":40},"start":{"column":88,"line":36}}},{"id":"1909","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":39},"start":{"column":36,"line":39}}},{"id":"1910","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":39},"start":{"column":72,"line":39}}},{"id":"1911","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":39},"start":{"column":83,"line":39}}},{"id":"1912","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":42},"start":{"column":17,"line":42}}},{"id":"1913","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":42},"start":{"column":17,"line":42}}},{"id":"1914","mutatorName":"LogicalOperator","replacement":"isMemberOfGroups || userData.groupTitleArray","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":42},"start":{"column":17,"line":42}}},{"id":"1915","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":48},"start":{"column":63,"line":42}}},{"id":"1907","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":53},"start":{"column":75,"line":35}}},{"id":"1917","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":44},"start":{"column":25,"line":44}}},{"id":"1918","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":44},"start":{"column":25,"line":44}}},{"id":"1919","mutatorName":"LogicalOperator","replacement":"isMemberOfGroups[index] || groupsMap[userGroup]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":44},"start":{"column":25,"line":44}}},{"id":"1920","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":46},"start":{"column":74,"line":44}}},{"id":"1921","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":52},"start":{"column":45,"line":52}}},{"id":"1922","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":54},"start":{"column":53,"line":54}}},{"id":"1924","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":66},"start":{"column":61,"line":58}}},{"id":"1923","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":106,"line":54},"start":{"column":89,"line":54}}},{"id":"1925","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":117,"line":59},"start":{"column":13,"line":59}}},{"id":"1926","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":117,"line":59},"start":{"column":13,"line":59}}},{"id":"1916","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":18,"line":47},"start":{"column":72,"line":43}}},{"id":"1928","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":59},"start":{"column":13,"line":59}}},{"id":"1930","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":59},"start":{"column":13,"line":59}}},{"id":"1929","mutatorName":"LogicalOperator","replacement":"meta.config.allowGuestHandles && postData && postData.user || parseInt(postData.uid, 10) === 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":59},"start":{"column":13,"line":59}}},{"id":"1931","mutatorName":"LogicalOperator","replacement":"meta.config.allowGuestHandles && postData || postData.user","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":59},"start":{"column":13,"line":59}}},{"id":"1932","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":59},"start":{"column":13,"line":59}}},{"id":"1933","mutatorName":"LogicalOperator","replacement":"meta.config.allowGuestHandles || postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":59},"start":{"column":13,"line":59}}},{"id":"1934","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":59},"start":{"column":75,"line":59}}},{"id":"1936","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":65},"start":{"column":119,"line":59}}},{"id":"1935","mutatorName":"EqualityOperator","replacement":"parseInt(postData.uid, 10) !== 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":107,"line":59},"start":{"column":75,"line":59}}},{"id":"1937","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":61},"start":{"column":17,"line":61}}},{"id":"1938","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":61},"start":{"column":17,"line":61}}},{"id":"1927","mutatorName":"LogicalOperator","replacement":"meta.config.allowGuestHandles && postData && postData.user && parseInt(postData.uid, 10) === 0 || handle","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":117,"line":59},"start":{"column":13,"line":59}}},{"id":"1940","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":63},"start":{"column":59,"line":61}}},{"id":"1941","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":73},"start":{"column":63,"line":68}}},{"id":"1942","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":69},"start":{"column":13,"line":69}}},{"id":"1943","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":69},"start":{"column":13,"line":69}}},{"id":"1944","mutatorName":"LogicalOperator","replacement":"!Array.isArray(groupTitleArray) && !groupTitleArray.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":69},"start":{"column":13,"line":69}}},{"id":"1945","mutatorName":"BooleanLiteral","replacement":"Array.isArray(groupTitleArray)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":69},"start":{"column":13,"line":69}}},{"id":"1946","mutatorName":"BooleanLiteral","replacement":"groupTitleArray.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":71,"line":69},"start":{"column":48,"line":69}}},{"id":"1947","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":71},"start":{"column":73,"line":69}}},{"id":"1948","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":81},"start":{"column":65,"line":75}}},{"id":"1949","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":76},"start":{"column":13,"line":76}}},{"id":"1951","mutatorName":"LogicalOperator","replacement":"(!userData.signature || !signatureUids.has(userData.uid)) && meta.config.disableSignatures","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":76},"start":{"column":13,"line":76}}},{"id":"1950","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":76},"start":{"column":13,"line":76}}},{"id":"1952","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":76},"start":{"column":13,"line":76}}},{"id":"1953","mutatorName":"LogicalOperator","replacement":"!userData.signature && !signatureUids.has(userData.uid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":76},"start":{"column":13,"line":76}}},{"id":"1954","mutatorName":"BooleanLiteral","replacement":"userData.signature","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":76},"start":{"column":13,"line":76}}},{"id":"1955","mutatorName":"BooleanLiteral","replacement":"signatureUids.has(userData.uid)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":76},"start":{"column":36,"line":76}}},{"id":"1957","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":77},"start":{"column":20,"line":77}}},{"id":"1956","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":78},"start":{"column":103,"line":76}}},{"id":"1958","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":100},"start":{"column":43,"line":83}}},{"id":"1959","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":84},"start":{"column":59,"line":84}}},{"id":"1960","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":84},"start":{"column":64,"line":84}}},{"id":"1961","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":84},"start":{"column":64,"line":84}}},{"id":"1962","mutatorName":"LogicalOperator","replacement":"u || u.groupTitleArray","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":84},"start":{"column":64,"line":84}}},{"id":"1963","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":98},"start":{"column":39,"line":87}}},{"id":"1964","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":88},"start":{"column":17,"line":88}}},{"id":"1965","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":88},"start":{"column":17,"line":88}}},{"id":"1966","mutatorName":"LogicalOperator","replacement":"group && group.userTitleEnabled || !group.hidden","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":88},"start":{"column":17,"line":88}}},{"id":"1967","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":88},"start":{"column":17,"line":88}}},{"id":"1968","mutatorName":"LogicalOperator","replacement":"group || group.userTitleEnabled","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":88},"start":{"column":17,"line":88}}},{"id":"1969","mutatorName":"BooleanLiteral","replacement":"group.hidden","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":88},"start":{"column":52,"line":88}}},{"id":"1970","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":97},"start":{"column":67,"line":88}}},{"id":"1972","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":115},"start":{"column":43,"line":102}}},{"id":"1971","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":96},"start":{"column":41,"line":89}}},{"id":"1974","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":104},"start":{"column":13,"line":104}}},{"id":"1973","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":108},"start":{"column":24,"line":103}}},{"id":"1975","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":104},"start":{"column":20,"line":104}}},{"id":"1976","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":104},"start":{"column":32,"line":104}}},{"id":"1978","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":105},"start":{"column":13,"line":105}}},{"id":"1977","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":104},"start":{"column":44,"line":104}}},{"id":"1979","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":105},"start":{"column":27,"line":105}}},{"id":"1980","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":105},"start":{"column":40,"line":105}}},{"id":"1939","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":56,"line":61},"start":{"column":46,"line":61}}},{"id":"1982","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":106},"start":{"column":13,"line":106}}},{"id":"1984","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":106},"start":{"column":36,"line":106}}},{"id":"1983","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":106},"start":{"column":26,"line":106}}},{"id":"1985","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":106},"start":{"column":53,"line":106}}},{"id":"1986","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":107},"start":{"column":13,"line":107}}},{"id":"1987","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":107},"start":{"column":27,"line":107}}},{"id":"1988","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":107},"start":{"column":41,"line":107}}},{"id":"1989","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":109},"start":{"column":49,"line":109}}},{"id":"1990","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":113},"start":{"column":79,"line":109}}},{"id":"1981","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":63,"line":105},"start":{"column":54,"line":105}}},{"id":"1991","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":127},"start":{"column":48,"line":117}}},{"id":"1993","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":121},"start":{"column":13,"line":121}}},{"id":"1994","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":121},"start":{"column":13,"line":121}}},{"id":"1995","mutatorName":"EqualityOperator","replacement":"uid <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":121},"start":{"column":13,"line":121}}},{"id":"1997","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":123},"start":{"column":23,"line":121}}},{"id":"1996","mutatorName":"EqualityOperator","replacement":"uid > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":121},"start":{"column":13,"line":121}}},{"id":"1998","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":122},"start":{"column":39,"line":122}}},{"id":"1999","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":122},"start":{"column":45,"line":122}}},{"id":"2000","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":122},"start":{"column":54,"line":122}}},{"id":"1992","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":39,"line":120},"start":{"column":33,"line":120}}},{"id":"2002","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":124},"start":{"column":60,"line":124}}},{"id":"2003","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":37,"line":125}}},{"id":"2004","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":45,"line":125}}},{"id":"2005","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":45,"line":125}}},{"id":"2006","mutatorName":"LogicalOperator","replacement":"post || post.uid === uid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":45,"line":125}}},{"id":"2007","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":53,"line":125}}},{"id":"2008","mutatorName":"EqualityOperator","replacement":"post.uid !== uid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":125},"start":{"column":53,"line":125}}},{"id":"2009","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":135},"start":{"column":52,"line":129}}},{"id":"2010","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":130},"start":{"column":13,"line":130}}},{"id":"2011","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":130},"start":{"column":13,"line":130}}},{"id":"2001","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":66,"line":124},"start":{"column":59,"line":124}}},{"id":"2012","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":130},"start":{"column":13,"line":130}}},{"id":"2014","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":132},"start":{"column":37,"line":130}}},{"id":"2015","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":131},"start":{"column":29,"line":131}}},{"id":"2016","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":131},"start":{"column":35,"line":131}}},{"id":"2017","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":189},"start":{"column":54,"line":137}}},{"id":"2018","mutatorName":"BooleanLiteral","replacement":"exists","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":139},"start":{"column":13,"line":139}}},{"id":"2019","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":139},"start":{"column":13,"line":139}}},{"id":"2020","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":139},"start":{"column":13,"line":139}}},{"id":"2021","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":141},"start":{"column":22,"line":139}}},{"id":"2022","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":140},"start":{"column":29,"line":140}}},{"id":"2023","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":144},"start":{"column":57,"line":142}}},{"id":"2024","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":143},"start":{"column":13,"line":143}}},{"id":"2025","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":143},"start":{"column":20,"line":143}}},{"id":"2026","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":143},"start":{"column":27,"line":143}}},{"id":"2027","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":143},"start":{"column":34,"line":143}}},{"id":"2028","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":143},"start":{"column":45,"line":143}}},{"id":"2029","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":143},"start":{"column":56,"line":143}}},{"id":"2030","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":143},"start":{"column":69,"line":143}}},{"id":"2031","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":143},"start":{"column":80,"line":143}}},{"id":"2032","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":145},"start":{"column":20,"line":145}}},{"id":"2033","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":36,"line":145}}},{"id":"2035","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":41,"line":145}}},{"id":"2034","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":41,"line":145}}},{"id":"2036","mutatorName":"LogicalOperator","replacement":"p.pid || p.uid !== parseInt(toUid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":41,"line":145}}},{"id":"2037","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":50,"line":145}}},{"id":"2038","mutatorName":"EqualityOperator","replacement":"p.uid === parseInt(toUid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":145},"start":{"column":50,"line":145}}},{"id":"2039","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":146},"start":{"column":29,"line":146}}},{"id":"2041","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":151},"start":{"column":25,"line":151}}},{"id":"2040","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":150},"start":{"column":28,"line":150}}},{"id":"2042","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":168},"start":{"column":39,"line":154}}},{"id":"2043","mutatorName":"AssignmentOperator","replacement":"repChange -= post.votes","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":156},"start":{"column":13,"line":156}}},{"id":"2044","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":157},"start":{"column":29,"line":157}}},{"id":"2045","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":157},"start":{"column":30,"line":157}}},{"id":"2047","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":158},"start":{"column":30,"line":158}}},{"id":"2046","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":158},"start":{"column":29,"line":158}}},{"id":"2048","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":85,"line":159},"start":{"column":29,"line":159}}},{"id":"2049","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":159},"start":{"column":30,"line":159}}},{"id":"2050","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":161},"start":{"column":26,"line":161}}},{"id":"2051","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":161},"start":{"column":27,"line":161}}},{"id":"2054","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":163},"start":{"column":17,"line":163}}},{"id":"2053","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":162},"start":{"column":27,"line":162}}},{"id":"2052","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":89,"line":162},"start":{"column":26,"line":162}}},{"id":"2013","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) > 0","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":35,"line":130},"start":{"column":13,"line":130}}},{"id":"2056","mutatorName":"LogicalOperator","replacement":"post.votes > 0 && post.votes <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":163},"start":{"column":17,"line":163}}},{"id":"2057","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":163},"start":{"column":17,"line":163}}},{"id":"2059","mutatorName":"EqualityOperator","replacement":"post.votes <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":163},"start":{"column":17,"line":163}}},{"id":"2058","mutatorName":"EqualityOperator","replacement":"post.votes >= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":163},"start":{"column":17,"line":163}}},{"id":"2060","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":163},"start":{"column":35,"line":163}}},{"id":"2061","mutatorName":"EqualityOperator","replacement":"post.votes <"+"= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":163},"start":{"column":35,"line":163}}},{"id":"2062","mutatorName":"EqualityOperator","replacement":"post.votes >= 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":163},"start":{"column":35,"line":163}}},{"id":"2063","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":165},"start":{"column":51,"line":163}}},{"id":"2065","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":164},"start":{"column":31,"line":164}}},{"id":"2064","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":164},"start":{"column":30,"line":164}}},{"id":"2066","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":166},"start":{"column":37,"line":166}}},{"id":"2067","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":166},"start":{"column":37,"line":166}}},{"id":"2068","mutatorName":"LogicalOperator","replacement":"postsByUser[post.uid] && []","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":166},"start":{"column":37,"line":166}}},{"id":"2070","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":177},"start":{"column":27,"line":170}}},{"id":"2071","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":171},"start":{"column":40,"line":171}}},{"id":"2069","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":166},"start":{"column":62,"line":166}}},{"id":"2072","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":171},"start":{"column":47,"line":171}}},{"id":"2073","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":171},"start":{"column":63,"line":171}}},{"id":"2074","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":182},"start":{"column":27,"line":179}}},{"id":"2077","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":199},"start":{"column":48,"line":191}}},{"id":"2075","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":184},"start":{"column":28,"line":184}}},{"id":"2078","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":198},"start":{"column":69,"line":192}}},{"id":"2076","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":187},"start":{"column":55,"line":184}}},{"id":"2079","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":193},"start":{"column":44,"line":193}}},{"id":"2080","mutatorName":"ArithmeticOperator","replacement":"acc - val.votes","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":193},"start":{"column":58,"line":193}}},{"id":"2081","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":197},"start":{"column":31,"line":194}}},{"id":"2082","mutatorName":"UnaryOperator","replacement":"+repChange","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":196},"start":{"column":53,"line":196}}},{"id":"2083","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":210},"start":{"column":56,"line":201}}},{"id":"2084","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":202},"start":{"column":50,"line":202}}},{"id":"2085","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":209},"start":{"column":64,"line":203}}},{"id":"2087","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":205},"start":{"column":38,"line":205}}},{"id":"2086","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":204},"start":{"column":50,"line":204}}},{"id":"2089","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":207},"start":{"column":42,"line":207}}},{"id":"2088","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":208},"start":{"column":67,"line":206}}},{"id":"2090","mutatorName":"UnaryOperator","replacement":"+posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":207},"start":{"column":64,"line":207}}},{"id":"2091","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":250},"start":{"column":62,"line":212}}},{"id":"2094","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":215},"start":{"column":13,"line":215}}},{"id":"2092","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":213},"start":{"column":42,"line":213}}},{"id":"2096","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":215},"start":{"column":27,"line":215}}},{"id":"2095","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":215},"start":{"column":20,"line":215}}},{"id":"2093","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":216},"start":{"column":62,"line":214}}},{"id":"2055","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":49,"line":163},"start":{"column":17,"line":163}}},{"id":"2099","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":215},"start":{"column":54,"line":215}}},{"id":"2101","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":84,"line":219},"start":{"column":27,"line":219}}},{"id":"2098","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":215},"start":{"column":47,"line":215}}},{"id":"2100","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":215},"start":{"column":65,"line":215}}},{"id":"2102","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":219},"start":{"column":43,"line":219}}},{"id":"2103","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":219},"start":{"column":48,"line":219}}},{"id":"2104","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":219},"start":{"column":48,"line":219}}},{"id":"2107","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":220},"start":{"column":13,"line":220}}},{"id":"2105","mutatorName":"EqualityOperator","replacement":"p.pid !== tidToTopic[p.tid].mainPid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":219},"start":{"column":48,"line":219}}},{"id":"2106","mutatorName":"BooleanLiteral","replacement":"mainPosts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":220},"start":{"column":13,"line":220}}},{"id":"2108","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":220},"start":{"column":13,"line":220}}},{"id":"2109","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":222},"start":{"column":32,"line":220}}},{"id":"2110","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":224},"start":{"column":25,"line":224}}},{"id":"2112","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":235},"start":{"column":37,"line":227}}},{"id":"2111","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":225},"start":{"column":28,"line":225}}},{"id":"2113","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":228},"start":{"column":29,"line":228}}},{"id":"2114","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":228},"start":{"column":30,"line":228}}},{"id":"2115","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":229},"start":{"column":29,"line":229}}},{"id":"2117","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":105,"line":231},"start":{"column":26,"line":231}}},{"id":"2119","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":232},"start":{"column":26,"line":232}}},{"id":"2118","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":231},"start":{"column":27,"line":231}}},{"id":"2116","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":229},"start":{"column":30,"line":229}}},{"id":"2120","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":232},"start":{"column":27,"line":232}}},{"id":"2121","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":233},"start":{"column":37,"line":233}}},{"id":"2122","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":233},"start":{"column":37,"line":233}}},{"id":"2124","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":233},"start":{"column":62,"line":233}}},{"id":"2123","mutatorName":"LogicalOperator","replacement":"postsByUser[post.uid] && []","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":233},"start":{"column":37,"line":233}}},{"id":"2125","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":243},"start":{"column":27,"line":237}}},{"id":"2126","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":238},"start":{"column":45,"line":238}}},{"id":"2127","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":238},"start":{"column":50,"line":238}}},{"id":"2129","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":241},"start":{"column":46,"line":241}}},{"id":"2128","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":238},"start":{"column":69,"line":238}}},{"id":"2130","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":245},"start":{"column":45,"line":245}}},{"id":"2131","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":246},"start":{"column":28,"line":246}}},{"id":"2132","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":249},"start":{"column":56,"line":246}}},{"id":"2133","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":260},"start":{"column":51,"line":252}}},{"id":"2136","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":256},"start":{"column":17,"line":256}}},{"id":"2097","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":45,"line":215},"start":{"column":38,"line":215}}},{"id":"2135","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":256},"start":{"column":17,"line":256}}},{"id":"2137","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":258},"start":{"column":25,"line":256}}},{"id":"2138","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":66,"line":257},"start":{"column":54,"line":257}}},{"id":"2139","mutatorName":"UnaryOperator","replacement":"+posts.length","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":257},"start":{"column":68,"line":257}}},{"id":"2134","mutatorName":"BlockStatement","replacement":"{}","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":10,"line":259},"start":{"column":73,"line":253}}}],"source":"'use strict';\n\nconst async = require('async');\nconst validator = require('validator');\nconst _ = require('lodash');\n\nconst db = require('../database');\nconst user = require('../user');\nconst topics = require('../topics');\nconst groups = require('../groups');\nconst meta = require('../meta');\nconst plugins = require('../plugins');\nconst privileges = require('../privileges');\n\nmodule.exports = function (Posts) {\n    Posts.getUserInfoForPosts = async function (uids, uid) {\n        const [userData, userSettings, signatureUids] = await Promise.all([\n            getUserData(uids, uid),\n            user.getMultipleUserSettings(uids),\n            privileges.global.filterUids('signature', uids),\n        ]);\n        const uidsSignatureSet = new Set(signatureUids.map(uid => parseInt(uid, 10)));\n        const groupsMap = await getGroupsMap(userData);\n\n        userData.forEach((userData, index) => {\n            userData.signature = validator.escape(String(userData.signature || ''));\n            userData.fullname = userSettings[index].showfullname ? validator.escape(String(userData.fullname || '')) : undefined;\n            userData.selectedGroups = [];\n\n            if (meta.config.hideFullname) {\n                userData.fullname = undefined;\n            }\n        });\n\n        const result = await Promise.all(userData.map(async (userData) => {\n            const [isMemberOfGroups, signature, customProfileInfo] = await Promise.all([\n                checkGroupMembership(userData.uid, userData.groupTitleArray),\n                parseSignature(userData, uid, uidsSignatureSet),\n                plugins.hooks.fire('filter:posts.custom_profile_info', { profile: [], uid: userData.uid }),\n            ]);\n\n            if (isMemberOfGroups && userData.groupTitleArray) {\n                userData.groupTitleArray.forEach((userGroup, index) => {\n                    if (isMemberOfGroups[index] && groupsMap[userGroup]) {\n                        userData.selectedGroups.push(groupsMap[userGroup]);\n                    }\n                });\n            }\n            userData.signature = signature;\n            userData.custom_profile_info = customProfileInfo.profile;\n\n            return await plugins.hooks.fire('filter:posts.modifyUserInfo', userData);\n        }));\n        const hookResult = await plugins.hooks.fire('filter:posts.getUserInfoForPosts', { users: result });\n        return hookResult.users;\n    };\n\n    Posts.overrideGuestHandle = function (postData, handle) {\n        if (meta.config.allowGuestHandles && postData && postData.user && parseInt(postData.uid, 10) === 0 && handle) {\n            postData.user.username = validator.escape(String(handle));\n            if (postData.user.hasOwnProperty('fullname')) {\n                postData.user.fullname = postData.user.username;\n            }\n            postData.user.displayname = postData.user.username;\n        }\n    };\n\n    async function checkGroupMembership(uid, groupTitleArray) {\n        if (!Array.isArray(groupTitleArray) || !groupTitleArray.length) {\n            return null;\n        }\n        return await groups.isMemberOfGroups(uid, groupTitleArray);\n    }\n\n    async function parseSignature(userData, uid, signatureUids) {\n        if (!userData.signature || !signatureUids.has(userData.uid) || meta.config.disableSignatures) {\n            return '';\n        }\n        const result = await Posts.parseSignature(userData, uid);\n        return result.userData.signature;\n    }\n\n    async function getGroupsMap(userData) {\n        const groupTitles = _.uniq(_.flatten(userData.map(u => u && u.groupTitleArray)));\n        const groupsMap = {};\n        const groupsData = await groups.getGroupsData(groupTitles);\n        groupsData.forEach((group) => {\n            if (group && group.userTitleEnabled && !group.hidden) {\n                groupsMap[group.name] = {\n                    name: group.name,\n                    slug: group.slug,\n                    labelColor: group.labelColor,\n                    textColor: group.textColor,\n                    icon: group.icon,\n                    userTitle: group.userTitle,\n                };\n            }\n        });\n        return groupsMap;\n    }\n\n    async function getUserData(uids, uid) {\n        const fields = [\n            'uid', 'username', 'fullname', 'userslug',\n            'reputation', 'postcount', 'topiccount', 'picture',\n            'signature', 'banned', 'banned:expire', 'status',\n            'lastonline', 'groupTitle', 'mutedUntil',\n        ];\n        const result = await plugins.hooks.fire('filter:posts.addUserFields', {\n            fields: fields,\n            uid: uid,\n            uids: uids,\n        });\n        return await user.getUsersFields(result.uids, _.uniq(result.fields));\n    }\n\n    Posts.isOwner = async function (pids, uid) {\n        uid = parseInt(uid, 10);\n        const isArray = Array.isArray(pids);\n        pids = isArray ? pids : [pids];\n        if (uid <"+"= 0) {\n            return isArray ? pids.map(() => false) : false;\n        }\n        const postData = await Posts.getPostsFields(pids, ['uid']);\n        const result = postData.map(post => post && post.uid === uid);\n        return isArray ? result : result[0];\n    };\n\n    Posts.isModerator = async function (pids, uid) {\n        if (parseInt(uid, 10) <"+"= 0) {\n            return pids.map(() => false);\n        }\n        const cids = await Posts.getCidsByPids(pids);\n        return await user.isModerator(uid, cids);\n    };\n\n    Posts.changeOwner = async function (pids, toUid) {\n        const exists = await user.exists(toUid);\n        if (!exists) {\n            throw new Error('[[error:no-user]]');\n        }\n        let postData = await Posts.getPostsFields(pids, [\n            'pid', 'tid', 'uid', 'content', 'deleted', 'timestamp', 'upvotes', 'downvotes',\n        ]);\n        postData = postData.filter(p => p.pid && p.uid !== parseInt(toUid, 10));\n        pids = postData.map(p => p.pid);\n\n        const cids = await Posts.getCidsByPids(pids);\n\n        const bulkRemove = [];\n        const bulkAdd = [];\n        let repChange = 0;\n        const postsByUser = {};\n        postData.forEach((post, i) => {\n            post.cid = cids[i];\n            repChange += post.votes;\n            bulkRemove.push([`uid:${post.uid}:posts`, post.pid]);\n            bulkRemove.push([`cid:${post.cid}:uid:${post.uid}:pids`, post.pid]);\n            bulkRemove.push([`cid:${post.cid}:uid:${post.uid}:pids:votes`, post.pid]);\n\n            bulkAdd.push([`uid:${toUid}:posts`, post.timestamp, post.pid]);\n            bulkAdd.push([`cid:${post.cid}:uid:${toUid}:pids`, post.timestamp, post.pid]);\n            if (post.votes > 0 || post.votes <"+" 0) {\n                bulkAdd.push([`cid:${post.cid}:uid:${toUid}:pids:votes`, post.votes, post.pid]);\n            }\n            postsByUser[post.uid] = postsByUser[post.uid] || [];\n            postsByUser[post.uid].push(post);\n        });\n\n        await Promise.all([\n            db.setObjectField(pids.map(pid => `post:${pid}`), 'uid', toUid),\n            db.sortedSetRemoveBulk(bulkRemove),\n            db.sortedSetAddBulk(bulkAdd),\n            user.incrementUserReputationBy(toUid, repChange),\n            handleMainPidOwnerChange(postData, toUid),\n            updateTopicPosters(postData, toUid),\n        ]);\n\n        await Promise.all([\n            user.updatePostCount(toUid),\n            reduceCounters(postsByUser),\n        ]);\n\n        plugins.hooks.fire('action:post.changeOwner', {\n            posts: _.cloneDeep(postData),\n            toUid: toUid,\n        });\n        return postData;\n    };\n\n    async function reduceCounters(postsByUser) {\n        await async.eachOfSeries(postsByUser, async (posts, uid) => {\n            const repChange = posts.reduce((acc, val) => acc + val.votes, 0);\n            await Promise.all([\n                user.updatePostCount(uid),\n                user.incrementUserReputationBy(uid, -repChange),\n            ]);\n        });\n    }\n\n    async function updateTopicPosters(postData, toUid) {\n        const postsByTopic = _.groupBy(postData, p => parseInt(p.tid, 10));\n        await async.eachOf(postsByTopic, async (posts, tid) => {\n            const postsByUser = _.groupBy(posts, p => parseInt(p.uid, 10));\n            await db.sortedSetIncrBy(`tid:${tid}:posters`, posts.length, toUid);\n            await async.eachOf(postsByUser, async (posts, uid) => {\n                await db.sortedSetIncrBy(`tid:${tid}:posters`, -posts.length, uid);\n            });\n        });\n    }\n\n    async function handleMainPidOwnerChange(postData, toUid) {\n        const tids = _.uniq(postData.map(p => p.tid));\n        const topicData = await topics.getTopicsFields(tids, [\n            'tid', 'cid', 'deleted', 'title', 'uid', 'mainPid', 'timestamp',\n        ]);\n        const tidToTopic = _.zipObject(tids, topicData);\n\n        const mainPosts = postData.filter(p => p.pid === tidToTopic[p.tid].mainPid);\n        if (!mainPosts.length) {\n            return;\n        }\n\n        const bulkAdd = [];\n        const bulkRemove = [];\n        const postsByUser = {};\n        mainPosts.forEach((post) => {\n            bulkRemove.push([`cid:${post.cid}:uid:${post.uid}:tids`, post.tid]);\n            bulkRemove.push([`uid:${post.uid}:topics`, post.tid]);\n\n            bulkAdd.push([`cid:${post.cid}:uid:${toUid}:tids`, tidToTopic[post.tid].timestamp, post.tid]);\n            bulkAdd.push([`uid:${toUid}:topics`, tidToTopic[post.tid].timestamp, post.tid]);\n            postsByUser[post.uid] = postsByUser[post.uid] || [];\n            postsByUser[post.uid].push(post);\n        });\n\n        await Promise.all([\n            db.setObjectField(mainPosts.map(p => `topic:${p.tid}`), 'uid', toUid),\n            db.sortedSetRemoveBulk(bulkRemove),\n            db.sortedSetAddBulk(bulkAdd),\n            user.incrementUserFieldBy(toUid, 'topiccount', mainPosts.length),\n            reduceTopicCounts(postsByUser),\n        ]);\n\n        const changedTopics = mainPosts.map(p => tidToTopic[p.tid]);\n        plugins.hooks.fire('action:topic.changeOwner', {\n            topics: _.cloneDeep(changedTopics),\n            toUid: toUid,\n        });\n    }\n\n    async function reduceTopicCounts(postsByUser) {\n        await async.eachSeries(Object.keys(postsByUser), async (uid) => {\n            const posts = postsByUser[uid];\n            const exists = await user.exists(uid);\n            if (exists) {\n                await user.incrementUserFieldBy(uid, 'topiccount', -posts.length);\n            }\n        });\n    }\n};\n"},"src/posts/votes.js":{"language":"javascript","mutants":[{"id":"2142","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":16},"start":{"column":13,"line":16}}},{"id":"2141","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":34},"start":{"column":46,"line":15}}},{"id":"2140","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":293},"start":{"column":35,"line":12}}},{"id":"2143","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":16},"start":{"column":13,"line":16}}},{"id":"2145","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":18},"start":{"column":49,"line":16}}},{"id":"2144","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":16},"start":{"column":25,"line":16}}},{"id":"2146","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":17},"start":{"column":29,"line":17}}},{"id":"2147","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":19},"start":{"column":54,"line":19}}},{"id":"2148","mutatorName":"BooleanLiteral","replacement":"canUpvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":20},"start":{"column":13,"line":20}}},{"id":"2149","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":20},"start":{"column":13,"line":20}}},{"id":"2151","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":22},"start":{"column":25,"line":20}}},{"id":"2150","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":23,"line":20},"start":{"column":13,"line":20}}},{"id":"2152","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":21},"start":{"column":29,"line":21}}},{"id":"2153","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":24},"start":{"column":13,"line":24}}},{"id":"2154","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":24},"start":{"column":13,"line":24}}},{"id":"2155","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":26},"start":{"column":39,"line":24}}},{"id":"2157","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":31},"start":{"column":13,"line":29}}},{"id":"2156","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":25},"start":{"column":29,"line":25}}},{"id":"2158","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":30},"start":{"column":37,"line":30}}},{"id":"2159","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":33},"start":{"column":19,"line":31}}},{"id":"2160","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":59},"start":{"column":48,"line":36}}},{"id":"2161","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":37},"start":{"column":13,"line":37}}},{"id":"2162","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":37},"start":{"column":13,"line":37}}},{"id":"2163","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":37},"start":{"column":25,"line":37}}},{"id":"2164","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":39},"start":{"column":49,"line":37}}},{"id":"2165","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":38},"start":{"column":29,"line":38}}},{"id":"2166","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":41},"start":{"column":13,"line":41}}},{"id":"2167","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":41},"start":{"column":13,"line":41}}},{"id":"2168","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":41},"start":{"column":25,"line":41}}},{"id":"2169","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":43},"start":{"column":47,"line":41}}},{"id":"2170","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":42},"start":{"column":29,"line":42}}},{"id":"2171","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":44},"start":{"column":56,"line":44}}},{"id":"2172","mutatorName":"BooleanLiteral","replacement":"canDownvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":45},"start":{"column":13,"line":45}}},{"id":"2173","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":45},"start":{"column":13,"line":45}}},{"id":"2174","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":45},"start":{"column":13,"line":45}}},{"id":"2175","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":47},"start":{"column":27,"line":45}}},{"id":"2176","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":46},"start":{"column":29,"line":46}}},{"id":"2178","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":49},"start":{"column":13,"line":49}}},{"id":"2179","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":51},"start":{"column":39,"line":49}}},{"id":"2181","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":56},"start":{"column":13,"line":54}}},{"id":"2180","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":50},"start":{"column":29,"line":50}}},{"id":"2182","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":55},"start":{"column":37,"line":55}}},{"id":"2183","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":58},"start":{"column":19,"line":56}}},{"id":"2184","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":73},"start":{"column":46,"line":61}}},{"id":"2185","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":62},"start":{"column":13,"line":62}}},{"id":"2187","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":64},"start":{"column":39,"line":62}}},{"id":"2186","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":62},"start":{"column":13,"line":62}}},{"id":"2177","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":37,"line":49},"start":{"column":13,"line":49}}},{"id":"2189","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":70},"start":{"column":13,"line":67}}},{"id":"2190","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":69},"start":{"column":43,"line":69}}},{"id":"2191","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":72},"start":{"column":19,"line":70}}},{"id":"2192","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":81},"start":{"column":48,"line":75}}},{"id":"2194","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":76},"start":{"column":13,"line":76}}},{"id":"2193","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":76},"start":{"column":13,"line":76}}},{"id":"2195","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":76},"start":{"column":13,"line":76}}},{"id":"2188","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":69,"line":63},"start":{"column":29,"line":63}}},{"id":"2197","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":78},"start":{"column":37,"line":76}}},{"id":"2198","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":77},"start":{"column":20,"line":77}}},{"id":"2200","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":77},"start":{"column":49,"line":77}}},{"id":"2199","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":77},"start":{"column":31,"line":77}}},{"id":"2201","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":94,"line":79},"start":{"column":50,"line":79}}},{"id":"2202","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":79},"start":{"column":51,"line":79}}},{"id":"2203","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":79},"start":{"column":72,"line":79}}},{"id":"2204","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":80},"start":{"column":16,"line":80}}},{"id":"2206","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":84},"start":{"column":13,"line":84}}},{"id":"2205","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":95},"start":{"column":63,"line":83}}},{"id":"2196","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) > 0","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":35,"line":76},"start":{"column":13,"line":76}}},{"id":"2208","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":84},"start":{"column":13,"line":84}}},{"id":"2209","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":84},"start":{"column":13,"line":84}}},{"id":"2211","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":85},"start":{"column":35,"line":85}}},{"id":"2210","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":87},"start":{"column":37,"line":84}}},{"id":"2212","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":46,"line":85},"start":{"column":41,"line":85}}},{"id":"2213","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":86},"start":{"column":20,"line":86}}},{"id":"2215","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":88},"start":{"column":44,"line":88}}},{"id":"2214","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":88},"start":{"column":37,"line":88}}},{"id":"2218","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":94},"start":{"column":16,"line":91}}},{"id":"2216","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":89},"start":{"column":39,"line":89}}},{"id":"2217","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":89},"start":{"column":46,"line":89}}},{"id":"2207","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":35,"line":84},"start":{"column":13,"line":84}}},{"id":"2221","mutatorName":"ArithmeticOperator","replacement":"pids.length / 2","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":93},"start":{"column":48,"line":93}}},{"id":"2220","mutatorName":"MethodExpression","replacement":"data","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":93},"start":{"column":24,"line":93}}},{"id":"2222","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":99},"start":{"column":56,"line":97}}},{"id":"2223","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":98},"start":{"column":49,"line":98}}},{"id":"2224","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":98},"start":{"column":56,"line":98}}},{"id":"2225","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":103},"start":{"column":39,"line":101}}},{"id":"2226","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":102},"start":{"column":16,"line":102}}},{"id":"2227","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":102},"start":{"column":16,"line":102}}},{"id":"2229","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":108},"start":{"column":42,"line":105}}},{"id":"2230","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":32,"line":106}}},{"id":"2228","mutatorName":"LogicalOperator","replacement":"Array.isArray(votesInProgress[uid]) || votesInProgress[uid].includes(parseInt(pid, 10))","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":102},"start":{"column":16,"line":102}}},{"id":"2219","mutatorName":"MethodExpression","replacement":"data","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":48,"line":92},"start":{"column":22,"line":92}}},{"id":"2232","mutatorName":"LogicalOperator","replacement":"votesInProgress[uid] && []","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":32,"line":106}}},{"id":"2236","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":111},"start":{"column":13,"line":111}}},{"id":"2234","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":117},"start":{"column":42,"line":110}}},{"id":"2233","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":106},"start":{"column":56,"line":106}}},{"id":"2235","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":111},"start":{"column":13,"line":111}}},{"id":"2237","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":116},"start":{"column":50,"line":111}}},{"id":"2238","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":113},"start":{"column":17,"line":113}}},{"id":"2241","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":113},"start":{"column":27,"line":113}}},{"id":"2239","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":113},"start":{"column":17,"line":113}}},{"id":"2240","mutatorName":"EqualityOperator","replacement":"index === -1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":113},"start":{"column":17,"line":113}}},{"id":"2242","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":115},"start":{"column":31,"line":113}}},{"id":"2231","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":58,"line":106},"start":{"column":32,"line":106}}},{"id":"2244","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":122},"start":{"column":33,"line":122}}},{"id":"2248","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":127},"start":{"column":13,"line":127}}},{"id":"2246","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":126},"start":{"column":53,"line":126}}},{"id":"2245","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":140},"start":{"column":55,"line":125}}},{"id":"2247","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":127},"start":{"column":13,"line":127}}},{"id":"2249","mutatorName":"EqualityOperator","replacement":"parseInt(uid, 10) !== parseInt(owner, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":127},"start":{"column":13,"line":127}}},{"id":"2250","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":129},"start":{"column":56,"line":127}}},{"id":"2251","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":50,"line":128},"start":{"column":29,"line":128}}},{"id":"2253","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":13,"line":131}}},{"id":"2254","mutatorName":"LogicalOperator","replacement":"type === 'downvote' && type === 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":13,"line":131}}},{"id":"2252","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":13,"line":131}}},{"id":"2243","mutatorName":"BlockStatement","replacement":"{}","statusReason":"[[error:no-user]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":6,"line":123},"start":{"column":47,"line":119}}},{"id":"2256","mutatorName":"EqualityOperator","replacement":"type !== 'downvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":131},"start":{"column":13,"line":131}}},{"id":"2257","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":131},"start":{"column":22,"line":131}}},{"id":"2259","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":36,"line":131}}},{"id":"2258","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":36,"line":131}}},{"id":"2260","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":131},"start":{"column":45,"line":131}}},{"id":"2261","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":133},"start":{"column":55,"line":131}}},{"id":"2255","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":32,"line":131},"start":{"column":13,"line":131}}},{"id":"2264","mutatorName":"LogicalOperator","replacement":"!voteStatus && !voteStatus.upvoted && !voteStatus.downvoted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":135},"start":{"column":13,"line":135}}},{"id":"2265","mutatorName":"BooleanLiteral","replacement":"voteStatus","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":24,"line":135},"start":{"column":13,"line":135}}},{"id":"2263","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":135},"start":{"column":13,"line":135}}},{"id":"2266","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":135},"start":{"column":29,"line":135}}},{"id":"2267","mutatorName":"LogicalOperator","replacement":"!voteStatus.upvoted || !voteStatus.downvoted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":135},"start":{"column":29,"line":135}}},{"id":"2268","mutatorName":"BooleanLiteral","replacement":"voteStatus.upvoted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":135},"start":{"column":29,"line":135}}},{"id":"2269","mutatorName":"BooleanLiteral","replacement":"voteStatus.downvoted","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":135},"start":{"column":52,"line":135}}},{"id":"2271","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":139},"start":{"column":48,"line":139}}},{"id":"2270","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":137},"start":{"column":76,"line":135}}},{"id":"2272","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":139},"start":{"column":61,"line":139}}},{"id":"2273","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":139},"start":{"column":71,"line":139}}},{"id":"2262","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":74,"line":135},"start":{"column":13,"line":135}}},{"id":"2276","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":146},"start":{"column":36,"line":146}}},{"id":"2274","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":168},"start":{"column":56,"line":142}}},{"id":"2277","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":147},"start":{"column":37,"line":147}}},{"id":"2278","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":149},"start":{"column":17,"line":149}}},{"id":"2279","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":149},"start":{"column":42,"line":149}}},{"id":"2280","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":149},"start":{"column":46,"line":149}}},{"id":"2282","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":153},"start":{"column":13,"line":153}}},{"id":"2281","mutatorName":"ArithmeticOperator","replacement":"Date.now() + oneDay","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":73,"line":149},"start":{"column":54,"line":149}}},{"id":"2283","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":153},"start":{"column":13,"line":153}}},{"id":"2284","mutatorName":"EqualityOperator","replacement":"reputation <"+"= meta.config[`min:rep:${type}`]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":153},"start":{"column":13,"line":153}}},{"id":"2285","mutatorName":"EqualityOperator","replacement":"reputation >= meta.config[`min:rep:${type}`]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":153},"start":{"column":13,"line":153}}},{"id":"2275","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"[[error:no-category]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":10,"line":151},"start":{"column":75,"line":145}}},{"id":"2288","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":108,"line":154},"start":{"column":29,"line":154}}},{"id":"2287","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":155},"start":{"column":58,"line":153}}},{"id":"2289","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":154},"start":{"column":86,"line":154}}},{"id":"2290","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":156},"start":{"column":40,"line":156}}},{"id":"2291","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":13,"line":157}}},{"id":"2292","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":13,"line":157}}},{"id":"2294","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":27,"line":157}}},{"id":"2295","mutatorName":"EqualityOperator","replacement":"votedPidsToday.length > votesToday","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":27,"line":157}}},{"id":"2293","mutatorName":"LogicalOperator","replacement":"votesToday || votedPidsToday.length >= votesToday","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":13,"line":157}}},{"id":"2296","mutatorName":"EqualityOperator","replacement":"votedPidsToday.length <"+" votesToday","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":62,"line":157},"start":{"column":27,"line":157}}},{"id":"2297","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":159},"start":{"column":64,"line":157}}},{"id":"2286","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":55,"line":153},"start":{"column":38,"line":153}}},{"id":"2299","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":160},"start":{"column":47,"line":160}}},{"id":"2300","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":161},"start":{"column":13,"line":161}}},{"id":"2301","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":161},"start":{"column":13,"line":161}}},{"id":"2302","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":167},"start":{"column":32,"line":161}}},{"id":"2303","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":162},"start":{"column":73,"line":162}}},{"id":"2304","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":162},"start":{"column":74,"line":162}}},{"id":"2306","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":163},"start":{"column":51,"line":163}}},{"id":"2307","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":163},"start":{"column":56,"line":163}}},{"id":"2305","mutatorName":"MethodExpression","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":163},"start":{"column":35,"line":163}}},{"id":"2309","mutatorName":"EqualityOperator","replacement":"p.uid !== targetUid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":163},"start":{"column":56,"line":163}}},{"id":"2308","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":163},"start":{"column":56,"line":163}}},{"id":"2298","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:no-privileges]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":79,"line":158},"start":{"column":29,"line":158}}},{"id":"2312","mutatorName":"EqualityOperator","replacement":"targetUpVotes > voterPerUserToday","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":164},"start":{"column":17,"line":164}}},{"id":"2313","mutatorName":"EqualityOperator","replacement":"targetUpVotes <"+" voterPerUserToday","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":164},"start":{"column":17,"line":164}}},{"id":"2311","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":164},"start":{"column":17,"line":164}}},{"id":"2314","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":166},"start":{"column":53,"line":164}}},{"id":"2315","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":165},"start":{"column":33,"line":165}}},{"id":"2316","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":205},"start":{"column":61,"line":170}}},{"id":"2318","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":172},"start":{"column":13,"line":172}}},{"id":"2317","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":172},"start":{"column":13,"line":172}}},{"id":"2319","mutatorName":"EqualityOperator","replacement":"uid <"+" 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":172},"start":{"column":13,"line":172}}},{"id":"2320","mutatorName":"EqualityOperator","replacement":"uid > 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":21,"line":172},"start":{"column":13,"line":172}}},{"id":"2321","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":174},"start":{"column":23,"line":172}}},{"id":"2322","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":173},"start":{"column":29,"line":173}}},{"id":"2323","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":177},"start":{"column":13,"line":177}}},{"id":"2324","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":177},"start":{"column":13,"line":177}}},{"id":"2325","mutatorName":"LogicalOperator","replacement":"type === 'upvote' || !unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":177},"start":{"column":13,"line":177}}},{"id":"2326","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":177},"start":{"column":13,"line":177}}},{"id":"2327","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":177},"start":{"column":13,"line":177}}},{"id":"2328","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":177},"start":{"column":22,"line":177}}},{"id":"2330","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":179},"start":{"column":43,"line":177}}},{"id":"2329","mutatorName":"BooleanLiteral","replacement":"unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":177},"start":{"column":34,"line":177}}},{"id":"2331","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":178},"start":{"column":35,"line":178}}},{"id":"2332","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":181},"start":{"column":16,"line":179}}},{"id":"2333","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":180},"start":{"column":38,"line":180}}},{"id":"2334","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":183},"start":{"column":13,"line":183}}},{"id":"2335","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":183},"start":{"column":13,"line":183}}},{"id":"2336","mutatorName":"LogicalOperator","replacement":"type === 'upvote' && unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":183},"start":{"column":13,"line":183}}},{"id":"2337","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":183},"start":{"column":13,"line":183}}},{"id":"2339","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":183},"start":{"column":22,"line":183}}},{"id":"2338","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":183},"start":{"column":13,"line":183}}},{"id":"2340","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":185},"start":{"column":42,"line":183}}},{"id":"2343","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":186},"start":{"column":35,"line":186}}},{"id":"2341","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":184},"start":{"column":38,"line":184}}},{"id":"2342","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":187},"start":{"column":16,"line":185}}},{"id":"2345","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":63,"line":189},"start":{"column":58,"line":189}}},{"id":"2344","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":189},"start":{"column":57,"line":189}}},{"id":"2346","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":70,"line":189},"start":{"column":65,"line":189}}},{"id":"2348","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":190},"start":{"column":82,"line":190}}},{"id":"2347","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":77,"line":189},"start":{"column":72,"line":189}}},{"id":"2349","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":190},"start":{"column":82,"line":190}}},{"id":"2351","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":190},"start":{"column":91,"line":190}}},{"id":"2350","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":99,"line":190},"start":{"column":82,"line":190}}},{"id":"2310","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":51,"line":164},"start":{"column":17,"line":164}}},{"id":"2353","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":204},"start":{"column":16,"line":196}}},{"id":"2354","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":199},"start":{"column":19,"line":197}}},{"id":"2355","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":202},"start":{"column":21,"line":202}}},{"id":"2357","mutatorName":"LogicalOperator","replacement":"type === 'upvote' || !unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":202},"start":{"column":21,"line":202}}},{"id":"2356","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":202},"start":{"column":21,"line":202}}},{"id":"2358","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":202},"start":{"column":21,"line":202}}},{"id":"2359","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":202},"start":{"column":21,"line":202}}},{"id":"2361","mutatorName":"BooleanLiteral","replacement":"unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":202},"start":{"column":42,"line":202}}},{"id":"2360","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":38,"line":202},"start":{"column":30,"line":202}}},{"id":"2362","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":203},"start":{"column":23,"line":203}}},{"id":"2363","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":203},"start":{"column":23,"line":203}}},{"id":"2364","mutatorName":"LogicalOperator","replacement":"type === 'downvote' || !unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":203},"start":{"column":23,"line":203}}},{"id":"2365","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":203},"start":{"column":23,"line":203}}},{"id":"2366","mutatorName":"EqualityOperator","replacement":"type !== 'downvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":203},"start":{"column":23,"line":203}}},{"id":"2367","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":203},"start":{"column":32,"line":203}}},{"id":"2368","mutatorName":"BooleanLiteral","replacement":"unvote","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":203},"start":{"column":46,"line":203}}},{"id":"2369","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":224},"start":{"column":74,"line":207}}},{"id":"2370","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":209},"start":{"column":44,"line":209}}},{"id":"2371","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":65,"line":209},"start":{"column":55,"line":209}}},{"id":"2372","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":210},"start":{"column":13,"line":210}}},{"id":"2373","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":210},"start":{"column":13,"line":210}}},{"id":"2376","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":214},"start":{"column":16,"line":212}}},{"id":"2375","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":28,"line":211},"start":{"column":20,"line":211}}},{"id":"2374","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":212},"start":{"column":21,"line":210}}},{"id":"2378","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":218},"start":{"column":28,"line":218}}},{"id":"2377","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":213},"start":{"column":23,"line":213}}},{"id":"2379","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":223},"start":{"column":51,"line":218}}},{"id":"2380","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":243},"start":{"column":65,"line":226}}},{"id":"2381","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":227},"start":{"column":26,"line":227}}},{"id":"2382","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":227},"start":{"column":26,"line":227}}},{"id":"2383","mutatorName":"EqualityOperator","replacement":"type !== 'upvote'","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":227},"start":{"column":26,"line":227}}},{"id":"2385","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":227},"start":{"column":46,"line":227}}},{"id":"2384","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":227},"start":{"column":35,"line":227}}},{"id":"2388","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":228},"start":{"column":13,"line":228}}},{"id":"2387","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":228},"start":{"column":13,"line":228}}},{"id":"2386","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":67,"line":227},"start":{"column":59,"line":227}}},{"id":"2391","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":232},"start":{"column":16,"line":230}}},{"id":"2390","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":229},"start":{"column":32,"line":229}}},{"id":"2389","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":230},"start":{"column":21,"line":228}}},{"id":"2393","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":233},"start":{"column":28,"line":233}}},{"id":"2392","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":58,"line":231},"start":{"column":29,"line":231}}},{"id":"2394","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":238},"start":{"column":56,"line":235}}},{"id":"2352","mutatorName":"UnaryOperator","replacement":"+1","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":108,"line":190},"start":{"column":106,"line":190}}},{"id":"2395","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":236},"start":{"column":25,"line":236}}},{"id":"2396","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":237},"start":{"column":25,"line":237}}},{"id":"2399","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":246},"start":{"column":13,"line":246}}},{"id":"2398","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":265},"start":{"column":59,"line":245}}},{"id":"2400","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":246},"start":{"column":13,"line":246}}},{"id":"2401","mutatorName":"LogicalOperator","replacement":"(!postData || !postData.pid) && !postData.tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":246},"start":{"column":13,"line":246}}},{"id":"2403","mutatorName":"LogicalOperator","replacement":"!postData && !postData.pid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":246},"start":{"column":13,"line":246}}},{"id":"2402","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":246},"start":{"column":13,"line":246}}},{"id":"2405","mutatorName":"BooleanLiteral","replacement":"postData.pid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":246},"start":{"column":26,"line":246}}},{"id":"2404","mutatorName":"BooleanLiteral","replacement":"postData","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":22,"line":246},"start":{"column":13,"line":246}}},{"id":"2406","mutatorName":"BooleanLiteral","replacement":"postData.tid","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":246},"start":{"column":43,"line":246}}},{"id":"2407","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":248},"start":{"column":58,"line":246}}},{"id":"2408","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":74,"line":249},"start":{"column":39,"line":249}}},{"id":"2409","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":13,"line":250}}},{"id":"2412","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":26,"line":250}}},{"id":"2411","mutatorName":"LogicalOperator","replacement":"threshold || postData.votes <"+"= -threshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":13,"line":250}}},{"id":"2410","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":13,"line":250}}},{"id":"2413","mutatorName":"EqualityOperator","replacement":"postData.votes <"+" -threshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":26,"line":250}}},{"id":"2415","mutatorName":"UnaryOperator","replacement":"+threshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":250},"start":{"column":45,"line":250}}},{"id":"2414","mutatorName":"EqualityOperator","replacement":"postData.votes > -threshold","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":250},"start":{"column":26,"line":250}}},{"id":"2416","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":255},"start":{"column":58,"line":250}}},{"id":"2418","mutatorName":"UnaryOperator","replacement":"+postData.votes","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":98,"line":252},"start":{"column":83,"line":252}}},{"id":"2417","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":102,"line":252},"start":{"column":58,"line":252}}},{"id":"2419","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":54,"line":253},"start":{"column":48,"line":253}}},{"id":"2420","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":101,"line":253},"start":{"column":97,"line":253}}},{"id":"2421","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":254},"start":{"column":51,"line":254}}},{"id":"2422","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":263},"start":{"column":27,"line":256}}},{"id":"2423","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":258},"start":{"column":29,"line":258}}},{"id":"2424","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":262},"start":{"column":47,"line":259}}},{"id":"2425","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":61,"line":264},"start":{"column":28,"line":264}}},{"id":"2426","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":264},"start":{"column":63,"line":264}}},{"id":"2427","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":292},"start":{"column":51,"line":267}}},{"id":"2428","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":97,"line":268},"start":{"column":69,"line":268}}},{"id":"2429","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":268},"start":{"column":70,"line":268}}},{"id":"2430","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":268},"start":{"column":81,"line":268}}},{"id":"2431","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":268},"start":{"column":88,"line":268}}},{"id":"2433","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":270},"start":{"column":13,"line":270}}},{"id":"2432","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":270},"start":{"column":13,"line":270}}},{"id":"2436","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":271},"start":{"column":17,"line":271}}},{"id":"2434","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":276},"start":{"column":27,"line":270}}},{"id":"2435","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":271},"start":{"column":17,"line":271}}},{"id":"2437","mutatorName":"EqualityOperator","replacement":"postData.votes === 0","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":271},"start":{"column":17,"line":271}}},{"id":"2397","mutatorName":"ArithmeticOperator","replacement":"postData.upvotes + postData.downvotes","statusReason":"POST /ping sent back unexpected HTTP status code: 401 {\"status\":{\"code\":\"not-authorised\",\"message\":\"A valid login session was not found. Please log in and try again.\"},\"response\":{}}","status":"Killed","testsCompleted":18,"killedBy":["17"],"location":{"end":{"column":63,"line":241},"start":{"column":26,"line":241}}},{"id":"2438","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":273},"start":{"column":39,"line":271}}},{"id":"2442","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":278},"start":{"column":13,"line":278}}},{"id":"2440","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":275},"start":{"column":20,"line":273}}},{"id":"2441","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":95,"line":274},"start":{"column":42,"line":274}}},{"id":"2443","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":278},"start":{"column":13,"line":278}}},{"id":"2444","mutatorName":"EqualityOperator","replacement":"parseInt(topicData.mainPid, 10) === parseInt(postData.pid, 10)","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":278},"start":{"column":13,"line":278}}},{"id":"2445","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":280},"start":{"column":77,"line":278}}},{"id":"2448","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":14,"line":285},"start":{"column":49,"line":282}}},{"id":"2446","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":279},"start":{"column":42,"line":279}}},{"id":"2447","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":287},"start":{"column":26,"line":281}}},{"id":"2439","mutatorName":"StringLiteral","replacement":"``","statusReason":"[[error:invalid-email]]","status":"Killed","testsCompleted":9,"killedBy":["8"],"location":{"end":{"column":92,"line":272},"start":{"column":39,"line":272}}},{"id":"2449","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":286},"start":{"column":29,"line":286}}},{"id":"2450","mutatorName":"BooleanLiteral","replacement":"topicData.pinned","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":288},"start":{"column":13,"line":288}}},{"id":"2451","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":288},"start":{"column":13,"line":288}}},{"id":"2454","mutatorName":"StringLiteral","replacement":"``","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":76,"line":289},"start":{"column":43,"line":289}}},{"id":"2452","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":288},"start":{"column":13,"line":288}}},{"id":"2453","mutatorName":"BlockStatement","replacement":"{}","statusReason":"listen EADDRINUSE: address already in use 0.0.0.0:4567","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":290},"start":{"column":32,"line":288}}}],"source":"'use strict';\n\nconst meta = require('../meta');\nconst db = require('../database');\nconst flags = require('../flags');\nconst user = require('../user');\nconst topics = require('../topics');\nconst plugins = require('../plugins');\nconst privileges = require('../privileges');\nconst translator = require('../translator');\n\nmodule.exports = function (Posts) {\n    const votesInProgress = {};\n\n    Posts.upvote = async function (pid, uid) {\n        if (meta.config['reputation:disabled']) {\n            throw new Error('[[error:reputation-system-disabled]]');\n        }\n        const canUpvote = await privileges.posts.can('posts:upvote', pid, uid);\n        if (!canUpvote) {\n            throw new Error('[[error:no-privileges]]');\n        }\n\n        if (voteInProgress(pid, uid)) {\n            throw new Error('[[error:already-voting-for-this-post]]');\n        }\n        putVoteInProgress(pid, uid);\n\n        try {\n            return await toggleVote('upvote', pid, uid);\n        } finally {\n            clearVoteProgress(pid, uid);\n        }\n    };\n\n    Posts.downvote = async function (pid, uid) {\n        if (meta.config['reputation:disabled']) {\n            throw new Error('[[error:reputation-system-disabled]]');\n        }\n\n        if (meta.config['downvote:disabled']) {\n            throw new Error('[[error:downvoting-disabled]]');\n        }\n        const canDownvote = await privileges.posts.can('posts:downvote', pid, uid);\n        if (!canDownvote) {\n            throw new Error('[[error:no-privileges]]');\n        }\n\n        if (voteInProgress(pid, uid)) {\n            throw new Error('[[error:already-voting-for-this-post]]');\n        }\n\n        putVoteInProgress(pid, uid);\n        try {\n            return await toggleVote('downvote', pid, uid);\n        } finally {\n            clearVoteProgress(pid, uid);\n        }\n    };\n\n    Posts.unvote = async function (pid, uid) {\n        if (voteInProgress(pid, uid)) {\n            throw new Error('[[error:already-voting-for-this-post]]');\n        }\n\n        putVoteInProgress(pid, uid);\n        try {\n            const voteStatus = await Posts.hasVoted(pid, uid);\n            return await unvote(pid, uid, 'unvote', voteStatus);\n        } finally {\n            clearVoteProgress(pid, uid);\n        }\n    };\n\n    Posts.hasVoted = async function (pid, uid) {\n        if (parseInt(uid, 10) <"+"= 0) {\n            return { upvoted: false, downvoted: false };\n        }\n        const hasVoted = await db.isMemberOfSets([`pid:${pid}:upvote`, `pid:${pid}:downvote`], uid);\n        return { upvoted: hasVoted[0], downvoted: hasVoted[1] };\n    };\n\n    Posts.getVoteStatusByPostIDs = async function (pids, uid) {\n        if (parseInt(uid, 10) <"+"= 0) {\n            const data = pids.map(() => false);\n            return { upvotes: data, downvotes: data };\n        }\n        const upvoteSets = pids.map(pid => `pid:${pid}:upvote`);\n        const downvoteSets = pids.map(pid => `pid:${pid}:downvote`);\n        const data = await db.isMemberOfSets(upvoteSets.concat(downvoteSets), uid);\n        return {\n            upvotes: data.slice(0, pids.length),\n            downvotes: data.slice(pids.length, pids.length * 2),\n        };\n    };\n\n    Posts.getUpvotedUidsByPids = async function (pids) {\n        return await db.getSetsMembers(pids.map(pid => `pid:${pid}:upvote`));\n    };\n\n    function voteInProgress(pid, uid) {\n        return Array.isArray(votesInProgress[uid]) && votesInProgress[uid].includes(parseInt(pid, 10));\n    }\n\n    function putVoteInProgress(pid, uid) {\n        votesInProgress[uid] = votesInProgress[uid] || [];\n        votesInProgress[uid].push(parseInt(pid, 10));\n    }\n\n    function clearVoteProgress(pid, uid) {\n        if (Array.isArray(votesInProgress[uid])) {\n            const index = votesInProgress[uid].indexOf(parseInt(pid, 10));\n            if (index !== -1) {\n                votesInProgress[uid].splice(index, 1);\n            }\n        }\n    }\n\n    async function toggleVote(type, pid, uid) {\n        const voteStatus = await Posts.hasVoted(pid, uid);\n        await unvote(pid, uid, type, voteStatus);\n        return await vote(type, false, pid, uid, voteStatus);\n    }\n\n    async function unvote(pid, uid, type, voteStatus) {\n        const owner = await Posts.getPostField(pid, 'uid');\n        if (parseInt(uid, 10) === parseInt(owner, 10)) {\n            throw new Error('[[error:self-vote]]');\n        }\n\n        if (type === 'downvote' || type === 'upvote') {\n            await checkVoteLimitation(pid, uid, type);\n        }\n\n        if (!voteStatus || (!voteStatus.upvoted && !voteStatus.downvoted)) {\n            return;\n        }\n\n        return await vote(voteStatus.upvoted ? 'downvote' : 'upvote', true, pid, uid, voteStatus);\n    }\n\n    async function checkVoteLimitation(pid, uid, type) {\n        // type = 'upvote' or 'downvote'\n        const oneDay = 86400000;\n        const [reputation, targetUid, votedPidsToday] = await Promise.all([\n            user.getUserField(uid, 'reputation'),\n            Posts.getPostField(pid, 'uid'),\n            db.getSortedSetRevRangeByScore(\n                `uid:${uid}:${type}`, 0, -1, '+inf', Date.now() - oneDay\n            ),\n        ]);\n\n        if (reputation <"+" meta.config[`min:rep:${type}`]) {\n            throw new Error(`[[error:not-enough-reputation-to-${type}, ${meta.config[`min:rep:${type}`]}]]`);\n        }\n        const votesToday = meta.config[`${type}sPerDay`];\n        if (votesToday && votedPidsToday.length >= votesToday) {\n            throw new Error(`[[error:too-many-${type}s-today, ${votesToday}]]`);\n        }\n        const voterPerUserToday = meta.config[`${type}sPerUserPerDay`];\n        if (voterPerUserToday) {\n            const postData = await Posts.getPostsFields(votedPidsToday, ['uid']);\n            const targetUpVotes = postData.filter(p => p.uid === targetUid).length;\n            if (targetUpVotes >= voterPerUserToday) {\n                throw new Error(`[[error:too-many-${type}s-today-user, ${voterPerUserToday}]]`);\n            }\n        }\n    }\n\n    async function vote(type, unvote, pid, uid, voteStatus) {\n        uid = parseInt(uid, 10);\n        if (uid <"+"= 0) {\n            throw new Error('[[error:not-logged-in]]');\n        }\n        const now = Date.now();\n\n        if (type === 'upvote' && !unvote) {\n            await db.sortedSetAdd(`uid:${uid}:upvote`, now, pid);\n        } else {\n            await db.sortedSetRemove(`uid:${uid}:upvote`, pid);\n        }\n\n        if (type === 'upvote' || unvote) {\n            await db.sortedSetRemove(`uid:${uid}:downvote`, pid);\n        } else {\n            await db.sortedSetAdd(`uid:${uid}:downvote`, now, pid);\n        }\n\n        const postData = await Posts.getPostFields(pid, ['pid', 'uid', 'tid']);\n        const newReputation = await user.incrementUserReputationBy(postData.uid, type === 'upvote' ? 1 : -1);\n\n        await adjustPostVotes(postData, uid, type, unvote);\n\n        await fireVoteHook(postData, uid, type, unvote, voteStatus);\n\n        return {\n            user: {\n                reputation: newReputation,\n            },\n            fromuid: uid,\n            post: postData,\n            upvote: type === 'upvote' && !unvote,\n            downvote: type === 'downvote' && !unvote,\n        };\n    }\n\n    async function fireVoteHook(postData, uid, type, unvote, voteStatus) {\n        let hook = type;\n        let current = voteStatus.upvoted ? 'upvote' : 'downvote';\n        if (unvote) { // e.g. unvoting, removing a upvote or downvote\n            hook = 'unvote';\n        } else { // e.g. User *has not* voted, clicks upvote or downvote\n            current = 'unvote';\n        }\n        // action:post.upvote\n        // action:post.downvote\n        // action:post.unvote\n        plugins.hooks.fire(`action:post.${hook}`, {\n            pid: postData.pid,\n            uid: uid,\n            owner: postData.uid,\n            current: current,\n        });\n    }\n\n    async function adjustPostVotes(postData, uid, type, unvote) {\n        const notType = (type === 'upvote' ? 'downvote' : 'upvote');\n        if (unvote) {\n            await db.setRemove(`pid:${postData.pid}:${type}`, uid);\n        } else {\n            await db.setAdd(`pid:${postData.pid}:${type}`, uid);\n        }\n        await db.setRemove(`pid:${postData.pid}:${notType}`, uid);\n\n        const [upvotes, downvotes] = await Promise.all([\n            db.setCount(`pid:${postData.pid}:upvote`),\n            db.setCount(`pid:${postData.pid}:downvote`),\n        ]);\n        postData.upvotes = upvotes;\n        postData.downvotes = downvotes;\n        postData.votes = postData.upvotes - postData.downvotes;\n        await Posts.updatePostVoteCount(postData);\n    }\n\n    Posts.updatePostVoteCount = async function (postData) {\n        if (!postData || !postData.pid || !postData.tid) {\n            return;\n        }\n        const threshold = meta.config['flags:autoFlagOnDownvoteThreshold'];\n        if (threshold && postData.votes <"+"= (-threshold)) {\n            const adminUid = await user.getFirstAdminUid();\n            const reportMsg = await translator.translate(`[[flags:auto-flagged, ${-postData.votes}]]`);\n            const flagObj = await flags.create('post', postData.pid, adminUid, reportMsg, null, true);\n            await flags.notify(flagObj, adminUid, true);\n        }\n        await Promise.all([\n            updateTopicVoteCount(postData),\n            db.sortedSetAdd('posts:votes', postData.votes, postData.pid),\n            Posts.setPostFields(postData.pid, {\n                upvotes: postData.upvotes,\n                downvotes: postData.downvotes,\n            }),\n        ]);\n        plugins.hooks.fire('action:post.updatePostVoteCount', { post: postData });\n    };\n\n    async function updateTopicVoteCount(postData) {\n        const topicData = await topics.getTopicFields(postData.tid, ['mainPid', 'cid', 'pinned']);\n\n        if (postData.uid) {\n            if (postData.votes !== 0) {\n                await db.sortedSetAdd(`cid:${topicData.cid}:uid:${postData.uid}:pids:votes`, postData.votes, postData.pid);\n            } else {\n                await db.sortedSetRemove(`cid:${topicData.cid}:uid:${postData.uid}:pids:votes`, postData.pid);\n            }\n        }\n\n        if (parseInt(topicData.mainPid, 10) !== parseInt(postData.pid, 10)) {\n            return await db.sortedSetAdd(`tid:${postData.tid}:posts:votes`, postData.votes, postData.pid);\n        }\n        const promises = [\n            topics.setTopicFields(postData.tid, {\n                upvotes: postData.upvotes,\n                downvotes: postData.downvotes,\n            }),\n            db.sortedSetAdd('topics:votes', postData.votes, postData.tid),\n        ];\n        if (!topicData.pinned) {\n            promises.push(db.sortedSetAdd(`cid:${topicData.cid}:tids:votes`, postData.votes, postData.tid));\n        }\n        await Promise.all(promises);\n    }\n};\n"}},"schemaVersion":"1.0","thresholds":{"high":80,"low":60,"break":null},"testFiles":{"test/utils.js":{"tests":[{"id":"0","name":"should correctly compare a password and a hash"},{"id":"1","name":"should correctly handle comparison with no sha wrapping of the input (backwards compatibility)"},{"id":"2","name":"should continue to function even with passwords > 73 characters"},{"id":"3","name":"should process a million-character long password quickly"},{"id":"4","name":"should grab all mounted routes and ensure a schema exists"},{"id":"5","name":"GET /ping: should have each path parameter defined in its context"},{"id":"6","name":"GET /ping: should have examples when parameters are present"},{"id":"7","name":"GET /ping: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"8","name":"GET /ping: should not error out when called"},{"id":"9","name":"GET /ping: response status code should match one of the schema defined responses"},{"id":"10","name":"GET /ping: response body should match schema definition"},{"id":"11","name":"GET /ping: should successfully re-login if needed"},{"id":"12","name":"GET /ping: should back out of a registration interstitial if needed"},{"id":"13","name":"POST /ping: should have each path parameter defined in its context"},{"id":"14","name":"POST /ping: should have examples when parameters are present"},{"id":"15","name":"POST /ping: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"16","name":"POST /ping: should not error out when called"},{"id":"17","name":"POST /ping: response status code should match one of the schema defined responses"},{"id":"18","name":"POST /ping: response body should match schema definition"},{"id":"19","name":"POST /ping: should successfully re-login if needed"},{"id":"20","name":"POST /ping: should back out of a registration interstitial if needed"},{"id":"21","name":"POST /utilities/login: should have each path parameter defined in its context"},{"id":"22","name":"POST /utilities/login: should have examples when parameters are present"},{"id":"23","name":"POST /utilities/login: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"24","name":"POST /utilities/login: should not error out when called"},{"id":"25","name":"POST /utilities/login: response status code should match one of the schema defined responses"},{"id":"26","name":"POST /utilities/login: response body should match schema definition"},{"id":"27","name":"POST /utilities/login: should successfully re-login if needed"},{"id":"28","name":"POST /utilities/login: should back out of a registration interstitial if needed"},{"id":"29","name":"POST /users/: should have each path parameter defined in its context"},{"id":"30","name":"POST /users/: should have examples when parameters are present"},{"id":"31","name":"POST /users/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"32","name":"POST /users/: should not error out when called"},{"id":"33","name":"POST /users/: response status code should match one of the schema defined responses"},{"id":"34","name":"POST /users/: response body should match schema definition"},{"id":"35","name":"POST /users/: should successfully re-login if needed"},{"id":"36","name":"POST /users/: should back out of a registration interstitial if needed"},{"id":"37","name":"DELETE /users/: should have each path parameter defined in its context"},{"id":"38","name":"DELETE /users/: should have examples when parameters are present"},{"id":"39","name":"DELETE /users/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"40","name":"DELETE /users/: should not error out when called"},{"id":"41","name":"DELETE /users/: response status code should match one of the schema defined responses"},{"id":"42","name":"DELETE /users/: response body should match schema definition"},{"id":"43","name":"DELETE /users/: should successfully re-login if needed"},{"id":"44","name":"DELETE /users/: should back out of a registration interstitial if needed"},{"id":"45","name":"HEAD /users/{uid}: should have each path parameter defined in its context"},{"id":"46","name":"HEAD /users/{uid}: should have examples when parameters are present"},{"id":"47","name":"HEAD /users/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"48","name":"HEAD /users/{uid}: should not error out when called"},{"id":"49","name":"HEAD /users/{uid}: response status code should match one of the schema defined responses"},{"id":"50","name":"HEAD /users/{uid}: response body should match schema definition"},{"id":"51","name":"HEAD /users/{uid}: should successfully re-login if needed"},{"id":"52","name":"HEAD /users/{uid}: should back out of a registration interstitial if needed"},{"id":"53","name":"GET /users/{uid}: should have each path parameter defined in its context"},{"id":"54","name":"GET /users/{uid}: should have examples when parameters are present"},{"id":"55","name":"GET /users/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"56","name":"GET /users/{uid}: should not error out when called"},{"id":"57","name":"GET /users/{uid}: response status code should match one of the schema defined responses"},{"id":"58","name":"GET /users/{uid}: response body should match schema definition"},{"id":"59","name":"GET /users/{uid}: should successfully re-login if needed"},{"id":"60","name":"GET /users/{uid}: should back out of a registration interstitial if needed"},{"id":"61","name":"DELETE /users/{uid}: should have each path parameter defined in its context"},{"id":"62","name":"DELETE /users/{uid}: should have examples when parameters are present"},{"id":"63","name":"DELETE /users/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"64","name":"DELETE /users/{uid}: should not error out when called"},{"id":"65","name":"DELETE /users/{uid}: response status code should match one of the schema defined responses"},{"id":"66","name":"DELETE /users/{uid}: response body should match schema definition"},{"id":"67","name":"DELETE /users/{uid}: should successfully re-login if needed"},{"id":"68","name":"DELETE /users/{uid}: should back out of a registration interstitial if needed"},{"id":"69","name":"PUT /users/{uid}: should have each path parameter defined in its context"},{"id":"70","name":"PUT /users/{uid}: should have examples when parameters are present"},{"id":"71","name":"PUT /users/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"72","name":"PUT /users/{uid}: should not error out when called"},{"id":"73","name":"PUT /users/{uid}: response status code should match one of the schema defined responses"},{"id":"74","name":"PUT /users/{uid}: response body should match schema definition"},{"id":"75","name":"PUT /users/{uid}: should successfully re-login if needed"},{"id":"76","name":"PUT /users/{uid}: should back out of a registration interstitial if needed"},{"id":"77","name":"PUT /users/{uid}/picture: should have each path parameter defined in its context"},{"id":"78","name":"PUT /users/{uid}/picture: should have examples when parameters are present"},{"id":"79","name":"PUT /users/{uid}/picture: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"80","name":"PUT /users/{uid}/picture: should not error out when called"},{"id":"81","name":"PUT /users/{uid}/picture: response status code should match one of the schema defined responses"},{"id":"82","name":"PUT /users/{uid}/picture: response body should match schema definition"},{"id":"83","name":"PUT /users/{uid}/picture: should successfully re-login if needed"},{"id":"84","name":"PUT /users/{uid}/picture: should back out of a registration interstitial if needed"},{"id":"85","name":"DELETE /users/{uid}/content: should have each path parameter defined in its context"},{"id":"86","name":"DELETE /users/{uid}/content: should have examples when parameters are present"},{"id":"87","name":"DELETE /users/{uid}/content: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"88","name":"DELETE /users/{uid}/content: should not error out when called"},{"id":"89","name":"DELETE /users/{uid}/content: response status code should match one of the schema defined responses"},{"id":"90","name":"DELETE /users/{uid}/content: response body should match schema definition"},{"id":"91","name":"DELETE /users/{uid}/content: should successfully re-login if needed"},{"id":"92","name":"DELETE /users/{uid}/content: should back out of a registration interstitial if needed"},{"id":"93","name":"DELETE /users/{uid}/account: should have each path parameter defined in its context"},{"id":"94","name":"DELETE /users/{uid}/account: should have examples when parameters are present"},{"id":"95","name":"DELETE /users/{uid}/account: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"96","name":"DELETE /users/{uid}/account: should not error out when called"},{"id":"97","name":"DELETE /users/{uid}/account: response status code should match one of the schema defined responses"},{"id":"98","name":"DELETE /users/{uid}/account: response body should match schema definition"},{"id":"99","name":"DELETE /users/{uid}/account: should successfully re-login if needed"},{"id":"100","name":"DELETE /users/{uid}/account: should back out of a registration interstitial if needed"},{"id":"101","name":"PUT /users/{uid}/settings: should have each path parameter defined in its context"},{"id":"102","name":"PUT /users/{uid}/settings: should have examples when parameters are present"},{"id":"103","name":"PUT /users/{uid}/settings: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"104","name":"PUT /users/{uid}/settings: should not error out when called"},{"id":"105","name":"PUT /users/{uid}/settings: response status code should match one of the schema defined responses"},{"id":"106","name":"PUT /users/{uid}/settings: response body should match schema definition"},{"id":"107","name":"PUT /users/{uid}/settings: should successfully re-login if needed"},{"id":"108","name":"PUT /users/{uid}/settings: should back out of a registration interstitial if needed"},{"id":"109","name":"PUT /users/{uid}/password: should have each path parameter defined in its context"},{"id":"110","name":"PUT /users/{uid}/password: should have examples when parameters are present"},{"id":"111","name":"PUT /users/{uid}/password: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"112","name":"PUT /users/{uid}/password: should not error out when called"},{"id":"113","name":"PUT /users/{uid}/password: response status code should match one of the schema defined responses"},{"id":"114","name":"PUT /users/{uid}/password: response body should match schema definition"},{"id":"115","name":"PUT /users/{uid}/password: should successfully re-login if needed"},{"id":"116","name":"PUT /users/{uid}/password: should back out of a registration interstitial if needed"},{"id":"117","name":"PUT /users/{uid}/follow: should have each path parameter defined in its context"},{"id":"118","name":"PUT /users/{uid}/follow: should have examples when parameters are present"},{"id":"119","name":"PUT /users/{uid}/follow: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"120","name":"PUT /users/{uid}/follow: should not error out when called"},{"id":"121","name":"PUT /users/{uid}/follow: response status code should match one of the schema defined responses"},{"id":"122","name":"PUT /users/{uid}/follow: response body should match schema definition"},{"id":"123","name":"PUT /users/{uid}/follow: should successfully re-login if needed"},{"id":"124","name":"PUT /users/{uid}/follow: should back out of a registration interstitial if needed"},{"id":"125","name":"DELETE /users/{uid}/follow: should have each path parameter defined in its context"},{"id":"126","name":"DELETE /users/{uid}/follow: should have examples when parameters are present"},{"id":"127","name":"DELETE /users/{uid}/follow: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"128","name":"DELETE /users/{uid}/follow: should not error out when called"},{"id":"129","name":"DELETE /users/{uid}/follow: response status code should match one of the schema defined responses"},{"id":"130","name":"DELETE /users/{uid}/follow: response body should match schema definition"},{"id":"131","name":"DELETE /users/{uid}/follow: should successfully re-login if needed"},{"id":"132","name":"DELETE /users/{uid}/follow: should back out of a registration interstitial if needed"},{"id":"133","name":"PUT /users/{uid}/ban: should have each path parameter defined in its context"},{"id":"134","name":"PUT /users/{uid}/ban: should have examples when parameters are present"},{"id":"135","name":"PUT /users/{uid}/ban: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"136","name":"PUT /users/{uid}/ban: should not error out when called"},{"id":"137","name":"PUT /users/{uid}/ban: response status code should match one of the schema defined responses"},{"id":"138","name":"PUT /users/{uid}/ban: response body should match schema definition"},{"id":"139","name":"PUT /users/{uid}/ban: should successfully re-login if needed"},{"id":"140","name":"PUT /users/{uid}/ban: should back out of a registration interstitial if needed"},{"id":"141","name":"DELETE /users/{uid}/ban: should have each path parameter defined in its context"},{"id":"142","name":"DELETE /users/{uid}/ban: should have examples when parameters are present"},{"id":"143","name":"DELETE /users/{uid}/ban: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"144","name":"DELETE /users/{uid}/ban: should not error out when called"},{"id":"145","name":"DELETE /users/{uid}/ban: response status code should match one of the schema defined responses"},{"id":"146","name":"DELETE /users/{uid}/ban: response body should match schema definition"},{"id":"147","name":"DELETE /users/{uid}/ban: should successfully re-login if needed"},{"id":"148","name":"DELETE /users/{uid}/ban: should back out of a registration interstitial if needed"},{"id":"149","name":"PUT /users/{uid}/mute: should have each path parameter defined in its context"},{"id":"150","name":"PUT /users/{uid}/mute: should have examples when parameters are present"},{"id":"151","name":"PUT /users/{uid}/mute: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"152","name":"PUT /users/{uid}/mute: should not error out when called"},{"id":"153","name":"PUT /users/{uid}/mute: response status code should match one of the schema defined responses"},{"id":"154","name":"PUT /users/{uid}/mute: response body should match schema definition"},{"id":"155","name":"PUT /users/{uid}/mute: should successfully re-login if needed"},{"id":"156","name":"PUT /users/{uid}/mute: should back out of a registration interstitial if needed"},{"id":"157","name":"DELETE /users/{uid}/mute: should have each path parameter defined in its context"},{"id":"158","name":"DELETE /users/{uid}/mute: should have examples when parameters are present"},{"id":"159","name":"DELETE /users/{uid}/mute: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"160","name":"DELETE /users/{uid}/mute: should not error out when called"},{"id":"161","name":"DELETE /users/{uid}/mute: response status code should match one of the schema defined responses"},{"id":"162","name":"DELETE /users/{uid}/mute: response body should match schema definition"},{"id":"163","name":"DELETE /users/{uid}/mute: should successfully re-login if needed"},{"id":"164","name":"DELETE /users/{uid}/mute: should back out of a registration interstitial if needed"},{"id":"165","name":"POST /users/{uid}/tokens: should have each path parameter defined in its context"},{"id":"166","name":"POST /users/{uid}/tokens: should have examples when parameters are present"},{"id":"167","name":"POST /users/{uid}/tokens: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"168","name":"POST /users/{uid}/tokens: should not error out when called"},{"id":"169","name":"POST /users/{uid}/tokens: response status code should match one of the schema defined responses"},{"id":"170","name":"POST /users/{uid}/tokens: response body should match schema definition"},{"id":"171","name":"POST /users/{uid}/tokens: should successfully re-login if needed"},{"id":"172","name":"POST /users/{uid}/tokens: should back out of a registration interstitial if needed"},{"id":"173","name":"DELETE /users/{uid}/tokens/{token}: should have each path parameter defined in its context"},{"id":"174","name":"DELETE /users/{uid}/tokens/{token}: should have examples when parameters are present"},{"id":"175","name":"DELETE /users/{uid}/tokens/{token}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"176","name":"DELETE /users/{uid}/tokens/{token}: should not error out when called"},{"id":"177","name":"DELETE /users/{uid}/tokens/{token}: response status code should match one of the schema defined responses"},{"id":"178","name":"DELETE /users/{uid}/tokens/{token}: response body should match schema definition"},{"id":"179","name":"DELETE /users/{uid}/tokens/{token}: should successfully re-login if needed"},{"id":"180","name":"DELETE /users/{uid}/tokens/{token}: should back out of a registration interstitial if needed"},{"id":"181","name":"DELETE /users/{uid}/sessions/{uuid}: should have each path parameter defined in its context"},{"id":"182","name":"DELETE /users/{uid}/sessions/{uuid}: should have examples when parameters are present"},{"id":"183","name":"DELETE /users/{uid}/sessions/{uuid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"184","name":"DELETE /users/{uid}/sessions/{uuid}: should not error out when called"},{"id":"185","name":"DELETE /users/{uid}/sessions/{uuid}: response status code should match one of the schema defined responses"},{"id":"186","name":"DELETE /users/{uid}/sessions/{uuid}: response body should match schema definition"},{"id":"187","name":"DELETE /users/{uid}/sessions/{uuid}: should successfully re-login if needed"},{"id":"188","name":"DELETE /users/{uid}/sessions/{uuid}: should back out of a registration interstitial if needed"},{"id":"189","name":"POST /users/{uid}/invites: should have each path parameter defined in its context"},{"id":"190","name":"POST /users/{uid}/invites: should have examples when parameters are present"},{"id":"191","name":"POST /users/{uid}/invites: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"192","name":"POST /users/{uid}/invites: should not error out when called"},{"id":"193","name":"POST /users/{uid}/invites: response status code should match one of the schema defined responses"},{"id":"194","name":"POST /users/{uid}/invites: response body should match schema definition"},{"id":"195","name":"POST /users/{uid}/invites: should successfully re-login if needed"},{"id":"196","name":"POST /users/{uid}/invites: should back out of a registration interstitial if needed"},{"id":"197","name":"GET /users/{uid}/invites/groups: should have each path parameter defined in its context"},{"id":"198","name":"GET /users/{uid}/invites/groups: should have examples when parameters are present"},{"id":"199","name":"GET /users/{uid}/invites/groups: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"200","name":"GET /users/{uid}/invites/groups: should not error out when called"},{"id":"201","name":"GET /users/{uid}/invites/groups: response status code should match one of the schema defined responses"},{"id":"202","name":"GET /users/{uid}/invites/groups: response body should match schema definition"},{"id":"203","name":"GET /users/{uid}/invites/groups: should successfully re-login if needed"},{"id":"204","name":"GET /users/{uid}/invites/groups: should back out of a registration interstitial if needed"},{"id":"205","name":"GET /users/{uid}/emails: should have each path parameter defined in its context"},{"id":"206","name":"GET /users/{uid}/emails: should have examples when parameters are present"},{"id":"207","name":"GET /users/{uid}/emails: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"208","name":"GET /users/{uid}/emails: should not error out when called"},{"id":"209","name":"GET /users/{uid}/emails: response status code should match one of the schema defined responses"},{"id":"210","name":"GET /users/{uid}/emails: response body should match schema definition"},{"id":"211","name":"GET /users/{uid}/emails: should successfully re-login if needed"},{"id":"212","name":"GET /users/{uid}/emails: should back out of a registration interstitial if needed"},{"id":"213","name":"GET /users/{uid}/emails/{email}: should have each path parameter defined in its context"},{"id":"214","name":"GET /users/{uid}/emails/{email}: should have examples when parameters are present"},{"id":"215","name":"GET /users/{uid}/emails/{email}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"216","name":"GET /users/{uid}/emails/{email}: should not error out when called"},{"id":"217","name":"GET /users/{uid}/emails/{email}: response status code should match one of the schema defined responses"},{"id":"218","name":"GET /users/{uid}/emails/{email}: response body should match schema definition"},{"id":"219","name":"GET /users/{uid}/emails/{email}: should successfully re-login if needed"},{"id":"220","name":"GET /users/{uid}/emails/{email}: should back out of a registration interstitial if needed"},{"id":"221","name":"POST /users/{uid}/emails/{email}/confirm: should have each path parameter defined in its context"},{"id":"222","name":"POST /users/{uid}/emails/{email}/confirm: should have examples when parameters are present"},{"id":"223","name":"POST /users/{uid}/emails/{email}/confirm: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"224","name":"POST /users/{uid}/emails/{email}/confirm: should not error out when called"},{"id":"225","name":"POST /users/{uid}/emails/{email}/confirm: response status code should match one of the schema defined responses"},{"id":"226","name":"POST /users/{uid}/emails/{email}/confirm: response body should match schema definition"},{"id":"227","name":"POST /users/{uid}/emails/{email}/confirm: should successfully re-login if needed"},{"id":"228","name":"POST /users/{uid}/emails/{email}/confirm: should back out of a registration interstitial if needed"},{"id":"229","name":"HEAD /users/{uid}/exports/{type}: should have each path parameter defined in its context"},{"id":"230","name":"HEAD /users/{uid}/exports/{type}: should have examples when parameters are present"},{"id":"231","name":"HEAD /users/{uid}/exports/{type}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"232","name":"HEAD /users/{uid}/exports/{type}: should not error out when called"},{"id":"233","name":"HEAD /users/{uid}/exports/{type}: response status code should match one of the schema defined responses"},{"id":"234","name":"HEAD /users/{uid}/exports/{type}: response body should match schema definition"},{"id":"235","name":"HEAD /users/{uid}/exports/{type}: should successfully re-login if needed"},{"id":"236","name":"HEAD /users/{uid}/exports/{type}: should back out of a registration interstitial if needed"},{"id":"237","name":"GET /users/{uid}/exports/{type}: should have each path parameter defined in its context"},{"id":"238","name":"GET /users/{uid}/exports/{type}: should have examples when parameters are present"},{"id":"239","name":"GET /users/{uid}/exports/{type}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"240","name":"GET /users/{uid}/exports/{type}: should not error out when called"},{"id":"241","name":"GET /users/{uid}/exports/{type}: response status code should match one of the schema defined responses"},{"id":"242","name":"GET /users/{uid}/exports/{type}: response body should match schema definition"},{"id":"243","name":"GET /users/{uid}/exports/{type}: should successfully re-login if needed"},{"id":"244","name":"GET /users/{uid}/exports/{type}: should back out of a registration interstitial if needed"},{"id":"245","name":"POST /users/{uid}/exports/{type}: should have each path parameter defined in its context"},{"id":"246","name":"POST /users/{uid}/exports/{type}: should have examples when parameters are present"},{"id":"247","name":"POST /users/{uid}/exports/{type}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"248","name":"POST /users/{uid}/exports/{type}: should not error out when called"},{"id":"249","name":"POST /users/{uid}/exports/{type}: response status code should match one of the schema defined responses"},{"id":"250","name":"POST /users/{uid}/exports/{type}: response body should match schema definition"},{"id":"251","name":"POST /users/{uid}/exports/{type}: should successfully re-login if needed"},{"id":"252","name":"POST /users/{uid}/exports/{type}: should back out of a registration interstitial if needed"},{"id":"253","name":"POST /groups/: should have each path parameter defined in its context"},{"id":"254","name":"POST /groups/: should have examples when parameters are present"},{"id":"255","name":"POST /groups/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"256","name":"POST /groups/: should not error out when called"},{"id":"257","name":"POST /groups/: response status code should match one of the schema defined responses"},{"id":"258","name":"POST /groups/: response body should match schema definition"},{"id":"259","name":"POST /groups/: should successfully re-login if needed"},{"id":"260","name":"POST /groups/: should back out of a registration interstitial if needed"},{"id":"261","name":"HEAD /groups/{slug}: should have each path parameter defined in its context"},{"id":"262","name":"HEAD /groups/{slug}: should have examples when parameters are present"},{"id":"263","name":"HEAD /groups/{slug}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"264","name":"HEAD /groups/{slug}: should not error out when called"},{"id":"265","name":"HEAD /groups/{slug}: response status code should match one of the schema defined responses"},{"id":"266","name":"HEAD /groups/{slug}: response body should match schema definition"},{"id":"267","name":"HEAD /groups/{slug}: should successfully re-login if needed"},{"id":"268","name":"HEAD /groups/{slug}: should back out of a registration interstitial if needed"},{"id":"269","name":"PUT /groups/{slug}: should have each path parameter defined in its context"},{"id":"270","name":"PUT /groups/{slug}: should have examples when parameters are present"},{"id":"271","name":"PUT /groups/{slug}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"272","name":"PUT /groups/{slug}: should not error out when called"},{"id":"273","name":"PUT /groups/{slug}: response status code should match one of the schema defined responses"},{"id":"274","name":"PUT /groups/{slug}: response body should match schema definition"},{"id":"275","name":"PUT /groups/{slug}: should successfully re-login if needed"},{"id":"276","name":"PUT /groups/{slug}: should back out of a registration interstitial if needed"},{"id":"277","name":"DELETE /groups/{slug}: should have each path parameter defined in its context"},{"id":"278","name":"DELETE /groups/{slug}: should have examples when parameters are present"},{"id":"279","name":"DELETE /groups/{slug}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"280","name":"DELETE /groups/{slug}: should not error out when called"},{"id":"281","name":"DELETE /groups/{slug}: response status code should match one of the schema defined responses"},{"id":"282","name":"DELETE /groups/{slug}: response body should match schema definition"},{"id":"283","name":"DELETE /groups/{slug}: should successfully re-login if needed"},{"id":"284","name":"DELETE /groups/{slug}: should back out of a registration interstitial if needed"},{"id":"285","name":"PUT /groups/{slug}/membership/{uid}: should have each path parameter defined in its context"},{"id":"286","name":"PUT /groups/{slug}/membership/{uid}: should have examples when parameters are present"},{"id":"287","name":"PUT /groups/{slug}/membership/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"288","name":"PUT /groups/{slug}/membership/{uid}: should not error out when called"},{"id":"289","name":"PUT /groups/{slug}/membership/{uid}: response status code should match one of the schema defined responses"},{"id":"290","name":"PUT /groups/{slug}/membership/{uid}: response body should match schema definition"},{"id":"291","name":"PUT /groups/{slug}/membership/{uid}: should successfully re-login if needed"},{"id":"292","name":"PUT /groups/{slug}/membership/{uid}: should back out of a registration interstitial if needed"},{"id":"293","name":"DELETE /groups/{slug}/membership/{uid}: should have each path parameter defined in its context"},{"id":"294","name":"DELETE /groups/{slug}/membership/{uid}: should have examples when parameters are present"},{"id":"295","name":"DELETE /groups/{slug}/membership/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"296","name":"DELETE /groups/{slug}/membership/{uid}: should not error out when called"},{"id":"297","name":"DELETE /groups/{slug}/membership/{uid}: response status code should match one of the schema defined responses"},{"id":"298","name":"DELETE /groups/{slug}/membership/{uid}: response body should match schema definition"},{"id":"299","name":"DELETE /groups/{slug}/membership/{uid}: should successfully re-login if needed"},{"id":"300","name":"DELETE /groups/{slug}/membership/{uid}: should back out of a registration interstitial if needed"},{"id":"301","name":"PUT /groups/{slug}/ownership/{uid}: should have each path parameter defined in its context"},{"id":"302","name":"PUT /groups/{slug}/ownership/{uid}: should have examples when parameters are present"},{"id":"303","name":"PUT /groups/{slug}/ownership/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"304","name":"PUT /groups/{slug}/ownership/{uid}: should not error out when called"},{"id":"305","name":"PUT /groups/{slug}/ownership/{uid}: response status code should match one of the schema defined responses"},{"id":"306","name":"PUT /groups/{slug}/ownership/{uid}: response body should match schema definition"},{"id":"307","name":"PUT /groups/{slug}/ownership/{uid}: should successfully re-login if needed"},{"id":"308","name":"PUT /groups/{slug}/ownership/{uid}: should back out of a registration interstitial if needed"},{"id":"309","name":"DELETE /groups/{slug}/ownership/{uid}: should have each path parameter defined in its context"},{"id":"310","name":"DELETE /groups/{slug}/ownership/{uid}: should have examples when parameters are present"},{"id":"311","name":"DELETE /groups/{slug}/ownership/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"312","name":"DELETE /groups/{slug}/ownership/{uid}: should not error out when called"},{"id":"313","name":"DELETE /groups/{slug}/ownership/{uid}: response status code should match one of the schema defined responses"},{"id":"314","name":"DELETE /groups/{slug}/ownership/{uid}: response body should match schema definition"},{"id":"315","name":"DELETE /groups/{slug}/ownership/{uid}: should successfully re-login if needed"},{"id":"316","name":"DELETE /groups/{slug}/ownership/{uid}: should back out of a registration interstitial if needed"},{"id":"317","name":"POST /categories/: should have each path parameter defined in its context"},{"id":"318","name":"POST /categories/: should have examples when parameters are present"},{"id":"319","name":"POST /categories/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"320","name":"POST /categories/: should not error out when called"},{"id":"321","name":"POST /categories/: response status code should match one of the schema defined responses"},{"id":"322","name":"POST /categories/: response body should match schema definition"},{"id":"323","name":"POST /categories/: should successfully re-login if needed"},{"id":"324","name":"POST /categories/: should back out of a registration interstitial if needed"},{"id":"325","name":"GET /categories/{cid}: should have each path parameter defined in its context"},{"id":"326","name":"GET /categories/{cid}: should have examples when parameters are present"},{"id":"327","name":"GET /categories/{cid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"328","name":"GET /categories/{cid}: should not error out when called"},{"id":"329","name":"GET /categories/{cid}: response status code should match one of the schema defined responses"},{"id":"330","name":"GET /categories/{cid}: response body should match schema definition"},{"id":"331","name":"GET /categories/{cid}: should successfully re-login if needed"},{"id":"332","name":"GET /categories/{cid}: should back out of a registration interstitial if needed"},{"id":"333","name":"PUT /categories/{cid}: should have each path parameter defined in its context"},{"id":"334","name":"PUT /categories/{cid}: should have examples when parameters are present"},{"id":"335","name":"PUT /categories/{cid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"336","name":"PUT /categories/{cid}: should not error out when called"},{"id":"337","name":"PUT /categories/{cid}: response status code should match one of the schema defined responses"},{"id":"338","name":"PUT /categories/{cid}: response body should match schema definition"},{"id":"339","name":"PUT /categories/{cid}: should successfully re-login if needed"},{"id":"340","name":"PUT /categories/{cid}: should back out of a registration interstitial if needed"},{"id":"341","name":"DELETE /categories/{cid}: should have each path parameter defined in its context"},{"id":"342","name":"DELETE /categories/{cid}: should have examples when parameters are present"},{"id":"343","name":"DELETE /categories/{cid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"344","name":"DELETE /categories/{cid}: should not error out when called"},{"id":"345","name":"DELETE /categories/{cid}: response status code should match one of the schema defined responses"},{"id":"346","name":"DELETE /categories/{cid}: response body should match schema definition"},{"id":"347","name":"DELETE /categories/{cid}: should successfully re-login if needed"},{"id":"348","name":"DELETE /categories/{cid}: should back out of a registration interstitial if needed"},{"id":"349","name":"GET /categories/{cid}/privileges: should have each path parameter defined in its context"},{"id":"350","name":"GET /categories/{cid}/privileges: should have examples when parameters are present"},{"id":"351","name":"GET /categories/{cid}/privileges: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"352","name":"GET /categories/{cid}/privileges: should not error out when called"},{"id":"353","name":"GET /categories/{cid}/privileges: response status code should match one of the schema defined responses"},{"id":"354","name":"GET /categories/{cid}/privileges: response body should match schema definition"},{"id":"355","name":"GET /categories/{cid}/privileges: should successfully re-login if needed"},{"id":"356","name":"GET /categories/{cid}/privileges: should back out of a registration interstitial if needed"},{"id":"357","name":"PUT /categories/{cid}/privileges/{privilege}: should have each path parameter defined in its context"},{"id":"358","name":"PUT /categories/{cid}/privileges/{privilege}: should have examples when parameters are present"},{"id":"359","name":"PUT /categories/{cid}/privileges/{privilege}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"360","name":"PUT /categories/{cid}/privileges/{privilege}: should not error out when called"},{"id":"361","name":"PUT /categories/{cid}/privileges/{privilege}: response status code should match one of the schema defined responses"},{"id":"362","name":"PUT /categories/{cid}/privileges/{privilege}: response body should match schema definition"},{"id":"363","name":"PUT /categories/{cid}/privileges/{privilege}: should successfully re-login if needed"},{"id":"364","name":"PUT /categories/{cid}/privileges/{privilege}: should back out of a registration interstitial if needed"},{"id":"365","name":"DELETE /categories/{cid}/privileges/{privilege}: should have each path parameter defined in its context"},{"id":"366","name":"DELETE /categories/{cid}/privileges/{privilege}: should have examples when parameters are present"},{"id":"367","name":"DELETE /categories/{cid}/privileges/{privilege}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"368","name":"DELETE /categories/{cid}/privileges/{privilege}: should not error out when called"},{"id":"369","name":"DELETE /categories/{cid}/privileges/{privilege}: response status code should match one of the schema defined responses"},{"id":"370","name":"DELETE /categories/{cid}/privileges/{privilege}: response body should match schema definition"},{"id":"371","name":"DELETE /categories/{cid}/privileges/{privilege}: should successfully re-login if needed"},{"id":"372","name":"DELETE /categories/{cid}/privileges/{privilege}: should back out of a registration interstitial if needed"},{"id":"373","name":"PUT /categories/{cid}/moderator/{uid}: should have each path parameter defined in its context"},{"id":"374","name":"PUT /categories/{cid}/moderator/{uid}: should have examples when parameters are present"},{"id":"375","name":"PUT /categories/{cid}/moderator/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"376","name":"PUT /categories/{cid}/moderator/{uid}: should not error out when called"},{"id":"377","name":"PUT /categories/{cid}/moderator/{uid}: response status code should match one of the schema defined responses"},{"id":"378","name":"PUT /categories/{cid}/moderator/{uid}: response body should match schema definition"},{"id":"379","name":"PUT /categories/{cid}/moderator/{uid}: should successfully re-login if needed"},{"id":"380","name":"PUT /categories/{cid}/moderator/{uid}: should back out of a registration interstitial if needed"},{"id":"381","name":"DELETE /categories/{cid}/moderator/{uid}: should have each path parameter defined in its context"},{"id":"382","name":"DELETE /categories/{cid}/moderator/{uid}: should have examples when parameters are present"},{"id":"383","name":"DELETE /categories/{cid}/moderator/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"384","name":"DELETE /categories/{cid}/moderator/{uid}: should not error out when called"},{"id":"385","name":"DELETE /categories/{cid}/moderator/{uid}: response status code should match one of the schema defined responses"},{"id":"386","name":"DELETE /categories/{cid}/moderator/{uid}: response body should match schema definition"},{"id":"387","name":"DELETE /categories/{cid}/moderator/{uid}: should successfully re-login if needed"},{"id":"388","name":"DELETE /categories/{cid}/moderator/{uid}: should back out of a registration interstitial if needed"},{"id":"389","name":"POST /topics/: should have each path parameter defined in its context"},{"id":"390","name":"POST /topics/: should have examples when parameters are present"},{"id":"391","name":"POST /topics/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"392","name":"POST /topics/: should not error out when called"},{"id":"393","name":"POST /topics/: response status code should match one of the schema defined responses"},{"id":"394","name":"POST /topics/: response body should match schema definition"},{"id":"395","name":"POST /topics/: should successfully re-login if needed"},{"id":"396","name":"POST /topics/: should back out of a registration interstitial if needed"},{"id":"397","name":"GET /topics/{tid}: should have each path parameter defined in its context"},{"id":"398","name":"GET /topics/{tid}: should have examples when parameters are present"},{"id":"399","name":"GET /topics/{tid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"400","name":"GET /topics/{tid}: should not error out when called"},{"id":"401","name":"GET /topics/{tid}: response status code should match one of the schema defined responses"},{"id":"402","name":"GET /topics/{tid}: response body should match schema definition"},{"id":"403","name":"GET /topics/{tid}: should successfully re-login if needed"},{"id":"404","name":"GET /topics/{tid}: should back out of a registration interstitial if needed"},{"id":"405","name":"POST /topics/{tid}: should have each path parameter defined in its context"},{"id":"406","name":"POST /topics/{tid}: should have examples when parameters are present"},{"id":"407","name":"POST /topics/{tid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"408","name":"POST /topics/{tid}: should not error out when called"},{"id":"409","name":"POST /topics/{tid}: response status code should match one of the schema defined responses"},{"id":"410","name":"POST /topics/{tid}: response body should match schema definition"},{"id":"411","name":"POST /topics/{tid}: should successfully re-login if needed"},{"id":"412","name":"POST /topics/{tid}: should back out of a registration interstitial if needed"},{"id":"413","name":"DELETE /topics/{tid}: should have each path parameter defined in its context"},{"id":"414","name":"DELETE /topics/{tid}: should have examples when parameters are present"},{"id":"415","name":"DELETE /topics/{tid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"416","name":"DELETE /topics/{tid}: should not error out when called"},{"id":"417","name":"DELETE /topics/{tid}: response status code should match one of the schema defined responses"},{"id":"418","name":"DELETE /topics/{tid}: response body should match schema definition"},{"id":"419","name":"DELETE /topics/{tid}: should successfully re-login if needed"},{"id":"420","name":"DELETE /topics/{tid}: should back out of a registration interstitial if needed"},{"id":"421","name":"DELETE /topics/{tid}/state: should have each path parameter defined in its context"},{"id":"422","name":"DELETE /topics/{tid}/state: should have examples when parameters are present"},{"id":"423","name":"DELETE /topics/{tid}/state: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"424","name":"DELETE /topics/{tid}/state: should not error out when called"},{"id":"425","name":"DELETE /topics/{tid}/state: response status code should match one of the schema defined responses"},{"id":"426","name":"DELETE /topics/{tid}/state: response body should match schema definition"},{"id":"427","name":"DELETE /topics/{tid}/state: should successfully re-login if needed"},{"id":"428","name":"DELETE /topics/{tid}/state: should back out of a registration interstitial if needed"},{"id":"429","name":"PUT /topics/{tid}/state: should have each path parameter defined in its context"},{"id":"430","name":"PUT /topics/{tid}/state: should have examples when parameters are present"},{"id":"431","name":"PUT /topics/{tid}/state: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"432","name":"PUT /topics/{tid}/state: should not error out when called"},{"id":"433","name":"PUT /topics/{tid}/state: response status code should match one of the schema defined responses"},{"id":"434","name":"PUT /topics/{tid}/state: response body should match schema definition"},{"id":"435","name":"PUT /topics/{tid}/state: should successfully re-login if needed"},{"id":"436","name":"PUT /topics/{tid}/state: should back out of a registration interstitial if needed"},{"id":"437","name":"PUT /topics/{tid}/lock: should have each path parameter defined in its context"},{"id":"438","name":"PUT /topics/{tid}/lock: should have examples when parameters are present"},{"id":"439","name":"PUT /topics/{tid}/lock: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"440","name":"PUT /topics/{tid}/lock: should not error out when called"},{"id":"441","name":"PUT /topics/{tid}/lock: response status code should match one of the schema defined responses"},{"id":"442","name":"PUT /topics/{tid}/lock: response body should match schema definition"},{"id":"443","name":"PUT /topics/{tid}/lock: should successfully re-login if needed"},{"id":"444","name":"PUT /topics/{tid}/lock: should back out of a registration interstitial if needed"},{"id":"445","name":"DELETE /topics/{tid}/lock: should have each path parameter defined in its context"},{"id":"446","name":"DELETE /topics/{tid}/lock: should have examples when parameters are present"},{"id":"447","name":"DELETE /topics/{tid}/lock: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"448","name":"DELETE /topics/{tid}/lock: should not error out when called"},{"id":"449","name":"DELETE /topics/{tid}/lock: response status code should match one of the schema defined responses"},{"id":"450","name":"DELETE /topics/{tid}/lock: response body should match schema definition"},{"id":"451","name":"DELETE /topics/{tid}/lock: should successfully re-login if needed"},{"id":"452","name":"DELETE /topics/{tid}/lock: should back out of a registration interstitial if needed"},{"id":"453","name":"PUT /topics/{tid}/pin: should have each path parameter defined in its context"},{"id":"454","name":"PUT /topics/{tid}/pin: should have examples when parameters are present"},{"id":"455","name":"PUT /topics/{tid}/pin: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"456","name":"PUT /topics/{tid}/pin: should not error out when called"},{"id":"457","name":"PUT /topics/{tid}/pin: response status code should match one of the schema defined responses"},{"id":"458","name":"PUT /topics/{tid}/pin: response body should match schema definition"},{"id":"459","name":"PUT /topics/{tid}/pin: should successfully re-login if needed"},{"id":"460","name":"PUT /topics/{tid}/pin: should back out of a registration interstitial if needed"},{"id":"461","name":"DELETE /topics/{tid}/pin: should have each path parameter defined in its context"},{"id":"462","name":"DELETE /topics/{tid}/pin: should have examples when parameters are present"},{"id":"463","name":"DELETE /topics/{tid}/pin: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"464","name":"DELETE /topics/{tid}/pin: should not error out when called"},{"id":"465","name":"DELETE /topics/{tid}/pin: response status code should match one of the schema defined responses"},{"id":"466","name":"DELETE /topics/{tid}/pin: response body should match schema definition"},{"id":"467","name":"DELETE /topics/{tid}/pin: should successfully re-login if needed"},{"id":"468","name":"DELETE /topics/{tid}/pin: should back out of a registration interstitial if needed"},{"id":"469","name":"PUT /topics/{tid}/follow: should have each path parameter defined in its context"},{"id":"470","name":"PUT /topics/{tid}/follow: should have examples when parameters are present"},{"id":"471","name":"PUT /topics/{tid}/follow: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"472","name":"PUT /topics/{tid}/follow: should not error out when called"},{"id":"473","name":"PUT /topics/{tid}/follow: response status code should match one of the schema defined responses"},{"id":"474","name":"PUT /topics/{tid}/follow: response body should match schema definition"},{"id":"475","name":"PUT /topics/{tid}/follow: should successfully re-login if needed"},{"id":"476","name":"PUT /topics/{tid}/follow: should back out of a registration interstitial if needed"},{"id":"477","name":"DELETE /topics/{tid}/follow: should have each path parameter defined in its context"},{"id":"478","name":"DELETE /topics/{tid}/follow: should have examples when parameters are present"},{"id":"479","name":"DELETE /topics/{tid}/follow: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"480","name":"DELETE /topics/{tid}/follow: should not error out when called"},{"id":"481","name":"DELETE /topics/{tid}/follow: response status code should match one of the schema defined responses"},{"id":"482","name":"DELETE /topics/{tid}/follow: response body should match schema definition"},{"id":"483","name":"DELETE /topics/{tid}/follow: should successfully re-login if needed"},{"id":"484","name":"DELETE /topics/{tid}/follow: should back out of a registration interstitial if needed"},{"id":"485","name":"PUT /topics/{tid}/ignore: should have each path parameter defined in its context"},{"id":"486","name":"PUT /topics/{tid}/ignore: should have examples when parameters are present"},{"id":"487","name":"PUT /topics/{tid}/ignore: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"488","name":"PUT /topics/{tid}/ignore: should not error out when called"},{"id":"489","name":"PUT /topics/{tid}/ignore: response status code should match one of the schema defined responses"},{"id":"490","name":"PUT /topics/{tid}/ignore: response body should match schema definition"},{"id":"491","name":"PUT /topics/{tid}/ignore: should successfully re-login if needed"},{"id":"492","name":"PUT /topics/{tid}/ignore: should back out of a registration interstitial if needed"},{"id":"493","name":"DELETE /topics/{tid}/ignore: should have each path parameter defined in its context"},{"id":"494","name":"DELETE /topics/{tid}/ignore: should have examples when parameters are present"},{"id":"495","name":"DELETE /topics/{tid}/ignore: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"496","name":"DELETE /topics/{tid}/ignore: should not error out when called"},{"id":"497","name":"DELETE /topics/{tid}/ignore: response status code should match one of the schema defined responses"},{"id":"498","name":"DELETE /topics/{tid}/ignore: response body should match schema definition"},{"id":"499","name":"DELETE /topics/{tid}/ignore: should successfully re-login if needed"},{"id":"500","name":"DELETE /topics/{tid}/ignore: should back out of a registration interstitial if needed"},{"id":"501","name":"PUT /topics/{tid}/tags: should have each path parameter defined in its context"},{"id":"502","name":"PUT /topics/{tid}/tags: should have examples when parameters are present"},{"id":"503","name":"PUT /topics/{tid}/tags: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"504","name":"PUT /topics/{tid}/tags: should not error out when called"},{"id":"505","name":"PUT /topics/{tid}/tags: response status code should match one of the schema defined responses"},{"id":"506","name":"PUT /topics/{tid}/tags: response body should match schema definition"},{"id":"507","name":"PUT /topics/{tid}/tags: should successfully re-login if needed"},{"id":"508","name":"PUT /topics/{tid}/tags: should back out of a registration interstitial if needed"},{"id":"509","name":"DELETE /topics/{tid}/tags: should have each path parameter defined in its context"},{"id":"510","name":"DELETE /topics/{tid}/tags: should have examples when parameters are present"},{"id":"511","name":"DELETE /topics/{tid}/tags: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"512","name":"DELETE /topics/{tid}/tags: should not error out when called"},{"id":"513","name":"DELETE /topics/{tid}/tags: response status code should match one of the schema defined responses"},{"id":"514","name":"DELETE /topics/{tid}/tags: response body should match schema definition"},{"id":"515","name":"DELETE /topics/{tid}/tags: should successfully re-login if needed"},{"id":"516","name":"DELETE /topics/{tid}/tags: should back out of a registration interstitial if needed"},{"id":"517","name":"GET /topics/{tid}/thumbs: should have each path parameter defined in its context"},{"id":"518","name":"GET /topics/{tid}/thumbs: should have examples when parameters are present"},{"id":"519","name":"GET /topics/{tid}/thumbs: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"520","name":"GET /topics/{tid}/thumbs: should not error out when called"},{"id":"521","name":"GET /topics/{tid}/thumbs: response status code should match one of the schema defined responses"},{"id":"522","name":"GET /topics/{tid}/thumbs: response body should match schema definition"},{"id":"523","name":"GET /topics/{tid}/thumbs: should successfully re-login if needed"},{"id":"524","name":"GET /topics/{tid}/thumbs: should back out of a registration interstitial if needed"},{"id":"525","name":"POST /topics/{tid}/thumbs: should have each path parameter defined in its context"},{"id":"526","name":"POST /topics/{tid}/thumbs: should have examples when parameters are present"},{"id":"527","name":"POST /topics/{tid}/thumbs: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"528","name":"POST /topics/{tid}/thumbs: should not error out when called"},{"id":"529","name":"POST /topics/{tid}/thumbs: response status code should match one of the schema defined responses"},{"id":"530","name":"POST /topics/{tid}/thumbs: response body should match schema definition"},{"id":"531","name":"POST /topics/{tid}/thumbs: should successfully re-login if needed"},{"id":"532","name":"POST /topics/{tid}/thumbs: should back out of a registration interstitial if needed"},{"id":"533","name":"PUT /topics/{tid}/thumbs: should have each path parameter defined in its context"},{"id":"534","name":"PUT /topics/{tid}/thumbs: should have examples when parameters are present"},{"id":"535","name":"PUT /topics/{tid}/thumbs: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"536","name":"PUT /topics/{tid}/thumbs: should not error out when called"},{"id":"537","name":"PUT /topics/{tid}/thumbs: response status code should match one of the schema defined responses"},{"id":"538","name":"PUT /topics/{tid}/thumbs: response body should match schema definition"},{"id":"539","name":"PUT /topics/{tid}/thumbs: should successfully re-login if needed"},{"id":"540","name":"PUT /topics/{tid}/thumbs: should back out of a registration interstitial if needed"},{"id":"541","name":"DELETE /topics/{tid}/thumbs: should have each path parameter defined in its context"},{"id":"542","name":"DELETE /topics/{tid}/thumbs: should have examples when parameters are present"},{"id":"543","name":"DELETE /topics/{tid}/thumbs: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"544","name":"DELETE /topics/{tid}/thumbs: should not error out when called"},{"id":"545","name":"DELETE /topics/{tid}/thumbs: response status code should match one of the schema defined responses"},{"id":"546","name":"DELETE /topics/{tid}/thumbs: response body should match schema definition"},{"id":"547","name":"DELETE /topics/{tid}/thumbs: should successfully re-login if needed"},{"id":"548","name":"DELETE /topics/{tid}/thumbs: should back out of a registration interstitial if needed"},{"id":"549","name":"PUT /topics/{tid}/thumbs/order: should have each path parameter defined in its context"},{"id":"550","name":"PUT /topics/{tid}/thumbs/order: should have examples when parameters are present"},{"id":"551","name":"PUT /topics/{tid}/thumbs/order: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"552","name":"PUT /topics/{tid}/thumbs/order: should not error out when called"},{"id":"553","name":"PUT /topics/{tid}/thumbs/order: response status code should match one of the schema defined responses"},{"id":"554","name":"PUT /topics/{tid}/thumbs/order: response body should match schema definition"},{"id":"555","name":"PUT /topics/{tid}/thumbs/order: should successfully re-login if needed"},{"id":"556","name":"PUT /topics/{tid}/thumbs/order: should back out of a registration interstitial if needed"},{"id":"557","name":"GET /topics/{tid}/events: should have each path parameter defined in its context"},{"id":"558","name":"GET /topics/{tid}/events: should have examples when parameters are present"},{"id":"559","name":"GET /topics/{tid}/events: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"560","name":"GET /topics/{tid}/events: should not error out when called"},{"id":"561","name":"GET /topics/{tid}/events: response status code should match one of the schema defined responses"},{"id":"562","name":"GET /topics/{tid}/events: response body should match schema definition"},{"id":"563","name":"GET /topics/{tid}/events: should successfully re-login if needed"},{"id":"564","name":"GET /topics/{tid}/events: should back out of a registration interstitial if needed"},{"id":"565","name":"DELETE /topics/{tid}/events/{eventId}: should have each path parameter defined in its context"},{"id":"566","name":"DELETE /topics/{tid}/events/{eventId}: should have examples when parameters are present"},{"id":"567","name":"DELETE /topics/{tid}/events/{eventId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"568","name":"DELETE /topics/{tid}/events/{eventId}: should not error out when called"},{"id":"569","name":"DELETE /topics/{tid}/events/{eventId}: response status code should match one of the schema defined responses"},{"id":"570","name":"DELETE /topics/{tid}/events/{eventId}: response body should match schema definition"},{"id":"571","name":"DELETE /topics/{tid}/events/{eventId}: should successfully re-login if needed"},{"id":"572","name":"DELETE /topics/{tid}/events/{eventId}: should back out of a registration interstitial if needed"},{"id":"573","name":"GET /posts/{pid}: should have each path parameter defined in its context"},{"id":"574","name":"GET /posts/{pid}: should have examples when parameters are present"},{"id":"575","name":"GET /posts/{pid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"576","name":"GET /posts/{pid}: should not error out when called"},{"id":"577","name":"GET /posts/{pid}: response status code should match one of the schema defined responses"},{"id":"578","name":"GET /posts/{pid}: response body should match schema definition"},{"id":"579","name":"GET /posts/{pid}: should successfully re-login if needed"},{"id":"580","name":"GET /posts/{pid}: should back out of a registration interstitial if needed"},{"id":"581","name":"PUT /posts/{pid}: should have each path parameter defined in its context"},{"id":"582","name":"PUT /posts/{pid}: should have examples when parameters are present"},{"id":"583","name":"PUT /posts/{pid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"584","name":"PUT /posts/{pid}: should not error out when called"},{"id":"585","name":"PUT /posts/{pid}: response status code should match one of the schema defined responses"},{"id":"586","name":"PUT /posts/{pid}: response body should match schema definition"},{"id":"587","name":"PUT /posts/{pid}: should successfully re-login if needed"},{"id":"588","name":"PUT /posts/{pid}: should back out of a registration interstitial if needed"},{"id":"589","name":"DELETE /posts/{pid}: should have each path parameter defined in its context"},{"id":"590","name":"DELETE /posts/{pid}: should have examples when parameters are present"},{"id":"591","name":"DELETE /posts/{pid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"592","name":"DELETE /posts/{pid}: should not error out when called"},{"id":"593","name":"DELETE /posts/{pid}: response status code should match one of the schema defined responses"},{"id":"594","name":"DELETE /posts/{pid}: response body should match schema definition"},{"id":"595","name":"DELETE /posts/{pid}: should successfully re-login if needed"},{"id":"596","name":"DELETE /posts/{pid}: should back out of a registration interstitial if needed"},{"id":"597","name":"DELETE /posts/{pid}/state: should have each path parameter defined in its context"},{"id":"598","name":"DELETE /posts/{pid}/state: should have examples when parameters are present"},{"id":"599","name":"DELETE /posts/{pid}/state: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"600","name":"DELETE /posts/{pid}/state: should not error out when called"},{"id":"601","name":"DELETE /posts/{pid}/state: response status code should match one of the schema defined responses"},{"id":"602","name":"DELETE /posts/{pid}/state: response body should match schema definition"},{"id":"603","name":"DELETE /posts/{pid}/state: should successfully re-login if needed"},{"id":"604","name":"DELETE /posts/{pid}/state: should back out of a registration interstitial if needed"},{"id":"605","name":"PUT /posts/{pid}/state: should have each path parameter defined in its context"},{"id":"606","name":"PUT /posts/{pid}/state: should have examples when parameters are present"},{"id":"607","name":"PUT /posts/{pid}/state: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"608","name":"PUT /posts/{pid}/state: should not error out when called"},{"id":"609","name":"PUT /posts/{pid}/state: response status code should match one of the schema defined responses"},{"id":"610","name":"PUT /posts/{pid}/state: response body should match schema definition"},{"id":"611","name":"PUT /posts/{pid}/state: should successfully re-login if needed"},{"id":"612","name":"PUT /posts/{pid}/state: should back out of a registration interstitial if needed"},{"id":"613","name":"PUT /posts/{pid}/move: should have each path parameter defined in its context"},{"id":"614","name":"PUT /posts/{pid}/move: should have examples when parameters are present"},{"id":"615","name":"PUT /posts/{pid}/move: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"616","name":"PUT /posts/{pid}/move: should not error out when called"},{"id":"617","name":"PUT /posts/{pid}/move: response status code should match one of the schema defined responses"},{"id":"618","name":"PUT /posts/{pid}/move: response body should match schema definition"},{"id":"619","name":"PUT /posts/{pid}/move: should successfully re-login if needed"},{"id":"620","name":"PUT /posts/{pid}/move: should back out of a registration interstitial if needed"},{"id":"621","name":"PUT /posts/{pid}/vote: should have each path parameter defined in its context"},{"id":"622","name":"PUT /posts/{pid}/vote: should have examples when parameters are present"},{"id":"623","name":"PUT /posts/{pid}/vote: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"624","name":"PUT /posts/{pid}/vote: should not error out when called"},{"id":"625","name":"PUT /posts/{pid}/vote: response status code should match one of the schema defined responses"},{"id":"626","name":"PUT /posts/{pid}/vote: response body should match schema definition"},{"id":"627","name":"PUT /posts/{pid}/vote: should successfully re-login if needed"},{"id":"628","name":"PUT /posts/{pid}/vote: should back out of a registration interstitial if needed"},{"id":"629","name":"DELETE /posts/{pid}/vote: should have each path parameter defined in its context"},{"id":"630","name":"DELETE /posts/{pid}/vote: should have examples when parameters are present"},{"id":"631","name":"DELETE /posts/{pid}/vote: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"632","name":"DELETE /posts/{pid}/vote: should not error out when called"},{"id":"633","name":"DELETE /posts/{pid}/vote: response status code should match one of the schema defined responses"},{"id":"634","name":"DELETE /posts/{pid}/vote: response body should match schema definition"},{"id":"635","name":"DELETE /posts/{pid}/vote: should successfully re-login if needed"},{"id":"636","name":"DELETE /posts/{pid}/vote: should back out of a registration interstitial if needed"},{"id":"637","name":"PUT /posts/{pid}/bookmark: should have each path parameter defined in its context"},{"id":"638","name":"PUT /posts/{pid}/bookmark: should have examples when parameters are present"},{"id":"639","name":"PUT /posts/{pid}/bookmark: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"640","name":"PUT /posts/{pid}/bookmark: should not error out when called"},{"id":"641","name":"PUT /posts/{pid}/bookmark: response status code should match one of the schema defined responses"},{"id":"642","name":"PUT /posts/{pid}/bookmark: response body should match schema definition"},{"id":"643","name":"PUT /posts/{pid}/bookmark: should successfully re-login if needed"},{"id":"644","name":"PUT /posts/{pid}/bookmark: should back out of a registration interstitial if needed"},{"id":"645","name":"DELETE /posts/{pid}/bookmark: should have each path parameter defined in its context"},{"id":"646","name":"DELETE /posts/{pid}/bookmark: should have examples when parameters are present"},{"id":"647","name":"DELETE /posts/{pid}/bookmark: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"648","name":"DELETE /posts/{pid}/bookmark: should not error out when called"},{"id":"649","name":"DELETE /posts/{pid}/bookmark: response status code should match one of the schema defined responses"},{"id":"650","name":"DELETE /posts/{pid}/bookmark: response body should match schema definition"},{"id":"651","name":"DELETE /posts/{pid}/bookmark: should successfully re-login if needed"},{"id":"652","name":"DELETE /posts/{pid}/bookmark: should back out of a registration interstitial if needed"},{"id":"653","name":"PUT /posts/{pid}/endorse: should have each path parameter defined in its context"},{"id":"654","name":"PUT /posts/{pid}/endorse: should have examples when parameters are present"},{"id":"655","name":"PUT /posts/{pid}/endorse: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"656","name":"PUT /posts/{pid}/endorse: should not error out when called"},{"id":"657","name":"PUT /posts/{pid}/endorse: response status code should match one of the schema defined responses"},{"id":"658","name":"PUT /posts/{pid}/endorse: response body should match schema definition"},{"id":"659","name":"PUT /posts/{pid}/endorse: should successfully re-login if needed"},{"id":"660","name":"PUT /posts/{pid}/endorse: should back out of a registration interstitial if needed"},{"id":"661","name":"DELETE /posts/{pid}/endorse: should have each path parameter defined in its context"},{"id":"662","name":"DELETE /posts/{pid}/endorse: should have examples when parameters are present"},{"id":"663","name":"DELETE /posts/{pid}/endorse: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"664","name":"DELETE /posts/{pid}/endorse: should not error out when called"},{"id":"665","name":"DELETE /posts/{pid}/endorse: response status code should match one of the schema defined responses"},{"id":"666","name":"DELETE /posts/{pid}/endorse: response body should match schema definition"},{"id":"667","name":"DELETE /posts/{pid}/endorse: should successfully re-login if needed"},{"id":"668","name":"DELETE /posts/{pid}/endorse: should back out of a registration interstitial if needed"},{"id":"669","name":"GET /posts/{pid}/diffs: should have each path parameter defined in its context"},{"id":"670","name":"GET /posts/{pid}/diffs: should have examples when parameters are present"},{"id":"671","name":"GET /posts/{pid}/diffs: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"672","name":"GET /posts/{pid}/diffs: should not error out when called"},{"id":"673","name":"GET /posts/{pid}/diffs: response status code should match one of the schema defined responses"},{"id":"674","name":"GET /posts/{pid}/diffs: response body should match schema definition"},{"id":"675","name":"GET /posts/{pid}/diffs: should successfully re-login if needed"},{"id":"676","name":"GET /posts/{pid}/diffs: should back out of a registration interstitial if needed"},{"id":"677","name":"GET /posts/{pid}/diffs/{since}: should have each path parameter defined in its context"},{"id":"678","name":"GET /posts/{pid}/diffs/{since}: should have examples when parameters are present"},{"id":"679","name":"GET /posts/{pid}/diffs/{since}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"680","name":"GET /posts/{pid}/diffs/{since}: should not error out when called"},{"id":"681","name":"GET /posts/{pid}/diffs/{since}: response status code should match one of the schema defined responses"},{"id":"682","name":"GET /posts/{pid}/diffs/{since}: response body should match schema definition"},{"id":"683","name":"GET /posts/{pid}/diffs/{since}: should successfully re-login if needed"},{"id":"684","name":"GET /posts/{pid}/diffs/{since}: should back out of a registration interstitial if needed"},{"id":"685","name":"PUT /posts/{pid}/diffs/{since}: should have each path parameter defined in its context"},{"id":"686","name":"PUT /posts/{pid}/diffs/{since}: should have examples when parameters are present"},{"id":"687","name":"PUT /posts/{pid}/diffs/{since}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"688","name":"PUT /posts/{pid}/diffs/{since}: should not error out when called"},{"id":"689","name":"PUT /posts/{pid}/diffs/{since}: response status code should match one of the schema defined responses"},{"id":"690","name":"PUT /posts/{pid}/diffs/{since}: response body should match schema definition"},{"id":"691","name":"PUT /posts/{pid}/diffs/{since}: should successfully re-login if needed"},{"id":"692","name":"PUT /posts/{pid}/diffs/{since}: should back out of a registration interstitial if needed"},{"id":"693","name":"DELETE /posts/{pid}/diffs/{timestamp}: should have each path parameter defined in its context"},{"id":"694","name":"DELETE /posts/{pid}/diffs/{timestamp}: should have examples when parameters are present"},{"id":"695","name":"DELETE /posts/{pid}/diffs/{timestamp}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"696","name":"DELETE /posts/{pid}/diffs/{timestamp}: should not error out when called"},{"id":"697","name":"DELETE /posts/{pid}/diffs/{timestamp}: response status code should match one of the schema defined responses"},{"id":"698","name":"DELETE /posts/{pid}/diffs/{timestamp}: response body should match schema definition"},{"id":"699","name":"DELETE /posts/{pid}/diffs/{timestamp}: should successfully re-login if needed"},{"id":"700","name":"DELETE /posts/{pid}/diffs/{timestamp}: should back out of a registration interstitial if needed"},{"id":"701","name":"GET /chats/: should have each path parameter defined in its context"},{"id":"702","name":"GET /chats/: should have examples when parameters are present"},{"id":"703","name":"GET /chats/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"704","name":"GET /chats/: should not error out when called"},{"id":"705","name":"GET /chats/: response status code should match one of the schema defined responses"},{"id":"706","name":"GET /chats/: response body should match schema definition"},{"id":"707","name":"GET /chats/: should successfully re-login if needed"},{"id":"708","name":"GET /chats/: should back out of a registration interstitial if needed"},{"id":"709","name":"POST /chats/: should have each path parameter defined in its context"},{"id":"710","name":"POST /chats/: should have examples when parameters are present"},{"id":"711","name":"POST /chats/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"712","name":"POST /chats/: should not error out when called"},{"id":"713","name":"POST /chats/: response status code should match one of the schema defined responses"},{"id":"714","name":"POST /chats/: response body should match schema definition"},{"id":"715","name":"POST /chats/: should successfully re-login if needed"},{"id":"716","name":"POST /chats/: should back out of a registration interstitial if needed"},{"id":"717","name":"HEAD /chats/{roomId}: should have each path parameter defined in its context"},{"id":"718","name":"HEAD /chats/{roomId}: should have examples when parameters are present"},{"id":"719","name":"HEAD /chats/{roomId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"720","name":"HEAD /chats/{roomId}: should not error out when called"},{"id":"721","name":"HEAD /chats/{roomId}: response status code should match one of the schema defined responses"},{"id":"722","name":"HEAD /chats/{roomId}: response body should match schema definition"},{"id":"723","name":"HEAD /chats/{roomId}: should successfully re-login if needed"},{"id":"724","name":"HEAD /chats/{roomId}: should back out of a registration interstitial if needed"},{"id":"725","name":"GET /chats/{roomId}: should have each path parameter defined in its context"},{"id":"726","name":"GET /chats/{roomId}: should have examples when parameters are present"},{"id":"727","name":"GET /chats/{roomId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"728","name":"GET /chats/{roomId}: should not error out when called"},{"id":"729","name":"GET /chats/{roomId}: response status code should match one of the schema defined responses"},{"id":"730","name":"GET /chats/{roomId}: response body should match schema definition"},{"id":"731","name":"GET /chats/{roomId}: should successfully re-login if needed"},{"id":"732","name":"GET /chats/{roomId}: should back out of a registration interstitial if needed"},{"id":"733","name":"POST /chats/{roomId}: should have each path parameter defined in its context"},{"id":"734","name":"POST /chats/{roomId}: should have examples when parameters are present"},{"id":"735","name":"POST /chats/{roomId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"736","name":"POST /chats/{roomId}: should not error out when called"},{"id":"737","name":"POST /chats/{roomId}: response status code should match one of the schema defined responses"},{"id":"738","name":"POST /chats/{roomId}: response body should match schema definition"},{"id":"739","name":"POST /chats/{roomId}: should successfully re-login if needed"},{"id":"740","name":"POST /chats/{roomId}: should back out of a registration interstitial if needed"},{"id":"741","name":"PUT /chats/{roomId}: should have each path parameter defined in its context"},{"id":"742","name":"PUT /chats/{roomId}: should have examples when parameters are present"},{"id":"743","name":"PUT /chats/{roomId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"744","name":"PUT /chats/{roomId}: should not error out when called"},{"id":"745","name":"PUT /chats/{roomId}: response status code should match one of the schema defined responses"},{"id":"746","name":"PUT /chats/{roomId}: response body should match schema definition"},{"id":"747","name":"PUT /chats/{roomId}: should successfully re-login if needed"},{"id":"748","name":"PUT /chats/{roomId}: should back out of a registration interstitial if needed"},{"id":"749","name":"GET /chats/{roomId}/users: should have each path parameter defined in its context"},{"id":"750","name":"GET /chats/{roomId}/users: should have examples when parameters are present"},{"id":"751","name":"GET /chats/{roomId}/users: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"752","name":"GET /chats/{roomId}/users: should not error out when called"},{"id":"753","name":"GET /chats/{roomId}/users: response status code should match one of the schema defined responses"},{"id":"754","name":"GET /chats/{roomId}/users: response body should match schema definition"},{"id":"755","name":"GET /chats/{roomId}/users: should successfully re-login if needed"},{"id":"756","name":"GET /chats/{roomId}/users: should back out of a registration interstitial if needed"},{"id":"757","name":"POST /chats/{roomId}/users: should have each path parameter defined in its context"},{"id":"758","name":"POST /chats/{roomId}/users: should have examples when parameters are present"},{"id":"759","name":"POST /chats/{roomId}/users: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"760","name":"POST /chats/{roomId}/users: should not error out when called"},{"id":"761","name":"POST /chats/{roomId}/users: response status code should match one of the schema defined responses"},{"id":"762","name":"POST /chats/{roomId}/users: response body should match schema definition"},{"id":"763","name":"POST /chats/{roomId}/users: should successfully re-login if needed"},{"id":"764","name":"POST /chats/{roomId}/users: should back out of a registration interstitial if needed"},{"id":"765","name":"DELETE /chats/{roomId}/users: should have each path parameter defined in its context"},{"id":"766","name":"DELETE /chats/{roomId}/users: should have examples when parameters are present"},{"id":"767","name":"DELETE /chats/{roomId}/users: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"768","name":"DELETE /chats/{roomId}/users: should not error out when called"},{"id":"769","name":"DELETE /chats/{roomId}/users: response status code should match one of the schema defined responses"},{"id":"770","name":"DELETE /chats/{roomId}/users: response body should match schema definition"},{"id":"771","name":"DELETE /chats/{roomId}/users: should successfully re-login if needed"},{"id":"772","name":"DELETE /chats/{roomId}/users: should back out of a registration interstitial if needed"},{"id":"773","name":"DELETE /chats/{roomId}/users/{uid}: should have each path parameter defined in its context"},{"id":"774","name":"DELETE /chats/{roomId}/users/{uid}: should have examples when parameters are present"},{"id":"775","name":"DELETE /chats/{roomId}/users/{uid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"776","name":"DELETE /chats/{roomId}/users/{uid}: should not error out when called"},{"id":"777","name":"DELETE /chats/{roomId}/users/{uid}: response status code should match one of the schema defined responses"},{"id":"778","name":"DELETE /chats/{roomId}/users/{uid}: response body should match schema definition"},{"id":"779","name":"DELETE /chats/{roomId}/users/{uid}: should successfully re-login if needed"},{"id":"780","name":"DELETE /chats/{roomId}/users/{uid}: should back out of a registration interstitial if needed"},{"id":"781","name":"GET /chats/{roomId}/messages: should have each path parameter defined in its context"},{"id":"782","name":"GET /chats/{roomId}/messages: should have examples when parameters are present"},{"id":"783","name":"GET /chats/{roomId}/messages: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"784","name":"GET /chats/{roomId}/messages: should not error out when called"},{"id":"785","name":"GET /chats/{roomId}/messages: response status code should match one of the schema defined responses"},{"id":"786","name":"GET /chats/{roomId}/messages: response body should match schema definition"},{"id":"787","name":"GET /chats/{roomId}/messages: should successfully re-login if needed"},{"id":"788","name":"GET /chats/{roomId}/messages: should back out of a registration interstitial if needed"},{"id":"789","name":"GET /chats/{roomId}/messages/{mid}: should have each path parameter defined in its context"},{"id":"790","name":"GET /chats/{roomId}/messages/{mid}: should have examples when parameters are present"},{"id":"791","name":"GET /chats/{roomId}/messages/{mid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"792","name":"GET /chats/{roomId}/messages/{mid}: should not error out when called"},{"id":"793","name":"GET /chats/{roomId}/messages/{mid}: response status code should match one of the schema defined responses"},{"id":"794","name":"GET /chats/{roomId}/messages/{mid}: response body should match schema definition"},{"id":"795","name":"GET /chats/{roomId}/messages/{mid}: should successfully re-login if needed"},{"id":"796","name":"GET /chats/{roomId}/messages/{mid}: should back out of a registration interstitial if needed"},{"id":"797","name":"PUT /chats/{roomId}/messages/{mid}: should have each path parameter defined in its context"},{"id":"798","name":"PUT /chats/{roomId}/messages/{mid}: should have examples when parameters are present"},{"id":"799","name":"PUT /chats/{roomId}/messages/{mid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"800","name":"PUT /chats/{roomId}/messages/{mid}: should not error out when called"},{"id":"801","name":"PUT /chats/{roomId}/messages/{mid}: response status code should match one of the schema defined responses"},{"id":"802","name":"PUT /chats/{roomId}/messages/{mid}: response body should match schema definition"},{"id":"803","name":"PUT /chats/{roomId}/messages/{mid}: should successfully re-login if needed"},{"id":"804","name":"PUT /chats/{roomId}/messages/{mid}: should back out of a registration interstitial if needed"},{"id":"805","name":"DELETE /chats/{roomId}/messages/{mid}: should have each path parameter defined in its context"},{"id":"806","name":"DELETE /chats/{roomId}/messages/{mid}: should have examples when parameters are present"},{"id":"807","name":"DELETE /chats/{roomId}/messages/{mid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"808","name":"DELETE /chats/{roomId}/messages/{mid}: should not error out when called"},{"id":"809","name":"DELETE /chats/{roomId}/messages/{mid}: response status code should match one of the schema defined responses"},{"id":"810","name":"DELETE /chats/{roomId}/messages/{mid}: response body should match schema definition"},{"id":"811","name":"DELETE /chats/{roomId}/messages/{mid}: should successfully re-login if needed"},{"id":"812","name":"DELETE /chats/{roomId}/messages/{mid}: should back out of a registration interstitial if needed"},{"id":"813","name":"POST /chats/{roomId}/messages/{mid}: should have each path parameter defined in its context"},{"id":"814","name":"POST /chats/{roomId}/messages/{mid}: should have examples when parameters are present"},{"id":"815","name":"POST /chats/{roomId}/messages/{mid}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"816","name":"POST /chats/{roomId}/messages/{mid}: should not error out when called"},{"id":"817","name":"POST /chats/{roomId}/messages/{mid}: response status code should match one of the schema defined responses"},{"id":"818","name":"POST /chats/{roomId}/messages/{mid}: response body should match schema definition"},{"id":"819","name":"POST /chats/{roomId}/messages/{mid}: should successfully re-login if needed"},{"id":"820","name":"POST /chats/{roomId}/messages/{mid}: should back out of a registration interstitial if needed"},{"id":"821","name":"POST /flags/: should have each path parameter defined in its context"},{"id":"822","name":"POST /flags/: should have examples when parameters are present"},{"id":"823","name":"POST /flags/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"824","name":"POST /flags/: should not error out when called"},{"id":"825","name":"POST /flags/: response status code should match one of the schema defined responses"},{"id":"826","name":"POST /flags/: response body should match schema definition"},{"id":"827","name":"POST /flags/: should successfully re-login if needed"},{"id":"828","name":"POST /flags/: should back out of a registration interstitial if needed"},{"id":"829","name":"GET /flags/{flagId}: should have each path parameter defined in its context"},{"id":"830","name":"GET /flags/{flagId}: should have examples when parameters are present"},{"id":"831","name":"GET /flags/{flagId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"832","name":"GET /flags/{flagId}: should not error out when called"},{"id":"833","name":"GET /flags/{flagId}: response status code should match one of the schema defined responses"},{"id":"834","name":"GET /flags/{flagId}: response body should match schema definition"},{"id":"835","name":"GET /flags/{flagId}: should successfully re-login if needed"},{"id":"836","name":"GET /flags/{flagId}: should back out of a registration interstitial if needed"},{"id":"837","name":"PUT /flags/{flagId}: should have each path parameter defined in its context"},{"id":"838","name":"PUT /flags/{flagId}: should have examples when parameters are present"},{"id":"839","name":"PUT /flags/{flagId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"840","name":"PUT /flags/{flagId}: should not error out when called"},{"id":"841","name":"PUT /flags/{flagId}: response status code should match one of the schema defined responses"},{"id":"842","name":"PUT /flags/{flagId}: response body should match schema definition"},{"id":"843","name":"PUT /flags/{flagId}: should successfully re-login if needed"},{"id":"844","name":"PUT /flags/{flagId}: should back out of a registration interstitial if needed"},{"id":"845","name":"DELETE /flags/{flagId}: should have each path parameter defined in its context"},{"id":"846","name":"DELETE /flags/{flagId}: should have examples when parameters are present"},{"id":"847","name":"DELETE /flags/{flagId}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"848","name":"DELETE /flags/{flagId}: should not error out when called"},{"id":"849","name":"DELETE /flags/{flagId}: response status code should match one of the schema defined responses"},{"id":"850","name":"DELETE /flags/{flagId}: response body should match schema definition"},{"id":"851","name":"DELETE /flags/{flagId}: should successfully re-login if needed"},{"id":"852","name":"DELETE /flags/{flagId}: should back out of a registration interstitial if needed"},{"id":"853","name":"POST /flags/{flagId}/notes: should have each path parameter defined in its context"},{"id":"854","name":"POST /flags/{flagId}/notes: should have examples when parameters are present"},{"id":"855","name":"POST /flags/{flagId}/notes: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"856","name":"POST /flags/{flagId}/notes: should not error out when called"},{"id":"857","name":"POST /flags/{flagId}/notes: response status code should match one of the schema defined responses"},{"id":"858","name":"POST /flags/{flagId}/notes: response body should match schema definition"},{"id":"859","name":"POST /flags/{flagId}/notes: should successfully re-login if needed"},{"id":"860","name":"POST /flags/{flagId}/notes: should back out of a registration interstitial if needed"},{"id":"861","name":"DELETE /flags/{flagId}/notes/{datetime}: should have each path parameter defined in its context"},{"id":"862","name":"DELETE /flags/{flagId}/notes/{datetime}: should have examples when parameters are present"},{"id":"863","name":"DELETE /flags/{flagId}/notes/{datetime}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"864","name":"DELETE /flags/{flagId}/notes/{datetime}: should not error out when called"},{"id":"865","name":"DELETE /flags/{flagId}/notes/{datetime}: response status code should match one of the schema defined responses"},{"id":"866","name":"DELETE /flags/{flagId}/notes/{datetime}: response body should match schema definition"},{"id":"867","name":"DELETE /flags/{flagId}/notes/{datetime}: should successfully re-login if needed"},{"id":"868","name":"DELETE /flags/{flagId}/notes/{datetime}: should back out of a registration interstitial if needed"},{"id":"869","name":"PUT /admin/settings/{setting}: should have each path parameter defined in its context"},{"id":"870","name":"PUT /admin/settings/{setting}: should have examples when parameters are present"},{"id":"871","name":"PUT /admin/settings/{setting}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"872","name":"PUT /admin/settings/{setting}: should not error out when called"},{"id":"873","name":"PUT /admin/settings/{setting}: response status code should match one of the schema defined responses"},{"id":"874","name":"PUT /admin/settings/{setting}: response body should match schema definition"},{"id":"875","name":"PUT /admin/settings/{setting}: should successfully re-login if needed"},{"id":"876","name":"PUT /admin/settings/{setting}: should back out of a registration interstitial if needed"},{"id":"877","name":"GET /admin/analytics: should have each path parameter defined in its context"},{"id":"878","name":"GET /admin/analytics: should have examples when parameters are present"},{"id":"879","name":"GET /admin/analytics: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"880","name":"GET /admin/analytics: should not error out when called"},{"id":"881","name":"GET /admin/analytics: response status code should match one of the schema defined responses"},{"id":"882","name":"GET /admin/analytics: response body should match schema definition"},{"id":"883","name":"GET /admin/analytics: should successfully re-login if needed"},{"id":"884","name":"GET /admin/analytics: should back out of a registration interstitial if needed"},{"id":"885","name":"GET /admin/analytics/{set}: should have each path parameter defined in its context"},{"id":"886","name":"GET /admin/analytics/{set}: should have examples when parameters are present"},{"id":"887","name":"GET /admin/analytics/{set}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"888","name":"GET /admin/analytics/{set}: should not error out when called"},{"id":"889","name":"GET /admin/analytics/{set}: response status code should match one of the schema defined responses"},{"id":"890","name":"GET /admin/analytics/{set}: response body should match schema definition"},{"id":"891","name":"GET /admin/analytics/{set}: should successfully re-login if needed"},{"id":"892","name":"GET /admin/analytics/{set}: should back out of a registration interstitial if needed"},{"id":"893","name":"DELETE /files/: should have each path parameter defined in its context"},{"id":"894","name":"DELETE /files/: should have examples when parameters are present"},{"id":"895","name":"DELETE /files/: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"896","name":"DELETE /files/: should not error out when called"},{"id":"897","name":"DELETE /files/: response status code should match one of the schema defined responses"},{"id":"898","name":"DELETE /files/: response body should match schema definition"},{"id":"899","name":"DELETE /files/: should successfully re-login if needed"},{"id":"900","name":"DELETE /files/: should back out of a registration interstitial if needed"},{"id":"901","name":"PUT /files/folder: should have each path parameter defined in its context"},{"id":"902","name":"PUT /files/folder: should have examples when parameters are present"},{"id":"903","name":"PUT /files/folder: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE"},{"id":"904","name":"PUT /files/folder: should not error out when called"},{"id":"905","name":"PUT /files/folder: response status code should match one of the schema defined responses"},{"id":"906","name":"PUT /files/folder: response body should match schema definition"},{"id":"907","name":"PUT /files/folder: should successfully re-login if needed"},{"id":"908","name":"PUT /files/folder: should back out of a registration interstitial if needed"},{"id":"2397","name":"Utility Methods should decode HTML entities"},{"id":"2398","name":"Utility Methods should strip HTML tags"},{"id":"2399","name":"Utility Methods should preserve case if requested"},{"id":"2400","name":"Utility Methods should work if a number is passed in"},{"id":"2401","name":"Utility Methods should remove punctuation"},{"id":"2402","name":"Utility Methods should return true if string has language key"},{"id":"2403","name":"Utility Methods should return false if string does not have language key"},{"id":"2404","name":"Utility Methods should shallow merge two objects"},{"id":"2405","name":"Utility Methods should return the file extesion"},{"id":"2406","name":"Utility Methods should return file mime type"},{"id":"2407","name":"Utility Methods should check if url is relative"},{"id":"2408","name":"Utility Methods should make number human readable"},{"id":"2409","name":"Utility Methods should make numbers human readable on elements"},{"id":"2410","name":"Utility Methods should add commas to numbers"},{"id":"2411","name":"Utility Methods should add commas to elements"},{"id":"2412","name":"Utility Methods should return passed in value if invalid"},{"id":"2413","name":"Utility Methods should return false if browser is not android"},{"id":"2414","name":"Utility Methods should return true if browser is android"},{"id":"2415","name":"Utility Methods should return false if not touch device"},{"id":"2416","name":"Utility Methods should check if element is in viewport"},{"id":"2417","name":"Utility Methods should get empty object for url params"},{"id":"2418","name":"Utility Methods should get url params"},{"id":"2419","name":"Utility Methods should get url params as arrays"},{"id":"2420","name":"Utility Methods should get a single param"},{"id":"2421","name":"Utility Methods should get the full URLSearchParams object"},{"id":"2422","name":"Utility Methods escape html"},{"id":"2423","name":"Utility Methods should escape regex chars"},{"id":"2424","name":"Utility Methods should get hours array"},{"id":"2425","name":"Utility Methods should get days array"},{"id":"2426","name":"Utility Methods `utils.rtrim` should remove trailing space"},{"id":"2427","name":"Utility Methods should profile function"},{"id":"2428","name":"Utility Methods should return object with data"},{"id":"2429","name":"Utility Methods username validation accepts latin-1 characters"},{"id":"2430","name":"Utility Methods username validation rejects empty string"},{"id":"2431","name":"Utility Methods username validation should reject new lines"},{"id":"2432","name":"Utility Methods username validation should reject tabs"},{"id":"2433","name":"Utility Methods username validation accepts square brackets"},{"id":"2434","name":"Utility Methods username validation accepts regular username"},{"id":"2435","name":"Utility Methods username validation accepts quotes"},{"id":"2436","name":"Utility Methods email validation accepts sample address"},{"id":"2437","name":"Utility Methods email validation rejects empty address"},{"id":"2438","name":"Utility Methods UUID generation return unique random value every time"},{"id":"2439","name":"Utility Methods cleanUpTag should cleanUp a tag"},{"id":"2440","name":"Utility Methods cleanUpTag should return empty string for invalid tags"},{"id":"2441","name":"Utility Methods toType should return param as is if not string"},{"id":"2442","name":"Utility Methods toType should convert return string numbers as numbers"},{"id":"2443","name":"Utility Methods toType should convert string \"false\" to boolean false"},{"id":"2444","name":"Utility Methods toType should convert string \"true\" to boolean true"},{"id":"2445","name":"Utility Methods toType should parse json"},{"id":"2446","name":"Utility Methods toType should return string as is if its not json,true,false or number"},{"id":"2447","name":"Utility Methods utils.props should set nested data"},{"id":"2448","name":"Utility Methods utils.props should return nested object"},{"id":"2449","name":"Utility Methods utils.props should returned undefined without throwing"},{"id":"2450","name":"Utility Methods utils.props should return undefined if second param is null"},{"id":"2451","name":"Utility Methods isInternalURI should return true if they match"},{"id":"2452","name":"Utility Methods isInternalURI should handle relative path"},{"id":"2453","name":"Utility Methods isInternalURI should return false if they do not match"},{"id":"2454","name":"GET /api/ should be defined in schema docs"},{"id":"2455","name":"POST /api/v3/users/ should be defined in schema docs"},{"id":"2456","name":"DELETE /api/v3/users/ should be defined in schema docs"},{"id":"2457","name":"HEAD /api/v3/users/{uid} should be defined in schema docs"},{"id":"2458","name":"GET /api/v3/users/{uid} should be defined in schema docs"},{"id":"2459","name":"PUT /api/v3/users/{uid} should be defined in schema docs"},{"id":"2460","name":"DELETE /api/v3/users/{uid} should be defined in schema docs"},{"id":"2461","name":"PUT /api/v3/users/{uid}/picture should be defined in schema docs"},{"id":"2462","name":"DELETE /api/v3/users/{uid}/content should be defined in schema docs"},{"id":"2463","name":"DELETE /api/v3/users/{uid}/account should be defined in schema docs"},{"id":"2464","name":"PUT /api/v3/users/{uid}/settings should be defined in schema docs"},{"id":"2465","name":"PUT /api/v3/users/{uid}/password should be defined in schema docs"},{"id":"2466","name":"PUT /api/v3/users/{uid}/follow should be defined in schema docs"},{"id":"2467","name":"DELETE /api/v3/users/{uid}/follow should be defined in schema docs"},{"id":"2468","name":"PUT /api/v3/users/{uid}/ban should be defined in schema docs"},{"id":"2469","name":"DELETE /api/v3/users/{uid}/ban should be defined in schema docs"},{"id":"2470","name":"PUT /api/v3/users/{uid}/mute should be defined in schema docs"},{"id":"2471","name":"DELETE /api/v3/users/{uid}/mute should be defined in schema docs"},{"id":"2472","name":"POST /api/v3/users/{uid}/tokens should be defined in schema docs"},{"id":"2473","name":"DELETE /api/v3/users/{uid}/tokens/{token} should be defined in schema docs"},{"id":"2474","name":"DELETE /api/v3/users/{uid}/sessions/{uuid} should be defined in schema docs"},{"id":"2475","name":"POST /api/v3/users/{uid}/invites should be defined in schema docs"},{"id":"2476","name":"GET /api/v3/users/{uid}/invites/groups should be defined in schema docs"},{"id":"2477","name":"GET /api/v3/users/{uid}/emails should be defined in schema docs"},{"id":"2478","name":"GET /api/v3/users/{uid}/emails/{email} should be defined in schema docs"},{"id":"2479","name":"POST /api/v3/users/{uid}/emails/{email}/confirm should be defined in schema docs"},{"id":"2480","name":"HEAD /api/v3/users/{uid}/exports/{type} should be defined in schema docs"},{"id":"2481","name":"GET /api/v3/users/{uid}/exports/{type} should be defined in schema docs"},{"id":"2482","name":"POST /api/v3/users/{uid}/exports/{type} should be defined in schema docs"},{"id":"2483","name":"POST /api/v3/groups/ should be defined in schema docs"},{"id":"2484","name":"HEAD /api/v3/groups/{slug} should be defined in schema docs"},{"id":"2485","name":"PUT /api/v3/groups/{slug} should be defined in schema docs"},{"id":"2486","name":"DELETE /api/v3/groups/{slug} should be defined in schema docs"},{"id":"2487","name":"PUT /api/v3/groups/{slug}/membership/{uid} should be defined in schema docs"},{"id":"2488","name":"DELETE /api/v3/groups/{slug}/membership/{uid} should be defined in schema docs"},{"id":"2489","name":"PUT /api/v3/groups/{slug}/ownership/{uid} should be defined in schema docs"},{"id":"2490","name":"DELETE /api/v3/groups/{slug}/ownership/{uid} should be defined in schema docs"},{"id":"2491","name":"POST /api/v3/categories/ should be defined in schema docs"},{"id":"2492","name":"GET /api/v3/categories/{cid} should be defined in schema docs"},{"id":"2493","name":"PUT /api/v3/categories/{cid} should be defined in schema docs"},{"id":"2494","name":"DELETE /api/v3/categories/{cid} should be defined in schema docs"},{"id":"2495","name":"GET /api/v3/categories/{cid}/privileges should be defined in schema docs"},{"id":"2496","name":"PUT /api/v3/categories/{cid}/privileges/{privilege} should be defined in schema docs"},{"id":"2497","name":"DELETE /api/v3/categories/{cid}/privileges/{privilege} should be defined in schema docs"},{"id":"2498","name":"PUT /api/v3/categories/{cid}/moderator/{uid} should be defined in schema docs"},{"id":"2499","name":"DELETE /api/v3/categories/{cid}/moderator/{uid} should be defined in schema docs"},{"id":"2500","name":"POST /api/v3/topics/ should be defined in schema docs"},{"id":"2501","name":"GET /api/v3/topics/{tid} should be defined in schema docs"},{"id":"2502","name":"POST /api/v3/topics/{tid} should be defined in schema docs"},{"id":"2503","name":"DELETE /api/v3/topics/{tid} should be defined in schema docs"},{"id":"2504","name":"PUT /api/v3/topics/{tid}/state should be defined in schema docs"},{"id":"2505","name":"DELETE /api/v3/topics/{tid}/state should be defined in schema docs"},{"id":"2506","name":"PUT /api/v3/topics/{tid}/pin should be defined in schema docs"},{"id":"2507","name":"DELETE /api/v3/topics/{tid}/pin should be defined in schema docs"},{"id":"2508","name":"PUT /api/v3/topics/{tid}/lock should be defined in schema docs"},{"id":"2509","name":"DELETE /api/v3/topics/{tid}/lock should be defined in schema docs"},{"id":"2510","name":"PUT /api/v3/topics/{tid}/follow should be defined in schema docs"},{"id":"2511","name":"DELETE /api/v3/topics/{tid}/follow should be defined in schema docs"},{"id":"2512","name":"PUT /api/v3/topics/{tid}/ignore should be defined in schema docs"},{"id":"2513","name":"DELETE /api/v3/topics/{tid}/ignore should be defined in schema docs"},{"id":"2514","name":"PUT /api/v3/topics/{tid}/tags should be defined in schema docs"},{"id":"2515","name":"DELETE /api/v3/topics/{tid}/tags should be defined in schema docs"},{"id":"2516","name":"GET /api/v3/topics/{tid}/thumbs should be defined in schema docs"},{"id":"2517","name":"POST /api/v3/topics/{tid}/thumbs should be defined in schema docs"},{"id":"2518","name":"PUT /api/v3/topics/{tid}/thumbs should be defined in schema docs"},{"id":"2519","name":"DELETE /api/v3/topics/{tid}/thumbs should be defined in schema docs"},{"id":"2520","name":"PUT /api/v3/topics/{tid}/thumbs/order should be defined in schema docs"},{"id":"2521","name":"GET /api/v3/topics/{tid}/events should be defined in schema docs"},{"id":"2522","name":"DELETE /api/v3/topics/{tid}/events/{eventId} should be defined in schema docs"},{"id":"2523","name":"GET /api/v3/posts/{pid} should be defined in schema docs"},{"id":"2524","name":"PUT /api/v3/posts/{pid} should be defined in schema docs"},{"id":"2525","name":"DELETE /api/v3/posts/{pid} should be defined in schema docs"},{"id":"2526","name":"PUT /api/v3/posts/{pid}/state should be defined in schema docs"},{"id":"2527","name":"DELETE /api/v3/posts/{pid}/state should be defined in schema docs"},{"id":"2528","name":"PUT /api/v3/posts/{pid}/move should be defined in schema docs"},{"id":"2529","name":"PUT /api/v3/posts/{pid}/vote should be defined in schema docs"},{"id":"2530","name":"DELETE /api/v3/posts/{pid}/vote should be defined in schema docs"},{"id":"2531","name":"PUT /api/v3/posts/{pid}/bookmark should be defined in schema docs"},{"id":"2532","name":"DELETE /api/v3/posts/{pid}/bookmark should be defined in schema docs"},{"id":"2533","name":"PUT /api/v3/posts/{pid}/endorse should be defined in schema docs"},{"id":"2534","name":"DELETE /api/v3/posts/{pid}/endorse should be defined in schema docs"},{"id":"2535","name":"GET /api/v3/posts/{pid}/diffs should be defined in schema docs"},{"id":"2536","name":"GET /api/v3/posts/{pid}/diffs/{since} should be defined in schema docs"},{"id":"2537","name":"PUT /api/v3/posts/{pid}/diffs/{since} should be defined in schema docs"},{"id":"2538","name":"DELETE /api/v3/posts/{pid}/diffs/{timestamp} should be defined in schema docs"},{"id":"2539","name":"GET /api/v3/chats/ should be defined in schema docs"},{"id":"2540","name":"POST /api/v3/chats/ should be defined in schema docs"},{"id":"2541","name":"HEAD /api/v3/chats/{roomId} should be defined in schema docs"},{"id":"2542","name":"GET /api/v3/chats/{roomId} should be defined in schema docs"},{"id":"2543","name":"POST /api/v3/chats/{roomId} should be defined in schema docs"},{"id":"2544","name":"PUT /api/v3/chats/{roomId} should be defined in schema docs"},{"id":"2545","name":"GET /api/v3/chats/{roomId}/users should be defined in schema docs"},{"id":"2546","name":"POST /api/v3/chats/{roomId}/users should be defined in schema docs"},{"id":"2547","name":"DELETE /api/v3/chats/{roomId}/users should be defined in schema docs"},{"id":"2548","name":"DELETE /api/v3/chats/{roomId}/users/{uid} should be defined in schema docs"},{"id":"2549","name":"GET /api/v3/chats/{roomId}/messages should be defined in schema docs"},{"id":"2550","name":"GET /api/v3/chats/{roomId}/messages/{mid} should be defined in schema docs"},{"id":"2551","name":"PUT /api/v3/chats/{roomId}/messages/{mid} should be defined in schema docs"},{"id":"2552","name":"POST /api/v3/chats/{roomId}/messages/{mid} should be defined in schema docs"},{"id":"2553","name":"DELETE /api/v3/chats/{roomId}/messages/{mid} should be defined in schema docs"},{"id":"2554","name":"POST /api/v3/flags/ should be defined in schema docs"},{"id":"2555","name":"GET /api/v3/flags/{flagId} should be defined in schema docs"},{"id":"2556","name":"PUT /api/v3/flags/{flagId} should be defined in schema docs"},{"id":"2557","name":"DELETE /api/v3/flags/{flagId} should be defined in schema docs"},{"id":"2558","name":"POST /api/v3/flags/{flagId}/notes should be defined in schema docs"},{"id":"2559","name":"DELETE /api/v3/flags/{flagId}/notes/{datetime} should be defined in schema docs"},{"id":"2560","name":"PUT /api/v3/admin/settings/{setting} should be defined in schema docs"},{"id":"2561","name":"GET /api/v3/admin/analytics should be defined in schema docs"},{"id":"2562","name":"GET /api/v3/admin/analytics/{set} should be defined in schema docs"},{"id":"2563","name":"DELETE /api/v3/files/ should be defined in schema docs"},{"id":"2564","name":"PUT /api/v3/files/folder should be defined in schema docs"},{"id":"2565","name":"POST /api/v3/utilities/login should be defined in schema docs"},{"id":"2566","name":"GET /api/v3/ping should be defined in schema docs"},{"id":"2567","name":"POST /api/v3/ping should be defined in schema docs"},{"id":"2568","name":"GET /api/config should be defined in schema docs"},{"id":"2569","name":"GET /api/self should be defined in schema docs"},{"id":"2570","name":"GET /api/user/uid/{uid} should be defined in schema docs"},{"id":"2571","name":"GET /api/user/username/{username} should be defined in schema docs"},{"id":"2572","name":"GET /api/user/email/{email} should be defined in schema docs"},{"id":"2573","name":"GET /api/user/{userslug}/export/posts should be defined in schema docs"},{"id":"2574","name":"GET /api/user/{userslug}/export/uploads should be defined in schema docs"},{"id":"2575","name":"GET /api/user/{userslug}/export/profile should be defined in schema docs"},{"id":"2576","name":"GET /api/user/uid/{userslug}/export/{type} should be defined in schema docs"},{"id":"2577","name":"GET /api/categories/{cid}/moderators should be defined in schema docs"},{"id":"2578","name":"GET /api/recent/posts/{term?} should be defined in schema docs"},{"id":"2579","name":"GET /api/unread/total should be defined in schema docs"},{"id":"2580","name":"GET /api/topic/teaser/{topic_id} should be defined in schema docs"},{"id":"2581","name":"GET /api/topic/pagination/{topic_id} should be defined in schema docs"},{"id":"2582","name":"POST /api/post/upload should be defined in schema docs"},{"id":"2583","name":"POST /api/user/{userslug}/uploadpicture should be defined in schema docs"},{"id":"2584","name":"GET /api/login should be defined in schema docs"},{"id":"2585","name":"GET /api/register should be defined in schema docs"},{"id":"2586","name":"GET /api/register/complete should be defined in schema docs"},{"id":"2587","name":"GET /api/confirm/{code} should be defined in schema docs"},{"id":"2588","name":"GET /api/outgoing should be defined in schema docs"},{"id":"2589","name":"GET /api/search should be defined in schema docs"},{"id":"2590","name":"GET /api/reset/{code?} should be defined in schema docs"},{"id":"2591","name":"GET /api/tos should be defined in schema docs"},{"id":"2592","name":"GET /api/email/unsubscribe/{token} should be defined in schema docs"},{"id":"2593","name":"GET /api/flags should be defined in schema docs"},{"id":"2594","name":"GET /api/flags/{flagId} should be defined in schema docs"},{"id":"2595","name":"GET /api/post-queue/{id?} should be defined in schema docs"},{"id":"2596","name":"GET /api/ip-blacklist should be defined in schema docs"},{"id":"2597","name":"GET /api/registration-queue should be defined in schema docs"},{"id":"2598","name":"GET /api/admin should be defined in schema docs"},{"id":"2599","name":"GET /api/admin/dashboard should be defined in schema docs"},{"id":"2600","name":"GET /api/admin/dashboard/logins should be defined in schema docs"},{"id":"2601","name":"GET /api/admin/dashboard/users should be defined in schema docs"},{"id":"2602","name":"GET /api/admin/dashboard/topics should be defined in schema docs"},{"id":"2603","name":"GET /api/admin/dashboard/searches should be defined in schema docs"},{"id":"2604","name":"GET /api/admin/manage/categories should be defined in schema docs"},{"id":"2605","name":"GET /api/admin/manage/categories/{category_id} should be defined in schema docs"},{"id":"2606","name":"GET /api/admin/manage/categories/{category_id}/analytics should be defined in schema docs"},{"id":"2607","name":"GET /api/admin/manage/privileges/{cid?} should be defined in schema docs"},{"id":"2608","name":"GET /api/admin/manage/tags should be defined in schema docs"},{"id":"2609","name":"GET /api/admin/manage/users should be defined in schema docs"},{"id":"2610","name":"GET /api/admin/manage/registration should be defined in schema docs"},{"id":"2611","name":"GET /api/admin/manage/admins-mods should be defined in schema docs"},{"id":"2612","name":"GET /api/admin/manage/groups should be defined in schema docs"},{"id":"2613","name":"GET /api/admin/manage/groups/{name} should be defined in schema docs"},{"id":"2614","name":"GET /api/admin/manage/uploads should be defined in schema docs"},{"id":"2615","name":"GET /api/admin/manage/digest should be defined in schema docs"},{"id":"2616","name":"GET /api/admin/settings/email should be defined in schema docs"},{"id":"2617","name":"GET /api/admin/settings/user should be defined in schema docs"},{"id":"2618","name":"GET /api/admin/settings/post should be defined in schema docs"},{"id":"2619","name":"GET /api/admin/settings/advanced should be defined in schema docs"},{"id":"2620","name":"GET /api/admin/settings/languages should be defined in schema docs"},{"id":"2621","name":"GET /api/admin/settings/navigation should be defined in schema docs"},{"id":"2622","name":"GET /api/admin/settings/homepage should be defined in schema docs"},{"id":"2623","name":"GET /api/admin/settings/social should be defined in schema docs"},{"id":"2624","name":"GET /api/admin/settings/{term?} should be defined in schema docs"},{"id":"2625","name":"GET /api/admin/appearance/{term?} should be defined in schema docs"},{"id":"2626","name":"GET /api/admin/extend/plugins should be defined in schema docs"},{"id":"2627","name":"GET /api/admin/extend/widgets should be defined in schema docs"},{"id":"2628","name":"GET /api/admin/extend/rewards should be defined in schema docs"},{"id":"2629","name":"GET /api/admin/advanced/database should be defined in schema docs"},{"id":"2630","name":"GET /api/admin/advanced/events should be defined in schema docs"},{"id":"2631","name":"GET /api/admin/advanced/hooks should be defined in schema docs"},{"id":"2632","name":"GET /api/admin/advanced/logs should be defined in schema docs"},{"id":"2633","name":"GET /api/admin/advanced/errors should be defined in schema docs"},{"id":"2634","name":"GET /api/admin/advanced/errors/export should be defined in schema docs"},{"id":"2635","name":"GET /api/admin/advanced/cache should be defined in schema docs"},{"id":"2636","name":"GET /api/admin/development/logger should be defined in schema docs"},{"id":"2637","name":"GET /api/admin/development/info should be defined in schema docs"},{"id":"2638","name":"GET /api/admin/users/csv should be defined in schema docs"},{"id":"2639","name":"GET /api/admin/groups/{groupname}/csv should be defined in schema docs"},{"id":"2640","name":"GET /api/admin/analytics should be defined in schema docs"},{"id":"2641","name":"GET /api/admin/advanced/cache/dump should be defined in schema docs"},{"id":"2642","name":"POST /api/admin/category/uploadpicture should be defined in schema docs"},{"id":"2643","name":"POST /api/admin/uploadfavicon should be defined in schema docs"},{"id":"2644","name":"POST /api/admin/uploadTouchIcon should be defined in schema docs"},{"id":"2645","name":"POST /api/admin/uploadMaskableIcon should be defined in schema docs"},{"id":"2646","name":"POST /api/admin/uploadlogo should be defined in schema docs"},{"id":"2647","name":"POST /api/admin/uploadOgImage should be defined in schema docs"},{"id":"2648","name":"POST /api/admin/upload/file should be defined in schema docs"},{"id":"2649","name":"POST /api/admin/uploadDefaultAvatar should be defined in schema docs"},{"id":"2650","name":"GET /api/categories should be defined in schema docs"},{"id":"2651","name":"GET /api/popular should be defined in schema docs"},{"id":"2652","name":"GET /api/recent should be defined in schema docs"},{"id":"2653","name":"GET /api/top should be defined in schema docs"},{"id":"2654","name":"GET /api/unread should be defined in schema docs"},{"id":"2655","name":"GET /api/category/{category_id}/{slug}/{topic_index} should be defined in schema docs"},{"id":"2656","name":"GET /api/category/{category_id}/{slug?} should be defined in schema docs"},{"id":"2657","name":"GET /api/topic/{topic_id}/{slug}/{post_index?} should be defined in schema docs"},{"id":"2658","name":"GET /api/topic/{topic_id}/{slug?} should be defined in schema docs"},{"id":"2659","name":"GET /api/post/{pid} should be defined in schema docs"},{"id":"2660","name":"GET /api/users should be defined in schema docs"},{"id":"2661","name":"GET /api/me should be defined in schema docs"},{"id":"2662","name":"GET /api/me/* should be defined in schema docs"},{"id":"2663","name":"GET /api/uid/{uid*} should be defined in schema docs"},{"id":"2664","name":"GET /api/user/{userslug} should be defined in schema docs"},{"id":"2665","name":"GET /api/user/{userslug}/following should be defined in schema docs"},{"id":"2666","name":"GET /api/user/{userslug}/followers should be defined in schema docs"},{"id":"2667","name":"GET /api/user/{userslug}/posts should be defined in schema docs"},{"id":"2668","name":"GET /api/user/{userslug}/topics should be defined in schema docs"},{"id":"2669","name":"GET /api/user/{userslug}/best should be defined in schema docs"},{"id":"2670","name":"GET /api/user/{userslug}/controversial should be defined in schema docs"},{"id":"2671","name":"GET /api/user/{userslug}/groups should be defined in schema docs"},{"id":"2672","name":"GET /api/user/{userslug}/categories should be defined in schema docs"},{"id":"2673","name":"GET /api/user/{userslug}/bookmarks should be defined in schema docs"},{"id":"2674","name":"GET /api/user/{userslug}/watched should be defined in schema docs"},{"id":"2675","name":"GET /api/user/{userslug}/ignored should be defined in schema docs"},{"id":"2676","name":"GET /api/user/{userslug}/upvoted should be defined in schema docs"},{"id":"2677","name":"GET /api/user/{userslug}/downvoted should be defined in schema docs"},{"id":"2678","name":"GET /api/user/{userslug}/edit should be defined in schema docs"},{"id":"2679","name":"GET /api/user/{userslug}/edit/username should be defined in schema docs"},{"id":"2680","name":"GET /api/user/{userslug}/edit/email should be defined in schema docs"},{"id":"2681","name":"GET /api/user/{userslug}/edit/password should be defined in schema docs"},{"id":"2682","name":"GET /api/user/{userslug}/info should be defined in schema docs"},{"id":"2683","name":"GET /api/user/{userslug}/settings should be defined in schema docs"},{"id":"2684","name":"GET /api/user/{userslug}/uploads should be defined in schema docs"},{"id":"2685","name":"GET /api/user/{userslug}/consent should be defined in schema docs"},{"id":"2686","name":"GET /api/user/{userslug}/blocks should be defined in schema docs"},{"id":"2687","name":"GET /api/user/{userslug}/sessions should be defined in schema docs"},{"id":"2688","name":"GET /api/notifications should be defined in schema docs"},{"id":"2689","name":"GET /api/user/{userslug}/chats/{roomid?} should be defined in schema docs"},{"id":"2690","name":"GET /api/chats/{roomid?} should be defined in schema docs"},{"id":"2691","name":"GET /api/groups should be defined in schema docs"},{"id":"2692","name":"GET /api/groups/{slug} should be defined in schema docs"},{"id":"2693","name":"GET /api/groups/{slug}/members should be defined in schema docs"},{"id":"2694","name":"GET /api/tags/{tag} should be defined in schema docs"},{"id":"2695","name":"GET /api/tags should be defined in schema docs"},{"id":"2696","name":"GET /api/career should be defined in schema docs"},{"id":"2697","name":"source language file structure should only contain valid JSON files"},{"id":"2698","name":"\"ar\" file structure translations should contain every language file contained in the source language directory"},{"id":"2699","name":"\"ar\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2700","name":"\"ar\" file contents should contain only valid JSON files"},{"id":"2701","name":"\"ar\" file contents should contain every translation key contained in its source counterpart"},{"id":"2702","name":"\"bg\" file structure translations should contain every language file contained in the source language directory"},{"id":"2703","name":"\"bg\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2704","name":"\"bg\" file contents should contain only valid JSON files"},{"id":"2705","name":"\"bg\" file contents should contain every translation key contained in its source counterpart"},{"id":"2706","name":"\"bn\" file structure translations should contain every language file contained in the source language directory"},{"id":"2707","name":"\"bn\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2708","name":"\"bn\" file contents should contain only valid JSON files"},{"id":"2709","name":"\"bn\" file contents should contain every translation key contained in its source counterpart"},{"id":"2710","name":"\"cs\" file structure translations should contain every language file contained in the source language directory"},{"id":"2711","name":"\"cs\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2712","name":"\"cs\" file contents should contain only valid JSON files"},{"id":"2713","name":"\"cs\" file contents should contain every translation key contained in its source counterpart"},{"id":"2714","name":"\"da\" file structure translations should contain every language file contained in the source language directory"},{"id":"2715","name":"\"da\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2716","name":"\"da\" file contents should contain only valid JSON files"},{"id":"2717","name":"\"da\" file contents should contain every translation key contained in its source counterpart"},{"id":"2718","name":"\"de\" file structure translations should contain every language file contained in the source language directory"},{"id":"2719","name":"\"de\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2720","name":"\"de\" file contents should contain only valid JSON files"},{"id":"2721","name":"\"de\" file contents should contain every translation key contained in its source counterpart"},{"id":"2722","name":"\"el\" file structure translations should contain every language file contained in the source language directory"},{"id":"2723","name":"\"el\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2724","name":"\"el\" file contents should contain only valid JSON files"},{"id":"2725","name":"\"el\" file contents should contain every translation key contained in its source counterpart"},{"id":"2726","name":"\"en-GB\" file structure translations should contain every language file contained in the source language directory"},{"id":"2727","name":"\"en-GB\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2728","name":"\"en-GB\" file contents should contain only valid JSON files"},{"id":"2729","name":"\"en-GB\" file contents should contain every translation key contained in its source counterpart"},{"id":"2730","name":"\"en-US\" file structure translations should contain every language file contained in the source language directory"},{"id":"2731","name":"\"en-US\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2732","name":"\"en-US\" file contents should contain only valid JSON files"},{"id":"2733","name":"\"en-US\" file contents should contain every translation key contained in its source counterpart"},{"id":"2734","name":"\"en-x-pirate\" file structure translations should contain every language file contained in the source language directory"},{"id":"2735","name":"\"en-x-pirate\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2736","name":"\"en-x-pirate\" file contents should contain only valid JSON files"},{"id":"2737","name":"\"en-x-pirate\" file contents should contain every translation key contained in its source counterpart"},{"id":"2738","name":"\"es\" file structure translations should contain every language file contained in the source language directory"},{"id":"2739","name":"\"es\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2740","name":"\"es\" file contents should contain only valid JSON files"},{"id":"2741","name":"\"es\" file contents should contain every translation key contained in its source counterpart"},{"id":"2742","name":"\"et\" file structure translations should contain every language file contained in the source language directory"},{"id":"2743","name":"\"et\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2744","name":"\"et\" file contents should contain only valid JSON files"},{"id":"2745","name":"\"et\" file contents should contain every translation key contained in its source counterpart"},{"id":"2746","name":"\"fa-IR\" file structure translations should contain every language file contained in the source language directory"},{"id":"2747","name":"\"fa-IR\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2748","name":"\"fa-IR\" file contents should contain only valid JSON files"},{"id":"2749","name":"\"fa-IR\" file contents should contain every translation key contained in its source counterpart"},{"id":"2750","name":"\"fi\" file structure translations should contain every language file contained in the source language directory"},{"id":"2751","name":"\"fi\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2752","name":"\"fi\" file contents should contain only valid JSON files"},{"id":"2753","name":"\"fi\" file contents should contain every translation key contained in its source counterpart"},{"id":"2754","name":"\"fr\" file structure translations should contain every language file contained in the source language directory"},{"id":"2755","name":"\"fr\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2756","name":"\"fr\" file contents should contain only valid JSON files"},{"id":"2757","name":"\"fr\" file contents should contain every translation key contained in its source counterpart"},{"id":"2758","name":"\"gl\" file structure translations should contain every language file contained in the source language directory"},{"id":"2759","name":"\"gl\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2760","name":"\"gl\" file contents should contain only valid JSON files"},{"id":"2761","name":"\"gl\" file contents should contain every translation key contained in its source counterpart"},{"id":"2762","name":"\"he\" file structure translations should contain every language file contained in the source language directory"},{"id":"2763","name":"\"he\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2764","name":"\"he\" file contents should contain only valid JSON files"},{"id":"2765","name":"\"he\" file contents should contain every translation key contained in its source counterpart"},{"id":"2766","name":"\"hr\" file structure translations should contain every language file contained in the source language directory"},{"id":"2767","name":"\"hr\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2768","name":"\"hr\" file contents should contain only valid JSON files"},{"id":"2769","name":"\"hr\" file contents should contain every translation key contained in its source counterpart"},{"id":"2770","name":"\"hu\" file structure translations should contain every language file contained in the source language directory"},{"id":"2771","name":"\"hu\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2772","name":"\"hu\" file contents should contain only valid JSON files"},{"id":"2773","name":"\"hu\" file contents should contain every translation key contained in its source counterpart"},{"id":"2774","name":"\"hy\" file structure translations should contain every language file contained in the source language directory"},{"id":"2775","name":"\"hy\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2776","name":"\"hy\" file contents should contain only valid JSON files"},{"id":"2777","name":"\"hy\" file contents should contain every translation key contained in its source counterpart"},{"id":"2778","name":"\"id\" file structure translations should contain every language file contained in the source language directory"},{"id":"2779","name":"\"id\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2780","name":"\"id\" file contents should contain only valid JSON files"},{"id":"2781","name":"\"id\" file contents should contain every translation key contained in its source counterpart"},{"id":"2782","name":"\"it\" file structure translations should contain every language file contained in the source language directory"},{"id":"2783","name":"\"it\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2784","name":"\"it\" file contents should contain only valid JSON files"},{"id":"2785","name":"\"it\" file contents should contain every translation key contained in its source counterpart"},{"id":"2786","name":"\"ja\" file structure translations should contain every language file contained in the source language directory"},{"id":"2787","name":"\"ja\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2788","name":"\"ja\" file contents should contain only valid JSON files"},{"id":"2789","name":"\"ja\" file contents should contain every translation key contained in its source counterpart"},{"id":"2790","name":"\"ko\" file structure translations should contain every language file contained in the source language directory"},{"id":"2791","name":"\"ko\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2792","name":"\"ko\" file contents should contain only valid JSON files"},{"id":"2793","name":"\"ko\" file contents should contain every translation key contained in its source counterpart"},{"id":"2794","name":"\"lt\" file structure translations should contain every language file contained in the source language directory"},{"id":"2795","name":"\"lt\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2796","name":"\"lt\" file contents should contain only valid JSON files"},{"id":"2797","name":"\"lt\" file contents should contain every translation key contained in its source counterpart"},{"id":"2798","name":"\"lv\" file structure translations should contain every language file contained in the source language directory"},{"id":"2799","name":"\"lv\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2800","name":"\"lv\" file contents should contain only valid JSON files"},{"id":"2801","name":"\"lv\" file contents should contain every translation key contained in its source counterpart"},{"id":"2802","name":"\"ms\" file structure translations should contain every language file contained in the source language directory"},{"id":"2803","name":"\"ms\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2804","name":"\"ms\" file contents should contain only valid JSON files"},{"id":"2805","name":"\"ms\" file contents should contain every translation key contained in its source counterpart"},{"id":"2806","name":"\"nb\" file structure translations should contain every language file contained in the source language directory"},{"id":"2807","name":"\"nb\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2808","name":"\"nb\" file contents should contain only valid JSON files"},{"id":"2809","name":"\"nb\" file contents should contain every translation key contained in its source counterpart"},{"id":"2810","name":"\"nl\" file structure translations should contain every language file contained in the source language directory"},{"id":"2811","name":"\"nl\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2812","name":"\"nl\" file contents should contain only valid JSON files"},{"id":"2813","name":"\"nl\" file contents should contain every translation key contained in its source counterpart"},{"id":"2814","name":"\"pl\" file structure translations should contain every language file contained in the source language directory"},{"id":"2815","name":"\"pl\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2816","name":"\"pl\" file contents should contain only valid JSON files"},{"id":"2817","name":"\"pl\" file contents should contain every translation key contained in its source counterpart"},{"id":"2818","name":"\"pt-BR\" file structure translations should contain every language file contained in the source language directory"},{"id":"2819","name":"\"pt-BR\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2820","name":"\"pt-BR\" file contents should contain only valid JSON files"},{"id":"2821","name":"\"pt-BR\" file contents should contain every translation key contained in its source counterpart"},{"id":"2822","name":"\"pt-PT\" file structure translations should contain every language file contained in the source language directory"},{"id":"2823","name":"\"pt-PT\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2824","name":"\"pt-PT\" file contents should contain only valid JSON files"},{"id":"2825","name":"\"pt-PT\" file contents should contain every translation key contained in its source counterpart"},{"id":"2826","name":"\"ro\" file structure translations should contain every language file contained in the source language directory"},{"id":"2827","name":"\"ro\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2828","name":"\"ro\" file contents should contain only valid JSON files"},{"id":"2829","name":"\"ro\" file contents should contain every translation key contained in its source counterpart"},{"id":"2830","name":"\"ru\" file structure translations should contain every language file contained in the source language directory"},{"id":"2831","name":"\"ru\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2832","name":"\"ru\" file contents should contain only valid JSON files"},{"id":"2833","name":"\"ru\" file contents should contain every translation key contained in its source counterpart"},{"id":"2834","name":"\"rw\" file structure translations should contain every language file contained in the source language directory"},{"id":"2835","name":"\"rw\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2836","name":"\"rw\" file contents should contain only valid JSON files"},{"id":"2837","name":"\"rw\" file contents should contain every translation key contained in its source counterpart"},{"id":"2838","name":"\"sc\" file structure translations should contain every language file contained in the source language directory"},{"id":"2839","name":"\"sc\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2840","name":"\"sc\" file contents should contain only valid JSON files"},{"id":"2841","name":"\"sc\" file contents should contain every translation key contained in its source counterpart"},{"id":"2842","name":"\"sk\" file structure translations should contain every language file contained in the source language directory"},{"id":"2843","name":"\"sk\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2844","name":"\"sk\" file contents should contain only valid JSON files"},{"id":"2845","name":"\"sk\" file contents should contain every translation key contained in its source counterpart"},{"id":"2846","name":"\"sl\" file structure translations should contain every language file contained in the source language directory"},{"id":"2847","name":"\"sl\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2848","name":"\"sl\" file contents should contain only valid JSON files"},{"id":"2849","name":"\"sl\" file contents should contain every translation key contained in its source counterpart"},{"id":"2850","name":"\"sq-AL\" file structure translations should contain every language file contained in the source language directory"},{"id":"2851","name":"\"sq-AL\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2852","name":"\"sq-AL\" file contents should contain only valid JSON files"},{"id":"2853","name":"\"sq-AL\" file contents should contain every translation key contained in its source counterpart"},{"id":"2854","name":"\"sr\" file structure translations should contain every language file contained in the source language directory"},{"id":"2855","name":"\"sr\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2856","name":"\"sr\" file contents should contain only valid JSON files"},{"id":"2857","name":"\"sr\" file contents should contain every translation key contained in its source counterpart"},{"id":"2858","name":"\"sv\" file structure translations should contain every language file contained in the source language directory"},{"id":"2859","name":"\"sv\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2860","name":"\"sv\" file contents should contain only valid JSON files"},{"id":"2861","name":"\"sv\" file contents should contain every translation key contained in its source counterpart"},{"id":"2862","name":"\"th\" file structure translations should contain every language file contained in the source language directory"},{"id":"2863","name":"\"th\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2864","name":"\"th\" file contents should contain only valid JSON files"},{"id":"2865","name":"\"th\" file contents should contain every translation key contained in its source counterpart"},{"id":"2866","name":"\"tr\" file structure translations should contain every language file contained in the source language directory"},{"id":"2867","name":"\"tr\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2868","name":"\"tr\" file contents should contain only valid JSON files"},{"id":"2869","name":"\"tr\" file contents should contain every translation key contained in its source counterpart"},{"id":"2870","name":"\"uk\" file structure translations should contain every language file contained in the source language directory"},{"id":"2871","name":"\"uk\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2872","name":"\"uk\" file contents should contain only valid JSON files"},{"id":"2873","name":"\"uk\" file contents should contain every translation key contained in its source counterpart"},{"id":"2874","name":"\"vi\" file structure translations should contain every language file contained in the source language directory"},{"id":"2875","name":"\"vi\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2876","name":"\"vi\" file contents should contain only valid JSON files"},{"id":"2877","name":"\"vi\" file contents should contain every translation key contained in its source counterpart"},{"id":"2878","name":"\"zh-CN\" file structure translations should contain every language file contained in the source language directory"},{"id":"2879","name":"\"zh-CN\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2880","name":"\"zh-CN\" file contents should contain only valid JSON files"},{"id":"2881","name":"\"zh-CN\" file contents should contain every translation key contained in its source counterpart"},{"id":"2882","name":"\"zh-TW\" file structure translations should contain every language file contained in the source language directory"},{"id":"2883","name":"\"zh-TW\" file structure should not contain any extraneous files not included in the source language directory"},{"id":"2884","name":"\"zh-TW\" file contents should contain only valid JSON files"},{"id":"2885","name":"\"zh-TW\" file contents should contain every translation key contained in its source counterpart"},{"id":"2886","name":"upload methods .sync() should properly add new images to the post's zset"},{"id":"2887","name":"upload methods .sync() should remove an image if it is edited out of the post"},{"id":"2888","name":"upload methods .list() should display the uploaded files for a specific post"},{"id":"2889","name":"upload methods .isOrphan() should return false if upload is not an orphan"},{"id":"2890","name":"upload methods .isOrphan() should return true if upload is an orphan"},{"id":"2891","name":"upload methods .associate() should add an image to the post's maintained list of uploads"},{"id":"2892","name":"upload methods .associate() should allow arrays to be passed in"},{"id":"2893","name":"upload methods .associate() should save a reverse association of md5sum to pid"},{"id":"2894","name":"upload methods .associate() should not associate a file that does not exist on the local disk"},{"id":"2895","name":"upload methods .dissociate() should remove an image from the post's maintained list of uploads"},{"id":"2896","name":"upload methods .dissociate() should allow arrays to be passed in"},{"id":"2897","name":"upload methods .dissociate() should remove the image's user association, if present"},{"id":"2898","name":"upload methods .dissociateAll() should remove all images from a post's maintained list of uploads"},{"id":"2899","name":"upload methods Dissociation on purge should not dissociate images on post deletion"},{"id":"2900","name":"upload methods Dissociation on purge should dissociate images on post purge"},{"id":"2901","name":"upload methods Deletion from disk on purge should purge the images from disk if the post is purged"},{"id":"2902","name":"upload methods Deletion from disk on purge should leave the images behind if `preserveOrphanedUploads` is enabled"},{"id":"2903","name":"upload methods Deletion from disk on purge should leave images behind if they are used in another post"},{"id":"2904","name":"upload methods .deleteFromDisk() should work if you pass in a string path"},{"id":"2905","name":"upload methods .deleteFromDisk() should throw an error if a non-string or non-array is passed"},{"id":"2906","name":"upload methods .deleteFromDisk() should delete the files passed in, from disk"},{"id":"2907","name":"upload methods .deleteFromDisk() should not delete files if they are not in `uploads/files/` (path traversal)"},{"id":"2908","name":"upload methods .deleteFromDisk() should delete files even if they are not orphans"},{"id":"2909","name":"post uploads management should automatically sync uploads on topic create and reply"},{"id":"2910","name":"post uploads management should automatically sync uploads on post edit"},{"id":"2911","name":"Topic Events .init() should allow a plugin to expose new event types"},{"id":"2912","name":"Topic Events .log() should log and return a set of new events in the topic"},{"id":"2913","name":"Topic Events .get() should get a topic's events"},{"id":"2914","name":"Topic Events .purge() should purge topic's events from the database"},{"id":"2915","name":"Topic thumbs should return bool for whether a thumb exists"},{"id":"2916","name":"Topic thumbs .get() should return an array of thumbs"},{"id":"2917","name":"Topic thumbs .get() should return an array of an array of thumbs if multiple tids are passed in"},{"id":"2918","name":"Topic thumbs .associate() should add an uploaded file to a zset"},{"id":"2919","name":"Topic thumbs .associate() should also work with UUIDs"},{"id":"2920","name":"Topic thumbs .associate() should also work with a URL"},{"id":"2921","name":"Topic thumbs .associate() should have a score equal to the number of thumbs prior to addition"},{"id":"2922","name":"Topic thumbs .associate() should update the relevant topic hash with the number of thumbnails"},{"id":"2923","name":"Topic thumbs .associate() should successfully associate a thumb with a topic even if it already contains that thumbnail (updates score)"},{"id":"2924","name":"Topic thumbs .associate() should update the score to be passed in as the third argument"},{"id":"2925","name":"Topic thumbs .associate() should associate the thumbnail with that topic's main pid's uploads"},{"id":"2926","name":"Topic thumbs .associate() should maintain state in the topic's main pid's uploads if posts.uploads.sync() is called"},{"id":"2927","name":"Topic thumbs .associate() should combine the thumbs uploaded to a UUID zset and combine it with a topic's thumb zset"},{"id":"2928","name":"Topic thumbs .delete() should remove a file from sorted set"},{"id":"2929","name":"Topic thumbs .delete() should no longer be associated with that topic's main pid's uploads"},{"id":"2930","name":"Topic thumbs .delete() should also work with UUIDs"},{"id":"2931","name":"Topic thumbs .delete() should also work with URLs"},{"id":"2932","name":"Topic thumbs .delete() should not delete the file from disk if not associated with the tid"},{"id":"2933","name":"Topic thumbs .delete() should handle an array of relative paths"},{"id":"2934","name":"Topic thumbs .delete() should have no more thumbs left"},{"id":"2935","name":"Topic thumbs .delete() should decrement numThumbs if dissociated one by one"},{"id":"2936","name":"Topic thumbs .deleteAll() should have thumbs prior to tests"},{"id":"2937","name":"Topic thumbs .deleteAll() should not error out"},{"id":"2938","name":"Topic thumbs .deleteAll() should remove all associated thumbs with that topic"},{"id":"2939","name":"Topic thumbs .deleteAll() should no longer have a :thumbs zset"},{"id":"2940","name":"Topic thumbs HTTP calls to topic thumb routes should succeed with a valid tid"},{"id":"2941","name":"Topic thumbs HTTP calls to topic thumb routes should succeed with a uuid"},{"id":"2942","name":"Topic thumbs HTTP calls to topic thumb routes should succeed with uploader plugins"},{"id":"2943","name":"Topic thumbs HTTP calls to topic thumb routes should fail with a non-existant tid"},{"id":"2944","name":"Topic thumbs HTTP calls to topic thumb routes should fail when garbage is passed in"},{"id":"2945","name":"Topic thumbs HTTP calls to topic thumb routes should fail when calling user cannot edit the tid"},{"id":"2946","name":"Topic thumbs HTTP calls to topic thumb routes should fail if thumbnails are not enabled"},{"id":"2947","name":"Topic thumbs HTTP calls to topic thumb routes should fail if file is not image"},{"id":"2948","name":"Topic thumbs behaviour on topic purge should no longer have a :thumbs zset"},{"id":"2949","name":"Topic thumbs behaviour on topic purge should not leave post upload associations behind"},{"id":"2950","name":"email confirmation (library methods) isValidationPending should return false if user did not request email validation"},{"id":"2951","name":"email confirmation (library methods) isValidationPending should return false if user did not request email validation (w/ email checking)"},{"id":"2952","name":"email confirmation (library methods) isValidationPending should return true if user requested email validation"},{"id":"2953","name":"email confirmation (library methods) isValidationPending should return true if user requested email validation (w/ email checking)"},{"id":"2954","name":"email confirmation (library methods) getValidationExpiry should return null if there is no validation available"},{"id":"2955","name":"email confirmation (library methods) getValidationExpiry should return a number smaller than configured expiry if validation available"},{"id":"2956","name":"email confirmation (library methods) expireValidation should invalidate any confirmation in-progress"},{"id":"2957","name":"email confirmation (library methods) canSendValidation should return true if no validation is pending"},{"id":"2958","name":"email confirmation (library methods) canSendValidation should return false if it has been too soon to re-send confirmation"},{"id":"2959","name":"email confirmation (library methods) canSendValidation should return true if it has been long enough to re-send confirmation"},{"id":"2960","name":"email confirmation (v3 api) should have a pending validation"},{"id":"2961","name":"email confirmation (v3 api) should not list their email"},{"id":"2962","name":"email confirmation (v3 api) should not allow confirmation if they are not an admin"},{"id":"2963","name":"email confirmation (v3 api) should not confirm an email that is not pending or set"},{"id":"2964","name":"email confirmation (v3 api) should confirm their email (using the pending validation)"},{"id":"2965","name":"email confirmation (v3 api) should still confirm the email (as email is set in user hash)"},{"id":"2966","name":"uploads.js .associateUpload() should associate an uploaded file to a user"},{"id":"2967","name":"uploads.js .associateUpload() should throw an error if the path is invalid"},{"id":"2968","name":"uploads.js .associateUpload() should guard against path traversal"},{"id":"2969","name":"uploads.js .deleteUpload should remove the upload from the user's uploads zset"},{"id":"2970","name":"uploads.js .deleteUpload should delete the file from disk"},{"id":"2971","name":"uploads.js .deleteUpload should clean up references to it from the database"},{"id":"2972","name":"uploads.js .deleteUpload should accept multiple paths"},{"id":"2973","name":"uploads.js .deleteUpload should throw an error on a non-existant file"},{"id":"2974","name":"uploads.js .deleteUpload should guard against path traversal"},{"id":"2975","name":"uploads.js .deleteUpload should remove the post association as well, if present"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst { JSDOM } = require('jsdom');\nconst slugify = require('../src/slugify');\nconst db = require('./mocks/databasemock');\n\ndescribe('Utility Methods', () => {\n    // https://gist.github.com/robballou/9ee108758dc5e0e2d028\n    // create some jsdom magic to allow jQuery to work\n    const dom = new JSDOM('<"+"html><"+"body><"+"/body><"+"/html>');\n    global.window = dom.window;\n    global.document = dom.window.document;\n    global.jQuery = require('jquery');\n    global.$ = global.jQuery;\n    const { $ } = global;\n\n    const utils = require('../public/src/utils');\n\n    // https://github.com/jprichardson/string.js/blob/master/test/string.test.js\n    it('should decode HTML entities', (done) => {\n        assert.strictEqual(\n            utils.decodeHTMLEntities('Ken Thompson &amp; Dennis Ritchie'),\n            'Ken Thompson & Dennis Ritchie'\n        );\n        assert.strictEqual(\n            utils.decodeHTMLEntities('3 &lt; 4'),\n            '3 <"+" 4'\n        );\n        assert.strictEqual(\n            utils.decodeHTMLEntities('http:&#47;&#47;'),\n            'http://'\n        );\n        done();\n    });\n    it('should strip HTML tags', (done) => {\n        assert.strictEqual(utils.stripHTMLTags('<"+"p>just <"+"b>some<"+"/b> text<"+"/p>'), 'just some text');\n        assert.strictEqual(utils.stripHTMLTags('<"+"p>just <"+"b>some<"+"/b> text<"+"/p>', ['p']), 'just <"+"b>some<"+"/b> text');\n        assert.strictEqual(utils.stripHTMLTags('<"+"i>just<"+"/i> some <"+"image/> text', ['i']), 'just some <"+"image/> text');\n        assert.strictEqual(utils.stripHTMLTags('<"+"i>just<"+"/i> some <"+"image/> <"+"div>text<"+"/div>', ['i', 'div']), 'just some <"+"image/> text');\n        done();\n    });\n\n    it('should preserve case if requested', (done) => {\n        assert.strictEqual(slugify('UPPER CASE', true), 'UPPER-CASE');\n        done();\n    });\n\n    it('should work if a number is passed in', (done) => {\n        assert.strictEqual(slugify(12345), '12345');\n        done();\n    });\n\n    describe('username validation', () => {\n        it('accepts latin-1 characters', () => {\n            const username = \"John\\\"'-. Doeäâèéë1234\";\n            assert(utils.isUserNameValid(username), 'invalid username');\n        });\n\n        it('rejects empty string', () => {\n            const username = '';\n            assert.equal(utils.isUserNameValid(username), false, 'accepted as valid username');\n        });\n\n        it('should reject new lines', () => {\n            assert.equal(utils.isUserNameValid('myusername\\r\\n'), false);\n        });\n\n        it('should reject new lines', () => {\n            assert.equal(utils.isUserNameValid('myusername\\n'), false);\n        });\n\n        it('should reject tabs', () => {\n            assert.equal(utils.isUserNameValid('myusername\\t'), false);\n        });\n\n        it('accepts square brackets', () => {\n            const username = '[best clan] julian';\n            assert(utils.isUserNameValid(username), 'invalid username');\n        });\n\n        it('accepts regular username', () => {\n            assert(utils.isUserNameValid('myusername'), 'invalid username');\n        });\n\n        it('accepts quotes', () => {\n            assert(utils.isUserNameValid('baris \"the best\" usakli'), 'invalid username');\n        });\n    });\n\n    describe('email validation', () => {\n        it('accepts sample address', () => {\n            const email = 'sample@example.com';\n            assert(utils.isEmailValid(email), 'invalid email');\n        });\n        it('rejects empty address', () => {\n            const email = '';\n            assert.equal(utils.isEmailValid(email), false, 'accepted as valid email');\n        });\n    });\n\n    describe('UUID generation', () => {\n        it('return unique random value every time', () => {\n            delete require.cache[require.resolve('../src/utils')];\n            const { generateUUID } = require('../src/utils');\n            const uuid1 = generateUUID();\n            const uuid2 = generateUUID();\n            assert.notEqual(uuid1, uuid2, 'matches');\n        });\n    });\n\n    describe('cleanUpTag', () => {\n        it('should cleanUp a tag', (done) => {\n            const cleanedTag = utils.cleanUpTag(',/#!$^*;TaG1:{}=_`<"+">\\'\"~()?|');\n            assert.equal(cleanedTag, 'tag1');\n            done();\n        });\n\n        it('should return empty string for invalid tags', (done) => {\n            assert.strictEqual(utils.cleanUpTag(undefined), '');\n            assert.strictEqual(utils.cleanUpTag(null), '');\n            assert.strictEqual(utils.cleanUpTag(false), '');\n            assert.strictEqual(utils.cleanUpTag(1), '');\n            assert.strictEqual(utils.cleanUpTag(0), '');\n            done();\n        });\n    });\n\n    it('should remove punctuation', (done) => {\n        const removed = utils.removePunctuation('some text with , ! punctuation inside \"');\n        assert.equal(removed, 'some text with   punctuation inside ');\n        done();\n    });\n\n    it('should return true if string has language key', (done) => {\n        assert.equal(utils.hasLanguageKey('some text [[topic:title]] and [[user:reputaiton]]'), true);\n        done();\n    });\n\n    it('should return false if string does not have language key', (done) => {\n        assert.equal(utils.hasLanguageKey('some text with no language keys'), false);\n        done();\n    });\n\n    it('should shallow merge two objects', (done) => {\n        const a = { foo: 1, cat1: 'ginger' };\n        const b = { baz: 2, cat2: 'phoebe' };\n        const obj = utils.merge(a, b);\n        assert.strictEqual(obj.foo, 1);\n        assert.strictEqual(obj.baz, 2);\n        assert.strictEqual(obj.cat1, 'ginger');\n        assert.strictEqual(obj.cat2, 'phoebe');\n        done();\n    });\n\n    it('should return the file extesion', (done) => {\n        assert.equal(utils.fileExtension('/path/to/some/file.png'), 'png');\n        done();\n    });\n\n    it('should return file mime type', (done) => {\n        assert.equal(utils.fileMimeType('/path/to/some/file.png'), 'image/png');\n        done();\n    });\n\n    it('should check if url is relative', (done) => {\n        assert.equal(utils.isRelativeUrl('/topic/1/slug'), true);\n        done();\n    });\n\n    it('should check if url is relative', (done) => {\n        assert.equal(utils.isRelativeUrl('https://nodebb.org'), false);\n        done();\n    });\n\n    it('should make number human readable', (done) => {\n        assert.equal(utils.makeNumberHumanReadable('1000'), '1.0k');\n        done();\n    });\n\n    it('should make number human readable', (done) => {\n        assert.equal(utils.makeNumberHumanReadable('1100000'), '1.1m');\n        done();\n    });\n\n    it('should make number human readable', (done) => {\n        assert.equal(utils.makeNumberHumanReadable('100'), '100');\n        done();\n    });\n\n    it('should make number human readable', (done) => {\n        assert.equal(utils.makeNumberHumanReadable(null), null);\n        done();\n    });\n\n    it('should make numbers human readable on elements', (done) => {\n        const el = $('<"+"div title=\"100000\"><"+"/div>');\n        utils.makeNumbersHumanReadable(el);\n        assert.equal(el.html(), '100.0k');\n        done();\n    });\n\n    it('should add commas to numbers', (done) => {\n        assert.equal(utils.addCommas('100'), '100');\n        done();\n    });\n\n    it('should add commas to numbers', (done) => {\n        assert.equal(utils.addCommas('1000'), '1,000');\n        done();\n    });\n\n    it('should add commas to numbers', (done) => {\n        assert.equal(utils.addCommas('1000000'), '1,000,000');\n        done();\n    });\n\n    it('should add commas to elements', (done) => {\n        const el = $('<"+"div>1000000<"+"/div>');\n        utils.addCommasToNumbers(el);\n        assert.equal(el.html(), '1,000,000');\n        done();\n    });\n\n    it('should return passed in value if invalid', (done) => {\n        // eslint-disable-next-line no-loss-of-precision\n        const bigInt = -111111111111111111;\n        const result = utils.toISOString(bigInt);\n        assert.equal(bigInt, result);\n        done();\n    });\n\n    it('should return false if browser is not android', (done) => {\n        global.navigator = {\n            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.96 Safari/537.36',\n        };\n        assert.equal(utils.isAndroidBrowser(), false);\n        done();\n    });\n\n    it('should return true if browser is android', (done) => {\n        global.navigator = {\n            userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Android /58.0.3029.96 Safari/537.36',\n        };\n        assert.equal(utils.isAndroidBrowser(), true);\n        done();\n    });\n\n    it('should return false if not touch device', (done) => {\n        assert(!utils.isTouchDevice());\n        done();\n    });\n\n    it('should check if element is in viewport', (done) => {\n        const el = $('<"+"div>some text<"+"/div>');\n        assert(utils.isElementInViewport(el));\n        done();\n    });\n\n    it('should get empty object for url params', (done) => {\n        const params = utils.params();\n        assert.equal(Object.keys(params), 0);\n        done();\n    });\n\n    it('should get url params', (done) => {\n        const params = utils.params({ url: 'http://nodebb.org?foo=1&bar=test&herp=2' });\n        assert.strictEqual(params.foo, 1);\n        assert.strictEqual(params.bar, 'test');\n        assert.strictEqual(params.herp, 2);\n        done();\n    });\n\n    it('should get url params as arrays', (done) => {\n        const params = utils.params({ url: 'http://nodebb.org?foo=1&bar=test&herp[]=2&herp[]=3' });\n        assert.strictEqual(params.foo, 1);\n        assert.strictEqual(params.bar, 'test');\n        assert.deepStrictEqual(params.herp, [2, 3]);\n        done();\n    });\n\n    it('should get a single param', (done) => {\n        assert.equal(utils.param('somekey'), undefined);\n        done();\n    });\n\n    it('should get the full URLSearchParams object', async () => {\n        const params = utils.params({ url: 'http://nodebb.org?foo=1&bar=test&herp[]=2&herp[]=3', full: true });\n        assert(params instanceof URLSearchParams);\n        assert.strictEqual(params.get('foo'), '1');\n        assert.strictEqual(params.get('bar'), 'test');\n        assert.strictEqual(params.get('herp[]'), '2');\n    });\n\n    describe('toType', () => {\n        it('should return param as is if not string', (done) => {\n            assert.equal(123, utils.toType(123));\n            done();\n        });\n\n        it('should convert return string numbers as numbers', (done) => {\n            assert.equal(123, utils.toType('123'));\n            done();\n        });\n\n        it('should convert string \"false\" to boolean false', (done) => {\n            assert.strictEqual(false, utils.toType('false'));\n            done();\n        });\n\n        it('should convert string \"true\" to boolean true', (done) => {\n            assert.strictEqual(true, utils.toType('true'));\n            done();\n        });\n\n        it('should parse json', (done) => {\n            const data = utils.toType('{\"a\":\"1\"}');\n            assert.equal(data.a, '1');\n            done();\n        });\n\n        it('should return string as is if its not json,true,false or number', (done) => {\n            const regularStr = 'this is a regular string';\n            assert.equal(regularStr, utils.toType(regularStr));\n            done();\n        });\n    });\n\n    describe('utils.props', () => {\n        const data = {};\n\n        it('should set nested data', (done) => {\n            assert.equal(10, utils.props(data, 'a.b.c.d', 10));\n            done();\n        });\n\n        it('should return nested object', (done) => {\n            const obj = utils.props(data, 'a.b.c');\n            assert.equal(obj.d, 10);\n            done();\n        });\n\n        it('should returned undefined without throwing', (done) => {\n            assert.equal(utils.props(data, 'a.b.c.foo.bar'), undefined);\n            done();\n        });\n\n        it('should return undefined if second param is null', (done) => {\n            assert.equal(utils.props(undefined, null), undefined);\n            done();\n        });\n    });\n\n    describe('isInternalURI', () => {\n        const target = { host: '', protocol: 'https' };\n        const reference = { host: '', protocol: 'https' };\n\n        it('should return true if they match', (done) => {\n            assert(utils.isInternalURI(target, reference, ''));\n            done();\n        });\n\n        it('should return true if they match', (done) => {\n            target.host = 'nodebb.org';\n            reference.host = 'nodebb.org';\n            assert(utils.isInternalURI(target, reference, ''));\n            done();\n        });\n\n        it('should handle relative path', (done) => {\n            target.pathname = '/forum';\n            assert(utils.isInternalURI(target, reference, '/forum'));\n            done();\n        });\n\n        it('should return false if they do not match', (done) => {\n            target.pathname = '';\n            reference.host = 'designcreateplay.com';\n            assert(!utils.isInternalURI(target, reference));\n            done();\n        });\n    });\n\n    it('escape html', (done) => {\n        const escaped = utils.escapeHTML('&<"+">');\n        assert.equal(escaped, '&amp;&lt;&gt;');\n        done();\n    });\n\n    it('should escape regex chars', (done) => {\n        const escaped = utils.escapeRegexChars('some text {}');\n        assert.equal(escaped, 'some\\\\ text\\\\ \\\\{\\\\}');\n        done();\n    });\n\n    it('should get hours array', (done) => {\n        const currentHour = new Date().getHours();\n        const hours = utils.getHoursArray();\n        let index = hours.length - 1;\n        for (let i = currentHour, ii = currentHour - 24; i > ii; i -= 1) {\n            const hour = i <"+" 0 ? 24 + i : i;\n            assert.equal(hours[index], `${hour}:00`);\n            index -= 1;\n        }\n        done();\n    });\n\n    it('should get days array', (done) => {\n        const currentDay = new Date(Date.now()).getTime();\n        const days = utils.getDaysArray();\n        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n        let index = 0;\n        for (let x = 29; x >= 0; x -= 1) {\n            const tmpDate = new Date(currentDay - (1000 * 60 * 60 * 24 * x));\n            assert.equal(`${months[tmpDate.getMonth()]} ${tmpDate.getDate()}`, days[index]);\n            index += 1;\n        }\n        done();\n    });\n\n    it('`utils.rtrim` should remove trailing space', (done) => {\n        assert.strictEqual(utils.rtrim('  thing   '), '  thing');\n        assert.strictEqual(utils.rtrim('\\tthing\\t\\t'), '\\tthing');\n        assert.strictEqual(utils.rtrim('\\t thing \\t'), '\\t thing');\n        done();\n    });\n\n    it('should profile function', (done) => {\n        const st = process.hrtime();\n        setTimeout(() => {\n            process.profile('it took', st);\n            done();\n        }, 500);\n    });\n\n    it('should return object with data', async () => {\n        const user = require('../src/user');\n        const uid1 = await user.create({ username: 'promise1' });\n        const uid2 = await user.create({ username: 'promise2' });\n        const result = await utils.promiseParallel({\n            user1: user.getUserData(uid1),\n            user2: user.getUserData(uid2),\n        });\n        assert(result.hasOwnProperty('user1') && result.hasOwnProperty('user2'));\n        assert.strictEqual(result.user1.uid, uid1);\n        assert.strictEqual(result.user2.uid, uid2);\n    });\n});\n"},"test/api.js":{"tests":[{"id":"909","name":"API should pass OpenAPI v3 validation"}],"source":"'use strict';\n\nconst _ = require('lodash');\nconst assert = require('assert');\nconst path = require('path');\nconst fs = require('fs');\nconst SwaggerParser = require('@apidevtools/swagger-parser');\nconst request = require('request-promise-native');\nconst nconf = require('nconf');\nconst jwt = require('jsonwebtoken');\nconst util = require('util');\n\nconst wait = util.promisify(setTimeout);\n\nconst db = require('./mocks/databasemock');\nconst helpers = require('./helpers');\nconst meta = require('../src/meta');\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst categories = require('../src/categories');\nconst topics = require('../src/topics');\nconst posts = require('../src/posts');\nconst plugins = require('../src/plugins');\nconst flags = require('../src/flags');\nconst messaging = require('../src/messaging');\nconst utils = require('../src/utils');\n\ndescribe('API', async () => {\n    let readApi = false;\n    let writeApi = false;\n    const readApiPath = path.resolve(__dirname, '../public/openapi/read.yaml');\n    const writeApiPath = path.resolve(__dirname, '../public/openapi/write.yaml');\n    let jar;\n    let csrfToken;\n    let setup = false;\n    const unauthenticatedRoutes = ['/api/login', '/api/register']; // Everything else will be called with the admin user\n\n    const mocks = {\n        head: {},\n        get: {\n            '/api/email/unsubscribe/{token}': [\n                {\n                    in: 'path',\n                    name: 'token',\n                    example: (() => jwt.sign({\n                        template: 'digest',\n                        uid: 1,\n                    }, nconf.get('secret')))(),\n                },\n            ],\n        },\n        post: {},\n        put: {},\n        delete: {\n            '/users/{uid}/tokens/{token}': [\n                {\n                    in: 'path',\n                    name: 'uid',\n                    example: 1,\n                },\n                {\n                    in: 'path',\n                    name: 'token',\n                    example: utils.generateUUID(),\n                },\n            ],\n            '/users/{uid}/sessions/{uuid}': [\n                {\n                    in: 'path',\n                    name: 'uid',\n                    example: 1,\n                },\n                {\n                    in: 'path',\n                    name: 'uuid',\n                    example: '', // to be defined below...\n                },\n            ],\n            '/posts/{pid}/diffs/{timestamp}': [\n                {\n                    in: 'path',\n                    name: 'pid',\n                    example: '', // to be defined below...\n                },\n                {\n                    in: 'path',\n                    name: 'timestamp',\n                    example: '', // to be defined below...\n                },\n            ],\n        },\n    };\n\n    async function dummySearchHook(data) {\n        return [1];\n    }\n    async function dummyEmailerHook(data) {\n        // pretend to handle sending emails\n    }\n\n    after(async () => {\n        plugins.hooks.unregister('core', 'filter:search.query', dummySearchHook);\n        plugins.hooks.unregister('emailer-test', 'filter:email.send');\n    });\n\n    async function setupData() {\n        if (setup) {\n            return;\n        }\n\n        // Create sample users\n        const adminUid = await user.create({ username: 'admin', password: '123456', email: 'test@example.org' });\n        const unprivUid = await user.create({ username: 'unpriv', password: '123456', email: 'unpriv@example.org' });\n        await user.setUserField(adminUid, 'email', 'test@example.org');\n        await user.setUserField(unprivUid, 'email', 'unpriv@example.org');\n        await user.email.confirmByUid(adminUid);\n        await user.email.confirmByUid(unprivUid);\n\n        for (let x = 0; x <"+" 4; x++) {\n            // eslint-disable-next-line no-await-in-loop\n            await user.create({ username: 'deleteme', password: '123456' }); // for testing of DELETE /users (uids 5, 6) and DELETE /user/:uid/account (uid 7)\n        }\n        await groups.join('administrators', adminUid);\n\n        // Create sample group\n        await groups.create({\n            name: 'Test Group',\n        });\n\n        await meta.settings.set('core.api', {\n            tokens: [{\n                token: mocks.delete['/users/{uid}/tokens/{token}'][1].example,\n                uid: 1,\n                description: 'for testing of token deletion route',\n                timestamp: Date.now(),\n            }],\n        });\n        meta.config.allowTopicsThumbnail = 1;\n        meta.config.termsOfUse = 'I, for one, welcome our new test-driven overlords';\n        meta.config.chatMessageDelay = 0;\n\n        // Create a category\n        const testCategory = await categories.create({ name: 'test' });\n\n        // Post a new topic\n        await topics.post({\n            uid: adminUid,\n            cid: testCategory.cid,\n            title: 'Test Topic',\n            content: 'Test topic content',\n        });\n        const unprivTopic = await topics.post({\n            uid: unprivUid,\n            cid: testCategory.cid,\n            title: 'Test Topic 2',\n            content: 'Test topic 2 content',\n        });\n        await topics.post({\n            uid: unprivUid,\n            cid: testCategory.cid,\n            title: 'Test Topic 3',\n            content: 'Test topic 3 content',\n        });\n\n        // Create a post diff\n        await posts.edit({\n            uid: adminUid,\n            pid: unprivTopic.postData.pid,\n            content: 'Test topic 2 edited content',\n            req: {},\n        });\n        mocks.delete['/posts/{pid}/diffs/{timestamp}'][0].example = unprivTopic.postData.pid;\n        mocks.delete['/posts/{pid}/diffs/{timestamp}'][1].example = (await posts.diffs.list(unprivTopic.postData.pid))[0];\n\n        // Create a sample flag\n        const { flagId } = await flags.create('post', 1, unprivUid, 'sample reasons', Date.now()); // deleted in DELETE /api/v3/flags/1\n        await flags.appendNote(flagId, 1, 'test note', 1626446956652);\n        await flags.create('post', 2, unprivUid, 'sample reasons', Date.now()); // for testing flag notes (since flag 1 deleted)\n\n        // Create a new chat room\n        await messaging.newRoom(1, [2]);\n\n        // Create an empty file to test DELETE /files and thumb deletion\n        fs.closeSync(fs.openSync(path.resolve(nconf.get('upload_path'), 'files/test.txt'), 'w'));\n        fs.closeSync(fs.openSync(path.resolve(nconf.get('upload_path'), 'files/test.png'), 'w'));\n\n        // Associate thumb with topic to test thumb reordering\n        await topics.thumbs.associate({\n            id: 2,\n            path: 'files/test.png',\n        });\n\n        const socketUser = require('../src/socket.io/user');\n        const socketAdmin = require('../src/socket.io/admin');\n        // export data for admin user\n        await socketUser.exportProfile({ uid: adminUid }, { uid: adminUid });\n        await wait(2000);\n        await socketUser.exportPosts({ uid: adminUid }, { uid: adminUid });\n        await wait(2000);\n        await socketUser.exportUploads({ uid: adminUid }, { uid: adminUid });\n        await wait(2000);\n        await socketAdmin.user.exportUsersCSV({ uid: adminUid }, {});\n        // wait for export child process to complete\n        await wait(5000);\n\n        // Attach a search hook so /api/search is enabled\n        plugins.hooks.register('core', {\n            hook: 'filter:search.query',\n            method: dummySearchHook,\n        });\n        // Attach an emailer hook so related requests do not error\n        plugins.hooks.register('emailer-test', {\n            hook: 'filter:email.send',\n            method: dummyEmailerHook,\n        });\n\n        // All tests run as admin user\n        ({ jar } = await helpers.loginUser('admin', '123456'));\n\n        // Retrieve CSRF token using cookie, to test Write API\n        const config = await request({\n            url: `${nconf.get('url')}/api/config`,\n            json: true,\n            jar: jar,\n        });\n        csrfToken = config.csrf_token;\n\n        setup = true;\n    }\n\n    it('should pass OpenAPI v3 validation', async () => {\n        try {\n            await SwaggerParser.validate(readApiPath);\n            await SwaggerParser.validate(writeApiPath);\n        } catch (e) {\n            assert.ifError(e);\n        }\n    });\n\n    readApi = await SwaggerParser.dereference(readApiPath);\n    writeApi = await SwaggerParser.dereference(writeApiPath);\n\n    it('should grab all mounted routes and ensure a schema exists', async () => {\n        const webserver = require('../src/webserver');\n        const buildPaths = function (stack, prefix) {\n            const paths = stack.map((dispatch) => {\n                if (dispatch.route && dispatch.route.path && typeof dispatch.route.path === 'string') {\n                    if (!prefix && !dispatch.route.path.startsWith('/api/')) {\n                        return null;\n                    }\n\n                    if (prefix === nconf.get('relative_path')) {\n                        prefix = '';\n                    }\n\n                    return {\n                        method: Object.keys(dispatch.route.methods)[0],\n                        path: (prefix || '') + dispatch.route.path,\n                    };\n                } else if (dispatch.name === 'router') {\n                    const prefix = dispatch.regexp.toString().replace('/^', '').replace('\\\\/?(?=\\\\/|$)/i', '').replace(/\\\\\\//g, '/');\n                    return buildPaths(dispatch.handle.stack, prefix);\n                }\n\n                // Drop any that aren't actual routes (middlewares, error handlers, etc.)\n                return null;\n            });\n\n            return _.flatten(paths);\n        };\n\n        let paths = buildPaths(webserver.app._router.stack).filter(Boolean).map((pathObj) => {\n            pathObj.path = pathObj.path.replace(/\\/:([^\\\\/]+)/g, '/{$1}');\n            return pathObj;\n        });\n        const exclusionPrefixes = [\n            '/api/admin/plugins', '/api/compose', '/debug',\n            '/api/user/{userslug}/theme', // from persona\n        ];\n        paths = paths.filter(path => path.method !== '_all' && !exclusionPrefixes.some(prefix => path.path.startsWith(prefix)));\n\n\n        // For each express path, query for existence in read and write api schemas\n        paths.forEach((pathObj) => {\n            describe(`${pathObj.method.toUpperCase()} ${pathObj.path}`, () => {\n                it('should be defined in schema docs', () => {\n                    let schema = readApi;\n                    if (pathObj.path.startsWith('/api/v3')) {\n                        schema = writeApi;\n                        pathObj.path = pathObj.path.replace('/api/v3', '');\n                    }\n\n                    // Don't check non-GET routes in Read API\n                    if (schema === readApi && pathObj.method !== 'get') {\n                        return;\n                    }\n\n                    const normalizedPath = pathObj.path.replace(/\\/:([^\\\\/]+)/g, '/{$1}').replace(/\\?/g, '');\n                    assert(schema.paths.hasOwnProperty(normalizedPath), `${pathObj.path} is not defined in schema docs`);\n                    assert(schema.paths[normalizedPath].hasOwnProperty(pathObj.method), `${pathObj.path} was found in schema docs, but ${pathObj.method.toUpperCase()} method is not defined`);\n                });\n            });\n        });\n    });\n\n    // generateTests(readApi, Object.keys(readApi.paths));\n    generateTests(writeApi, Object.keys(writeApi.paths), writeApi.servers[0].url);\n\n    function generateTests(api, paths, prefix) {\n        // Iterate through all documented paths, make a call to it,\n        // and compare the result body with what is defined in the spec\n        const pathLib = path; // for calling path module from inside this forEach\n        paths.forEach((path) => {\n            const context = api.paths[path];\n            let schema;\n            let response;\n            let url;\n            let method;\n            const headers = {};\n            const qs = {};\n\n            Object.keys(context).forEach((_method) => {\n                // Only test GET routes in the Read API\n                if (api.info.title === 'NodeBB Read API' && _method !== 'get') {\n                    return;\n                }\n\n                it(`${_method.toUpperCase()} ${path}: should have each path parameter defined in its context`, () => {\n                    method = _method;\n                    if (!context[method].parameters) {\n                        return;\n                    }\n\n                    const pathParams = (path.match(/{[\\w\\-_*]+}?/g) || []).map(match => match.slice(1, -1));\n                    const schemaParams = context[method].parameters.map(param => (param.in === 'path' ? param.name : null)).filter(Boolean);\n                    assert(pathParams.every(param => schemaParams.includes(param)), `${method.toUpperCase()} ${path} has path parameters specified but not defined`);\n                });\n\n                it(`${_method.toUpperCase()} ${path}: should have examples when parameters are present`, () => {\n                    let { parameters } = context[method];\n                    let testPath = path;\n\n                    if (parameters) {\n                        // Use mock data if provided\n                        parameters = mocks[method][path] || parameters;\n\n                        parameters.forEach((param) => {\n                            assert(param.example !== null && param.example !== undefined, `${method.toUpperCase()} ${path} has parameters without examples`);\n\n                            switch (param.in) {\n                            case 'path':\n                                testPath = testPath.replace(`{${param.name}}`, param.example);\n                                break;\n                            case 'header':\n                                headers[param.name] = param.example;\n                                break;\n                            case 'query':\n                                qs[param.name] = param.example;\n                                break;\n                            }\n                        });\n                    }\n\n                    url = nconf.get('url') + (prefix || '') + testPath;\n                });\n\n                it(`${_method.toUpperCase()} ${path}: should contain a valid request body (if present) with application/json or multipart/form-data type if POST/PUT/DELETE`, () => {\n                    if (['post', 'put', 'delete'].includes(method) && context[method].hasOwnProperty('requestBody')) {\n                        const failMessage = `${method.toUpperCase()} ${path} has a malformed request body`;\n                        assert(context[method].requestBody, failMessage);\n                        assert(context[method].requestBody.content, failMessage);\n\n                        if (context[method].requestBody.content.hasOwnProperty('application/json')) {\n                            assert(context[method].requestBody.content['application/json'], failMessage);\n                            assert(context[method].requestBody.content['application/json'].schema, failMessage);\n                            assert(context[method].requestBody.content['application/json'].schema.properties, failMessage);\n                        } else if (context[method].requestBody.content.hasOwnProperty('multipart/form-data')) {\n                            assert(context[method].requestBody.content['multipart/form-data'], failMessage);\n                            assert(context[method].requestBody.content['multipart/form-data'].schema, failMessage);\n                            assert(context[method].requestBody.content['multipart/form-data'].schema.properties, failMessage);\n                        }\n                    }\n                });\n\n                it(`${_method.toUpperCase()} ${path}: should not error out when called`, async () => {\n                    await setupData();\n\n                    if (csrfToken) {\n                        headers['x-csrf-token'] = csrfToken;\n                    }\n\n                    let body = {};\n                    let type = 'json';\n                    if (context[method].hasOwnProperty('requestBody') && context[method].requestBody.content['application/json']) {\n                        body = buildBody(context[method].requestBody.content['application/json'].schema.properties);\n                    } else if (context[method].hasOwnProperty('requestBody') && context[method].requestBody.content['multipart/form-data']) {\n                        type = 'form';\n                    }\n\n                    try {\n                        if (type === 'json') {\n                            response = await request(url, {\n                                method: method,\n                                jar: !unauthenticatedRoutes.includes(path) ? jar : undefined,\n                                json: true,\n                                followRedirect: false, // all responses are significant (e.g. 302)\n                                simple: false, // don't throw on non-200 (e.g. 302)\n                                resolveWithFullResponse: true, // send full request back (to check statusCode)\n                                headers: headers,\n                                qs: qs,\n                                body: body,\n                            });\n                        } else if (type === 'form') {\n                            response = await new Promise((resolve, reject) => {\n                                helpers.uploadFile(url, pathLib.join(__dirname, './files/test.png'), {}, jar, csrfToken, (err, res) => {\n                                    if (err) {\n                                        return reject(err);\n                                    }\n                                    resolve(res);\n                                });\n                            });\n                        }\n                    } catch (e) {\n                        assert(!e, `${method.toUpperCase()} ${path} errored with: ${e.message}`);\n                    }\n                });\n\n                it(`${_method.toUpperCase()} ${path}: response status code should match one of the schema defined responses`, () => {\n                    // HACK: allow HTTP 418 I am a teapot, for now   👇\n                    assert(context[method].responses.hasOwnProperty('418') || Object.keys(context[method].responses).includes(String(response.statusCode)), `${method.toUpperCase()} ${path} sent back unexpected HTTP status code: ${response.statusCode} ${JSON.stringify(response.body)}`);\n                });\n\n                // Recursively iterate through schema properties, comparing type\n                it(`${_method.toUpperCase()} ${path}: response body should match schema definition`, async () => {\n                    const http302 = context[method].responses['302'];\n                    if (http302 && response.statusCode === 302) {\n                        // Compare headers instead\n                        const expectedHeaders = Object.keys(http302.headers).reduce((memo, name) => {\n                            const value = http302.headers[name].schema.example;\n                            memo[name] = value.startsWith(nconf.get('relative_path')) ? value : nconf.get('relative_path') + value;\n                            return memo;\n                        }, {});\n\n                        for (const header of Object.keys(expectedHeaders)) {\n                            assert(response.headers[header.toLowerCase()]);\n                            assert.strictEqual(response.headers[header.toLowerCase()], expectedHeaders[header]);\n                        }\n                        return;\n                    }\n\n                    const http200 = context[method].responses['200'];\n                    if (!http200) {\n                        return;\n                    }\n\n                    assert.strictEqual(response.statusCode, 200, `HTTP 200 expected (path: ${method} ${path}`);\n\n                    const hasJSON = http200.content && http200.content['application/json'];\n                    if (hasJSON) {\n                        schema = context[method].responses['200'].content['application/json'].schema;\n                        compare(schema, response.body, method.toUpperCase(), path, 'root');\n                    }\n\n                    // TODO someday: text/csv, binary file type checking?\n                });\n\n                it(`${_method.toUpperCase()} ${path}: should successfully re-login if needed`, async () => {\n                    const reloginPaths = ['PUT /users/{uid}/password', 'DELETE /users/{uid}/sessions/{uuid}'];\n                    if (reloginPaths.includes(`${method.toUpperCase()} ${path}`)) {\n                        ({ jar } = await helpers.loginUser('admin', '123456'));\n                        const sessionUUIDs = await db.getObject('uid:1:sessionUUID:sessionId');\n                        mocks.delete['/users/{uid}/sessions/{uuid}'][1].example = Object.keys(sessionUUIDs).pop();\n\n                        // Retrieve CSRF token using cookie, to test Write API\n                        const config = await request({\n                            url: `${nconf.get('url')}/api/config`,\n                            json: true,\n                            jar: jar,\n                        });\n                        csrfToken = config.csrf_token;\n                    }\n                });\n\n                it(`${_method.toUpperCase()} ${path}: should back out of a registration interstitial if needed`, async () => {\n                    const affectedPaths = ['GET /api/user/{userslug}/edit/email'];\n                    if (affectedPaths.includes(`${method.toUpperCase()} ${path}`)) {\n                        await request({\n                            uri: `${nconf.get('url')}/register/abort?_csrf=${csrfToken}`,\n                            method: 'POST',\n                            jar,\n                            simple: false,\n                        });\n                    }\n                });\n            });\n        });\n    }\n\n    function buildBody(schema) {\n        return Object.keys(schema).reduce((memo, cur) => {\n            memo[cur] = schema[cur].example;\n            return memo;\n        }, {});\n    }\n\n    function compare(schema, response, method, path, context) {\n        let required = [];\n        const additionalProperties = schema.hasOwnProperty('additionalProperties');\n\n        function flattenAllOf(obj) {\n            return obj.reduce((memo, obj) => {\n                if (obj.allOf) {\n                    obj = { properties: flattenAllOf(obj.allOf) };\n                } else {\n                    try {\n                        required = required.concat(obj.required ? obj.required : Object.keys(obj.properties));\n                    } catch (e) {\n                        assert.fail(`Syntax error re: allOf, perhaps you allOf'd an array? (path: ${method} ${path}, context: ${context})`);\n                    }\n                }\n\n                return { ...memo, ...obj.properties };\n            }, {});\n        }\n\n        if (schema.allOf) {\n            schema = flattenAllOf(schema.allOf);\n        } else if (schema.properties) {\n            required = schema.required || Object.keys(schema.properties);\n            schema = schema.properties;\n        } else {\n            // If schema contains no properties, check passes\n            return;\n        }\n\n        // Compare the schema to the response\n        required.forEach((prop) => {\n            if (schema.hasOwnProperty(prop)) {\n                assert(response.hasOwnProperty(prop), `\"${prop}\" is a required property (path: ${method} ${path}, context: ${context})`);\n\n                // Don't proceed with type-check if the value could possibly be unset (nullable: true, in spec)\n                if (response[prop] === null && schema[prop].nullable === true) {\n                    return;\n                }\n\n                // Therefore, if the value is actually null, that's a problem (nullable is probably missing)\n                assert(response[prop] !== null, `\"${prop}\" was null, but schema does not specify it to be a nullable property (path: ${method} ${path}, context: ${context})`);\n\n                switch (schema[prop].type) {\n                case 'string':\n                    assert.strictEqual(typeof response[prop], 'string', `\"${prop}\" was expected to be a string, but was ${typeof response[prop]} instead (path: ${method} ${path}, context: ${context})`);\n                    break;\n                case 'boolean':\n                    assert.strictEqual(typeof response[prop], 'boolean', `\"${prop}\" was expected to be a boolean, but was ${typeof response[prop]} instead (path: ${method} ${path}, context: ${context})`);\n                    break;\n                case 'object':\n                    assert.strictEqual(typeof response[prop], 'object', `\"${prop}\" was expected to be an object, but was ${typeof response[prop]} instead (path: ${method} ${path}, context: ${context})`);\n                    compare(schema[prop], response[prop], method, path, context ? [context, prop].join('.') : prop);\n                    break;\n                case 'array':\n                    assert.strictEqual(Array.isArray(response[prop]), true, `\"${prop}\" was expected to be an array, but was ${typeof response[prop]} instead (path: ${method} ${path}, context: ${context})`);\n\n                    if (schema[prop].items) {\n                        // Ensure the array items have a schema defined\n                        assert(schema[prop].items.type || schema[prop].items.allOf, `\"${prop}\" is defined to be an array, but its items have no schema defined (path: ${method} ${path}, context: ${context})`);\n\n                        // Compare types\n                        if (schema[prop].items.type === 'object' || Array.isArray(schema[prop].items.allOf)) {\n                            response[prop].forEach((res) => {\n                                compare(schema[prop].items, res, method, path, context ? [context, prop].join('.') : prop);\n                            });\n                        } else if (response[prop].length) { // for now\n                            response[prop].forEach((item) => {\n                                assert.strictEqual(typeof item, schema[prop].items.type, `\"${prop}\" should have ${schema[prop].items.type} items, but found ${typeof items} instead (path: ${method} ${path}, context: ${context})`);\n                            });\n                        }\n                    }\n                    break;\n                }\n            }\n        });\n\n        // Compare the response to the schema\n        Object.keys(response).forEach((prop) => {\n            if (additionalProperties) { // All bets are off\n                return;\n            }\n\n            assert(schema[prop], `\"${prop}\" was found in response, but is not defined in schema (path: ${method} ${path}, context: ${context})`);\n        });\n    }\n});\n"},"test/authentication.js":{"tests":[{"id":"910","name":"authentication should allow login with email for uid 1"},{"id":"911","name":"authentication second user should fail to login with email since email is not confirmed"},{"id":"912","name":"authentication should fail to create user if username is too short"},{"id":"913","name":"authentication should fail to create user if userslug is too short"},{"id":"914","name":"authentication should register and login a user"},{"id":"915","name":"authentication should logout a user"},{"id":"916","name":"authentication should login a user"},{"id":"917","name":"authentication should regenerate the session identifier on successful login"},{"id":"918","name":"authentication should revoke all sessions"},{"id":"919","name":"authentication should fail to login if ip address is invalid"},{"id":"920","name":"authentication should fail to login if user does not exist"},{"id":"921","name":"authentication should fail to login if username is empty"},{"id":"922","name":"authentication should fail to login if password is empty"},{"id":"923","name":"authentication should fail to login if username and password are empty"},{"id":"924","name":"authentication should fail to login if user does not have password field in db"},{"id":"925","name":"authentication should fail to login if password is longer than 4096"},{"id":"926","name":"authentication should fail to login if local login is disabled"},{"id":"927","name":"authentication should fail to register if registraton is disabled"},{"id":"928","name":"authentication should return error if invitation is not valid"},{"id":"929","name":"authentication should fail to register if username is falsy or too short"},{"id":"930","name":"authentication should fail to register if username is too long"},{"id":"931","name":"authentication should fail to register if account type is invalid"},{"id":"932","name":"authentication should queue user if ip is used before"},{"id":"933","name":"authentication should be able to login with email"},{"id":"934","name":"authentication should fail to login if login type is username and an email is sent"},{"id":"935","name":"authentication should send 200 if not logged in"},{"id":"936","name":"authentication should lockout account on 3 failed login attempts"},{"id":"937","name":"authentication should clear all reset tokens upon successful login"},{"id":"938","name":"authentication banned user authentication should prevent banned user from logging in"},{"id":"939","name":"authentication banned user authentication should allow banned user to log in if the \"banned-users\" group has \"local-login\" privilege"},{"id":"940","name":"authentication banned user authentication should allow banned user to log in if the user herself has \"local-login\" privilege"},{"id":"941","name":"authentication api tokens should fail with invalid token"},{"id":"942","name":"authentication api tokens should use a token tied to an uid"},{"id":"943","name":"authentication api tokens should fail if _uid is not passed in with master token"},{"id":"944","name":"authentication api tokens should use master api token and _uid"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst url = require('url');\nconst async = require('async');\nconst nconf = require('nconf');\nconst request = require('request');\nconst util = require('util');\n\nconst db = require('./mocks/databasemock');\nconst user = require('../src/user');\nconst utils = require('../src/utils');\nconst meta = require('../src/meta');\nconst privileges = require('../src/privileges');\nconst helpers = require('./helpers');\n\ndescribe('authentication', () => {\n    const jar = request.jar();\n    let regularUid;\n    before((done) => {\n        user.create({ username: 'regular', password: 'regularpwd', email: 'regular@nodebb.org' }, (err, uid) => {\n            assert.ifError(err);\n            regularUid = uid;\n            assert.strictEqual(uid, 1);\n            done();\n        });\n    });\n\n    it('should allow login with email for uid 1', async () => {\n        const oldValue = meta.config.allowLoginWith;\n        meta.config.allowLoginWith = 'username-email';\n        const { res } = await helpers.loginUser('regular@nodebb.org', 'regularpwd');\n        assert.strictEqual(res.statusCode, 200);\n        meta.config.allowLoginWith = oldValue;\n    });\n\n    it('second user should fail to login with email since email is not confirmed', async () => {\n        const oldValue = meta.config.allowLoginWith;\n        meta.config.allowLoginWith = 'username-email';\n        const uid = await user.create({ username: '2nduser', password: '2ndpassword', email: '2nduser@nodebb.org' });\n        const { res, body } = await helpers.loginUser('2nduser@nodebb.org', '2ndpassword');\n        assert.strictEqual(res.statusCode, 403);\n        assert.strictEqual(body, '[[error:invalid-login-credentials]]');\n        meta.config.allowLoginWith = oldValue;\n    });\n\n    it('should fail to create user if username is too short', (done) => {\n        helpers.registerUser({\n            username: 'a',\n            password: '123456',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-short]]');\n            done();\n        });\n    });\n\n    it('should fail to create user if userslug is too short', (done) => {\n        helpers.registerUser({\n            username: '----a-----',\n            password: '123456',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-short]]');\n            done();\n        });\n    });\n\n    it('should fail to create user if userslug is too short', (done) => {\n        helpers.registerUser({\n            username: '     a',\n            password: '123456',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-short]]');\n            done();\n        });\n    });\n\n    it('should fail to create user if userslug is too short', (done) => {\n        helpers.registerUser({\n            username: 'a      ',\n            password: '123456',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-short]]');\n            done();\n        });\n    });\n\n    it('should register and login a user', (done) => {\n        request({\n            url: `${nconf.get('url')}/api/config`,\n            json: true,\n            jar: jar,\n        }, (err, response, body) => {\n            assert.ifError(err);\n\n            request.post(`${nconf.get('url')}/register`, {\n                form: {\n                    email: 'admin@nodebb.org',\n                    username: 'admin',\n                    password: 'adminpwd',\n                    'password-confirm': 'adminpwd',\n                    'account-type': 'instructor',\n                    userLang: 'it',\n                    gdpr_consent: true,\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    'x-csrf-token': body.csrf_token,\n                },\n            }, async (err, response, body) => {\n                const validationPending = await user.email.isValidationPending(body.uid, 'admin@nodebb.org');\n                assert.strictEqual(validationPending, true);\n                assert.ifError(err);\n                assert(body);\n                assert(body.hasOwnProperty('uid') && body.uid > 0);\n                const newUid = body.uid;\n                request({\n                    url: `${nconf.get('url')}/api/self`,\n                    json: true,\n                    jar: jar,\n                }, (err, response, body) => {\n                    assert.ifError(err);\n                    assert(body);\n                    assert.equal(body.username, 'admin');\n                    assert.equal(body.uid, newUid);\n                    user.getSettings(body.uid, (err, settings) => {\n                        assert.ifError(err);\n                        assert.equal(settings.userLang, 'it');\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    it('should logout a user', (done) => {\n        helpers.logoutUser(jar, (err) => {\n            assert.ifError(err);\n            request({\n                url: `${nconf.get('url')}/api/me`,\n                json: true,\n                jar: jar,\n            }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 401);\n                assert.strictEqual(body.status.code, 'not-authorised');\n                done();\n            });\n        });\n    });\n\n    it('should login a user', (done) => {\n        helpers.loginUser('regular', 'regularpwd', (err, data) => {\n            assert.ifError(err);\n            assert(data.body);\n            request({\n                url: `${nconf.get('url')}/api/self`,\n                json: true,\n                jar: data.jar,\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert(body);\n                assert.equal(body.username, 'regular');\n                assert.equal(body.email, 'regular@nodebb.org');\n                db.getObject(`uid:${regularUid}:sessionUUID:sessionId`, (err, sessions) => {\n                    assert.ifError(err);\n                    assert(sessions);\n                    assert(Object.keys(sessions).length > 0);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should regenerate the session identifier on successful login', async () => {\n        const matchRegexp = /express\\.sid=s%3A(.+?);/;\n        const { hostname, path } = url.parse(nconf.get('url'));\n\n        const sid = String(jar._jar.store.idx[hostname][path]['express.sid']).match(matchRegexp)[1];\n        await helpers.logoutUser(jar);\n        const newJar = (await helpers.loginUser('regular', 'regularpwd')).jar;\n        const newSid = String(newJar._jar.store.idx[hostname][path]['express.sid']).match(matchRegexp)[1];\n\n        assert.notStrictEqual(newSid, sid);\n    });\n\n    it('should revoke all sessions', (done) => {\n        const socketAdmin = require('../src/socket.io/admin');\n        db.sortedSetCard(`uid:${regularUid}:sessions`, (err, count) => {\n            assert.ifError(err);\n            assert(count);\n            socketAdmin.deleteAllSessions({ uid: 1 }, {}, (err) => {\n                assert.ifError(err);\n                db.sortedSetCard(`uid:${regularUid}:sessions`, (err, count) => {\n                    assert.ifError(err);\n                    assert(!count);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should fail to login if ip address is invalid', (done) => {\n        const jar = request.jar();\n        request({\n            url: `${nconf.get('url')}/api/config`,\n            json: true,\n            jar: jar,\n        }, (err, response, body) => {\n            if (err) {\n                return done(err);\n            }\n\n            request.post(`${nconf.get('url')}/login`, {\n                form: {\n                    username: 'regular',\n                    password: 'regularpwd',\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    'x-csrf-token': body.csrf_token,\n                    'x-forwarded-for': '<"+"script>alert(\"xss\")<"+"/script>',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 500);\n                done();\n            });\n        });\n    });\n\n    it('should fail to login if user does not exist', (done) => {\n        helpers.loginUser('doesnotexist', 'nopassword', (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 403);\n            assert.equal(data.body, '[[error:invalid-login-credentials]]');\n            done();\n        });\n    });\n\n    it('should fail to login if username is empty', (done) => {\n        helpers.loginUser('', 'some password', (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 403);\n            assert.equal(data.body, '[[error:invalid-username-or-password]]');\n            done();\n        });\n    });\n\n    it('should fail to login if password is empty', (done) => {\n        helpers.loginUser('someuser', '', (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 403);\n            assert.equal(data.body, '[[error:invalid-username-or-password]]');\n            done();\n        });\n    });\n\n    it('should fail to login if username and password are empty', (done) => {\n        helpers.loginUser('', '', (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 403);\n            assert.equal(data.body, '[[error:invalid-username-or-password]]');\n            done();\n        });\n    });\n\n    it('should fail to login if user does not have password field in db', (done) => {\n        user.create({ username: 'hasnopassword', email: 'no@pass.org' }, (err, uid) => {\n            assert.ifError(err);\n            helpers.loginUser('hasnopassword', 'doesntmatter', (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.res.statusCode, 403);\n                assert.equal(data.body, '[[error:invalid-login-credentials]]');\n                done();\n            });\n        });\n    });\n\n    it('should fail to login if password is longer than 4096', (done) => {\n        let longPassword;\n        for (let i = 0; i <"+" 5000; i++) {\n            longPassword += 'a';\n        }\n        helpers.loginUser('someuser', longPassword, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 403);\n            assert.equal(data.body, '[[error:password-too-long]]');\n            done();\n        });\n    });\n\n    it('should fail to login if local login is disabled', (done) => {\n        privileges.global.rescind(['groups:local:login'], 'registered-users', (err) => {\n            assert.ifError(err);\n            helpers.loginUser('regular', 'regularpwd', (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.res.statusCode, 403);\n                assert.equal(data.body, '[[error:local-login-disabled]]');\n                privileges.global.give(['groups:local:login'], 'registered-users', done);\n            });\n        });\n    });\n\n    it('should fail to register if registraton is disabled', (done) => {\n        meta.config.registrationType = 'disabled';\n        helpers.registerUser({\n            username: 'someuser',\n            password: 'somepassword',\n            'account-type': 'student',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 403);\n            assert.equal(body, 'Forbidden');\n            done();\n        });\n    });\n\n    it('should return error if invitation is not valid', (done) => {\n        meta.config.registrationType = 'invite-only';\n        helpers.registerUser({\n            username: 'someuser',\n            password: 'somepassword',\n            'account-type': 'student',\n        }, (err, jar, response, body) => {\n            meta.config.registrationType = 'normal';\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[register:invite.error-invite-only]]');\n            done();\n        });\n    });\n\n    it('should fail to register if username is falsy or too short', (done) => {\n        helpers.registerUser({\n            username: '',\n            password: 'somepassword',\n            'account-type': 'student',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-short]]');\n            helpers.registerUser({\n                username: 'a',\n                password: 'somepassword',\n                'account-type': 'student',\n            }, (err, jar, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 400);\n                assert.equal(body, '[[error:username-too-short]]');\n                done();\n            });\n        });\n    });\n\n    it('should fail to register if username is too long', (done) => {\n        helpers.registerUser({\n            username: 'thisisareallylongusername',\n            password: '123456',\n            'account-type': 'student',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, '[[error:username-too-long]]');\n            done();\n        });\n    });\n\n    it('should fail to register if account type is invalid', (done) => {\n        helpers.registerUser({\n            username: 'someuser',\n            password: '123456',\n            'account-type': 'invalidtype',\n        }, (err, jar, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 400);\n            assert.equal(body, 'Invalid account type');\n            done();\n        });\n    });\n\n    it('should queue user if ip is used before', (done) => {\n        meta.config.registrationApprovalType = 'admin-approval-ip';\n        helpers.registerUser({\n            email: 'another@user.com',\n            username: 'anotheruser',\n            password: 'anotherpwd',\n            'account-type': 'student',\n            gdpr_consent: 1,\n        }, (err, jar, response, body) => {\n            meta.config.registrationApprovalType = 'normal';\n            assert.ifError(err);\n            assert.equal(response.statusCode, 200);\n            assert.equal(body.message, '[[register:registration-added-to-queue]]');\n            done();\n        });\n    });\n\n\n    it('should be able to login with email', async () => {\n        const email = 'ginger@nodebb.org';\n        const uid = await user.create({ username: 'ginger', password: '123456', email });\n        await user.setUserField(uid, 'email', email);\n        await user.email.confirmByUid(uid);\n        const { res } = await helpers.loginUser('ginger@nodebb.org', '123456');\n        assert.equal(res.statusCode, 200);\n    });\n\n    it('should fail to login if login type is username and an email is sent', (done) => {\n        meta.config.allowLoginWith = 'username';\n        helpers.loginUser('ginger@nodebb.org', '123456', (err, data) => {\n            meta.config.allowLoginWith = 'username-email';\n            assert.ifError(err);\n            assert.equal(data.res.statusCode, 400);\n            assert.equal(data.body, '[[error:wrong-login-type-username]]');\n            done();\n        });\n    });\n\n    it('should send 200 if not logged in', (done) => {\n        const jar = request.jar();\n        request({\n            url: `${nconf.get('url')}/api/config`,\n            json: true,\n            jar: jar,\n        }, (err, response, body) => {\n            assert.ifError(err);\n\n            request.post(`${nconf.get('url')}/logout`, {\n                form: {},\n                json: true,\n                jar: jar,\n                headers: {\n                    'x-csrf-token': body.csrf_token,\n                },\n            }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert.equal(body, 'not-logged-in');\n                done();\n            });\n        });\n    });\n\n    describe('banned user authentication', () => {\n        const bannedUser = {\n            username: 'banme',\n            pw: '123456',\n            uid: null,\n        };\n\n        before(async () => {\n            bannedUser.uid = await user.create({ username: 'banme', password: '123456', email: 'ban@me.com' });\n        });\n\n        it('should prevent banned user from logging in', (done) => {\n            user.bans.ban(bannedUser.uid, 0, 'spammer', (err) => {\n                assert.ifError(err);\n                helpers.loginUser(bannedUser.username, bannedUser.pw, (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.res.statusCode, 403);\n                    delete data.body.timestamp;\n                    assert.deepStrictEqual(data.body, {\n                        banned_until: 0,\n                        banned_until_readable: '',\n                        expiry: 0,\n                        expiry_readable: '',\n                        reason: 'spammer',\n                        uid: bannedUser.uid,\n                    });\n                    user.bans.unban(bannedUser.uid, (err) => {\n                        assert.ifError(err);\n                        const expiry = Date.now() + 10000;\n                        user.bans.ban(bannedUser.uid, expiry, '', (err) => {\n                            assert.ifError(err);\n                            helpers.loginUser(bannedUser.username, bannedUser.pw, (err, data) => {\n                                assert.ifError(err);\n                                assert.equal(data.res.statusCode, 403);\n                                assert(data.body.banned_until);\n                                assert(data.body.reason, '[[user:info.banned-no-reason]]');\n                                done();\n                            });\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should allow banned user to log in if the \"banned-users\" group has \"local-login\" privilege', async () => {\n            await privileges.global.give(['groups:local:login'], 'banned-users');\n            const { res } = await helpers.loginUser(bannedUser.username, bannedUser.pw);\n            assert.strictEqual(res.statusCode, 200);\n        });\n\n        it('should allow banned user to log in if the user herself has \"local-login\" privilege', async () => {\n            await privileges.global.rescind(['groups:local:login'], 'banned-users');\n            await privileges.categories.give(['local:login'], 0, bannedUser.uid);\n            const { res } = await helpers.loginUser(bannedUser.username, bannedUser.pw);\n            assert.strictEqual(res.statusCode, 200);\n        });\n    });\n\n    it('should lockout account on 3 failed login attempts', (done) => {\n        meta.config.loginAttempts = 3;\n        let uid;\n        async.waterfall([\n            function (next) {\n                user.create({ username: 'lockme', password: '123456' }, next);\n            },\n            function (_uid, next) {\n                uid = _uid;\n                helpers.loginUser('lockme', 'abcdef', next);\n            },\n            function (data, next) {\n                helpers.loginUser('lockme', 'abcdef', next);\n            },\n            function (data, next) {\n                helpers.loginUser('lockme', 'abcdef', next);\n            },\n            function (data, next) {\n                helpers.loginUser('lockme', 'abcdef', next);\n            },\n            function (data, next) {\n                meta.config.loginAttempts = 5;\n                assert.equal(data.res.statusCode, 403);\n                assert.equal(data.body, '[[error:account-locked]]');\n                helpers.loginUser('lockme', 'abcdef', next);\n            },\n            function (data, next) {\n                assert.equal(data.res.statusCode, 403);\n                assert.equal(data.body, '[[error:account-locked]]');\n                db.exists(`lockout:${uid}`, next);\n            },\n            function (locked, next) {\n                assert(locked);\n                next();\n            },\n        ], done);\n    });\n\n    it('should clear all reset tokens upon successful login', async () => {\n        const code = await user.reset.generate(regularUid);\n        await helpers.loginUser('regular', 'regularpwd');\n        const valid = await user.reset.validate(code);\n        assert.strictEqual(valid, false);\n    });\n\n    describe('api tokens', () => {\n        let newUid;\n        let userToken;\n        let masterToken;\n        before(async () => {\n            newUid = await user.create({ username: 'apiUserTarget' });\n            const settings = await meta.settings.get('core.api');\n            settings.tokens = settings.tokens || [];\n            userToken = {\n                token: utils.generateUUID(),\n                uid: newUid,\n                description: `api token for uid ${newUid}`,\n                timestamp: Date.now(),\n            };\n            settings.tokens.push(userToken);\n            masterToken = {\n                token: utils.generateUUID(),\n                uid: 0,\n                description: 'api master token',\n                timestamp: Date.now(),\n            };\n            settings.tokens.push(masterToken);\n\n            await meta.settings.set('core.api', settings);\n        });\n\n        it('should fail with invalid token', async () => {\n            const { res, body } = await helpers.request('get', `/api/self`, {\n                form: {\n                    _uid: newUid,\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    Authorization: `Bearer sdfhaskfdja-jahfdaksdf`,\n                },\n            });\n            assert.strictEqual(res.statusCode, 401);\n            assert.strictEqual(body, 'not-authorized');\n        });\n\n        it('should use a token tied to an uid', async () => {\n            const { res, body } = await helpers.request('get', `/api/self`, {\n                json: true,\n                headers: {\n                    Authorization: `Bearer ${userToken.token}`,\n                },\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert.strictEqual(body.username, 'apiUserTarget');\n        });\n\n        it('should fail if _uid is not passed in with master token', async () => {\n            const { res, body } = await helpers.request('get', `/api/self`, {\n                form: {},\n                json: true,\n                headers: {\n                    Authorization: `Bearer ${masterToken.token}`,\n                },\n            });\n\n            assert.strictEqual(res.statusCode, 500);\n            assert.strictEqual(body.error, '[[error:api.master-token-no-uid]]');\n        });\n\n        it('should use master api token and _uid', async () => {\n            const { res, body } = await helpers.request('get', `/api/self`, {\n                form: {\n                    _uid: newUid,\n                },\n                json: true,\n                headers: {\n                    Authorization: `Bearer ${masterToken.token}`,\n                },\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert.strictEqual(body.username, 'apiUserTarget');\n        });\n    });\n});\n"},"test/batch.js":{"tests":[{"id":"945","name":"batch should process sorted set with callbacks"},{"id":"946","name":"batch should process sorted set with async/await"},{"id":"947","name":"batch should process array with callbacks"},{"id":"948","name":"batch should process array with async/await"}],"source":"'use strict';\n\nconst async = require('async');\nconst assert = require('assert');\n\nconst db = require('./mocks/databasemock');\n\nconst batch = require('../src/batch');\n\ndescribe('batch', () => {\n    const scores = [];\n    const values = [];\n    before((done) => {\n        for (let i = 0; i <"+" 100; i++) {\n            scores.push(i);\n            values.push(`val${i}`);\n        }\n        db.sortedSetAdd('processMe', scores, values, done);\n    });\n\n    it('should process sorted set with callbacks', (done) => {\n        let total = 0;\n        batch.processSortedSet('processMe', (items, next) => {\n            items.forEach((item) => {\n                total += item.score;\n            });\n\n            setImmediate(next);\n        }, {\n            withScores: true,\n            interval: 50,\n            batch: 10,\n        }, (err) => {\n            assert.ifError(err);\n            assert.strictEqual(total, 4950);\n            done();\n        });\n    });\n\n    it('should process sorted set with callbacks', (done) => {\n        let total = 0;\n        batch.processSortedSet('processMe', (values, next) => {\n            values.forEach((val) => {\n                total += val.length;\n            });\n\n            setImmediate(next);\n        }, (err) => {\n            assert.ifError(err);\n            assert.strictEqual(total, 490);\n            done();\n        });\n    });\n\n    it('should process sorted set with async/await', async () => {\n        let total = 0;\n        await batch.processSortedSet('processMe', (values, next) => {\n            values.forEach((val) => {\n                total += val.length;\n            });\n\n            setImmediate(next);\n        }, {});\n\n        assert.strictEqual(total, 490);\n    });\n\n    it('should process sorted set with async/await', async () => {\n        let total = 0;\n        await batch.processSortedSet('processMe', async (values) => {\n            values.forEach((val) => {\n                total += val.length;\n            });\n            await db.getObject('doesnotexist');\n        }, {});\n\n        assert.strictEqual(total, 490);\n    });\n\n    it('should process array with callbacks', (done) => {\n        let total = 0;\n        batch.processArray(scores, (nums, next) => {\n            nums.forEach((n) => {\n                total += n;\n            });\n\n            setImmediate(next);\n        }, {\n            withScores: true,\n            interval: 50,\n            batch: 10,\n        }, (err) => {\n            assert.ifError(err);\n            assert.strictEqual(total, 4950);\n            done();\n        });\n    });\n\n    it('should process array with async/await', async () => {\n        let total = 0;\n        await batch.processArray(scores, (nums, next) => {\n            nums.forEach((n) => {\n                total += n;\n            });\n\n            setImmediate(next);\n        }, {\n            withScores: true,\n            interval: 50,\n            batch: 10,\n        });\n\n        assert.strictEqual(total, 4950);\n    });\n});\n"},"test/blacklist.js":{"tests":[{"id":"949","name":"blacklist should validate blacklist"},{"id":"950","name":"blacklist should error if not admin"},{"id":"951","name":"blacklist should save blacklist"},{"id":"952","name":"blacklist should pass ip test against blacklist"},{"id":"953","name":"blacklist should fail ip test against blacklist"},{"id":"954","name":"blacklist should pass ip test and not crash with ipv6 address"}],"source":"'use strict';\n\nconst async = require('async');\nconst assert = require('assert');\n\nconst db = require('./mocks/databasemock');\nconst groups = require('../src/groups');\nconst user = require('../src/user');\nconst blacklist = require('../src/meta/blacklist');\n\ndescribe('blacklist', () => {\n    let adminUid;\n\n    before((done) => {\n        user.create({ username: 'admin' }, (err, uid) => {\n            assert.ifError(err);\n            adminUid = uid;\n            groups.join('administrators', adminUid, done);\n        });\n    });\n\n    const socketBlacklist = require('../src/socket.io/blacklist');\n    const rules = '1.1.1.1\\n2.2.2.2\\n::ffff:0:2.2.2.2\\n127.0.0.1\\n192.168.100.0/22';\n\n    it('should validate blacklist', (done) => {\n        socketBlacklist.validate({ uid: adminUid }, {\n            rules: rules,\n        }, (err, data) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should error if not admin', (done) => {\n        socketBlacklist.save({ uid: 0 }, rules, (err) => {\n            assert.equal(err.message, '[[error:no-privileges]]');\n            done();\n        });\n    });\n\n    it('should save blacklist', (done) => {\n        socketBlacklist.save({ uid: adminUid }, rules, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should pass ip test against blacklist', (done) => {\n        blacklist.test('3.3.3.3', (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should fail ip test against blacklist', (done) => {\n        blacklist.test('1.1.1.1', (err) => {\n            assert.equal(err.message, '[[error:blacklisted-ip]]');\n            done();\n        });\n    });\n\n    it('should pass ip test and not crash with ipv6 address', (done) => {\n        blacklist.test('2001:db8:85a3:0:0:8a2e:370:7334', (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n});\n"},"test/categories.js":{"tests":[{"id":"955","name":"Categories should create a new category"},{"id":"956","name":"Categories should retrieve a newly created category by its ID"},{"id":"957","name":"Categories should return null if category does not exist"},{"id":"958","name":"Categories should get all categories"},{"id":"959","name":"Categories should load a category route"},{"id":"960","name":"Categories should get active users"},{"id":"961","name":"Categories should return nested children categories"},{"id":"962","name":"Categories Categories.getRecentTopicReplies should not throw"},{"id":"963","name":"Categories .getCategoryTopics should return a list of topics"},{"id":"964","name":"Categories .getCategoryTopics should return a list of topics by a specific user"},{"id":"965","name":"Categories Categories.moveRecentReplies should move posts from one category to another"},{"id":"966","name":"Categories api/socket methods should get recent replies in category"},{"id":"967","name":"Categories api/socket methods should get categories"},{"id":"968","name":"Categories api/socket methods should get watched categories"},{"id":"969","name":"Categories api/socket methods should load more topics"},{"id":"970","name":"Categories api/socket methods should not show deleted topic titles"},{"id":"971","name":"Categories api/socket methods should load topic count"},{"id":"972","name":"Categories api/socket methods should load category by privilege"},{"id":"973","name":"Categories api/socket methods should get move categories"},{"id":"974","name":"Categories api/socket methods should ignore category"},{"id":"975","name":"Categories api/socket methods should watch category"},{"id":"976","name":"Categories api/socket methods should error if watch state does not exist"},{"id":"977","name":"Categories api/socket methods should check if user is moderator"},{"id":"978","name":"Categories api/socket methods should get category data"},{"id":"979","name":"Categories admin api/socket methods should return error with invalid data"},{"id":"980","name":"Categories admin api/socket methods should error if you try to set parent as self"},{"id":"981","name":"Categories admin api/socket methods should error if you try to set child as parent"},{"id":"982","name":"Categories admin api/socket methods should update category data"},{"id":"983","name":"Categories admin api/socket methods should properly order categories"},{"id":"984","name":"Categories admin api/socket methods should not remove category from parent if parent is set again to same category"},{"id":"985","name":"Categories admin api/socket methods should purge category"},{"id":"986","name":"Categories admin api/socket methods should get all category names"},{"id":"987","name":"Categories admin api/socket methods should give privilege"},{"id":"988","name":"Categories admin api/socket methods should remove privilege"},{"id":"989","name":"Categories admin api/socket methods should get privilege settings"},{"id":"990","name":"Categories admin api/socket methods should copy privileges to children"},{"id":"991","name":"Categories admin api/socket methods should create category with settings from"},{"id":"992","name":"Categories admin api/socket methods should copy settings from"},{"id":"993","name":"Categories admin api/socket methods should copy privileges from another category"},{"id":"994","name":"Categories admin api/socket methods should copy privileges from another category for a single group"},{"id":"995","name":"Categories tag whitelist should error if data is invalid"},{"id":"996","name":"Categories tag whitelist should return true if category whitelist is empty"},{"id":"997","name":"Categories tag whitelist should add tags to category whitelist"},{"id":"998","name":"Categories tag whitelist should return false if category whitelist does not have tag"},{"id":"999","name":"Categories tag whitelist should return true if category whitelist has tag"},{"id":"1000","name":"Categories tag whitelist should post a topic with only allowed tags"},{"id":"1001","name":"Categories privileges should return empty array if uids is empty array"},{"id":"1002","name":"Categories privileges should filter uids by privilege"},{"id":"1003","name":"Categories privileges should load category user privileges"},{"id":"1004","name":"Categories privileges should load global user privileges"},{"id":"1005","name":"Categories privileges should load category group privileges"},{"id":"1006","name":"Categories privileges should load global group privileges"},{"id":"1007","name":"Categories privileges should return false if cid is falsy"},{"id":"1008","name":"Categories privileges Categories.getModeratorUids should retrieve all users with moderator bit in category privilege"},{"id":"1009","name":"Categories privileges Categories.getModeratorUids should not fail when there are multiple groups"},{"id":"1010","name":"Categories getTopicIds should get topic ids with filter"}],"source":"'use strict';\n\n\nconst async = require('async');\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst request = require('request');\n\nconst db = require('./mocks/databasemock');\nconst Categories = require('../src/categories');\nconst Topics = require('../src/topics');\nconst User = require('../src/user');\nconst groups = require('../src/groups');\nconst privileges = require('../src/privileges');\n\ndescribe('Categories', () => {\n    let categoryObj;\n    let posterUid;\n    let adminUid;\n\n    before((done) => {\n        async.series({\n            posterUid: function (next) {\n                User.create({ username: 'poster' }, next);\n            },\n            adminUid: function (next) {\n                User.create({ username: 'admin' }, next);\n            },\n        }, (err, results) => {\n            assert.ifError(err);\n            posterUid = results.posterUid;\n            adminUid = results.adminUid;\n            groups.join('administrators', adminUid, done);\n        });\n    });\n\n\n    it('should create a new category', (done) => {\n        Categories.create({\n            name: 'Test Category & NodeBB',\n            description: 'Test category created by testing script',\n            icon: 'fa-check',\n            blockclass: 'category-blue',\n            order: '5',\n        }, (err, category) => {\n            assert.ifError(err);\n\n            categoryObj = category;\n            done();\n        });\n    });\n\n    it('should retrieve a newly created category by its ID', (done) => {\n        Categories.getCategoryById({\n            cid: categoryObj.cid,\n            start: 0,\n            stop: -1,\n            uid: 0,\n        }, (err, categoryData) => {\n            assert.ifError(err);\n\n            assert(categoryData);\n            assert.equal('Test Category &amp; NodeBB', categoryData.name);\n            assert.equal(categoryObj.description, categoryData.description);\n            assert.strictEqual(categoryObj.disabled, 0);\n            done();\n        });\n    });\n\n    it('should return null if category does not exist', (done) => {\n        Categories.getCategoryById({\n            cid: 123123123,\n            start: 0,\n            stop: -1,\n        }, (err, categoryData) => {\n            assert.ifError(err);\n            assert.strictEqual(categoryData, null);\n            done();\n        });\n    });\n\n    it('should get all categories', (done) => {\n        Categories.getAllCategories(1, (err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            assert.equal(data[0].cid, categoryObj.cid);\n            done();\n        });\n    });\n\n    it('should load a category route', (done) => {\n        request(`${nconf.get('url')}/api/category/${categoryObj.cid}/test-category`, { json: true }, (err, response, body) => {\n            assert.ifError(err);\n            assert.equal(response.statusCode, 200);\n            assert.equal(body.name, 'Test Category &amp; NodeBB');\n            assert(body);\n            done();\n        });\n    });\n\n    describe('Categories.getRecentTopicReplies', () => {\n        it('should not throw', (done) => {\n            Categories.getCategoryById({\n                cid: categoryObj.cid,\n                set: `cid:${categoryObj.cid}:tids`,\n                reverse: true,\n                start: 0,\n                stop: -1,\n                uid: 0,\n            }, (err, categoryData) => {\n                assert.ifError(err);\n                Categories.getRecentTopicReplies(categoryData, 0, {}, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.getCategoryTopics', () => {\n        it('should return a list of topics', (done) => {\n            Categories.getCategoryTopics({\n                cid: categoryObj.cid,\n                start: 0,\n                stop: 10,\n                uid: 0,\n                sort: 'oldest_to_newest',\n            }, (err, result) => {\n                assert.equal(err, null);\n\n                assert(Array.isArray(result.topics));\n                assert(result.topics.every(topic => topic instanceof Object));\n\n                done();\n            });\n        });\n\n        it('should return a list of topics by a specific user', (done) => {\n            Categories.getCategoryTopics({\n                cid: categoryObj.cid,\n                start: 0,\n                stop: 10,\n                uid: 0,\n                targetUid: 1,\n                sort: 'oldest_to_newest',\n            }, (err, result) => {\n                assert.equal(err, null);\n                assert(Array.isArray(result.topics));\n                assert(result.topics.every(topic => topic instanceof Object && topic.uid === '1'));\n\n                done();\n            });\n        });\n    });\n\n    describe('Categories.moveRecentReplies', () => {\n        let moveCid;\n        let moveTid;\n        before((done) => {\n            async.parallel({\n                category: function (next) {\n                    Categories.create({\n                        name: 'Test Category 2',\n                        description: 'Test category created by testing script',\n                    }, next);\n                },\n                topic: function (next) {\n                    Topics.post({\n                        uid: posterUid,\n                        cid: categoryObj.cid,\n                        title: 'Test Topic Title',\n                        content: 'The content of test topic',\n                    }, next);\n                },\n            }, (err, results) => {\n                if (err) {\n                    return done(err);\n                }\n                moveCid = results.category.cid;\n                moveTid = results.topic.topicData.tid;\n                Topics.reply({ uid: posterUid, content: 'test post', tid: moveTid }, (err) => {\n                    done(err);\n                });\n            });\n        });\n\n        it('should move posts from one category to another', (done) => {\n            Categories.moveRecentReplies(moveTid, categoryObj.cid, moveCid, (err) => {\n                assert.ifError(err);\n                db.getSortedSetRange(`cid:${categoryObj.cid}:pids`, 0, -1, (err, pids) => {\n                    assert.ifError(err);\n                    assert.equal(pids.length, 0);\n                    db.getSortedSetRange(`cid:${moveCid}:pids`, 0, -1, (err, pids) => {\n                        assert.ifError(err);\n                        assert.equal(pids.length, 2);\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    describe('api/socket methods', () => {\n        const socketCategories = require('../src/socket.io/categories');\n        const apiCategories = require('../src/api/categories');\n        before(async () => {\n            await Topics.post({\n                uid: posterUid,\n                cid: categoryObj.cid,\n                title: 'Test Topic Title',\n                content: 'The content of test topic',\n                tags: ['nodebb'],\n            });\n            const data = await Topics.post({\n                uid: posterUid,\n                cid: categoryObj.cid,\n                title: 'will delete',\n                content: 'The content of deleted topic',\n            });\n            await Topics.delete(data.topicData.tid, adminUid);\n        });\n\n        it('should get recent replies in category', (done) => {\n            socketCategories.getRecentReplies({ uid: posterUid }, categoryObj.cid, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should get categories', (done) => {\n            socketCategories.get({ uid: posterUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should get watched categories', (done) => {\n            socketCategories.getWatchedCategories({ uid: posterUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should load more topics', (done) => {\n            socketCategories.loadMore({ uid: posterUid }, {\n                cid: categoryObj.cid,\n                after: 0,\n                query: {\n                    author: 'poster',\n                    tag: 'nodebb',\n                },\n            }, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data.topics));\n                assert.equal(data.topics[0].user.username, 'poster');\n                assert.equal(data.topics[0].tags[0].value, 'nodebb');\n                assert.equal(data.topics[0].category.cid, categoryObj.cid);\n                done();\n            });\n        });\n\n        it('should not show deleted topic titles', async () => {\n            const data = await socketCategories.loadMore({ uid: 0 }, {\n                cid: categoryObj.cid,\n                after: 0,\n            });\n\n            assert.deepStrictEqual(\n                data.topics.map(t => t.title),\n                ['[[topic:topic_is_deleted]]', 'Test Topic Title', 'Test Topic Title'],\n            );\n        });\n\n        it('should load topic count', (done) => {\n            socketCategories.getTopicCount({ uid: posterUid }, categoryObj.cid, (err, topicCount) => {\n                assert.ifError(err);\n                assert.strictEqual(topicCount, 3);\n                done();\n            });\n        });\n\n        it('should load category by privilege', (done) => {\n            socketCategories.getCategoriesByPrivilege({ uid: posterUid }, 'find', (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should get move categories', (done) => {\n            socketCategories.getMoveCategories({ uid: posterUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should ignore category', (done) => {\n            socketCategories.ignore({ uid: posterUid }, { cid: categoryObj.cid }, (err) => {\n                assert.ifError(err);\n                Categories.isIgnored([categoryObj.cid], posterUid, (err, isIgnored) => {\n                    assert.ifError(err);\n                    assert.equal(isIgnored[0], true);\n                    Categories.getIgnorers(categoryObj.cid, 0, -1, (err, ignorers) => {\n                        assert.ifError(err);\n                        assert.deepEqual(ignorers, [posterUid]);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should watch category', (done) => {\n            socketCategories.watch({ uid: posterUid }, { cid: categoryObj.cid }, (err) => {\n                assert.ifError(err);\n                Categories.isIgnored([categoryObj.cid], posterUid, (err, isIgnored) => {\n                    assert.ifError(err);\n                    assert.equal(isIgnored[0], false);\n                    done();\n                });\n            });\n        });\n\n        it('should error if watch state does not exist', (done) => {\n            socketCategories.setWatchState({ uid: posterUid }, { cid: categoryObj.cid, state: 'invalid-state' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-watch-state]]');\n                done();\n            });\n        });\n\n        it('should check if user is moderator', (done) => {\n            socketCategories.isModerator({ uid: posterUid }, {}, (err, isModerator) => {\n                assert.ifError(err);\n                assert(!isModerator);\n                done();\n            });\n        });\n\n        it('should get category data', async () => {\n            const data = await apiCategories.get({ uid: posterUid }, { cid: categoryObj.cid });\n            assert.equal(categoryObj.cid, data.cid);\n        });\n    });\n\n    describe('admin api/socket methods', () => {\n        const socketCategories = require('../src/socket.io/admin/categories');\n        const apiCategories = require('../src/api/categories');\n        let cid;\n        before(async () => {\n            const category = await apiCategories.create({ uid: adminUid }, {\n                name: 'update name',\n                description: 'update description',\n                parentCid: categoryObj.cid,\n                icon: 'fa-check',\n                order: '5',\n            });\n            cid = category.cid;\n        });\n\n        it('should return error with invalid data', async () => {\n            let err;\n            try {\n                await apiCategories.update({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n\n        it('should error if you try to set parent as self', async () => {\n            const updateData = {};\n            updateData[cid] = {\n                parentCid: cid,\n            };\n            let err;\n            try {\n                await apiCategories.update({ uid: adminUid }, updateData);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:cant-set-self-as-parent]]');\n        });\n\n        it('should error if you try to set child as parent', async () => {\n            const parentCategory = await Categories.create({ name: 'parent 1', description: 'poor parent' });\n            const parentCid = parentCategory.cid;\n            const childCategory = await Categories.create({ name: 'child1', description: 'wanna be parent', parentCid: parentCid });\n            const child1Cid = childCategory.cid;\n            const updateData = {};\n            updateData[parentCid] = {\n                parentCid: child1Cid,\n            };\n            let err;\n            try {\n                await apiCategories.update({ uid: adminUid }, updateData);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:cant-set-child-as-parent]]');\n        });\n\n        it('should update category data', async () => {\n            const updateData = {};\n            updateData[cid] = {\n                name: 'new name',\n                description: 'new description',\n                parentCid: 0,\n                order: 3,\n                icon: 'fa-hammer',\n            };\n            await apiCategories.update({ uid: adminUid }, updateData);\n\n            const data = await Categories.getCategoryData(cid);\n            assert.equal(data.name, updateData[cid].name);\n            assert.equal(data.description, updateData[cid].description);\n            assert.equal(data.parentCid, updateData[cid].parentCid);\n            assert.equal(data.order, updateData[cid].order);\n            assert.equal(data.icon, updateData[cid].icon);\n        });\n\n        it('should properly order categories', async () => {\n            const p1 = await Categories.create({ name: 'p1', description: 'd', parentCid: 0, order: 1 });\n            const c1 = await Categories.create({ name: 'c1', description: 'd1', parentCid: p1.cid, order: 1 });\n            const c2 = await Categories.create({ name: 'c2', description: 'd2', parentCid: p1.cid, order: 2 });\n            const c3 = await Categories.create({ name: 'c3', description: 'd3', parentCid: p1.cid, order: 3 });\n            // move c1 to second place\n            await apiCategories.update({ uid: adminUid }, { [c1.cid]: { order: 2 } });\n            let cids = await db.getSortedSetRange(`cid:${p1.cid}:children`, 0, -1);\n            assert.deepStrictEqual(cids.map(Number), [c2.cid, c1.cid, c3.cid]);\n\n            // move c3 to front\n            await apiCategories.update({ uid: adminUid }, { [c3.cid]: { order: 1 } });\n            cids = await db.getSortedSetRange(`cid:${p1.cid}:children`, 0, -1);\n            assert.deepStrictEqual(cids.map(Number), [c3.cid, c2.cid, c1.cid]);\n        });\n\n        it('should not remove category from parent if parent is set again to same category', async () => {\n            const parentCat = await Categories.create({ name: 'parent', description: 'poor parent' });\n            const updateData = {};\n            updateData[cid] = {\n                parentCid: parentCat.cid,\n            };\n            await Categories.update(updateData);\n            let data = await Categories.getCategoryData(cid);\n            assert.equal(data.parentCid, updateData[cid].parentCid);\n            let childrenCids = await db.getSortedSetRange(`cid:${parentCat.cid}:children`, 0, -1);\n            assert(childrenCids.includes(String(cid)));\n\n            // update again to same parent\n            await Categories.update(updateData);\n            data = await Categories.getCategoryData(cid);\n            assert.equal(data.parentCid, updateData[cid].parentCid);\n            childrenCids = await db.getSortedSetRange(`cid:${parentCat.cid}:children`, 0, -1);\n            assert(childrenCids.includes(String(cid)));\n        });\n\n        it('should purge category', async () => {\n            const category = await Categories.create({\n                name: 'purge me',\n                description: 'update description',\n            });\n            await Topics.post({\n                uid: posterUid,\n                cid: category.cid,\n                title: 'Test Topic Title',\n                content: 'The content of test topic',\n            });\n            await apiCategories.delete({ uid: adminUid }, { cid: category.cid });\n            const data = await Categories.getCategoryById(category.cid);\n            assert.strictEqual(data, null);\n        });\n\n        it('should get all category names', (done) => {\n            socketCategories.getNames({ uid: adminUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                done();\n            });\n        });\n\n        it('should give privilege', async () => {\n            await apiCategories.setPrivilege({ uid: adminUid }, { cid: categoryObj.cid, privilege: ['groups:topics:delete'], set: true, member: 'registered-users' });\n            const canDeleteTopics = await privileges.categories.can('topics:delete', categoryObj.cid, posterUid);\n            assert(canDeleteTopics);\n        });\n\n        it('should remove privilege', async () => {\n            await apiCategories.setPrivilege({ uid: adminUid }, { cid: categoryObj.cid, privilege: 'groups:topics:delete', set: false, member: 'registered-users' });\n            const canDeleteTopics = await privileges.categories.can('topics:delete', categoryObj.cid, posterUid);\n            assert(!canDeleteTopics);\n        });\n\n        it('should get privilege settings', async () => {\n            const data = await apiCategories.getPrivileges({ uid: adminUid }, categoryObj.cid);\n            assert(data.labels);\n            assert(data.labels.users);\n            assert(data.labels.groups);\n            assert(data.keys.users);\n            assert(data.keys.groups);\n            assert(data.users);\n            assert(data.groups);\n        });\n\n        it('should copy privileges to children', async () => {\n            const parentCategory = await Categories.create({ name: 'parent' });\n            const parentCid = parentCategory.cid;\n            const child1 = await Categories.create({ name: 'child1', parentCid: parentCid });\n            const child2 = await Categories.create({ name: 'child2', parentCid: child1.cid });\n            await apiCategories.setPrivilege({ uid: adminUid }, {\n                cid: parentCid,\n                privilege: 'groups:topics:delete',\n                set: true,\n                member: 'registered-users',\n            });\n            await socketCategories.copyPrivilegesToChildren({ uid: adminUid }, { cid: parentCid, group: '' });\n            const canDelete = await privileges.categories.can('topics:delete', child2.cid, posterUid);\n            assert(canDelete);\n        });\n\n        it('should create category with settings from', (done) => {\n            let child1Cid;\n            let parentCid;\n            async.waterfall([\n                function (next) {\n                    Categories.create({ name: 'copy from', description: 'copy me' }, next);\n                },\n                function (category, next) {\n                    parentCid = category.cid;\n                    Categories.create({ name: 'child1', description: 'will be gone', cloneFromCid: parentCid }, next);\n                },\n                function (category, next) {\n                    child1Cid = category.cid;\n                    assert.equal(category.description, 'copy me');\n                    next();\n                },\n            ], done);\n        });\n\n        it('should copy settings from', (done) => {\n            let child1Cid;\n            let parentCid;\n            async.waterfall([\n                function (next) {\n                    Categories.create({ name: 'parent', description: 'copy me' }, next);\n                },\n                function (category, next) {\n                    parentCid = category.cid;\n                    Categories.create({ name: 'child1' }, next);\n                },\n                function (category, next) {\n                    child1Cid = category.cid;\n                    socketCategories.copySettingsFrom(\n                        { uid: adminUid },\n                        { fromCid: parentCid, toCid: child1Cid, copyParent: true },\n                        next\n                    );\n                },\n                function (destinationCategory, next) {\n                    Categories.getCategoryField(child1Cid, 'description', next);\n                },\n                function (description, next) {\n                    assert.equal(description, 'copy me');\n                    next();\n                },\n            ], done);\n        });\n\n        it('should copy privileges from another category', async () => {\n            const parent = await Categories.create({ name: 'parent', description: 'copy me' });\n            const parentCid = parent.cid;\n            const child1 = await Categories.create({ name: 'child1' });\n            await apiCategories.setPrivilege({ uid: adminUid }, {\n                cid: parentCid,\n                privilege: 'groups:topics:delete',\n                set: true,\n                member: 'registered-users',\n            });\n            await socketCategories.copyPrivilegesFrom({ uid: adminUid }, { fromCid: parentCid, toCid: child1.cid });\n            const canDelete = await privileges.categories.can('topics:delete', child1.cid, posterUid);\n            assert(canDelete);\n        });\n\n        it('should copy privileges from another category for a single group', async () => {\n            const parent = await Categories.create({ name: 'parent', description: 'copy me' });\n            const parentCid = parent.cid;\n            const child1 = await Categories.create({ name: 'child1' });\n            await apiCategories.setPrivilege({ uid: adminUid }, {\n                cid: parentCid,\n                privilege: 'groups:topics:delete',\n                set: true,\n                member: 'registered-users',\n            });\n            await socketCategories.copyPrivilegesFrom({ uid: adminUid }, { fromCid: parentCid, toCid: child1.cid, group: 'registered-users' });\n            const canDelete = await privileges.categories.can('topics:delete', child1.cid, 0);\n            assert(!canDelete);\n        });\n    });\n\n    it('should get active users', (done) => {\n        Categories.create({\n            name: 'test',\n        }, (err, category) => {\n            assert.ifError(err);\n            Topics.post({\n                uid: posterUid,\n                cid: category.cid,\n                title: 'Test Topic Title',\n                content: 'The content of test topic',\n            }, (err) => {\n                assert.ifError(err);\n                Categories.getActiveUsers(category.cid, (err, uids) => {\n                    assert.ifError(err);\n                    assert.equal(uids[0], posterUid);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('tag whitelist', () => {\n        let cid;\n        const socketTopics = require('../src/socket.io/topics');\n        before((done) => {\n            Categories.create({\n                name: 'test',\n            }, (err, category) => {\n                assert.ifError(err);\n                cid = category.cid;\n                done();\n            });\n        });\n\n        it('should error if data is invalid', (done) => {\n            socketTopics.isTagAllowed({ uid: posterUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should return true if category whitelist is empty', (done) => {\n            socketTopics.isTagAllowed({ uid: posterUid }, { tag: 'notallowed', cid: cid }, (err, allowed) => {\n                assert.ifError(err);\n                assert(allowed);\n                done();\n            });\n        });\n\n        it('should add tags to category whitelist', (done) => {\n            const data = {};\n            data[cid] = {\n                tagWhitelist: 'nodebb,jquery,javascript',\n            };\n            Categories.update(data, (err) => {\n                assert.ifError(err);\n                db.getSortedSetRange(`cid:${cid}:tag:whitelist`, 0, -1, (err, tagWhitelist) => {\n                    assert.ifError(err);\n                    assert.deepEqual(['nodebb', 'jquery', 'javascript'], tagWhitelist);\n                    done();\n                });\n            });\n        });\n\n        it('should return false if category whitelist does not have tag', (done) => {\n            socketTopics.isTagAllowed({ uid: posterUid }, { tag: 'notallowed', cid: cid }, (err, allowed) => {\n                assert.ifError(err);\n                assert(!allowed);\n                done();\n            });\n        });\n\n        it('should return true if category whitelist has tag', (done) => {\n            socketTopics.isTagAllowed({ uid: posterUid }, { tag: 'nodebb', cid: cid }, (err, allowed) => {\n                assert.ifError(err);\n                assert(allowed);\n                done();\n            });\n        });\n\n        it('should post a topic with only allowed tags', (done) => {\n            Topics.post({\n                uid: posterUid,\n                cid: cid,\n                title: 'Test Topic Title',\n                content: 'The content of test topic',\n                tags: ['nodebb', 'jquery', 'notallowed'],\n            }, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.topicData.tags.length, 2);\n                done();\n            });\n        });\n    });\n\n\n    describe('privileges', () => {\n        const privileges = require('../src/privileges');\n\n        it('should return empty array if uids is empty array', (done) => {\n            privileges.categories.filterUids('find', categoryObj.cid, [], (err, uids) => {\n                assert.ifError(err);\n                assert.equal(uids.length, 0);\n                done();\n            });\n        });\n\n        it('should filter uids by privilege', (done) => {\n            privileges.categories.filterUids('find', categoryObj.cid, [1, 2, 3, 4], (err, uids) => {\n                assert.ifError(err);\n                assert.deepEqual(uids, [1, 2]);\n                done();\n            });\n        });\n\n        it('should load category user privileges', (done) => {\n            privileges.categories.userPrivileges(categoryObj.cid, 1, (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual(data, {\n                    find: false,\n                    'posts:delete': false,\n                    read: false,\n                    'topics:reply': false,\n                    'topics:read': false,\n                    'topics:create': false,\n                    'topics:tag': false,\n                    'topics:delete': false,\n                    'topics:schedule': false,\n                    'posts:edit': false,\n                    'posts:history': false,\n                    'posts:upvote': false,\n                    'posts:downvote': false,\n                    purge: false,\n                    'posts:view_deleted': false,\n                    moderate: false,\n                });\n\n                done();\n            });\n        });\n\n        it('should load global user privileges', (done) => {\n            privileges.global.userPrivileges(1, (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual(data, {\n                    ban: false,\n                    mute: false,\n                    invite: false,\n                    chat: false,\n                    'search:content': false,\n                    'search:users': false,\n                    'search:tags': false,\n                    'view:users:info': false,\n                    'upload:post:image': false,\n                    'upload:post:file': false,\n                    signature: false,\n                    'local:login': false,\n                    'group:create': false,\n                    'view:users': false,\n                    'view:tags': false,\n                    'view:groups': false,\n                });\n\n                done();\n            });\n        });\n\n        it('should load category group privileges', (done) => {\n            privileges.categories.groupPrivileges(categoryObj.cid, 'registered-users', (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual(data, {\n                    'groups:find': true,\n                    'groups:posts:edit': true,\n                    'groups:posts:history': true,\n                    'groups:posts:upvote': true,\n                    'groups:posts:downvote': true,\n                    'groups:topics:delete': false,\n                    'groups:topics:create': true,\n                    'groups:topics:reply': true,\n                    'groups:topics:tag': true,\n                    'groups:topics:schedule': false,\n                    'groups:posts:delete': true,\n                    'groups:read': true,\n                    'groups:topics:read': true,\n                    'groups:purge': false,\n                    'groups:posts:view_deleted': false,\n                    'groups:moderate': false,\n                });\n\n                done();\n            });\n        });\n\n        it('should load global group privileges', (done) => {\n            privileges.global.groupPrivileges('registered-users', (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual(data, {\n                    'groups:ban': false,\n                    'groups:mute': false,\n                    'groups:invite': false,\n                    'groups:chat': true,\n                    'groups:search:content': true,\n                    'groups:search:users': true,\n                    'groups:search:tags': true,\n                    'groups:view:users': true,\n                    'groups:view:users:info': false,\n                    'groups:view:tags': true,\n                    'groups:view:groups': true,\n                    'groups:upload:post:image': true,\n                    'groups:upload:post:file': false,\n                    'groups:signature': true,\n                    'groups:local:login': true,\n                    'groups:group:create': false,\n                });\n\n                done();\n            });\n        });\n\n        it('should return false if cid is falsy', (done) => {\n            privileges.categories.isUserAllowedTo('find', null, adminUid, (err, isAllowed) => {\n                assert.ifError(err);\n                assert.equal(isAllowed, false);\n                done();\n            });\n        });\n\n        describe('Categories.getModeratorUids', () => {\n            before((done) => {\n                async.series([\n                    async.apply(groups.create, { name: 'testGroup' }),\n                    async.apply(groups.join, 'cid:1:privileges:groups:moderate', 'testGroup'),\n                    async.apply(groups.join, 'testGroup', 1),\n                ], done);\n            });\n\n            it('should retrieve all users with moderator bit in category privilege', (done) => {\n                Categories.getModeratorUids([1, 2], (err, uids) => {\n                    assert.ifError(err);\n                    assert.strictEqual(uids.length, 2);\n                    assert(uids[0].includes('1'));\n                    assert.strictEqual(uids[1].length, 0);\n                    done();\n                });\n            });\n\n            it('should not fail when there are multiple groups', (done) => {\n                async.series([\n                    async.apply(groups.create, { name: 'testGroup2' }),\n                    async.apply(groups.join, 'cid:1:privileges:groups:moderate', 'testGroup2'),\n                    async.apply(groups.join, 'testGroup2', 1),\n                    function (next) {\n                        Categories.getModeratorUids([1, 2], (err, uids) => {\n                            assert.ifError(err);\n                            assert(uids[0].includes('1'));\n                            next();\n                        });\n                    },\n                ], done);\n            });\n\n            after((done) => {\n                async.series([\n                    async.apply(groups.leave, 'cid:1:privileges:groups:moderate', 'testGroup'),\n                    async.apply(groups.leave, 'cid:1:privileges:groups:moderate', 'testGroup2'),\n                    async.apply(groups.destroy, 'testGroup'),\n                    async.apply(groups.destroy, 'testGroup2'),\n                ], done);\n            });\n        });\n    });\n\n\n    describe('getTopicIds', () => {\n        const plugins = require('../src/plugins');\n        it('should get topic ids with filter', (done) => {\n            function method(data, callback) {\n                data.tids = [1, 2, 3];\n                callback(null, data);\n            }\n\n            plugins.hooks.register('my-test-plugin', {\n                hook: 'filter:categories.getTopicIds',\n                method: method,\n            });\n\n            Categories.getTopicIds({\n                cid: categoryObj.cid,\n                start: 0,\n                stop: 19,\n            }, (err, tids) => {\n                assert.ifError(err);\n                assert.deepEqual(tids, [1, 2, 3]);\n                plugins.hooks.unregister('my-test-plugin', 'filter:categories.getTopicIds', method);\n                done();\n            });\n        });\n    });\n\n    it('should return nested children categories', async () => {\n        const rootCategory = await Categories.create({ name: 'root' });\n        const child1 = await Categories.create({ name: 'child1', parentCid: rootCategory.cid });\n        const child2 = await Categories.create({ name: 'child2', parentCid: child1.cid });\n        const data = await Categories.getCategoryById({\n            uid: 1,\n            cid: rootCategory.cid,\n            start: 0,\n            stop: 19,\n        });\n        assert.strictEqual(child1.cid, data.children[0].cid);\n        assert.strictEqual(child2.cid, data.children[0].children[0].cid);\n    });\n});\n"},"test/controllers-admin.js":{"tests":[{"id":"1011","name":"Admin Controllers should 403 if user is not admin"},{"id":"1012","name":"Admin Controllers should load admin dashboard"},{"id":"1013","name":"Admin Controllers should load admin analytics"},{"id":"1014","name":"Admin Controllers should load groups page"},{"id":"1015","name":"Admin Controllers should load groups detail page"},{"id":"1016","name":"Admin Controllers should load global privileges page"},{"id":"1017","name":"Admin Controllers should load admin privileges page"},{"id":"1018","name":"Admin Controllers should load privileges page for category 1"},{"id":"1019","name":"Admin Controllers should load manage digests"},{"id":"1020","name":"Admin Controllers should load manage uploads"},{"id":"1021","name":"Admin Controllers should load general settings page"},{"id":"1022","name":"Admin Controllers should load email settings page"},{"id":"1023","name":"Admin Controllers should load user settings page"},{"id":"1024","name":"Admin Controllers should load info page for a user"},{"id":"1025","name":"Admin Controllers should 404 for edit/email page if user does not exist"},{"id":"1026","name":"Admin Controllers should load /admin/settings/homepage"},{"id":"1027","name":"Admin Controllers should load /admin/advanced/database"},{"id":"1028","name":"Admin Controllers should load /admin/extend/plugins"},{"id":"1029","name":"Admin Controllers should load /admin/manage/users"},{"id":"1030","name":"Admin Controllers should load /admin/manage/users?filters=banned"},{"id":"1031","name":"Admin Controllers should load /admin/manage/users?filters=banned&filters=verified"},{"id":"1032","name":"Admin Controllers should load /admin/manage/users?query=admin"},{"id":"1033","name":"Admin Controllers should return empty results if query is too short"},{"id":"1034","name":"Admin Controllers should load /admin/manage/registration"},{"id":"1035","name":"Admin Controllers should 404 if users is not privileged"},{"id":"1036","name":"Admin Controllers should load /api/registration-queue"},{"id":"1037","name":"Admin Controllers should load /admin/manage/admins-mods"},{"id":"1038","name":"Admin Controllers should load /admin/users/csv"},{"id":"1039","name":"Admin Controllers should return 403 if no referer"},{"id":"1040","name":"Admin Controllers should return 403 if referer is not /api/admin/groups/administrators/csv"},{"id":"1041","name":"Admin Controllers should load /api/admin/groups/administrators/csv"},{"id":"1042","name":"Admin Controllers should load /admin/advanced/hooks"},{"id":"1043","name":"Admin Controllers should load /admin/advanced/cache"},{"id":"1044","name":"Admin Controllers should load /api/admin/advanced/cache/dump and 404 with no query param"},{"id":"1045","name":"Admin Controllers should load /api/admin/advanced/cache/dump"},{"id":"1046","name":"Admin Controllers should load /admin/advanced/errors"},{"id":"1047","name":"Admin Controllers should load /admin/advanced/errors/export"},{"id":"1048","name":"Admin Controllers should load /admin/advanced/logs"},{"id":"1049","name":"Admin Controllers should load /admin/settings/navigation"},{"id":"1050","name":"Admin Controllers should load /admin/development/info"},{"id":"1051","name":"Admin Controllers should load /admin/development/logger"},{"id":"1052","name":"Admin Controllers should load /admin/advanced/events"},{"id":"1053","name":"Admin Controllers should load /admin/manage/categories"},{"id":"1054","name":"Admin Controllers should load /admin/manage/categories/1"},{"id":"1055","name":"Admin Controllers should load /admin/manage/catgories?cid=<"+"cid>"},{"id":"1056","name":"Admin Controllers should load /admin/manage/categories/1/analytics"},{"id":"1057","name":"Admin Controllers should load /admin/extend/rewards"},{"id":"1058","name":"Admin Controllers should load /admin/extend/widgets"},{"id":"1059","name":"Admin Controllers should load /admin/settings/languages"},{"id":"1060","name":"Admin Controllers should load /admin/settings/social"},{"id":"1061","name":"Admin Controllers should load /admin/manage/tags"},{"id":"1062","name":"Admin Controllers /post-queue should 404 for regular user"},{"id":"1063","name":"Admin Controllers should load /post-queue"},{"id":"1064","name":"Admin Controllers /ip-blacklist should 404 for regular user"},{"id":"1065","name":"Admin Controllers should load /ip-blacklist"},{"id":"1066","name":"Admin Controllers should load /admin/appearance/themes"},{"id":"1067","name":"Admin Controllers should load /admin/appearance/customise"},{"id":"1068","name":"Admin Controllers should load /recent in maintenance mode"},{"id":"1069","name":"Admin Controllers should escape special characters in config"},{"id":"1070","name":"Admin Controllers mods page should error with no privileges"},{"id":"1071","name":"Admin Controllers mods page should load flags page data"},{"id":"1072","name":"Admin Controllers mods page should return a 404 if flag does not exist"},{"id":"1073","name":"Admin Controllers mods page should error when you attempt to flag a privileged user's post"},{"id":"1074","name":"Admin Controllers mods page should error with not enough reputation to flag"},{"id":"1075","name":"Admin Controllers mods page should return flag details"},{"id":"1076","name":"Admin Controllers admin page privileges should list all admin privileges"},{"id":"1077","name":"Admin Controllers admin page privileges should list user admin privileges"},{"id":"1078","name":"Admin Controllers admin page privileges should check if group has admin group privilege"},{"id":"1079","name":"Admin Controllers admin page privileges should not have admin:privileges"},{"id":"1080","name":"Admin Controllers admin page privileges routeMap parsing should allow normal user access to admin pages"},{"id":"1081","name":"Admin Controllers admin page privileges routePrefixMap parsing should allow normal user access to admin pages"}],"source":"'use strict';\n\nconst async = require('async');\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst request = require('request');\n\nconst db = require('./mocks/databasemock');\nconst categories = require('../src/categories');\nconst topics = require('../src/topics');\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst helpers = require('./helpers');\nconst meta = require('../src/meta');\n\ndescribe('Admin Controllers', () => {\n    let tid;\n    let cid;\n    let pid;\n    let regularPid;\n    let adminUid;\n    let regularUid;\n    let regular2Uid;\n    let moderatorUid;\n    let jar;\n\n    before((done) => {\n        async.series({\n            category: function (next) {\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n            adminUid: function (next) {\n                user.create({ username: 'admin', password: 'barbar' }, next);\n            },\n            regularUid: function (next) {\n                user.create({ username: 'regular', password: 'regularpwd' }, next);\n            },\n            regular2Uid: function (next) {\n                user.create({ username: 'regular2' }, next);\n            },\n            moderatorUid: function (next) {\n                user.create({ username: 'moderator', password: 'modmod' }, next);\n            },\n        }, async (err, results) => {\n            if (err) {\n                return done(err);\n            }\n            adminUid = results.adminUid;\n            regularUid = results.regularUid;\n            regular2Uid = results.regular2Uid;\n            moderatorUid = results.moderatorUid;\n            cid = results.category.cid;\n\n            const adminPost = await topics.post({ uid: adminUid, title: 'test topic title', content: 'test topic content', cid: results.category.cid });\n            assert.ifError(err);\n            tid = adminPost.topicData.tid;\n            pid = adminPost.postData.pid;\n\n            const regularPost = await topics.post({ uid: regular2Uid, title: 'regular user\\'s test topic title', content: 'test topic content', cid: results.category.cid });\n            regularPid = regularPost.postData.pid;\n            done();\n        });\n    });\n\n    it('should 403 if user is not admin', (done) => {\n        helpers.loginUser('admin', 'barbar', (err, data) => {\n            assert.ifError(err);\n            jar = data.jar;\n            request(`${nconf.get('url')}/admin`, { jar: jar }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 403);\n                assert(body);\n                done();\n            });\n        });\n    });\n\n    it('should load admin dashboard', (done) => {\n        groups.join('administrators', adminUid, (err) => {\n            assert.ifError(err);\n            const dashboards = [\n                '/admin', '/admin/dashboard/logins', '/admin/dashboard/users', '/admin/dashboard/topics', '/admin/dashboard/searches',\n            ];\n            async.each(dashboards, (url, next) => {\n                request(`${nconf.get('url')}${url}`, { jar: jar }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(res.statusCode, 200, url);\n                    assert(body);\n\n                    next();\n                });\n            }, done);\n        });\n    });\n\n    it('should load admin analytics', (done) => {\n        request(`${nconf.get('url')}/api/admin/analytics?units=hours`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            assert(body.query);\n            assert(body.result);\n            done();\n        });\n    });\n\n    it('should load groups page', (done) => {\n        request(`${nconf.get('url')}/admin/manage/groups`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load groups detail page', (done) => {\n        request(`${nconf.get('url')}/admin/manage/groups/administrators`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load global privileges page', (done) => {\n        request(`${nconf.get('url')}/admin/manage/privileges`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load admin privileges page', (done) => {\n        request(`${nconf.get('url')}/admin/manage/privileges/admin`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load privileges page for category 1', (done) => {\n        request(`${nconf.get('url')}/admin/manage/privileges/1`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load manage digests', (done) => {\n        request(`${nconf.get('url')}/admin/manage/digest`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load manage uploads', (done) => {\n        request(`${nconf.get('url')}/admin/manage/uploads`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load general settings page', (done) => {\n        request(`${nconf.get('url')}/admin/settings`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load email settings page', (done) => {\n        request(`${nconf.get('url')}/admin/settings/email`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load user settings page', (done) => {\n        request(`${nconf.get('url')}/admin/settings/user`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load info page for a user', (done) => {\n        request(`${nconf.get('url')}/api/user/regular/info`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body.history);\n            assert(Array.isArray(body.history.flags));\n            assert(Array.isArray(body.history.bans));\n            assert(Array.isArray(body.sessions));\n            done();\n        });\n    });\n\n    it('should 404 for edit/email page if user does not exist', (done) => {\n        request(`${nconf.get('url')}/api/user/doesnotexist/edit/email`, { jar: jar, json: true }, (err, res) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should load /admin/settings/homepage', (done) => {\n        request(`${nconf.get('url')}/api/admin/settings/homepage`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body.routes);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/database', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/database`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n\n            if (nconf.get('redis')) {\n                assert(body.redis);\n            } else if (nconf.get('mongo')) {\n                assert(body.mongo);\n            } else if (nconf.get('postgres')) {\n                assert(body.postgres);\n            }\n            done();\n        });\n    });\n\n    it('should load /admin/extend/plugins', function (done) {\n        this.timeout(50000);\n        request(`${nconf.get('url')}/api/admin/extend/plugins`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert(body.hasOwnProperty('installed'));\n            assert(body.hasOwnProperty('upgradeCount'));\n            assert(body.hasOwnProperty('download'));\n            assert(body.hasOwnProperty('incompatible'));\n            done();\n        });\n    });\n\n    it('should load /admin/manage/users', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/users`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.strictEqual(res.statusCode, 200);\n            assert(body);\n            assert(body.users.length > 0);\n            done();\n        });\n    });\n\n\n    it('should load /admin/manage/users?filters=banned', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/users?filters=banned`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.strictEqual(res.statusCode, 200);\n            assert(body);\n            assert.strictEqual(body.users.length, 0);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/users?filters=banned&filters=verified', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/users?filters=banned&filters=verified`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.strictEqual(res.statusCode, 200);\n            assert(body);\n            assert.strictEqual(body.users.length, 0);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/users?query=admin', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/users?query=admin`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.strictEqual(res.statusCode, 200);\n            assert(body);\n            assert.strictEqual(body.users[0].username, 'admin');\n            done();\n        });\n    });\n\n    it('should return empty results if query is too short', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/users?query=a`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.strictEqual(res.statusCode, 200);\n            assert(body);\n            assert.strictEqual(body.users.length, 0);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/registration', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/registration`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should 404 if users is not privileged', (done) => {\n        request(`${nconf.get('url')}/api/registration-queue`, { json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /api/registration-queue', (done) => {\n        request(`${nconf.get('url')}/api/registration-queue`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/admins-mods', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/admins-mods`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/users/csv', (done) => {\n        const socketAdmin = require('../src/socket.io/admin');\n        socketAdmin.user.exportUsersCSV({ uid: adminUid }, {}, (err) => {\n            assert.ifError(err);\n            setTimeout(() => {\n                request(`${nconf.get('url')}/api/admin/users/csv`, {\n                    jar: jar,\n                    headers: {\n                        referer: `${nconf.get('url')}/admin/manage/users`,\n                    },\n                }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(res.statusCode, 200);\n                    assert(body);\n                    done();\n                });\n            }, 2000);\n        });\n    });\n\n    it('should return 403 if no referer', (done) => {\n        request(`${nconf.get('url')}/api/admin/groups/administrators/csv`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 403);\n            assert.equal(body, '[[error:invalid-origin]]');\n            done();\n        });\n    });\n\n    it('should return 403 if referer is not /api/admin/groups/administrators/csv', (done) => {\n        request(`${nconf.get('url')}/api/admin/groups/administrators/csv`, {\n            jar: jar,\n            headers: {\n                referer: '/topic/1/test',\n            },\n        }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 403);\n            assert.equal(body, '[[error:invalid-origin]]');\n            done();\n        });\n    });\n\n    it('should load /api/admin/groups/administrators/csv', (done) => {\n        request(`${nconf.get('url')}/api/admin/groups/administrators/csv`, {\n            jar: jar,\n            headers: {\n                referer: `${nconf.get('url')}/admin/manage/groups`,\n            },\n        }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/hooks', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/hooks`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/cache', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/cache`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /api/admin/advanced/cache/dump and 404 with no query param', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/cache/dump`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /api/admin/advanced/cache/dump', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/cache/dump?name=post`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/errors', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/errors`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/errors/export', (done) => {\n        meta.errors.clear((err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/admin/advanced/errors/export`, { jar: jar }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert.strictEqual(body, '');\n                done();\n            });\n        });\n    });\n\n    it('should load /admin/advanced/logs', (done) => {\n        const fs = require('fs');\n        fs.appendFile(meta.logs.path, 'dummy log', (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/admin/advanced/logs`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n    });\n\n    it('should load /admin/settings/navigation', (done) => {\n        const navigation = require('../src/navigation/admin');\n        const data = require('../install/data/navigation.json');\n\n        navigation.save(data, (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/admin/settings/navigation`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert(body);\n                assert(body.available);\n                assert(body.enabled);\n                done();\n            });\n        });\n    });\n\n    it('should load /admin/development/info', (done) => {\n        request(`${nconf.get('url')}/api/admin/development/info`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/development/logger', (done) => {\n        request(`${nconf.get('url')}/api/admin/development/logger`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/advanced/events', (done) => {\n        request(`${nconf.get('url')}/api/admin/advanced/events`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/categories', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/categories`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/categories/1', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/categories/1`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/manage/catgories?cid=<"+"cid>', async () => {\n        const { cid: rootCid } = await categories.create({ name: 'parent category' });\n        const { cid: childCid } = await categories.create({ name: 'child category', parentCid: rootCid });\n        const { res, body } = await helpers.request('get', `/api/admin/manage/categories?cid=${rootCid}`, {\n            jar: jar,\n            json: true,\n        });\n        assert.strictEqual(res.statusCode, 200);\n        assert.strictEqual(body.categoriesTree[0].cid, rootCid);\n        assert.strictEqual(body.categoriesTree[0].children[0].cid, childCid);\n        assert.strictEqual(body.breadcrumbs[0].text, '[[admin/manage/categories:top-level]]');\n        assert.strictEqual(body.breadcrumbs[1].text, 'parent category');\n    });\n\n    it('should load /admin/manage/categories/1/analytics', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/categories/1/analytics`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/extend/rewards', (done) => {\n        request(`${nconf.get('url')}/api/admin/extend/rewards`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/extend/widgets', (done) => {\n        request(`${nconf.get('url')}/api/admin/extend/widgets`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/settings/languages', (done) => {\n        request(`${nconf.get('url')}/api/admin/settings/languages`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/settings/social', (done) => {\n        const socketAdmin = require('../src/socket.io/admin');\n        socketAdmin.social.savePostSharingNetworks({ uid: adminUid }, ['facebook', 'twitter'], (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/admin/settings/social`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert(body);\n                body = body.posts.map(network => network && network.id);\n                assert(body.includes('facebook'));\n                assert(body.includes('twitter'));\n                done();\n            });\n        });\n    });\n\n    it('should load /admin/manage/tags', (done) => {\n        request(`${nconf.get('url')}/api/admin/manage/tags`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('/post-queue should 404 for regular user', (done) => {\n        request(`${nconf.get('url')}/api/post-queue`, { json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert(body);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should load /post-queue', (done) => {\n        request(`${nconf.get('url')}/api/post-queue`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('/ip-blacklist should 404 for regular user', (done) => {\n        request(`${nconf.get('url')}/api/ip-blacklist`, { json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert(body);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should load /ip-blacklist', (done) => {\n        request(`${nconf.get('url')}/api/ip-blacklist`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/appearance/themes', (done) => {\n        request(`${nconf.get('url')}/api/admin/appearance/themes`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /admin/appearance/customise', (done) => {\n        request(`${nconf.get('url')}/api/admin/appearance/customise`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            done();\n        });\n    });\n\n    it('should load /recent in maintenance mode', (done) => {\n        meta.config.maintenanceMode = 1;\n        request(`${nconf.get('url')}/api/recent`, { jar: jar, json: true }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            meta.config.maintenanceMode = 0;\n            done();\n        });\n    });\n\n    describe('mods page', () => {\n        let moderatorJar;\n        let regularJar;\n        before(async () => {\n            moderatorJar = (await helpers.loginUser('moderator', 'modmod')).jar;\n            regularJar = (await helpers.loginUser('regular', 'regularpwd')).jar;\n            await groups.join(`cid:${cid}:privileges:moderate`, moderatorUid);\n        });\n\n        it('should error with no privileges', (done) => {\n            request(`${nconf.get('url')}/api/flags`, { json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.deepStrictEqual(body, {\n                    status: {\n                        code: 'not-authorised',\n                        message: 'A valid login session was not found. Please log in and try again.',\n                    },\n                    response: {},\n                });\n                done();\n            });\n        });\n\n        it('should load flags page data', (done) => {\n            request(`${nconf.get('url')}/api/flags`, { jar: moderatorJar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert(body);\n                assert(body.flags);\n                assert(body.filters);\n                assert.equal(body.filters.cid.indexOf(cid), -1);\n                done();\n            });\n        });\n\n        it('should return a 404 if flag does not exist', (done) => {\n            request(`${nconf.get('url')}/api/flags/123123123`, {\n                jar: moderatorJar,\n                json: true,\n                headers: {\n                    Accept: 'text/html, application/json',\n                },\n            }, (err, res, body) => {\n                assert.ifError(err);\n                assert.strictEqual(res.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should error when you attempt to flag a privileged user\\'s post', async () => {\n            const { res, body } = await helpers.request('post', '/api/v3/flags', {\n                json: true,\n                jar: regularJar,\n                form: {\n                    id: pid,\n                    type: 'post',\n                    reason: 'spam',\n                },\n            });\n            assert.strictEqual(res.statusCode, 400);\n            assert.strictEqual(body.status.code, 'bad-request');\n            assert.strictEqual(body.status.message, 'You are not allowed to flag the profiles or content of privileged users (moderators/global moderators/admins)');\n        });\n\n        it('should error with not enough reputation to flag', async () => {\n            const oldValue = meta.config['min:rep:flag'];\n            meta.config['min:rep:flag'] = 1000;\n            const { res, body } = await helpers.request('post', '/api/v3/flags', {\n                json: true,\n                jar: regularJar,\n                form: {\n                    id: regularPid,\n                    type: 'post',\n                    reason: 'spam',\n                },\n            });\n            assert.strictEqual(res.statusCode, 400);\n            assert.strictEqual(body.status.code, 'bad-request');\n            assert.strictEqual(body.status.message, 'You need 1000 reputation to flag this post');\n\n            meta.config['min:rep:flag'] = oldValue;\n        });\n\n        it('should return flag details', async () => {\n            const oldValue = meta.config['min:rep:flag'];\n            meta.config['min:rep:flag'] = 0;\n            const result = await helpers.request('post', '/api/v3/flags', {\n                json: true,\n                jar: regularJar,\n                form: {\n                    id: regularPid,\n                    type: 'post',\n                    reason: 'spam',\n                },\n            });\n            meta.config['min:rep:flag'] = oldValue;\n\n            const flagsResult = await helpers.request('get', `/api/flags`, {\n                json: true,\n                jar: moderatorJar,\n            });\n\n            assert(flagsResult.body);\n            assert(Array.isArray(flagsResult.body.flags));\n            const { flagId } = flagsResult.body.flags[0];\n\n            const { body } = await helpers.request('get', `/api/flags/${flagId}`, {\n                json: true,\n                jar: moderatorJar,\n            });\n            assert(body.reports);\n            assert(Array.isArray(body.reports));\n            assert.strictEqual(body.reports[0].reporter.username, 'regular');\n        });\n    });\n\n    it('should escape special characters in config', (done) => {\n        const plugins = require('../src/plugins');\n        function onConfigGet(config, callback) {\n            config.someValue = '\"foo\"';\n            config.otherValue = \"'123'\";\n            config.script = '<"+"/script>';\n            callback(null, config);\n        }\n        plugins.hooks.register('somePlugin', { hook: 'filter:config.get', method: onConfigGet });\n        request(`${nconf.get('url')}/admin`, { jar: jar }, (err, res, body) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 200);\n            assert(body);\n            assert(body.includes('\"someValue\":\"\\\\\\\\\"foo\\\\\\\\\"\"'));\n            assert(body.includes('\"otherValue\":\"\\\\\\'123\\\\\\'\"'));\n            assert(body.includes('\"script\":\"<"+"\\\\/script>\"'));\n            request(nconf.get('url'), { jar: jar }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                assert(body.includes('\"someValue\":\"\\\\\\\\\"foo\\\\\\\\\"\"'));\n                assert(body.includes('\"otherValue\":\"\\\\\\'123\\\\\\'\"'));\n                assert(body.includes('\"script\":\"<"+"\\\\/script>\"'));\n                plugins.hooks.unregister('somePlugin', 'filter:config.get', onConfigGet);\n                done();\n            });\n        });\n    });\n\n    describe('admin page privileges', () => {\n        let userJar;\n        let uid;\n        const privileges = require('../src/privileges');\n        before(async () => {\n            uid = await user.create({ username: 'regularjoe', password: 'barbar' });\n            userJar = (await helpers.loginUser('regularjoe', 'barbar')).jar;\n        });\n\n        describe('routeMap parsing', () => {\n            it('should allow normal user access to admin pages', async function () {\n                this.timeout(50000);\n                function makeRequest(url) {\n                    return new Promise((resolve, reject) => {\n                        request(url, { jar: userJar, json: true }, (err, res, body) => {\n                            if (err) reject(err);\n                            else resolve(res);\n                        });\n                    });\n                }\n                const uploadRoutes = [\n                    'category/uploadpicture',\n                    'uploadfavicon',\n                    'uploadTouchIcon',\n                    'uploadMaskableIcon',\n                    'uploadlogo',\n                    'uploadOgImage',\n                    'uploadDefaultAvatar',\n                ];\n                const adminRoutes = Object.keys(privileges.admin.routeMap)\n                    .filter(route => !uploadRoutes.includes(route));\n                for (const route of adminRoutes) {\n                    /* eslint-disable no-await-in-loop */\n                    await privileges.admin.rescind([privileges.admin.routeMap[route]], uid);\n                    let res = await makeRequest(`${nconf.get('url')}/api/admin/${route}`);\n                    assert.strictEqual(res.statusCode, 403);\n\n                    await privileges.admin.give([privileges.admin.routeMap[route]], uid);\n                    res = await makeRequest(`${nconf.get('url')}/api/admin/${route}`);\n                    assert.strictEqual(res.statusCode, 200);\n\n                    await privileges.admin.rescind([privileges.admin.routeMap[route]], uid);\n                }\n\n                for (const route of adminRoutes) {\n                    /* eslint-disable no-await-in-loop */\n                    await privileges.admin.rescind([privileges.admin.routeMap[route]], uid);\n                    let res = await makeRequest(`${nconf.get('url')}/api/admin`);\n                    assert.strictEqual(res.statusCode, 403);\n\n                    await privileges.admin.give([privileges.admin.routeMap[route]], uid);\n                    res = await makeRequest(`${nconf.get('url')}/api/admin`);\n                    assert.strictEqual(res.statusCode, 200);\n\n                    await privileges.admin.rescind([privileges.admin.routeMap[route]], uid);\n                }\n            });\n        });\n\n        describe('routePrefixMap parsing', () => {\n            it('should allow normal user access to admin pages', async () => {\n                // this.timeout(50000);\n                function makeRequest(url) {\n                    return new Promise((resolve, reject) => {\n                        request(url, { jar: userJar, json: true }, (err, res, body) => {\n                            if (err) reject(err);\n                            else resolve(res);\n                        });\n                    });\n                }\n                for (const route of Object.keys(privileges.admin.routePrefixMap)) {\n                    /* eslint-disable no-await-in-loop */\n                    await privileges.admin.rescind([privileges.admin.routePrefixMap[route]], uid);\n                    let res = await makeRequest(`${nconf.get('url')}/api/admin/${route}foobar/derp`);\n                    assert.strictEqual(res.statusCode, 403);\n\n                    await privileges.admin.give([privileges.admin.routePrefixMap[route]], uid);\n                    res = await makeRequest(`${nconf.get('url')}/api/admin/${route}foobar/derp`);\n                    assert.strictEqual(res.statusCode, 404);\n\n                    await privileges.admin.rescind([privileges.admin.routePrefixMap[route]], uid);\n                }\n            });\n        });\n\n        it('should list all admin privileges', async () => {\n            const privs = await privileges.admin.getPrivilegeList();\n            assert.deepStrictEqual(privs, [\n                'admin:dashboard',\n                'admin:categories',\n                'admin:privileges',\n                'admin:admins-mods',\n                'admin:users',\n                'admin:groups',\n                'admin:tags',\n                'admin:settings',\n                'groups:admin:dashboard',\n                'groups:admin:categories',\n                'groups:admin:privileges',\n                'groups:admin:admins-mods',\n                'groups:admin:users',\n                'groups:admin:groups',\n                'groups:admin:tags',\n                'groups:admin:settings',\n            ]);\n        });\n        it('should list user admin privileges', async () => {\n            const privs = await privileges.admin.userPrivileges(adminUid);\n            assert.deepStrictEqual(privs, {\n                'admin:dashboard': false,\n                'admin:categories': false,\n                'admin:privileges': false,\n                'admin:admins-mods': false,\n                'admin:users': false,\n                'admin:groups': false,\n                'admin:tags': false,\n                'admin:settings': false,\n            });\n        });\n\n        it('should check if group has admin group privilege', async () => {\n            await groups.create({ name: 'some-special-group', private: 1, hidden: 1 });\n            await privileges.admin.give(['groups:admin:users', 'groups:admin:groups'], 'some-special-group');\n            const can = await privileges.admin.canGroup('admin:users', 'some-special-group');\n            assert.strictEqual(can, true);\n            const privs = await privileges.admin.groupPrivileges('some-special-group');\n            assert.deepStrictEqual(privs, {\n                'groups:admin:dashboard': false,\n                'groups:admin:categories': false,\n                'groups:admin:privileges': false,\n                'groups:admin:admins-mods': false,\n                'groups:admin:users': true,\n                'groups:admin:groups': true,\n                'groups:admin:tags': false,\n                'groups:admin:settings': false,\n            });\n        });\n\n        it('should not have admin:privileges', async () => {\n            const res = await privileges.admin.list(regularUid);\n            assert.strictEqual(res.keys.users.includes('admin:privileges'), false);\n            assert.strictEqual(res.keys.groups.includes('admin:privileges'), false);\n        });\n    });\n});\n"},"test/coverPhoto.js":{"tests":[{"id":"1082","name":"coverPhoto should get default group cover"},{"id":"1083","name":"coverPhoto should get default default profile cover"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst coverPhoto = require('../src/coverPhoto');\nconst meta = require('../src/meta');\n\ndescribe('coverPhoto', () => {\n    it('should get default group cover', (done) => {\n        meta.config['groups:defaultCovers'] = '/assets/image1.png, /assets/image2.png';\n        const result = coverPhoto.getDefaultGroupCover('registered-users');\n        assert.equal(result, `${nconf.get('relative_path')}/assets/image2.png`);\n        done();\n    });\n\n    it('should get default default profile cover', (done) => {\n        meta.config['profile:defaultCovers'] = ' /assets/image1.png, /assets/image2.png ';\n        const result = coverPhoto.getDefaultProfileCover(1);\n        assert.equal(result, `${nconf.get('relative_path')}/assets/image2.png`);\n        done();\n    });\n});\n"},"test/database.js":{"tests":[{"id":"1084","name":"Test database should work"},{"id":"1085","name":"Test database info should return info about database"},{"id":"1086","name":"Test database info should not error and return info if client is falsy"},{"id":"1087","name":"Test database checkCompatibility should not throw"},{"id":"1088","name":"Test database checkCompatibility should return error with a too low version"},{"id":"1089","name":"Test database Key methods should set a key without error"},{"id":"1090","name":"Test database Key methods should get a key without error"},{"id":"1091","name":"Test database Key methods should return null if key does not exist"},{"id":"1092","name":"Test database Key methods should return true if key exist"},{"id":"1093","name":"Test database Key methods should return false if key does not exist"},{"id":"1094","name":"Test database Key methods should work for an array of keys"},{"id":"1095","name":"Test database Key methods should delete a key without error"},{"id":"1096","name":"Test database Key methods should return false if key was deleted"},{"id":"1097","name":"Test database Key methods should delete all keys passed in"},{"id":"1098","name":"Test database Key methods should delete all sorted set elements"},{"id":"1099","name":"Test database Key methods scan should scan keys for pattern"},{"id":"1100","name":"Test database Key methods increment should initialize key to 1"},{"id":"1101","name":"Test database Key methods increment should increment key to 2"},{"id":"1102","name":"Test database Key methods increment should set then increment a key"},{"id":"1103","name":"Test database Key methods increment should return the correct value"},{"id":"1104","name":"Test database Key methods rename should rename key to new name"},{"id":"1105","name":"Test database Key methods rename should rename multiple keys"},{"id":"1106","name":"Test database Key methods rename should not error if old key does not exist"},{"id":"1107","name":"Test database Key methods type should return null if key does not exist"},{"id":"1108","name":"Test database Key methods type should return hash as type"},{"id":"1109","name":"Test database Key methods type should return zset as type"},{"id":"1110","name":"Test database Key methods type should return set as type"},{"id":"1111","name":"Test database Key methods type should return list as type"},{"id":"1112","name":"Test database Key methods type should return string as type"},{"id":"1113","name":"Test database Key methods type should expire a key using seconds"},{"id":"1114","name":"Test database Key methods type should expire a key using milliseconds"},{"id":"1115","name":"Test database List methods listAppend() should append to a list"},{"id":"1116","name":"Test database List methods listAppend() should not add anyhing if key is falsy"},{"id":"1117","name":"Test database List methods listAppend() should append each element to list"},{"id":"1118","name":"Test database List methods listPrepend() should prepend to a list"},{"id":"1119","name":"Test database List methods listPrepend() should prepend 2 more elements to a list"},{"id":"1120","name":"Test database List methods listPrepend() should not add anyhing if key is falsy"},{"id":"1121","name":"Test database List methods listPrepend() should prepend each element to list"},{"id":"1122","name":"Test database List methods getListRange() should return an empty list"},{"id":"1123","name":"Test database List methods getListRange() should return a list with one element"},{"id":"1124","name":"Test database List methods getListRange() should return a list with 2 elements 3, 7"},{"id":"1125","name":"Test database List methods getListRange() should not get anything if key is falsy"},{"id":"1126","name":"Test database List methods listRemoveLast() should remove the last element of list and return it"},{"id":"1127","name":"Test database List methods listRemoveLast() should not remove anyhing if key is falsy"},{"id":"1128","name":"Test database List methods listRemoveAll() should remove all the matching elements of list"},{"id":"1129","name":"Test database List methods listRemoveAll() should not remove anyhing if key is falsy"},{"id":"1130","name":"Test database List methods listRemoveAll() should remove multiple elements from list"},{"id":"1131","name":"Test database List methods listTrim() should trim list to a certain range"},{"id":"1132","name":"Test database List methods listTrim() should not add anyhing if key is falsy"},{"id":"1133","name":"Test database List methods listLength should get the length of a list"},{"id":"1134","name":"Test database List methods listLength should return 0 if list does not have any elements"},{"id":"1135","name":"Test database Set methods setAdd() should add to a set"},{"id":"1136","name":"Test database Set methods setAdd() should add an array to a set"},{"id":"1137","name":"Test database Set methods setAdd() should not do anything if values array is empty"},{"id":"1138","name":"Test database Set methods getSetMembers() should return an empty set"},{"id":"1139","name":"Test database Set methods getSetMembers() should return a set with all elements"},{"id":"1140","name":"Test database Set methods setsAdd() should add to multiple sets"},{"id":"1141","name":"Test database Set methods setsAdd() should not error if keys is empty array"},{"id":"1142","name":"Test database Set methods getSetsMembers() should return members of two sets"},{"id":"1143","name":"Test database Set methods isSetMember() should return false if element is not member of set"},{"id":"1144","name":"Test database Set methods isSetMember() should return true if element is a member of set"},{"id":"1145","name":"Test database Set methods isSetMembers() should return an array of booleans"},{"id":"1146","name":"Test database Set methods isMemberOfSets() should return an array of booleans"},{"id":"1147","name":"Test database Set methods setCount() should return the element count of set"},{"id":"1148","name":"Test database Set methods setCount() should return 0 if set does not exist"},{"id":"1149","name":"Test database Set methods setsCount() should return the element count of sets"},{"id":"1150","name":"Test database Set methods setRemove() should remove a element from set"},{"id":"1151","name":"Test database Set methods setRemove() should remove multiple elements from set"},{"id":"1152","name":"Test database Set methods setRemove() should remove multiple values from multiple keys"},{"id":"1153","name":"Test database Set methods setsRemove() should remove a element from multiple sets"},{"id":"1154","name":"Test database Set methods setRemoveRandom() should remove a random element from set"},{"id":"1155","name":"Test database Hash methods setObject() should create a object"},{"id":"1156","name":"Test database Hash methods setObject() should set two objects to same data"},{"id":"1157","name":"Test database Hash methods setObject() should do nothing if key is falsy"},{"id":"1158","name":"Test database Hash methods setObject() should do nothing if data is falsy"},{"id":"1159","name":"Test database Hash methods setObject() should not error if a key is empty string"},{"id":"1160","name":"Test database Hash methods setObject() should work for field names with \".\" in them"},{"id":"1161","name":"Test database Hash methods setObject() should set multiple keys to different objects"},{"id":"1162","name":"Test database Hash methods setObject() should not error if object is empty"},{"id":"1163","name":"Test database Hash methods setObject() should update existing object on second call"},{"id":"1164","name":"Test database Hash methods setObjectField() should create a new object with field"},{"id":"1165","name":"Test database Hash methods setObjectField() should add a new field to an object"},{"id":"1166","name":"Test database Hash methods setObjectField() should set two objects fields to same data"},{"id":"1167","name":"Test database Hash methods setObjectField() should work for field names with \".\" in them"},{"id":"1168","name":"Test database Hash methods setObjectField() should work for field names with \".\" in them when they are cached"},{"id":"1169","name":"Test database Hash methods getObject() should return falsy if object does not exist"},{"id":"1170","name":"Test database Hash methods getObject() should retrieve an object"},{"id":"1171","name":"Test database Hash methods getObject() should return null if key is falsy"},{"id":"1172","name":"Test database Hash methods getObject() should return fields if given"},{"id":"1173","name":"Test database Hash methods getObjects() should return 3 objects with correct data"},{"id":"1174","name":"Test database Hash methods getObjects() should return fields if given"},{"id":"1175","name":"Test database Hash methods getObjectField() should return falsy if object does not exist"},{"id":"1176","name":"Test database Hash methods getObjectField() should return falsy if field does not exist"},{"id":"1177","name":"Test database Hash methods getObjectField() should get an objects field"},{"id":"1178","name":"Test database Hash methods getObjectField() should return null if key is falsy"},{"id":"1179","name":"Test database Hash methods getObjectField() should return null and not error"},{"id":"1180","name":"Test database Hash methods getObjectFields() should return an object with falsy values"},{"id":"1181","name":"Test database Hash methods getObjectFields() should return an object with correct fields"},{"id":"1182","name":"Test database Hash methods getObjectFields() should return null if key is falsy"},{"id":"1183","name":"Test database Hash methods getObjectsFields() should return an array of objects with correct values"},{"id":"1184","name":"Test database Hash methods getObjectsFields() should return undefined for all fields if object does not exist"},{"id":"1185","name":"Test database Hash methods getObjectsFields() should return all fields if fields is empty array"},{"id":"1186","name":"Test database Hash methods getObjectsFields() should return objects if fields is not an array"},{"id":"1187","name":"Test database Hash methods getObjectKeys() should return an empty array for a object that does not exist"},{"id":"1188","name":"Test database Hash methods getObjectKeys() should return an array of keys for the object's fields"},{"id":"1189","name":"Test database Hash methods getObjectValues() should return an empty array for a object that does not exist"},{"id":"1190","name":"Test database Hash methods getObjectValues() should return an array of values for the object's fields"},{"id":"1191","name":"Test database Hash methods isObjectField() should return false if object does not exist"},{"id":"1192","name":"Test database Hash methods isObjectField() should return false if field does not exist"},{"id":"1193","name":"Test database Hash methods isObjectField() should return true if field exists"},{"id":"1194","name":"Test database Hash methods isObjectField() should not error if field is falsy"},{"id":"1195","name":"Test database Hash methods isObjectFields() should return an array of false if object does not exist"},{"id":"1196","name":"Test database Hash methods isObjectFields() should return false if field does not exist"},{"id":"1197","name":"Test database Hash methods isObjectFields() should not error if one field is falsy"},{"id":"1198","name":"Test database Hash methods deleteObjectField() should delete an objects field"},{"id":"1199","name":"Test database Hash methods deleteObjectField() should delete multiple fields of the object"},{"id":"1200","name":"Test database Hash methods deleteObjectField() should delete multiple fields of multiple objects"},{"id":"1201","name":"Test database Hash methods deleteObjectField() should not error if fields is empty array"},{"id":"1202","name":"Test database Hash methods deleteObjectField() should not error if key is undefined"},{"id":"1203","name":"Test database Hash methods deleteObjectField() should not error if key is null"},{"id":"1204","name":"Test database Hash methods deleteObjectField() should not error if field is undefined"},{"id":"1205","name":"Test database Hash methods deleteObjectField() should not error if one of the fields is undefined"},{"id":"1206","name":"Test database Hash methods deleteObjectField() should not error if field is null"},{"id":"1207","name":"Test database Hash methods incrObjectField() should set an objects field to 1 if object does not exist"},{"id":"1208","name":"Test database Hash methods incrObjectField() should increment an object fields by 1 and return it"},{"id":"1209","name":"Test database Hash methods decrObjectField() should set an objects field to -1 if object does not exist"},{"id":"1210","name":"Test database Hash methods decrObjectField() should decrement an object fields by 1 and return it"},{"id":"1211","name":"Test database Hash methods decrObjectField() should decrement multiple objects field by 1 and return an array of new values"},{"id":"1212","name":"Test database Hash methods incrObjectFieldBy() should set an objects field to 5 if object does not exist"},{"id":"1213","name":"Test database Hash methods incrObjectFieldBy() should increment an object fields by passed in value and return it"},{"id":"1214","name":"Test database Hash methods incrObjectFieldBy() should return null if value is NaN"},{"id":"1215","name":"Test database Hash methods incrObjectFieldByBulk should increment multiple object fields"},{"id":"1216","name":"Test database Sorted Set methods sortedSetScan should find matches in sorted set containing substring"},{"id":"1217","name":"Test database Sorted Set methods sortedSetScan should find matches in sorted set with scores"},{"id":"1218","name":"Test database Sorted Set methods sortedSetScan should find matches in sorted set with a limit"},{"id":"1219","name":"Test database Sorted Set methods sortedSetScan should work for special characters"},{"id":"1220","name":"Test database Sorted Set methods sortedSetScan should find everything starting with string"},{"id":"1221","name":"Test database Sorted Set methods sortedSetScan should find everything ending with string"},{"id":"1222","name":"Test database Sorted Set methods sortedSetAdd() should add an element to a sorted set"},{"id":"1223","name":"Test database Sorted Set methods sortedSetAdd() should add two elements to a sorted set"},{"id":"1224","name":"Test database Sorted Set methods sortedSetAdd() should gracefully handle adding the same element twice"},{"id":"1225","name":"Test database Sorted Set methods sortedSetAdd() should error if score is null"},{"id":"1226","name":"Test database Sorted Set methods sortedSetAdd() should error if any score is undefined"},{"id":"1227","name":"Test database Sorted Set methods sortedSetAdd() should add null value as `null` string"},{"id":"1228","name":"Test database Sorted Set methods sortedSetsAdd() should add an element to two sorted sets"},{"id":"1229","name":"Test database Sorted Set methods sortedSetsAdd() should add an element to two sorted sets with different scores"},{"id":"1230","name":"Test database Sorted Set methods sortedSetsAdd() should error if keys.length is different than scores.length"},{"id":"1231","name":"Test database Sorted Set methods sortedSetsAdd() should error if score is null"},{"id":"1232","name":"Test database Sorted Set methods sortedSetsAdd() should error if scores has null"},{"id":"1233","name":"Test database Sorted Set methods sortedSetAddMulti() should add elements into multiple sorted sets with different scores"},{"id":"1234","name":"Test database Sorted Set methods sortedSetAddMulti() should not error if data is undefined"},{"id":"1235","name":"Test database Sorted Set methods sortedSetAddMulti() should error if score is null"},{"id":"1236","name":"Test database Sorted Set methods getSortedSetRange() should return the lowest scored element"},{"id":"1237","name":"Test database Sorted Set methods getSortedSetRange() should return elements sorted by score lowest to highest"},{"id":"1238","name":"Test database Sorted Set methods getSortedSetRange() should return empty array if set does not exist"},{"id":"1239","name":"Test database Sorted Set methods getSortedSetRange() should handle negative start/stop"},{"id":"1240","name":"Test database Sorted Set methods getSortedSetRange() should return empty array if keys is empty array"},{"id":"1241","name":"Test database Sorted Set methods getSortedSetRange() should return duplicates if two sets have same elements"},{"id":"1242","name":"Test database Sorted Set methods getSortedSetRange() should return correct number of elements"},{"id":"1243","name":"Test database Sorted Set methods getSortedSetRange() should work with big arrays (length > 100) "},{"id":"1244","name":"Test database Sorted Set methods getSortedSetRevRange() should return the highest scored element"},{"id":"1245","name":"Test database Sorted Set methods getSortedSetRevRange() should return elements sorted by score highest to lowest"},{"id":"1246","name":"Test database Sorted Set methods getSortedSetRangeWithScores() should return array of elements sorted by score lowest to highest with scores"},{"id":"1247","name":"Test database Sorted Set methods getSortedSetRevRangeWithScores() should return array of elements sorted by score highest to lowest with scores"},{"id":"1248","name":"Test database Sorted Set methods getSortedSetRangeByScore() should get count elements with score between min max sorted by score lowest to highest"},{"id":"1249","name":"Test database Sorted Set methods getSortedSetRangeByScore() should return empty array if set does not exist"},{"id":"1250","name":"Test database Sorted Set methods getSortedSetRangeByScore() should return empty array if count is 0"},{"id":"1251","name":"Test database Sorted Set methods getSortedSetRangeByScore() should return elements from 1 to end"},{"id":"1252","name":"Test database Sorted Set methods getSortedSetRangeByScore() should return elements from 3 to last"},{"id":"1253","name":"Test database Sorted Set methods getSortedSetRevRangeByScore() should get count elements with score between max min sorted by score highest to lowest"},{"id":"1254","name":"Test database Sorted Set methods getSortedSetRangeByScoreWithScores() should get count elements with score between min max sorted by score lowest to highest with scores"},{"id":"1255","name":"Test database Sorted Set methods getSortedSetRevRangeByScoreWithScores() should get count elements with score between max min sorted by score highest to lowest"},{"id":"1256","name":"Test database Sorted Set methods getSortedSetRevRangeByScoreWithScores() should work with an array of keys"},{"id":"1257","name":"Test database Sorted Set methods sortedSetCount() should return 0 for a sorted set that does not exist"},{"id":"1258","name":"Test database Sorted Set methods sortedSetCount() should return number of elements between scores min max inclusive"},{"id":"1259","name":"Test database Sorted Set methods sortedSetCount() should return number of elements between scores -inf +inf inclusive"},{"id":"1260","name":"Test database Sorted Set methods sortedSetCard() should return 0 for a sorted set that does not exist"},{"id":"1261","name":"Test database Sorted Set methods sortedSetCard() should return number of elements in a sorted set"},{"id":"1262","name":"Test database Sorted Set methods sortedSetsCard() should return the number of elements in sorted sets"},{"id":"1263","name":"Test database Sorted Set methods sortedSetsCard() should return empty array if keys is falsy"},{"id":"1264","name":"Test database Sorted Set methods sortedSetsCard() should return empty array if keys is empty array"},{"id":"1265","name":"Test database Sorted Set methods sortedSetsCardSum() should return the total number of elements in sorted sets"},{"id":"1266","name":"Test database Sorted Set methods sortedSetsCardSum() should return 0 if keys is falsy"},{"id":"1267","name":"Test database Sorted Set methods sortedSetsCardSum() should return 0 if keys is empty array"},{"id":"1268","name":"Test database Sorted Set methods sortedSetsCardSum() should return the total number of elements in sorted set"},{"id":"1269","name":"Test database Sorted Set methods sortedSetRank() should return falsy if sorted set does not exist"},{"id":"1270","name":"Test database Sorted Set methods sortedSetRank() should return falsy if element isnt in sorted set"},{"id":"1271","name":"Test database Sorted Set methods sortedSetRank() should return the rank of the element in the sorted set sorted by lowest to highest score"},{"id":"1272","name":"Test database Sorted Set methods sortedSetRank() should return the rank sorted by the score and then the value (a)"},{"id":"1273","name":"Test database Sorted Set methods sortedSetRank() should return the rank sorted by the score and then the value (b)"},{"id":"1274","name":"Test database Sorted Set methods sortedSetRank() should return the rank sorted by the score and then the value (c)"},{"id":"1275","name":"Test database Sorted Set methods sortedSetRevRank() should return falsy if sorted set doesnot exist"},{"id":"1276","name":"Test database Sorted Set methods sortedSetRevRank() should return falsy if element isnt in sorted set"},{"id":"1277","name":"Test database Sorted Set methods sortedSetRevRank() should return the rank of the element in the sorted set sorted by highest to lowest score"},{"id":"1278","name":"Test database Sorted Set methods sortedSetsRanks() should return the ranks of values in sorted sets"},{"id":"1279","name":"Test database Sorted Set methods sortedSetRanks() should return the ranks of values in a sorted set"},{"id":"1280","name":"Test database Sorted Set methods sortedSetRanks() should return the ranks of values in a sorted set in reverse"},{"id":"1281","name":"Test database Sorted Set methods sortedSetScore() should return falsy if sorted set does not exist"},{"id":"1282","name":"Test database Sorted Set methods sortedSetScore() should return falsy if element is not in sorted set"},{"id":"1283","name":"Test database Sorted Set methods sortedSetScore() should return the score of an element"},{"id":"1284","name":"Test database Sorted Set methods sortedSetScore() should not error if key is undefined"},{"id":"1285","name":"Test database Sorted Set methods sortedSetScore() should not error if value is undefined"},{"id":"1286","name":"Test database Sorted Set methods sortedSetsScore() should return the scores of value in sorted sets"},{"id":"1287","name":"Test database Sorted Set methods sortedSetsScore() should return scores even if some keys are undefined"},{"id":"1288","name":"Test database Sorted Set methods sortedSetsScore() should return empty array if keys is empty array"},{"id":"1289","name":"Test database Sorted Set methods sortedSetScores() should return 0 if score is 0"},{"id":"1290","name":"Test database Sorted Set methods sortedSetScores() should return the scores of value in sorted sets"},{"id":"1291","name":"Test database Sorted Set methods sortedSetScores() should return scores even if some values are undefined"},{"id":"1292","name":"Test database Sorted Set methods sortedSetScores() should return empty array if values is an empty array"},{"id":"1293","name":"Test database Sorted Set methods sortedSetScores() should return scores properly"},{"id":"1294","name":"Test database Sorted Set methods isSortedSetMember() should return false if sorted set does not exist"},{"id":"1295","name":"Test database Sorted Set methods isSortedSetMember() should return false if element is not in sorted set"},{"id":"1296","name":"Test database Sorted Set methods isSortedSetMember() should return true if element is in sorted set"},{"id":"1297","name":"Test database Sorted Set methods isSortedSetMember() should return true if element is in sorted set with score 0"},{"id":"1298","name":"Test database Sorted Set methods isSortedSetMembers() should return an array of booleans indicating membership"},{"id":"1299","name":"Test database Sorted Set methods isSortedSetMembers() should return true if element is in sorted set with score 0"},{"id":"1300","name":"Test database Sorted Set methods isMemberOfSortedSets should return true for members false for non members"},{"id":"1301","name":"Test database Sorted Set methods isMemberOfSortedSets should return empty array if keys is empty array"},{"id":"1302","name":"Test database Sorted Set methods getSortedSetsMembers should return members of a sorted set"},{"id":"1303","name":"Test database Sorted Set methods getSortedSetsMembers should return members of multiple sorted sets"},{"id":"1304","name":"Test database Sorted Set methods sortedSetUnionCard should return the number of elements in the union"},{"id":"1305","name":"Test database Sorted Set methods getSortedSetUnion() should return an array of values from both sorted sets sorted by scores lowest to highest"},{"id":"1306","name":"Test database Sorted Set methods getSortedSetUnion() should return an array of values and scores from both sorted sets sorted by scores lowest to highest"},{"id":"1307","name":"Test database Sorted Set methods getSortedSetRevUnion() should return an array of values from both sorted sets sorted by scores highest to lowest"},{"id":"1308","name":"Test database Sorted Set methods sortedSetIncrBy() should create a sorted set with a field set to 1"},{"id":"1309","name":"Test database Sorted Set methods sortedSetIncrBy() should increment a field of a sorted set by 5"},{"id":"1310","name":"Test database Sorted Set methods sortedSetIncrBy() should increment fields of sorted sets with a single call"},{"id":"1311","name":"Test database Sorted Set methods sortedSetIncrBy() should increment the same field"},{"id":"1312","name":"Test database Sorted Set methods sortedSetRemove() should remove an element from a sorted set"},{"id":"1313","name":"Test database Sorted Set methods sortedSetRemove() should not think the sorted set exists if the last element is removed"},{"id":"1314","name":"Test database Sorted Set methods sortedSetRemove() should remove multiple values from multiple keys"},{"id":"1315","name":"Test database Sorted Set methods sortedSetRemove() should remove value from multiple keys"},{"id":"1316","name":"Test database Sorted Set methods sortedSetRemove() should not remove anything if values is empty array"},{"id":"1317","name":"Test database Sorted Set methods sortedSetRemove() should do a bulk remove"},{"id":"1318","name":"Test database Sorted Set methods sortedSetRemove() should not remove wrong elements in bulk remove"},{"id":"1319","name":"Test database Sorted Set methods sortedSetsRemove() should remove element from multiple sorted sets"},{"id":"1320","name":"Test database Sorted Set methods sortedSetsRemoveRangeByScore() should remove elements with scores between min max inclusive"},{"id":"1321","name":"Test database Sorted Set methods sortedSetsRemoveRangeByScore() should remove elements with if strin score is passed in"},{"id":"1322","name":"Test database Sorted Set methods getSortedSetIntersect should return the intersection of two sets"},{"id":"1323","name":"Test database Sorted Set methods getSortedSetIntersect should return the intersection of two sets with scores"},{"id":"1324","name":"Test database Sorted Set methods getSortedSetIntersect should return the reverse intersection of two sets"},{"id":"1325","name":"Test database Sorted Set methods getSortedSetIntersect should return the intersection of two sets with scores aggregate MIN"},{"id":"1326","name":"Test database Sorted Set methods getSortedSetIntersect should return the intersection of two sets with scores aggregate MAX"},{"id":"1327","name":"Test database Sorted Set methods getSortedSetIntersect should return the intersection with scores modified by weights"},{"id":"1328","name":"Test database Sorted Set methods getSortedSetIntersect should return empty array if sets do not exist"},{"id":"1329","name":"Test database Sorted Set methods getSortedSetIntersect should return empty array if one set does not exist"},{"id":"1330","name":"Test database Sorted Set methods getSortedSetIntersect should return correct results if sorting by different zset"},{"id":"1331","name":"Test database Sorted Set methods getSortedSetIntersect should return correct results when intersecting big zsets"},{"id":"1332","name":"Test database Sorted Set methods sortedSetIntersectCard should return # of elements in intersection"},{"id":"1333","name":"Test database Sorted Set methods sortedSetIntersectCard should return 0 if intersection is empty"},{"id":"1334","name":"Test database Sorted Set methods getSortedSetRangeByLex should return an array of all values"},{"id":"1335","name":"Test database Sorted Set methods getSortedSetRangeByLex should return an array with an inclusive range by default"},{"id":"1336","name":"Test database Sorted Set methods getSortedSetRangeByLex should return an array with an inclusive range"},{"id":"1337","name":"Test database Sorted Set methods getSortedSetRangeByLex should return an array with an exclusive range"},{"id":"1338","name":"Test database Sorted Set methods getSortedSetRangeByLex should return an array limited to the first two values"},{"id":"1339","name":"Test database Sorted Set methods getSortedSetRangeByLex should return correct result"},{"id":"1340","name":"Test database Sorted Set methods getSortedSetRevRangeByLex should return an array of all values reversed"},{"id":"1341","name":"Test database Sorted Set methods getSortedSetRevRangeByLex should return an array with an inclusive range by default reversed"},{"id":"1342","name":"Test database Sorted Set methods getSortedSetRevRangeByLex should return an array with an inclusive range reversed"},{"id":"1343","name":"Test database Sorted Set methods getSortedSetRevRangeByLex should return an array with an exclusive range reversed"},{"id":"1344","name":"Test database Sorted Set methods getSortedSetRevRangeByLex should return an array limited to the first two values reversed"},{"id":"1345","name":"Test database Sorted Set methods sortedSetLexCount should return the count of all values"},{"id":"1346","name":"Test database Sorted Set methods sortedSetLexCount should return the count with an inclusive range by default"},{"id":"1347","name":"Test database Sorted Set methods sortedSetLexCount should return the count with an inclusive range"},{"id":"1348","name":"Test database Sorted Set methods sortedSetLexCount should return the count with an exclusive range"},{"id":"1349","name":"Test database Sorted Set methods sortedSetRemoveRangeByLex should remove an inclusive range by default"},{"id":"1350","name":"Test database Sorted Set methods sortedSetRemoveRangeByLex should remove an inclusive range"},{"id":"1351","name":"Test database Sorted Set methods sortedSetRemoveRangeByLex should remove an exclusive range"},{"id":"1352","name":"Test database Sorted Set methods sortedSetRemoveRangeByLex should remove all values"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst db = require('./mocks/databasemock');\n\n\ndescribe('Test database', () => {\n    it('should work', () => {\n        assert.doesNotThrow(() => {\n            require('./mocks/databasemock');\n        });\n    });\n\n    describe('info', () => {\n        it('should return info about database', (done) => {\n            db.info(db.client, (err, info) => {\n                assert.ifError(err);\n                assert(info);\n                done();\n            });\n        });\n\n        it('should not error and return info if client is falsy', (done) => {\n            db.info(null, (err, info) => {\n                assert.ifError(err);\n                assert(info);\n                done();\n            });\n        });\n    });\n\n    describe('checkCompatibility', () => {\n        it('should not throw', (done) => {\n            db.checkCompatibility(done);\n        });\n\n        it('should return error with a too low version', (done) => {\n            const dbName = nconf.get('database');\n            if (dbName === 'redis') {\n                db.checkCompatibilityVersion('2.4.0', (err) => {\n                    assert.equal(err.message, 'Your Redis version is not new enough to support NodeBB, please upgrade Redis to v2.8.9 or higher.');\n                    done();\n                });\n            } else if (dbName === 'mongo') {\n                db.checkCompatibilityVersion('1.8.0', (err) => {\n                    assert.equal(err.message, 'The `mongodb` package is out-of-date, please run `./nodebb setup` again.');\n                    done();\n                });\n            } else if (dbName === 'postgres') {\n                db.checkCompatibilityVersion('6.3.0', (err) => {\n                    assert.equal(err.message, 'The `pg` package is out-of-date, please run `./nodebb setup` again.');\n                    done();\n                });\n            }\n        });\n    });\n\n\n    require('./database/keys');\n    require('./database/list');\n    require('./database/sets');\n    require('./database/hash');\n    require('./database/sorted');\n});\n"},"test/emailer.js":{"tests":[{"id":"1353","name":"emailer plugin hook should work"},{"id":"1354","name":"emailer should build custom template on config change"},{"id":"1355","name":"emailer should send via SMTP"},{"id":"1356","name":"emailer emailer.send() should not send email to a banned user"},{"id":"1357","name":"emailer emailer.send() should return true if the template is \"banned\""},{"id":"1358","name":"emailer emailer.send() should return true if system settings allow sending to banned users"}],"source":"'use strict';\n\nconst { SMTPServer } = require('smtp-server');\nconst assert = require('assert');\nconst fs = require('fs');\nconst path = require('path');\n\nconst db = require('./mocks/databasemock');\nconst Plugins = require('../src/plugins');\nconst Emailer = require('../src/emailer');\nconst user = require('../src/user');\nconst meta = require('../src/meta');\nconst Meta = require('../src/meta');\n\ndescribe('emailer', () => {\n    let onMail = function (address, session, callback) { callback(); };\n    let onTo = function (address, session, callback) { callback(); };\n\n    const template = 'test';\n    const email = 'test@example.org';\n    const language = 'en-GB';\n    const params = {\n        subject: 'Welcome to NodeBB',\n    };\n\n    before((done) => {\n        const server = new SMTPServer({\n            allowInsecureAuth: true,\n            onAuth: function (auth, session, callback) {\n                callback(null, {\n                    user: auth.username,\n                });\n            },\n            onMailFrom: function (address, session, callback) {\n                onMail(address, session, callback);\n            },\n            onRcptTo: function (address, session, callback) {\n                onTo(address, session, callback);\n            },\n        });\n\n        server.on('error', (err) => {\n            throw err;\n        });\n        server.listen(4000, done);\n    });\n\n    // TODO: test sendmail here at some point\n\n    it('plugin hook should work', (done) => {\n        const error = new Error();\n        const method = function (data, next) {\n            assert(data);\n            assert.equal(data.to, email);\n            assert.equal(data.subject, `[NodeBB] ${params.subject}`);\n\n            next(error);\n        };\n\n        Plugins.hooks.register('emailer-test', {\n            hook: 'filter:email.send',\n            method,\n        });\n\n        Emailer.sendToEmail(template, email, language, params, (err) => {\n            assert.equal(err, error);\n\n            Plugins.hooks.unregister('emailer-test', 'filter:email.send', method);\n            done();\n        });\n    });\n\n    it('should build custom template on config change', (done) => {\n        const text = 'a random string of text';\n\n        // make sure it's not already set\n        Emailer.renderAndTranslate('test', {}, 'en-GB', (err, output) => {\n            assert.ifError(err);\n\n            assert.notEqual(output, text);\n\n            Meta.configs.set('email:custom:test', text, (err) => {\n                assert.ifError(err);\n\n                // wait for pubsub stuff\n                setTimeout(() => {\n                    Emailer.renderAndTranslate('test', {}, 'en-GB', (err, output) => {\n                        assert.ifError(err);\n\n                        assert.equal(output, text);\n                        done();\n                    });\n                }, 2000);\n            });\n        });\n    });\n\n    it('should send via SMTP', (done) => {\n        const from = 'admin@example.org';\n        const username = 'another@example.com';\n\n        onMail = function (address, session, callback) {\n            assert.equal(address.address, from);\n            assert.equal(session.user, username);\n\n            callback();\n        };\n\n        onTo = function (address, session, callback) {\n            assert.equal(address.address, email);\n\n            callback();\n            done();\n        };\n\n        Meta.configs.setMultiple({\n            'email:smtpTransport:enabled': '1',\n            'email:smtpTransport:user': username,\n            'email:smtpTransport:pass': 'anything',\n            'email:smtpTransport:service': 'nodebb-custom-smtp',\n            'email:smtpTransport:port': 4000,\n            'email:smtpTransport:host': 'localhost',\n            'email:smtpTransport:security': 'NONE',\n            'email:from': from,\n        }, (err) => {\n            assert.ifError(err);\n\n            // delay so emailer has a chance to update after config changes\n            setTimeout(() => {\n                assert.equal(Emailer.fallbackTransport, Emailer.transports.smtp);\n\n                Emailer.sendToEmail(template, email, language, params, (err) => {\n                    assert.ifError(err);\n                });\n            }, 200);\n        });\n    });\n\n    after((done) => {\n        fs.unlinkSync(path.join(__dirname, '../build/public/templates/emails/test.js'));\n        Meta.configs.setMultiple({\n            'email:smtpTransport:enabled': '0',\n            'email:custom:test': '',\n        }, done);\n    });\n\n    describe('emailer.send()', () => {\n        let recipientUid;\n\n        before(async () => {\n            recipientUid = await user.create({ username: 'recipient', email: 'test@example.org' });\n            await user.email.confirmByUid(recipientUid);\n        });\n\n        it('should not send email to a banned user', async () => {\n            const method = async () => {\n                assert(false); // if thrown, email was sent\n            };\n            Plugins.hooks.register('emailer-test', {\n                hook: 'filter:email.send',\n                method,\n            });\n\n            await user.bans.ban(recipientUid);\n            await Emailer.send('test', recipientUid, {});\n\n            Plugins.hooks.unregister('emailer-test', 'filter:email.send', method);\n        });\n\n        it('should return true if the template is \"banned\"', async () => {\n            const method = async () => {\n                assert(true); // if thrown, email was sent\n            };\n            Plugins.hooks.register('emailer-test', {\n                hook: 'filter:email.send',\n                method,\n            });\n\n            await Emailer.send('banned', recipientUid, {});\n            Plugins.hooks.unregister('emailer-test', 'filter:email.send', method);\n        });\n\n        it('should return true if system settings allow sending to banned users', async () => {\n            const method = async () => {\n                assert(true); // if thrown, email was sent\n            };\n            Plugins.hooks.register('emailer-test', {\n                hook: 'filter:email.send',\n                method,\n            });\n\n            meta.config.sendEmailToBanned = 1;\n            await Emailer.send('test', recipientUid, {});\n            meta.config.sendEmailToBanned = 0;\n            await user.bans.unban(recipientUid);\n\n            Plugins.hooks.unregister('emailer-test', 'filter:email.send', method);\n        });\n    });\n});\n"},"test/feeds.js":{"tests":[{"id":"1359","name":"feeds should 404"},{"id":"1360","name":"feeds should 404 if topic does not exist"},{"id":"1361","name":"feeds should 404 if category id is not a number"},{"id":"1362","name":"feeds should redirect if we do not have read privilege"},{"id":"1363","name":"feeds should 404 if user is not found"},{"id":"1364","name":"feeds private feeds and tokens should load feed if its not private"},{"id":"1365","name":"feeds private feeds and tokens should not allow access if uid or token is missing"},{"id":"1366","name":"feeds private feeds and tokens should not allow access if token is wrong"},{"id":"1367","name":"feeds private feeds and tokens should allow access if token is correct"},{"id":"1368","name":"feeds private feeds and tokens should not allow access if token is correct but has no privilege"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\nconst request = require('request');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst topics = require('../src/topics');\nconst categories = require('../src/categories');\nconst groups = require('../src/groups');\nconst user = require('../src/user');\nconst meta = require('../src/meta');\nconst privileges = require('../src/privileges');\nconst helpers = require('./helpers');\n\ndescribe('feeds', () => {\n    let tid;\n    let pid;\n    let fooUid;\n    let cid;\n    before((done) => {\n        meta.config['feeds:disableRSS'] = 1;\n        async.series({\n            category: function (next) {\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n            user: function (next) {\n                user.create({ username: 'foo', password: 'barbar', email: 'foo@test.com' }, next);\n            },\n        }, (err, results) => {\n            if (err) {\n                return done(err);\n            }\n            cid = results.category.cid;\n            fooUid = results.user;\n\n            topics.post({ uid: results.user, title: 'test topic title', content: 'test topic content', cid: results.category.cid }, (err, result) => {\n                tid = result.topicData.tid;\n                pid = result.postData.pid;\n                done(err);\n            });\n        });\n    });\n\n\n    it('should 404', (done) => {\n        const feedUrls = [\n            `${nconf.get('url')}/topic/${tid}.rss`,\n            `${nconf.get('url')}/category/${cid}.rss`,\n            `${nconf.get('url')}/topics.rss`,\n            `${nconf.get('url')}/recent.rss`,\n            `${nconf.get('url')}/top.rss`,\n            `${nconf.get('url')}/popular.rss`,\n            `${nconf.get('url')}/popular/day.rss`,\n            `${nconf.get('url')}/recentposts.rss`,\n            `${nconf.get('url')}/category/${cid}/recentposts.rss`,\n            `${nconf.get('url')}/user/foo/topics.rss`,\n            `${nconf.get('url')}/tags/nodebb.rss`,\n        ];\n        async.eachSeries(feedUrls, (url, next) => {\n            request(url, (err, res) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 404);\n                next();\n            });\n        }, (err) => {\n            assert.ifError(err);\n            meta.config['feeds:disableRSS'] = 0;\n            done();\n        });\n    });\n\n    it('should 404 if topic does not exist', (done) => {\n        request(`${nconf.get('url')}/topic/${1000}.rss`, (err, res) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should 404 if category id is not a number', (done) => {\n        request(`${nconf.get('url')}/category/invalid.rss`, (err, res) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should redirect if we do not have read privilege', (done) => {\n        privileges.categories.rescind(['groups:topics:read'], cid, 'guests', (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/topic/${tid}.rss`, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                assert(body.includes('Login to your account'));\n                privileges.categories.give(['groups:topics:read'], cid, 'guests', done);\n            });\n        });\n    });\n\n    it('should 404 if user is not found', (done) => {\n        request(`${nconf.get('url')}/user/doesnotexist/topics.rss`, (err, res) => {\n            assert.ifError(err);\n            assert.equal(res.statusCode, 404);\n            done();\n        });\n    });\n\n    it('should redirect if we do not have read privilege', (done) => {\n        privileges.categories.rescind(['groups:read'], cid, 'guests', (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/category/${cid}.rss`, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                assert(body.includes('Login to your account'));\n                privileges.categories.give(['groups:read'], cid, 'guests', done);\n            });\n        });\n    });\n\n    describe('private feeds and tokens', () => {\n        let jar;\n        let rssToken;\n        before(async () => {\n            ({ jar } = await helpers.loginUser('foo', 'barbar'));\n        });\n\n        it('should load feed if its not private', (done) => {\n            request(`${nconf.get('url')}/category/${cid}.rss`, { }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n\n\n        it('should not allow access if uid or token is missing', (done) => {\n            privileges.categories.rescind(['groups:read'], cid, 'guests', (err) => {\n                assert.ifError(err);\n                async.parallel({\n                    test1: function (next) {\n                        request(`${nconf.get('url')}/category/${cid}.rss?uid=${fooUid}`, { }, next);\n                    },\n                    test2: function (next) {\n                        request(`${nconf.get('url')}/category/${cid}.rss?token=sometoken`, { }, next);\n                    },\n                }, (err, results) => {\n                    assert.ifError(err);\n                    assert.equal(results.test1[0].statusCode, 200);\n                    assert.equal(results.test2[0].statusCode, 200);\n                    assert(results.test1[0].body.includes('Login to your account'));\n                    assert(results.test2[0].body.includes('Login to your account'));\n                    done();\n                });\n            });\n        });\n\n        it('should not allow access if token is wrong', (done) => {\n            request(`${nconf.get('url')}/category/${cid}.rss?uid=${fooUid}&token=sometoken`, { }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body.includes('Login to your account'));\n                done();\n            });\n        });\n\n        it('should allow access if token is correct', (done) => {\n            request(`${nconf.get('url')}/api/category/${cid}`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                rssToken = body.rssFeedUrl.split('token')[1].slice(1);\n                request(`${nconf.get('url')}/category/${cid}.rss?uid=${fooUid}&token=${rssToken}`, { }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(res.statusCode, 200);\n                    assert(body.startsWith('<"+"?xml version=\"1.0\"'));\n                    done();\n                });\n            });\n        });\n\n        it('should not allow access if token is correct but has no privilege', (done) => {\n            privileges.categories.rescind(['groups:read'], cid, 'registered-users', (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/category/${cid}.rss?uid=${fooUid}&token=${rssToken}`, { }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(res.statusCode, 200);\n                    assert(body.includes('Login to your account'));\n                    done();\n                });\n            });\n        });\n    });\n});\n"},"test/file.js":{"tests":[{"id":"1369","name":"file should walk directory"},{"id":"1370","name":"file should convert mime type to extension"},{"id":"1371","name":"file copyFile should copy a file"},{"id":"1372","name":"file copyFile should override an existing file"},{"id":"1373","name":"file copyFile should error if source file does not exist"},{"id":"1374","name":"file copyFile should error if existing file is read only"},{"id":"1375","name":"file saveFileToLocal should work"},{"id":"1376","name":"file saveFileToLocal should error if source does not exist"},{"id":"1377","name":"file saveFileToLocal should error if folder is relative"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst fs = require('fs');\nconst path = require('path');\nconst nconf = require('nconf');\n\nconst utils = require('../src/utils');\nconst file = require('../src/file');\n\ndescribe('file', () => {\n    const filename = `${utils.generateUUID()}.png`;\n    const folder = 'files';\n    const uploadPath = path.join(nconf.get('upload_path'), folder, filename);\n    const tempPath = path.join(__dirname, './files/test.png');\n\n    afterEach((done) => {\n        fs.unlink(uploadPath, () => {\n            done();\n        });\n    });\n\n    describe('copyFile', () => {\n        it('should copy a file', (done) => {\n            fs.copyFile(tempPath, uploadPath, (err) => {\n                assert.ifError(err);\n\n                assert(file.existsSync(uploadPath));\n\n                const srcContent = fs.readFileSync(tempPath, 'utf8');\n                const destContent = fs.readFileSync(uploadPath, 'utf8');\n\n                assert.strictEqual(srcContent, destContent);\n                done();\n            });\n        });\n\n        it('should override an existing file', (done) => {\n            fs.writeFileSync(uploadPath, 'hsdkjhgkjsfhkgj');\n\n            fs.copyFile(tempPath, uploadPath, (err) => {\n                assert.ifError(err);\n\n                assert(file.existsSync(uploadPath));\n\n                const srcContent = fs.readFileSync(tempPath, 'utf8');\n                const destContent = fs.readFileSync(uploadPath, 'utf8');\n\n                assert.strictEqual(srcContent, destContent);\n                done();\n            });\n        });\n\n        it('should error if source file does not exist', (done) => {\n            fs.copyFile(`${tempPath}0000000000`, uploadPath, (err) => {\n                assert(err);\n                assert.strictEqual(err.code, 'ENOENT');\n\n                done();\n            });\n        });\n\n        it('should error if existing file is read only', (done) => {\n            fs.writeFileSync(uploadPath, 'hsdkjhgkjsfhkgj');\n            fs.chmodSync(uploadPath, '444');\n\n            fs.copyFile(tempPath, uploadPath, (err) => {\n                assert(err);\n                assert(err.code === 'EPERM' || err.code === 'EACCES');\n\n                done();\n            });\n        });\n    });\n\n    describe('saveFileToLocal', () => {\n        it('should work', (done) => {\n            file.saveFileToLocal(filename, folder, tempPath, (err) => {\n                assert.ifError(err);\n\n                assert(file.existsSync(uploadPath));\n\n                const oldFile = fs.readFileSync(tempPath, 'utf8');\n                const newFile = fs.readFileSync(uploadPath, 'utf8');\n                assert.strictEqual(oldFile, newFile);\n\n                done();\n            });\n        });\n\n        it('should error if source does not exist', (done) => {\n            file.saveFileToLocal(filename, folder, `${tempPath}000000000`, (err) => {\n                assert(err);\n                assert.strictEqual(err.code, 'ENOENT');\n\n                done();\n            });\n        });\n\n        it('should error if folder is relative', (done) => {\n            file.saveFileToLocal(filename, '../../text', `${tempPath}000000000`, (err) => {\n                assert(err);\n                assert.strictEqual(err.message, '[[error:invalid-path]]');\n                done();\n            });\n        });\n    });\n\n    it('should walk directory', (done) => {\n        file.walk(__dirname, (err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            done();\n        });\n    });\n\n    it('should convert mime type to extension', (done) => {\n        assert.equal(file.typeToExtension('image/png'), '.png');\n        assert.equal(file.typeToExtension(''), '');\n        done();\n    });\n});\n"},"test/flags.js":{"tests":[{"id":"1378","name":"Flags .create() should create a flag and return its data"},{"id":"1379","name":"Flags .create() should add the flag to the byCid zset for category 1 if it is of type post"},{"id":"1380","name":"Flags .create() should add the flag to the byPid zset for pid 1 if it is of type post"},{"id":"1381","name":"Flags .exists() should return Boolean True if a flag matching the flag hash already exists"},{"id":"1382","name":"Flags .exists() should return Boolean False if a flag matching the flag hash does not already exists"},{"id":"1383","name":"Flags .targetExists() should return Boolean True if the targeted element exists"},{"id":"1384","name":"Flags .targetExists() should return Boolean False if the targeted element does not exist"},{"id":"1385","name":"Flags .get() should retrieve and display a flag's data"},{"id":"1386","name":"Flags .get() should show user history for admins"},{"id":"1387","name":"Flags .get() should show user history for global moderators"},{"id":"1388","name":"Flags .get() should NOT show user history for regular moderators"},{"id":"1389","name":"Flags .list() should show a list of flags (with one item)"},{"id":"1390","name":"Flags .list() (with filters) should return a filtered list of flags if said filters are passed in"},{"id":"1391","name":"Flags .list() (with filters) should return no flags if a filter with no matching flags is used"},{"id":"1392","name":"Flags .list() (with filters) should return a flag when filtered by cid 1"},{"id":"1393","name":"Flags .list() (with filters) shouldn't return a flag when filtered by cid 2"},{"id":"1394","name":"Flags .list() (with filters) should return a flag when filtered by both cid 1 and 2"},{"id":"1395","name":"Flags .list() (with filters) should return one flag if filtered by both cid 1 and 2 and open state"},{"id":"1396","name":"Flags .list() (with filters) should return no flag if filtered by both cid 1 and 2 and non-open state"},{"id":"1397","name":"Flags .list() (with sort) should return sorted flags latest first if no sort is passed in"},{"id":"1398","name":"Flags .list() (with sort) should return sorted flags oldest first if \"oldest\" sort is passed in"},{"id":"1399","name":"Flags .list() (with sort) should return flags with more reports first if \"reports\" sort is passed in"},{"id":"1400","name":"Flags .update() should alter a flag's various attributes and persist them to the database"},{"id":"1401","name":"Flags .update() should persist to the flag's history"},{"id":"1402","name":"Flags .update() should allow assignment if user is an admin and do nothing otherwise"},{"id":"1403","name":"Flags .update() should allow assignment if user is a global mod and do nothing otherwise"},{"id":"1404","name":"Flags .update() should allow assignment if user is a mod of the category, do nothing otherwise"},{"id":"1405","name":"Flags .update() should do nothing when you attempt to set a bogus state"},{"id":"1406","name":"Flags .update() resolve/reject should rescind notification if flag is resolved"},{"id":"1407","name":"Flags .update() resolve/reject should rescind notification if flag is rejected"},{"id":"1408","name":"Flags .update() resolve/reject should do nothing if flag is resolved but ACP action is not \"rescind\""},{"id":"1409","name":"Flags .update() resolve/reject should do nothing if flag is rejected but ACP action is not \"rescind\""},{"id":"1410","name":"Flags .getTarget() should return a post's data if queried with type \"post\""},{"id":"1411","name":"Flags .getTarget() should return a user's data if queried with type \"user\""},{"id":"1412","name":"Flags .getTarget() should return a plain object with no properties if the target no longer exists"},{"id":"1413","name":"Flags .validate() should error out if type is post and post is deleted"},{"id":"1414","name":"Flags .validate() should not pass validation if flag threshold is set and user rep does not meet it"},{"id":"1415","name":"Flags .validate() should not error if user blocked target"},{"id":"1416","name":"Flags .validate() should send back error if reporter does not exist"},{"id":"1417","name":"Flags .appendNote() should add a note to a flag"},{"id":"1418","name":"Flags .appendNote() should be a JSON string"},{"id":"1419","name":"Flags .appendNote() should insert a note in the past if a datetime is passed in"},{"id":"1420","name":"Flags .getNotes() return should match a predefined spec"},{"id":"1421","name":"Flags .getNotes() should retrieve a list of notes, from newest to oldest"},{"id":"1422","name":"Flags .appendHistory() should add a new entry into a flag's history"},{"id":"1423","name":"Flags .getHistory() should retrieve a flag's history"},{"id":"1424","name":"Flags (v3 API) .create() should create a flag with no errors"},{"id":"1425","name":"Flags (v3 API) .create() should escape flag reason"},{"id":"1426","name":"Flags (v3 API) .create() should not allow flagging post in private category"},{"id":"1427","name":"Flags (v3 API) .update() should update a flag's properties"},{"id":"1428","name":"Flags (v3 API) .appendNote() should append a note to the flag"},{"id":"1429","name":"Flags (v3 API) .deleteNote() should delete a note from a flag"},{"id":"1430","name":"Flags (v3 API) access control should not allow access to privileged flag endpoints to guests"},{"id":"1431","name":"Flags (v3 API) access control should not allow access to privileged flag endpoints to regular users"},{"id":"1432","name":"Flags (v3 API) access control should allow access to privileged endpoints to administrators"},{"id":"1433","name":"Flags (v3 API) access control should allow access to privileged endpoints to global moderators"},{"id":"1434","name":"Flags (v3 API) access control should allow access to privileged endpoints to moderators if the flag target is a post in a cid they moderate"},{"id":"1435","name":"Flags (v3 API) access control should NOT allow access to privileged endpoints to moderators if the flag target is a post in a cid they DO NOT moderate"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst async = require('async');\nconst request = require('request-promise-native');\nconst util = require('util');\n\nconst sleep = util.promisify(setTimeout);\n\nconst db = require('./mocks/databasemock');\nconst helpers = require('./helpers');\n\nconst Flags = require('../src/flags');\nconst Categories = require('../src/categories');\nconst Topics = require('../src/topics');\nconst Posts = require('../src/posts');\nconst User = require('../src/user');\nconst Groups = require('../src/groups');\nconst Meta = require('../src/meta');\nconst Privileges = require('../src/privileges');\nconst utils = require('../src/utils');\nconst api = require('../src/api');\n\ndescribe('Flags', () => {\n    let uid1;\n    let adminUid;\n    let uid3;\n    let moderatorUid;\n    let jar;\n    let csrfToken;\n    let category;\n    before(async () => {\n        // Create some stuff to flag\n        uid1 = await User.create({ username: 'testUser', password: 'abcdef', email: 'b@c.com' });\n\n        adminUid = await User.create({ username: 'testUser2', password: 'abcdef', email: 'c@d.com' });\n        await Groups.join('administrators', adminUid);\n\n        category = await Categories.create({\n            name: 'test category',\n        });\n        await Topics.post({\n            cid: category.cid,\n            uid: uid1,\n            title: 'Topic to flag',\n            content: 'This is flaggable content',\n        });\n\n        uid3 = await User.create({\n            username: 'unprivileged', password: 'abcdef', email: 'd@e.com',\n        });\n\n        moderatorUid = await User.create({\n            username: 'moderator', password: 'abcdef',\n        });\n        await Privileges.categories.give(['moderate'], category.cid, [moderatorUid]);\n\n        const login = await helpers.loginUser('moderator', 'abcdef');\n        jar = login.jar;\n        csrfToken = login.csrf_token;\n    });\n\n    describe('.create()', () => {\n        it('should create a flag and return its data', (done) => {\n            Flags.create('post', 1, 1, 'Test flag', (err, flagData) => {\n                assert.ifError(err);\n                const compare = {\n                    flagId: 1,\n                    targetId: 1,\n                    type: 'post',\n                    state: 'open',\n                    target_readable: 'Post 1',\n                };\n                assert(flagData);\n                for (const key of Object.keys(compare)) {\n                    assert.ok(flagData[key], `undefined key ${key}`);\n                    assert.equal(flagData[key], compare[key]);\n                }\n\n                done();\n            });\n        });\n\n        it('should add the flag to the byCid zset for category 1 if it is of type post', (done) => {\n            db.isSortedSetMember(`flags:byCid:${1}`, 1, (err, isMember) => {\n                assert.ifError(err);\n                assert.ok(isMember);\n                done();\n            });\n        });\n\n        it('should add the flag to the byPid zset for pid 1 if it is of type post', (done) => {\n            db.isSortedSetMember(`flags:byPid:${1}`, 1, (err, isMember) => {\n                assert.ifError(err);\n                assert.ok(isMember);\n                done();\n            });\n        });\n    });\n\n    describe('.exists()', () => {\n        it('should return Boolean True if a flag matching the flag hash already exists', (done) => {\n            Flags.exists('post', 1, 1, (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(true, exists);\n                done();\n            });\n        });\n\n        it('should return Boolean False if a flag matching the flag hash does not already exists', (done) => {\n            Flags.exists('post', 1, 2, (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(false, exists);\n                done();\n            });\n        });\n    });\n\n    describe('.targetExists()', () => {\n        it('should return Boolean True if the targeted element exists', (done) => {\n            Flags.targetExists('post', 1, (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(true, exists);\n                done();\n            });\n        });\n\n        it('should return Boolean False if the targeted element does not exist', (done) => {\n            Flags.targetExists('post', 15, (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(false, exists);\n                done();\n            });\n        });\n    });\n\n    describe('.get()', () => {\n        it('should retrieve and display a flag\\'s data', (done) => {\n            Flags.get(1, (err, flagData) => {\n                assert.ifError(err);\n                const compare = {\n                    flagId: 1,\n                    targetId: 1,\n                    type: 'post',\n                    state: 'open',\n                    target_readable: 'Post 1',\n                };\n                assert(flagData);\n                for (const key of Object.keys(compare)) {\n                    assert.ok(flagData[key], `undefined key ${key}`);\n                    assert.equal(flagData[key], compare[key]);\n                }\n\n                done();\n            });\n        });\n\n        it('should show user history for admins', async () => {\n            await Groups.join('administrators', moderatorUid);\n            const flagData = await request({\n                uri: `${nconf.get('url')}/api/flags/1`,\n                jar,\n                headers: {\n                    'x-csrf-token': csrfToken,\n                },\n                json: true,\n            });\n\n            assert(flagData.history);\n            assert(Array.isArray(flagData.history));\n\n            await Groups.leave('administrators', moderatorUid);\n        });\n\n        it('should show user history for global moderators', async () => {\n            await Groups.join('Global Moderators', moderatorUid);\n            const flagData = await request({\n                uri: `${nconf.get('url')}/api/flags/1`,\n                jar,\n                headers: {\n                    'x-csrf-token': csrfToken,\n                },\n                json: true,\n            });\n\n            assert(flagData.history);\n            assert(Array.isArray(flagData.history));\n\n            await Groups.leave('Global Moderators', moderatorUid);\n        });\n\n        it('should NOT show user history for regular moderators', async () => {\n            const flagData = await request({\n                uri: `${nconf.get('url')}/api/flags/1`,\n                jar,\n                headers: {\n                    'x-csrf-token': csrfToken,\n                },\n                json: true,\n            });\n\n            assert(flagData.hasOwnProperty('history'));\n            assert(flagData.history === null);\n        });\n    });\n\n    describe('.list()', () => {\n        it('should show a list of flags (with one item)', (done) => {\n            Flags.list({\n                filters: {},\n                uid: 1,\n            }, (err, payload) => {\n                assert.ifError(err);\n                assert.ok(payload.hasOwnProperty('flags'));\n                assert.ok(payload.hasOwnProperty('page'));\n                assert.ok(payload.hasOwnProperty('pageCount'));\n                assert.ok(Array.isArray(payload.flags));\n                assert.equal(payload.flags.length, 1);\n\n                Flags.get(payload.flags[0].flagId, (err, flagData) => {\n                    assert.ifError(err);\n                    assert.equal(payload.flags[0].flagId, flagData.flagId);\n                    assert.equal(payload.flags[0].description, flagData.description);\n                    done();\n                });\n            });\n        });\n\n        describe('(with filters)', () => {\n            it('should return a filtered list of flags if said filters are passed in', (done) => {\n                Flags.list({\n                    filters: {\n                        state: 'open',\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(1, parseInt(payload.flags[0].flagId, 10));\n                    done();\n                });\n            });\n\n            it('should return no flags if a filter with no matching flags is used', (done) => {\n                Flags.list({\n                    filters: {\n                        state: 'rejected',\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(0, payload.flags.length);\n                    done();\n                });\n            });\n\n            it('should return a flag when filtered by cid 1', (done) => {\n                Flags.list({\n                    filters: {\n                        cid: 1,\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(1, payload.flags.length);\n                    done();\n                });\n            });\n\n            it('shouldn\\'t return a flag when filtered by cid 2', (done) => {\n                Flags.list({\n                    filters: {\n                        cid: 2,\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(0, payload.flags.length);\n                    done();\n                });\n            });\n\n            it('should return a flag when filtered by both cid 1 and 2', (done) => {\n                Flags.list({\n                    filters: {\n                        cid: [1, 2],\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(1, payload.flags.length);\n                    done();\n                });\n            });\n\n            it('should return one flag if filtered by both cid 1 and 2 and open state', (done) => {\n                Flags.list({\n                    filters: {\n                        cid: [1, 2],\n                        state: 'open',\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(1, payload.flags.length);\n                    done();\n                });\n            });\n\n            it('should return no flag if filtered by both cid 1 and 2 and non-open state', (done) => {\n                Flags.list({\n                    filters: {\n                        cid: [1, 2],\n                        state: 'resolved',\n                    },\n                    uid: 1,\n                }, (err, payload) => {\n                    assert.ifError(err);\n                    assert.ok(payload.hasOwnProperty('flags'));\n                    assert.ok(payload.hasOwnProperty('page'));\n                    assert.ok(payload.hasOwnProperty('pageCount'));\n                    assert.ok(Array.isArray(payload.flags));\n                    assert.strictEqual(0, payload.flags.length);\n                    done();\n                });\n            });\n        });\n\n        describe('(with sort)', () => {\n            before(async () => {\n                // Create a second flag to test sorting\n                const post = await Topics.reply({\n                    tid: 1,\n                    uid: uid1,\n                    content: 'this is a reply -- flag me',\n                });\n                await Flags.create('post', post.pid, adminUid, 'another flag');\n                await Flags.create('post', 1, uid3, 'additional flag report');\n            });\n\n            it('should return sorted flags latest first if no sort is passed in', async () => {\n                const payload = await Flags.list({\n                    uid: adminUid,\n                });\n\n                assert(payload.flags.every((cur, idx) => {\n                    if (idx === payload.flags.length - 1) {\n                        return true;\n                    }\n\n                    const next = payload.flags[idx + 1];\n                    return parseInt(cur.datetime, 10) > parseInt(next.datetime, 10);\n                }));\n            });\n\n            it('should return sorted flags oldest first if \"oldest\" sort is passed in', async () => {\n                const payload = await Flags.list({\n                    uid: adminUid,\n                    sort: 'oldest',\n                });\n\n                assert(payload.flags.every((cur, idx) => {\n                    if (idx === payload.flags.length - 1) {\n                        return true;\n                    }\n\n                    const next = payload.flags[idx + 1];\n                    return parseInt(cur.datetime, 10) <"+" parseInt(next.datetime, 10);\n                }));\n            });\n\n            it('should return flags with more reports first if \"reports\" sort is passed in', async () => {\n                const payload = await Flags.list({\n                    uid: adminUid,\n                    sort: 'reports',\n                });\n\n                assert(payload.flags.every((cur, idx) => {\n                    if (idx === payload.flags.length - 1) {\n                        return true;\n                    }\n\n                    const next = payload.flags[idx + 1];\n                    return parseInt(cur.heat, 10) >= parseInt(next.heat, 10);\n                }));\n            });\n        });\n    });\n\n    describe('.update()', () => {\n        it('should alter a flag\\'s various attributes and persist them to the database', (done) => {\n            Flags.update(1, adminUid, {\n                state: 'wip',\n                assignee: adminUid,\n            }, (err) => {\n                assert.ifError(err);\n                db.getObjectFields('flag:1', ['state', 'assignee'], (err, data) => {\n                    if (err) {\n                        throw err;\n                    }\n\n                    assert.strictEqual('wip', data.state);\n                    assert.ok(!isNaN(parseInt(data.assignee, 10)));\n                    assert.strictEqual(adminUid, parseInt(data.assignee, 10));\n                    done();\n                });\n            });\n        });\n\n        it('should persist to the flag\\'s history', (done) => {\n            Flags.getHistory(1, (err, history) => {\n                if (err) {\n                    throw err;\n                }\n\n                history.forEach((change) => {\n                    switch (change.attribute) {\n                    case 'state':\n                        assert.strictEqual('[[flags:state-wip]]', change.value);\n                        break;\n\n                    case 'assignee':\n                        assert.strictEqual(1, change.value);\n                        break;\n                    }\n                });\n\n                done();\n            });\n        });\n\n        it('should allow assignment if user is an admin and do nothing otherwise', async () => {\n            await Flags.update(1, adminUid, {\n                assignee: adminUid,\n            });\n            let assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(adminUid, parseInt(assignee, 10));\n\n            await Flags.update(1, adminUid, {\n                assignee: uid3,\n            });\n            assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(adminUid, parseInt(assignee, 10));\n        });\n\n        it('should allow assignment if user is a global mod and do nothing otherwise', async () => {\n            await Groups.join('Global Moderators', uid3);\n\n            await Flags.update(1, uid3, {\n                assignee: uid3,\n            });\n            let assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(uid3, parseInt(assignee, 10));\n\n            await Flags.update(1, uid3, {\n                assignee: uid1,\n            });\n            assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(uid3, parseInt(assignee, 10));\n\n            await Groups.leave('Global Moderators', uid3);\n        });\n\n        it('should allow assignment if user is a mod of the category, do nothing otherwise', async () => {\n            await Groups.join(`cid:${category.cid}:privileges:moderate`, uid3);\n\n            await Flags.update(1, uid3, {\n                assignee: uid3,\n            });\n            let assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(uid3, parseInt(assignee, 10));\n\n            await Flags.update(1, uid3, {\n                assignee: uid1,\n            });\n            assignee = await db.getObjectField('flag:1', 'assignee');\n            assert.strictEqual(uid3, parseInt(assignee, 10));\n\n            await Groups.leave(`cid:${category.cid}:privileges:moderate`, uid3);\n        });\n\n        it('should do nothing when you attempt to set a bogus state', async () => {\n            await Flags.update(1, adminUid, {\n                state: 'hocus pocus',\n            });\n\n            const state = await db.getObjectField('flag:1', 'state');\n            assert.strictEqual('wip', state);\n        });\n\n        describe('resolve/reject', () => {\n            let result;\n            let flagObj;\n            beforeEach(async () => {\n                result = await Topics.post({\n                    cid: category.cid,\n                    uid: uid3,\n                    title: 'Topic to flag',\n                    content: 'This is flaggable content',\n                });\n                flagObj = await api.flags.create({ uid: uid1 }, { type: 'post', id: result.postData.pid, reason: 'spam' });\n                await sleep(2000);\n            });\n\n            it('should rescind notification if flag is resolved', async () => {\n                let userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                await Flags.update(flagObj.flagId, adminUid, {\n                    state: 'resolved',\n                });\n\n                userNotifs = await User.notifications.getAll(adminUid);\n                assert(!userNotifs.includes(`flag:post:${result.postData.pid}`));\n            });\n\n            it('should rescind notification if flag is rejected', async () => {\n                let userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                await Flags.update(flagObj.flagId, adminUid, {\n                    state: 'rejected',\n                });\n\n                userNotifs = await User.notifications.getAll(adminUid);\n                assert(!userNotifs.includes(`flag:post:${result.postData.pid}`));\n            });\n\n            it('should do nothing if flag is resolved but ACP action is not \"rescind\"', async () => {\n                Meta.config['flags:actionOnResolve'] = '';\n\n                let userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                await Flags.update(flagObj.flagId, adminUid, {\n                    state: 'resolved',\n                });\n\n                userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                delete Meta.config['flags:actionOnResolve'];\n            });\n\n            it('should do nothing if flag is rejected but ACP action is not \"rescind\"', async () => {\n                Meta.config['flags:actionOnReject'] = '';\n\n                let userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                await Flags.update(flagObj.flagId, adminUid, {\n                    state: 'rejected',\n                });\n\n                userNotifs = await User.notifications.getAll(adminUid);\n                assert(userNotifs.includes(`flag:post:${result.postData.pid}`));\n\n                delete Meta.config['flags:actionOnReject'];\n            });\n        });\n    });\n\n    describe('.getTarget()', () => {\n        it('should return a post\\'s data if queried with type \"post\"', (done) => {\n            Flags.getTarget('post', 1, 1, (err, data) => {\n                assert.ifError(err);\n                const compare = {\n                    uid: 1,\n                    pid: 1,\n                    content: 'This is flaggable content',\n                };\n\n                for (const key of Object.keys(compare)) {\n                    assert.ok(data[key]);\n                    assert.equal(data[key], compare[key]);\n                }\n\n                done();\n            });\n        });\n\n        it('should return a user\\'s data if queried with type \"user\"', (done) => {\n            Flags.getTarget('user', 1, 1, (err, data) => {\n                assert.ifError(err);\n                const compare = {\n                    uid: 1,\n                    username: 'testUser',\n                    email: 'b@c.com',\n                };\n\n                for (const key of Object.keys(compare)) {\n                    assert.ok(data[key]);\n                    assert.equal(data[key], compare[key]);\n                }\n\n                done();\n            });\n        });\n\n        it('should return a plain object with no properties if the target no longer exists', (done) => {\n            Flags.getTarget('user', 15, 1, (err, data) => {\n                assert.ifError(err);\n                assert.strictEqual(0, Object.keys(data).length);\n                done();\n            });\n        });\n    });\n\n    describe('.validate()', () => {\n        it('should error out if type is post and post is deleted', (done) => {\n            Posts.delete(1, 1, (err) => {\n                if (err) {\n                    throw err;\n                }\n\n                Flags.validate({\n                    type: 'post',\n                    id: 1,\n                    uid: 1,\n                }, (err) => {\n                    assert.ok(err);\n                    assert.strictEqual('[[error:post-deleted]]', err.message);\n                    Posts.restore(1, 1, done);\n                });\n            });\n        });\n\n        it('should not pass validation if flag threshold is set and user rep does not meet it', (done) => {\n            Meta.configs.set('min:rep:flag', '50', (err) => {\n                assert.ifError(err);\n\n                Flags.validate({\n                    type: 'post',\n                    id: 1,\n                    uid: 3,\n                }, (err) => {\n                    assert.ok(err);\n                    assert.strictEqual('[[error:not-enough-reputation-to-flag, 50]]', err.message);\n                    Meta.configs.set('min:rep:flag', 0, done);\n                });\n            });\n        });\n\n        it('should not error if user blocked target', async () => {\n            const apiFlags = require('../src/api/flags');\n            const reporterUid = await User.create({ username: 'reporter' });\n            const reporteeUid = await User.create({ username: 'reportee' });\n            await User.blocks.add(reporteeUid, reporterUid);\n            const data = await Topics.post({\n                cid: 1,\n                uid: reporteeUid,\n                title: 'Another topic',\n                content: 'This is flaggable content',\n            });\n            await apiFlags.create({ uid: reporterUid }, {\n                type: 'post',\n                id: data.postData.pid,\n                reason: 'spam',\n            });\n        });\n\n        it('should send back error if reporter does not exist', (done) => {\n            Flags.validate({ uid: 123123123, id: 1, type: 'post' }, (err) => {\n                assert.equal(err.message, '[[error:no-user]]');\n                done();\n            });\n        });\n    });\n\n    describe('.appendNote()', () => {\n        it('should add a note to a flag', (done) => {\n            Flags.appendNote(1, 1, 'this is my note', (err) => {\n                assert.ifError(err);\n\n                db.getSortedSetRange('flag:1:notes', 0, -1, (err, notes) => {\n                    if (err) {\n                        throw err;\n                    }\n\n                    assert.strictEqual('[1,\"this is my note\"]', notes[0]);\n                    setTimeout(done, 10);\n                });\n            });\n        });\n\n        it('should be a JSON string', (done) => {\n            db.getSortedSetRange('flag:1:notes', 0, -1, (err, notes) => {\n                if (err) {\n                    throw err;\n                }\n\n                try {\n                    JSON.parse(notes[0]);\n                } catch (e) {\n                    assert.ifError(e);\n                }\n\n                done();\n            });\n        });\n\n        it('should insert a note in the past if a datetime is passed in', async () => {\n            await Flags.appendNote(1, 1, 'this is the first note', 1626446956652);\n            const note = (await db.getSortedSetRange('flag:1:notes', 0, 0)).pop();\n            assert.strictEqual('[1,\"this is the first note\"]', note);\n        });\n    });\n\n    describe('.getNotes()', () => {\n        before((done) => {\n            // Add a second note\n            Flags.appendNote(1, 1, 'this is the second note', done);\n        });\n\n        it('return should match a predefined spec', (done) => {\n            Flags.getNotes(1, (err, notes) => {\n                assert.ifError(err);\n                const compare = {\n                    uid: 1,\n                    content: 'this is my note',\n                };\n\n                const data = notes[1];\n                for (const key of Object.keys(compare)) {\n                    assert.ok(data[key]);\n                    assert.strictEqual(data[key], compare[key]);\n                }\n\n                done();\n            });\n        });\n\n        it('should retrieve a list of notes, from newest to oldest', (done) => {\n            Flags.getNotes(1, (err, notes) => {\n                assert.ifError(err);\n                assert(notes[0].datetime > notes[1].datetime, `${notes[0].datetime}-${notes[1].datetime}`);\n                assert.strictEqual('this is the second note', notes[0].content);\n                done();\n            });\n        });\n    });\n\n    describe('.appendHistory()', () => {\n        let entries;\n        before((done) => {\n            db.sortedSetCard('flag:1:history', (err, count) => {\n                entries = count;\n                done(err);\n            });\n        });\n\n        it('should add a new entry into a flag\\'s history', (done) => {\n            Flags.appendHistory(1, 1, {\n                state: 'rejected',\n            }, (err) => {\n                assert.ifError(err);\n\n                Flags.getHistory(1, (err, history) => {\n                    if (err) {\n                        throw err;\n                    }\n\n                    // 1 for the new event appended, 2 for username/email change\n                    assert.strictEqual(entries + 3, history.length);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.getHistory()', () => {\n        it('should retrieve a flag\\'s history', (done) => {\n            Flags.getHistory(1, (err, history) => {\n                assert.ifError(err);\n                assert.strictEqual(history[0].fields.state, '[[flags:state-rejected]]');\n                done();\n            });\n        });\n    });\n\n    describe('(v3 API)', () => {\n        let pid;\n        let tid;\n        let jar;\n        let csrfToken;\n        before(async () => {\n            const login = await helpers.loginUser('testUser2', 'abcdef');\n            jar = login.jar;\n            csrfToken = login.csrf_token;\n\n            const result = await Topics.post({\n                cid: 1,\n                uid: 1,\n                title: 'Another topic',\n                content: 'This is flaggable content',\n            });\n            pid = result.postData.pid;\n            tid = result.topicData.tid;\n        });\n\n        describe('.create()', () => {\n            it('should create a flag with no errors', async () => {\n                await request({\n                    method: 'post',\n                    uri: `${nconf.get('url')}/api/v3/flags`,\n                    jar,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    body: {\n                        type: 'post',\n                        id: pid,\n                        reason: 'foobar',\n                    },\n                    json: true,\n                });\n\n                const exists = await Flags.exists('post', pid, 2);\n                assert(exists);\n            });\n\n            it('should escape flag reason', async () => {\n                const postData = await Topics.reply({\n                    tid: tid,\n                    uid: 1,\n                    content: 'This is flaggable content',\n                });\n\n                const { response } = await request({\n                    method: 'post',\n                    uri: `${nconf.get('url')}/api/v3/flags`,\n                    jar,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    body: {\n                        type: 'post',\n                        id: postData.pid,\n                        reason: '\"<"+"script>alert(\\'ok\\');<"+"/script>',\n                    },\n                    json: true,\n                });\n\n                const flagData = await Flags.get(response.flagId);\n                assert.strictEqual(flagData.reports[0].value, '&quot;&lt;script&gt;alert(&#x27;ok&#x27;);&lt;&#x2F;script&gt;');\n            });\n\n            it('should not allow flagging post in private category', async () => {\n                const category = await Categories.create({ name: 'private category' });\n\n                await Privileges.categories.rescind(['groups:topics:read'], category.cid, 'registered-users');\n                await Groups.join('private category', uid3);\n                const result = await Topics.post({\n                    cid: category.cid,\n                    uid: uid3,\n                    title: 'private topic',\n                    content: 'private post',\n                });\n                const login = await helpers.loginUser('unprivileged', 'abcdef');\n                const jar3 = login.jar;\n                const config = await request({\n                    url: `${nconf.get('url')}/api/config`,\n                    json: true,\n                    jar: jar3,\n                });\n                const csrfToken = config.csrf_token;\n                const { statusCode, body } = await request({\n                    method: 'post',\n                    uri: `${nconf.get('url')}/api/v3/flags`,\n                    jar: jar3,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    body: {\n                        type: 'post',\n                        id: result.postData.pid,\n                        reason: 'foobar',\n                    },\n                    json: true,\n                    simple: false,\n                    resolveWithFullResponse: true,\n                });\n                assert.strictEqual(statusCode, 403);\n\n                // Handle dev mode test\n                delete body.stack;\n\n                assert.deepStrictEqual(body, {\n                    status: {\n                        code: 'forbidden',\n                        message: 'You do not have enough privileges for this action.',\n                    },\n                    response: {},\n                });\n            });\n        });\n\n        describe('.update()', () => {\n            it('should update a flag\\'s properties', async () => {\n                const { response } = await request({\n                    method: 'put',\n                    uri: `${nconf.get('url')}/api/v3/flags/2`,\n                    jar,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    body: {\n                        state: 'wip',\n                    },\n                    json: true,\n                });\n\n                const { history } = response;\n                assert(Array.isArray(history));\n                assert(history[0].fields.hasOwnProperty('state'));\n                assert.strictEqual('[[flags:state-wip]]', history[0].fields.state);\n            });\n        });\n\n        describe('.appendNote()', () => {\n            it('should append a note to the flag', async () => {\n                const { response } = await request({\n                    method: 'post',\n                    uri: `${nconf.get('url')}/api/v3/flags/2/notes`,\n                    jar,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    body: {\n                        note: 'lorem ipsum dolor sit amet',\n                        datetime: 1626446956652,\n                    },\n                    json: true,\n                });\n\n                assert(response.hasOwnProperty('notes'));\n                assert(Array.isArray(response.notes));\n                assert.strictEqual('lorem ipsum dolor sit amet', response.notes[0].content);\n                assert.strictEqual(2, response.notes[0].uid);\n\n                assert(response.hasOwnProperty('history'));\n                assert(Array.isArray(response.history));\n                assert.strictEqual(1, Object.keys(response.history[response.history.length - 1].fields).length);\n                assert(response.history[response.history.length - 1].fields.hasOwnProperty('notes'));\n            });\n        });\n\n        describe('.deleteNote()', () => {\n            it('should delete a note from a flag', async () => {\n                const { response } = await request({\n                    method: 'delete',\n                    uri: `${nconf.get('url')}/api/v3/flags/2/notes/1626446956652`,\n                    jar,\n                    headers: {\n                        'x-csrf-token': csrfToken,\n                    },\n                    json: true,\n                });\n\n                assert(Array.isArray(response.history));\n                assert(Array.isArray(response.notes));\n                assert.strictEqual(response.notes.length, 0);\n            });\n        });\n\n        describe('access control', () => {\n            let uid;\n            let jar;\n            let csrf_token;\n            let requests;\n\n            let flaggerUid;\n            let flagId;\n\n            const noteTime = Date.now();\n\n            before(async () => {\n                uid = await User.create({ username: 'flags-access-control', password: 'abcdef' });\n                ({ jar, csrf_token } = await helpers.loginUser('flags-access-control', 'abcdef'));\n\n                flaggerUid = await User.create({ username: 'flags-access-control-flagger', password: 'abcdef' });\n            });\n\n            beforeEach(async () => {\n                // Reset uid back to unprivileged user\n                await Groups.leave('administrators', uid);\n                await Groups.leave('Global Moderators', uid);\n                await Privileges.categories.rescind(['moderate'], 1, [uid]);\n\n                const { postData } = await Topics.post({\n                    uid,\n                    cid: 1,\n                    title: utils.generateUUID(),\n                    content: utils.generateUUID(),\n                });\n\n                ({ flagId } = await Flags.create('post', postData.pid, flaggerUid, 'spam'));\n                requests = new Set([\n                    {\n                        method: 'get',\n                        uri: `${nconf.get('url')}/api/v3/flags/${flagId}`,\n                        jar,\n                        headers: {\n                            'x-csrf-token': csrf_token,\n                        },\n                        json: true,\n                        simple: false,\n                        resolveWithFullResponse: true,\n                    },\n                    {\n                        method: 'put',\n                        uri: `${nconf.get('url')}/api/v3/flags/${flagId}`,\n                        jar,\n                        headers: {\n                            'x-csrf-token': csrf_token,\n                        },\n                        body: {\n                            state: 'wip',\n                        },\n                        json: true,\n                        simple: false,\n                        resolveWithFullResponse: true,\n                    },\n                    {\n                        method: 'post',\n                        uri: `${nconf.get('url')}/api/v3/flags/${flagId}/notes`,\n                        jar,\n                        headers: {\n                            'x-csrf-token': csrf_token,\n                        },\n                        body: {\n                            note: 'test note',\n                            datetime: noteTime,\n                        },\n                        json: true,\n                        simple: false,\n                        resolveWithFullResponse: true,\n                    },\n                    {\n                        method: 'delete',\n                        uri: `${nconf.get('url')}/api/v3/flags/${flagId}/notes/${noteTime}`,\n                        jar,\n                        headers: {\n                            'x-csrf-token': csrf_token,\n                        },\n                        json: true,\n                        simple: false,\n                        resolveWithFullResponse: true,\n                    },\n                    {\n                        method: 'delete',\n                        uri: `${nconf.get('url')}/api/v3/flags/${flagId}`,\n                        jar,\n                        headers: {\n                            'x-csrf-token': csrf_token,\n                        },\n                        json: true,\n                        simple: false,\n                        resolveWithFullResponse: true,\n                    },\n                ]);\n            });\n\n            it('should not allow access to privileged flag endpoints to guests', async () => {\n                for (let opts of requests) {\n                    opts = { ...opts };\n                    delete opts.jar;\n                    delete opts.headers;\n\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert(statusCode.toString().startsWith(4), `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n\n            it('should not allow access to privileged flag endpoints to regular users', async () => {\n                for (const opts of requests) {\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert(statusCode.toString().startsWith(4), `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n\n            it('should allow access to privileged endpoints to administrators', async () => {\n                await Groups.join('administrators', uid);\n\n                for (const opts of requests) {\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert.strictEqual(statusCode, 200, `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n\n            it('should allow access to privileged endpoints to global moderators', async () => {\n                await Groups.join('Global Moderators', uid);\n\n                for (const opts of requests) {\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert.strictEqual(statusCode, 200, `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n\n            it('should allow access to privileged endpoints to moderators if the flag target is a post in a cid they moderate', async () => {\n                await Privileges.categories.give(['moderate'], 1, [uid]);\n\n                for (const opts of requests) {\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert.strictEqual(statusCode, 200, `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n\n            it('should NOT allow access to privileged endpoints to moderators if the flag target is a post in a cid they DO NOT moderate', async () => {\n                // This is a new category the user will moderate, but the flagged post is in a different category\n                const { cid } = await Categories.create({\n                    name: utils.generateUUID(),\n                });\n                await Privileges.categories.give(['moderate'], cid, [uid]);\n\n                for (const opts of requests) {\n                    // eslint-disable-next-line no-await-in-loop\n                    const { statusCode } = await request(opts);\n                    assert(statusCode.toString().startsWith(4), `${opts.method.toUpperCase()} ${opts.uri} => ${statusCode}`);\n                }\n            });\n        });\n    });\n});\n"},"test/groups.js":{"tests":[{"id":"1436","name":"Groups .list() should list the groups present"},{"id":"1437","name":"Groups .get() with no options, should show group information"},{"id":"1438","name":"Groups .get() should return null if group does not exist"},{"id":"1439","name":"Groups .search() should return empty array if query is falsy"},{"id":"1440","name":"Groups .search() should return the groups when search query is empty"},{"id":"1441","name":"Groups .search() should return the \"Test\" group when searched for"},{"id":"1442","name":"Groups .search() should return the \"Test\" group when searched for and sort by member count"},{"id":"1443","name":"Groups .search() should return the \"Test\" group when searched for and sort by creation time"},{"id":"1444","name":"Groups .search() should return all users if no query"},{"id":"1445","name":"Groups .search() should search group members"},{"id":"1446","name":"Groups .search() should not return hidden groups"},{"id":"1447","name":"Groups .isMember() should return boolean true when a user is in a group"},{"id":"1448","name":"Groups .isMember() should return boolean false when a user is not in a group"},{"id":"1449","name":"Groups .isMember() should return true for uid 0 and guests group"},{"id":"1450","name":"Groups .isMemberOfGroupList should report that a user is part of a groupList, if they are"},{"id":"1451","name":"Groups .isMemberOfGroupList should report that a user is not part of a groupList, if they are not"},{"id":"1452","name":"Groups .exists() should verify that the test group exists"},{"id":"1453","name":"Groups .exists() should verify that a fake group does not exist"},{"id":"1454","name":"Groups .exists() should check if group exists using an array"},{"id":"1455","name":"Groups .create() should create another group"},{"id":"1456","name":"Groups .create() should create a hidden group if hidden is 1"},{"id":"1457","name":"Groups .create() should create a visible group if hidden is 0"},{"id":"1458","name":"Groups .create() should create a visible group if hidden is not passed in"},{"id":"1459","name":"Groups .create() should fail to create group with duplicate group name"},{"id":"1460","name":"Groups .create() should fail to create group if slug is empty"},{"id":"1461","name":"Groups .create() should fail if group name is invalid"},{"id":"1462","name":"Groups .create() should not create a system group"},{"id":"1463","name":"Groups .create() should return falsy for userTitleEnabled"},{"id":"1464","name":"Groups .hide() should mark the group as hidden"},{"id":"1465","name":"Groups .update() should change an aspect of a group"},{"id":"1466","name":"Groups .update() should rename a group and not break navigation routes"},{"id":"1467","name":"Groups .update() should fail if system groups is being renamed"},{"id":"1468","name":"Groups .update() should fail to rename if group name is invalid"},{"id":"1469","name":"Groups .update() should fail to rename if group name is too short"},{"id":"1470","name":"Groups .update() should fail to rename if group name is too long"},{"id":"1471","name":"Groups .update() should fail to rename group to an existing group"},{"id":"1472","name":"Groups .destroy() should destroy a group"},{"id":"1473","name":"Groups .destroy() should also remove the members set"},{"id":"1474","name":"Groups .destroy() should remove group from privilege groups"},{"id":"1475","name":"Groups .join() should add a user to a group"},{"id":"1476","name":"Groups .join() should fail to add user to admin group"},{"id":"1477","name":"Groups .join() should fail to add user to group if group name is invalid"},{"id":"1478","name":"Groups .join() should fail to add user to group if uid is invalid"},{"id":"1479","name":"Groups .join() should add user to Global Moderators group"},{"id":"1480","name":"Groups .join() should add user to multiple groups"},{"id":"1481","name":"Groups .join() should set group title when user joins the group"},{"id":"1482","name":"Groups .join() should fail to add user to system group"},{"id":"1483","name":"Groups .join() should allow admins to join private groups"},{"id":"1484","name":"Groups .leave() should remove a user from a group"},{"id":"1485","name":"Groups .leaveAllGroups() should remove a user from all groups"},{"id":"1486","name":"Groups .show() should make a group visible"},{"id":"1487","name":"Groups .hide() should make a group hidden"},{"id":"1488","name":"Groups socket methods should error if data is null"},{"id":"1489","name":"Groups socket methods should not error if data is valid"},{"id":"1490","name":"Groups socket methods should return error if not logged in"},{"id":"1491","name":"Groups socket methods should return error if group name is special"},{"id":"1492","name":"Groups socket methods should error if group does not exist"},{"id":"1493","name":"Groups socket methods should join test group"},{"id":"1494","name":"Groups socket methods should error if not logged in"},{"id":"1495","name":"Groups socket methods should leave test group"},{"id":"1496","name":"Groups socket methods should fail to join if group is private and join requests are disabled"},{"id":"1497","name":"Groups socket methods should fail to leave if group is private and leave is disabled"},{"id":"1498","name":"Groups socket methods should join if user is admin"},{"id":"1499","name":"Groups socket methods should request membership for regular user"},{"id":"1500","name":"Groups socket methods should reject membership of user"},{"id":"1501","name":"Groups socket methods should error if not owner or admin"},{"id":"1502","name":"Groups socket methods should accept membership of user"},{"id":"1503","name":"Groups socket methods should reject/accept all memberships requests"},{"id":"1504","name":"Groups socket methods should issue invite to user"},{"id":"1505","name":"Groups socket methods should fail with invalid data"},{"id":"1506","name":"Groups socket methods should issue mass invite to users"},{"id":"1507","name":"Groups socket methods should rescind invite"},{"id":"1508","name":"Groups socket methods should error if user is not invited"},{"id":"1509","name":"Groups socket methods should accept invite"},{"id":"1510","name":"Groups socket methods should reject invite"},{"id":"1511","name":"Groups socket methods should grant ownership to user"},{"id":"1512","name":"Groups socket methods should rescind ownership from user"},{"id":"1513","name":"Groups socket methods should fail to kick user with invalid data"},{"id":"1514","name":"Groups socket methods should kick user from group"},{"id":"1515","name":"Groups socket methods should fail to create group with invalid data"},{"id":"1516","name":"Groups socket methods should fail to create group if group creation is disabled"},{"id":"1517","name":"Groups socket methods should fail to create group if name is privilege group"},{"id":"1518","name":"Groups socket methods should create/update group"},{"id":"1519","name":"Groups socket methods should fail to create a group with name guests"},{"id":"1520","name":"Groups socket methods should fail to rename guests group"},{"id":"1521","name":"Groups socket methods should delete group"},{"id":"1522","name":"Groups socket methods should fail to delete group if name is special"},{"id":"1523","name":"Groups socket methods should fail to load more groups with invalid data"},{"id":"1524","name":"Groups socket methods should load more groups"},{"id":"1525","name":"Groups socket methods should fail to load more members with invalid data"},{"id":"1526","name":"Groups socket methods should load more members"},{"id":"1527","name":"Groups api methods should fail to create group with invalid data"},{"id":"1528","name":"Groups api methods should fail to create group if group name is privilege group"},{"id":"1529","name":"Groups api methods should create a group"},{"id":"1530","name":"Groups api methods should fail to join with invalid data"},{"id":"1531","name":"Groups api methods should add user to group"},{"id":"1532","name":"Groups api methods should not error if user is already member"},{"id":"1533","name":"Groups api methods it should fail with invalid data"},{"id":"1534","name":"Groups api methods it should fail if admin tries to remove self"},{"id":"1535","name":"Groups api methods should not error if user is not member"},{"id":"1536","name":"Groups api methods should fail if trying to remove someone else from group"},{"id":"1537","name":"Groups api methods should remove user from group"},{"id":"1538","name":"Groups api methods should fail with invalid data"},{"id":"1539","name":"Groups api methods should update group"},{"id":"1540","name":"Groups groups cover should fail if user is not logged in or not owner"},{"id":"1541","name":"Groups groups cover should upload group cover image from file"},{"id":"1542","name":"Groups groups cover should upload group cover image from data"},{"id":"1543","name":"Groups groups cover should fail to upload group cover with invalid image"},{"id":"1544","name":"Groups groups cover should update group cover position"},{"id":"1545","name":"Groups groups cover should fail to update cover position if group name is missing"},{"id":"1546","name":"Groups groups cover should fail to remove cover if not logged in"},{"id":"1547","name":"Groups groups cover should fail to remove cover if not owner"},{"id":"1548","name":"Groups groups cover should remove cover"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\nconst fs = require('fs');\nconst path = require('path');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst helpers = require('./helpers');\nconst Groups = require('../src/groups');\nconst User = require('../src/user');\nconst socketGroups = require('../src/socket.io/groups');\nconst apiGroups = require('../src/api/groups');\nconst meta = require('../src/meta');\nconst navigation = require('../src/navigation/admin');\n\n\ndescribe('Groups', () => {\n    let adminUid;\n    let testUid;\n    before(async () => {\n        const navData = require('../install/data/navigation.json');\n        await navigation.save(navData);\n\n        await Groups.create({\n            name: 'Test',\n            description: 'Foobar!',\n        });\n\n        await Groups.create({\n            name: 'PrivateNoJoin',\n            description: 'Private group',\n            private: 1,\n            disableJoinRequests: 1,\n        });\n\n        await Groups.create({\n            name: 'PrivateCanJoin',\n            description: 'Private group',\n            private: 1,\n            disableJoinRequests: 0,\n        });\n\n        await Groups.create({\n            name: 'PrivateNoLeave',\n            description: 'Private group',\n            private: 1,\n            disableLeave: 1,\n        });\n\n        await Groups.create({\n            name: 'Global Moderators',\n            userTitle: 'Global Moderator',\n            description: 'Forum wide moderators',\n            hidden: 0,\n            private: 1,\n            disableJoinRequests: 1,\n        });\n\n        // Also create a hidden group\n        await Groups.join('Hidden', 'Test');\n        // create another group that starts with test for search/sort\n        await Groups.create({ name: 'Test2', description: 'Foobar!' });\n\n        testUid = await User.create({\n            username: 'testuser',\n            email: 'b@c.com',\n        });\n\n        adminUid = await User.create({\n            username: 'admin',\n            email: 'admin@admin.com',\n            password: '123456',\n        });\n        await Groups.join('administrators', adminUid);\n    });\n\n    describe('.list()', () => {\n        it('should list the groups present', (done) => {\n            Groups.getGroupsFromSet('groups:visible:createtime', 0, -1, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(groups.length, 5);\n                done();\n            });\n        });\n    });\n\n    describe('.get()', () => {\n        before((done) => {\n            Groups.join('Test', testUid, done);\n        });\n\n        it('with no options, should show group information', (done) => {\n            Groups.get('Test', {}, (err, groupObj) => {\n                assert.ifError(err);\n                assert.equal(typeof groupObj, 'object');\n                assert(Array.isArray(groupObj.members));\n                assert.strictEqual(groupObj.name, 'Test');\n                assert.strictEqual(groupObj.description, 'Foobar!');\n                assert.strictEqual(groupObj.memberCount, 1);\n                assert.equal(typeof groupObj.members[0], 'object');\n\n                done();\n            });\n        });\n\n        it('should return null if group does not exist', (done) => {\n            Groups.get('doesnotexist', {}, (err, groupObj) => {\n                assert.ifError(err);\n                assert.strictEqual(groupObj, null);\n                done();\n            });\n        });\n    });\n\n    describe('.search()', () => {\n        const socketGroups = require('../src/socket.io/groups');\n\n        it('should return empty array if query is falsy', (done) => {\n            Groups.search(null, {}, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(0, groups.length);\n                done();\n            });\n        });\n\n        it('should return the groups when search query is empty', (done) => {\n            socketGroups.search({ uid: adminUid }, { query: '' }, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(5, groups.length);\n                done();\n            });\n        });\n\n        it('should return the \"Test\" group when searched for', (done) => {\n            socketGroups.search({ uid: adminUid }, { query: 'test' }, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(2, groups.length);\n                assert.strictEqual('Test', groups[0].name);\n                done();\n            });\n        });\n\n        it('should return the \"Test\" group when searched for and sort by member count', (done) => {\n            Groups.search('test', { filterHidden: true, sort: 'count' }, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(2, groups.length);\n                assert.strictEqual('Test', groups[0].name);\n                done();\n            });\n        });\n\n        it('should return the \"Test\" group when searched for and sort by creation time', (done) => {\n            Groups.search('test', { filterHidden: true, sort: 'date' }, (err, groups) => {\n                assert.ifError(err);\n                assert.equal(2, groups.length);\n                assert.strictEqual('Test', groups[1].name);\n                done();\n            });\n        });\n\n        it('should return all users if no query', (done) => {\n            function createAndJoinGroup(username, email, callback) {\n                async.waterfall([\n                    function (next) {\n                        User.create({ username: username, email: email }, next);\n                    },\n                    function (uid, next) {\n                        Groups.join('Test', uid, next);\n                    },\n                ], callback);\n            }\n            async.series([\n                function (next) {\n                    createAndJoinGroup('newuser', 'newuser@b.com', next);\n                },\n                function (next) {\n                    createAndJoinGroup('bob', 'bob@b.com', next);\n                },\n            ], (err) => {\n                assert.ifError(err);\n\n                socketGroups.searchMembers({ uid: adminUid }, { groupName: 'Test', query: '' }, (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.users.length, 3);\n                    done();\n                });\n            });\n        });\n\n        it('should search group members', (done) => {\n            socketGroups.searchMembers({ uid: adminUid }, { groupName: 'Test', query: 'test' }, (err, data) => {\n                assert.ifError(err);\n                assert.strictEqual('testuser', data.users[0].username);\n                done();\n            });\n        });\n\n        it('should not return hidden groups', async () => {\n            await Groups.create({\n                name: 'hiddenGroup',\n                hidden: '1',\n            });\n            const result = await socketGroups.search({ uid: testUid }, { query: 'hiddenGroup' });\n            assert.equal(result.length, 0);\n        });\n    });\n\n    describe('.isMember()', () => {\n        it('should return boolean true when a user is in a group', (done) => {\n            Groups.isMember(1, 'Test', (err, isMember) => {\n                assert.ifError(err);\n                assert.strictEqual(isMember, true);\n                done();\n            });\n        });\n\n        it('should return boolean false when a user is not in a group', (done) => {\n            Groups.isMember(2, 'Test', (err, isMember) => {\n                assert.ifError(err);\n                assert.strictEqual(isMember, false);\n                done();\n            });\n        });\n\n        it('should return true for uid 0 and guests group', (done) => {\n            Groups.isMembers([1, 0], 'guests', (err, isMembers) => {\n                assert.ifError(err);\n                assert.deepStrictEqual(isMembers, [false, true]);\n                done();\n            });\n        });\n\n        it('should return true for uid 0 and guests group', (done) => {\n            Groups.isMemberOfGroups(0, ['guests', 'registered-users'], (err, isMembers) => {\n                assert.ifError(err);\n                assert.deepStrictEqual(isMembers, [true, false]);\n                done();\n            });\n        });\n    });\n\n    describe('.isMemberOfGroupList', () => {\n        it('should report that a user is part of a groupList, if they are', (done) => {\n            Groups.isMemberOfGroupList(1, 'Hidden', (err, isMember) => {\n                assert.ifError(err);\n                assert.strictEqual(isMember, true);\n                done();\n            });\n        });\n\n        it('should report that a user is not part of a groupList, if they are not', (done) => {\n            Groups.isMemberOfGroupList(2, 'Hidden', (err, isMember) => {\n                assert.ifError(err);\n                assert.strictEqual(isMember, false);\n                done();\n            });\n        });\n    });\n\n    describe('.exists()', () => {\n        it('should verify that the test group exists', (done) => {\n            Groups.exists('Test', (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(exists, true);\n                done();\n            });\n        });\n\n        it('should verify that a fake group does not exist', (done) => {\n            Groups.exists('Derp', (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(exists, false);\n                done();\n            });\n        });\n\n        it('should check if group exists using an array', (done) => {\n            Groups.exists(['Test', 'Derp'], (err, groupsExists) => {\n                assert.ifError(err);\n                assert.strictEqual(groupsExists[0], true);\n                assert.strictEqual(groupsExists[1], false);\n                done();\n            });\n        });\n    });\n\n    describe('.create()', () => {\n        it('should create another group', (done) => {\n            Groups.create({\n                name: 'foo',\n                description: 'bar',\n            }, (err) => {\n                assert.ifError(err);\n                Groups.get('foo', {}, done);\n            });\n        });\n\n        it('should create a hidden group if hidden is 1', (done) => {\n            Groups.create({\n                name: 'hidden group',\n                hidden: '1',\n            }, (err) => {\n                assert.ifError(err);\n                db.isSortedSetMember('groups:visible:memberCount', 'visible group', (err, isMember) => {\n                    assert.ifError(err);\n                    assert(!isMember);\n                    done();\n                });\n            });\n        });\n\n        it('should create a visible group if hidden is 0', (done) => {\n            Groups.create({\n                name: 'visible group',\n                hidden: '0',\n            }, (err) => {\n                assert.ifError(err);\n                db.isSortedSetMember('groups:visible:memberCount', 'visible group', (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            });\n        });\n\n        it('should create a visible group if hidden is not passed in', (done) => {\n            Groups.create({\n                name: 'visible group 2',\n            }, (err) => {\n                assert.ifError(err);\n                db.isSortedSetMember('groups:visible:memberCount', 'visible group 2', (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            });\n        });\n\n        it('should fail to create group with duplicate group name', (done) => {\n            Groups.create({ name: 'foo' }, (err) => {\n                assert(err);\n                assert.equal(err.message, '[[error:group-already-exists]]');\n                done();\n            });\n        });\n\n        it('should fail to create group if slug is empty', (done) => {\n            Groups.create({ name: '>>>>' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n                done();\n            });\n        });\n\n        it('should fail if group name is invalid', (done) => {\n            Groups.create({ name: 'not/valid' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n                done();\n            });\n        });\n\n        it('should fail if group name is invalid', (done) => {\n            Groups.create({ name: ['array/'] }, (err) => {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n                done();\n            });\n        });\n\n        it('should fail if group name is invalid', async () => {\n            try {\n                await apiGroups.create({ uid: adminUid }, { name: ['test', 'administrators'] });\n            } catch (err) {\n                return assert.equal(err.message, '[[error:invalid-group-name]]');\n            }\n            assert(false);\n        });\n\n        it('should not create a system group', async () => {\n            await apiGroups.create({ uid: adminUid }, { name: 'mysystemgroup', system: true });\n            const data = await Groups.getGroupData('mysystemgroup');\n            assert.strictEqual(data.system, 0);\n        });\n\n        it('should fail if group name is invalid', (done) => {\n            Groups.create({ name: 'not:valid' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n                done();\n            });\n        });\n\n        it('should return falsy for userTitleEnabled', (done) => {\n            Groups.create({ name: 'userTitleEnabledGroup' }, (err) => {\n                assert.ifError(err);\n                Groups.setGroupField('userTitleEnabledGroup', 'userTitleEnabled', 0, (err) => {\n                    assert.ifError(err);\n                    Groups.getGroupData('userTitleEnabledGroup', (err, data) => {\n                        assert.ifError(err);\n                        assert.strictEqual(data.userTitleEnabled, 0);\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    describe('.hide()', () => {\n        it('should mark the group as hidden', (done) => {\n            Groups.hide('foo', (err) => {\n                assert.ifError(err);\n\n                Groups.get('foo', {}, (err, groupObj) => {\n                    assert.ifError(err);\n                    assert.strictEqual(1, groupObj.hidden);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.update()', () => {\n        before((done) => {\n            Groups.create({\n                name: 'updateTestGroup',\n                description: 'bar',\n                system: 0,\n                hidden: 0,\n            }, done);\n        });\n\n        it('should change an aspect of a group', (done) => {\n            Groups.update('updateTestGroup', {\n                description: 'baz',\n            }, (err) => {\n                assert.ifError(err);\n\n                Groups.get('updateTestGroup', {}, (err, groupObj) => {\n                    assert.ifError(err);\n                    assert.strictEqual('baz', groupObj.description);\n                    done();\n                });\n            });\n        });\n\n        it('should rename a group and not break navigation routes', async () => {\n            await Groups.update('updateTestGroup', {\n                name: 'updateTestGroup?',\n            });\n\n            const groupObj = await Groups.get('updateTestGroup?', {});\n            assert.strictEqual('updateTestGroup?', groupObj.name);\n            assert.strictEqual('updatetestgroup', groupObj.slug);\n\n            const navItems = await navigation.get();\n            assert.strictEqual(navItems[0].route, '&#x2F;categories');\n        });\n\n        it('should fail if system groups is being renamed', (done) => {\n            Groups.update('administrators', {\n                name: 'administrators_fail',\n            }, (err) => {\n                assert.equal(err.message, '[[error:not-allowed-to-rename-system-group]]');\n                done();\n            });\n        });\n\n        it('should fail to rename if group name is invalid', async () => {\n            try {\n                await apiGroups.update({ uid: adminUid }, { slug: ['updateTestGroup?'], values: {} });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:invalid-group-name]]');\n            }\n            assert(false);\n        });\n\n        it('should fail to rename if group name is too short', async () => {\n            try {\n                const slug = await Groups.getGroupField('updateTestGroup?', 'slug');\n                await apiGroups.update({ uid: adminUid }, { slug: slug, name: '' });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:group-name-too-short]]');\n            }\n            assert(false);\n        });\n\n        it('should fail to rename if group name is invalid', async () => {\n            try {\n                const slug = await Groups.getGroupField('updateTestGroup?', 'slug');\n                await apiGroups.update({ uid: adminUid }, { slug: slug, name: ['invalid'] });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:invalid-group-name]]');\n            }\n            assert(false);\n        });\n\n        it('should fail to rename if group name is invalid', async () => {\n            try {\n                const slug = await Groups.getGroupField('updateTestGroup?', 'slug');\n                await apiGroups.update({ uid: adminUid }, { slug: slug, name: 'cid:0:privileges:ban' });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:invalid-group-name]]');\n            }\n            assert(false);\n        });\n\n        it('should fail to rename if group name is too long', async () => {\n            try {\n                const slug = await Groups.getGroupField('updateTestGroup?', 'slug');\n                await apiGroups.update({ uid: adminUid }, { slug: slug, name: 'verylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstringverylongstring' });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:group-name-too-long]]');\n            }\n            assert(false);\n        });\n\n        it('should fail to rename if group name is invalid', async () => {\n            const slug = await Groups.getGroupField('updateTestGroup?', 'slug');\n            const invalidNames = ['test:test', 'another/test', '---'];\n            for (const name of invalidNames) {\n                try {\n                    // eslint-disable-next-line no-await-in-loop\n                    await apiGroups.update({ uid: adminUid }, { slug: slug, name: name });\n                    assert(false);\n                } catch (err) {\n                    assert.strictEqual(err.message, '[[error:invalid-group-name]]');\n                }\n            }\n        });\n\n        it('should fail to rename group to an existing group', (done) => {\n            Groups.create({\n                name: 'group2',\n                system: 0,\n                hidden: 0,\n            }, (err) => {\n                assert.ifError(err);\n                Groups.update('group2', {\n                    name: 'updateTestGroup?',\n                }, (err) => {\n                    assert.equal(err.message, '[[error:group-already-exists]]');\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.destroy()', () => {\n        before((done) => {\n            Groups.join('foobar?', 1, done);\n        });\n\n        it('should destroy a group', (done) => {\n            Groups.destroy('foobar?', (err) => {\n                assert.ifError(err);\n\n                Groups.get('foobar?', {}, (err, groupObj) => {\n                    assert.ifError(err);\n                    assert.strictEqual(groupObj, null);\n                    done();\n                });\n            });\n        });\n\n        it('should also remove the members set', (done) => {\n            db.exists('group:foo:members', (err, exists) => {\n                assert.ifError(err);\n                assert.strictEqual(false, exists);\n                done();\n            });\n        });\n\n        it('should remove group from privilege groups', (done) => {\n            const privileges = require('../src/privileges');\n            const cid = 1;\n            const groupName = '1';\n            const uid = 1;\n            async.waterfall([\n                function (next) {\n                    Groups.create({ name: groupName }, next);\n                },\n                function (groupData, next) {\n                    privileges.categories.give(['groups:topics:create'], cid, groupName, next);\n                },\n                function (next) {\n                    Groups.isMember(groupName, 'cid:1:privileges:groups:topics:create', next);\n                },\n                function (isMember, next) {\n                    assert(isMember);\n                    Groups.destroy(groupName, next);\n                },\n                function (next) {\n                    Groups.isMember(groupName, 'cid:1:privileges:groups:topics:create', next);\n                },\n                function (isMember, next) {\n                    assert(!isMember);\n                    Groups.isMember(uid, 'registered-users', next);\n                },\n                function (isMember, next) {\n                    assert(isMember);\n                    next();\n                },\n            ], done);\n        });\n    });\n\n    describe('.join()', () => {\n        before((done) => {\n            Groups.leave('Test', testUid, done);\n        });\n\n        it('should add a user to a group', (done) => {\n            Groups.join('Test', testUid, (err) => {\n                assert.ifError(err);\n\n                Groups.isMember(testUid, 'Test', (err, isMember) => {\n                    assert.ifError(err);\n                    assert.strictEqual(true, isMember);\n\n                    done();\n                });\n            });\n        });\n\n        it('should fail to add user to admin group', async () => {\n            const oldValue = meta.config.allowPrivateGroups;\n            try {\n                meta.config.allowPrivateGroups = false;\n                const newUid = await User.create({ username: 'newadmin' });\n                await apiGroups.join({ uid: newUid }, { slug: ['test', 'administrators'], uid: newUid }, 1);\n                const isMember = await Groups.isMember(newUid, 'administrators');\n                assert(!isMember);\n            } catch (err) {\n                assert.strictEqual(err.message, '[[error:no-group]]');\n            }\n            meta.config.allowPrivateGroups = oldValue;\n        });\n\n        it('should fail to add user to group if group name is invalid', (done) => {\n            Groups.join(0, 1, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                Groups.join(null, 1, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    Groups.join(undefined, 1, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should fail to add user to group if uid is invalid', (done) => {\n            Groups.join('Test', 0, (err) => {\n                assert.equal(err.message, '[[error:invalid-uid]]');\n                Groups.join('Test', null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-uid]]');\n                    Groups.join('Test', undefined, (err) => {\n                        assert.equal(err.message, '[[error:invalid-uid]]');\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should add user to Global Moderators group', async () => {\n            const uid = await User.create({ username: 'glomod' });\n            const slug = await Groups.getGroupField('Global Moderators', 'slug');\n            await apiGroups.join({ uid: adminUid }, { slug: slug, uid: uid });\n            const isGlobalMod = await User.isGlobalModerator(uid);\n            assert.strictEqual(isGlobalMod, true);\n        });\n\n        it('should add user to multiple groups', (done) => {\n            const groupNames = ['test-hidden1', 'Test', 'test-hidden2', 'empty group'];\n            Groups.create({ name: 'empty group' }, (err) => {\n                assert.ifError(err);\n                Groups.join(groupNames, testUid, (err) => {\n                    assert.ifError(err);\n                    Groups.isMemberOfGroups(testUid, groupNames, (err, isMembers) => {\n                        assert.ifError(err);\n                        assert(isMembers.every(Boolean));\n                        db.sortedSetScores('groups:visible:memberCount', groupNames, (err, memberCounts) => {\n                            assert.ifError(err);\n                            // hidden groups are not in \"groups:visible:memberCount\" so they are null\n                            assert.deepEqual(memberCounts, [null, 3, null, 1]);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should set group title when user joins the group', (done) => {\n            const groupName = 'this will be title';\n            User.create({ username: 'needstitle' }, (err, uid) => {\n                assert.ifError(err);\n                Groups.create({ name: groupName }, (err) => {\n                    assert.ifError(err);\n                    Groups.join([groupName], uid, (err) => {\n                        assert.ifError(err);\n                        User.getUserData(uid, (err, data) => {\n                            assert.ifError(err);\n                            assert.equal(data.groupTitle, `[\"${groupName}\"]`);\n                            assert.deepEqual(data.groupTitleArray, [groupName]);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should fail to add user to system group', async () => {\n            const uid = await User.create({ username: 'eviluser' });\n            const oldValue = meta.config.allowPrivateGroups;\n            meta.config.allowPrivateGroups = 0;\n            async function test(groupName) {\n                let err;\n                try {\n                    const slug = await Groups.getGroupField(groupName, 'slug');\n                    await apiGroups.join({ uid: uid }, { slug: slug, uid: uid });\n                    const isMember = await Groups.isMember(uid, groupName);\n                    assert.strictEqual(isMember, false);\n                } catch (_err) {\n                    err = _err;\n                }\n                assert.strictEqual(err.message, '[[error:not-allowed]]');\n            }\n            const groups = ['Global Moderators', 'verified-users', 'unverified-users'];\n            for (const g of groups) {\n                // eslint-disable-next-line no-await-in-loop\n                await test(g);\n            }\n            meta.config.allowPrivateGroups = oldValue;\n        });\n\n        it('should allow admins to join private groups', async () => {\n            await apiGroups.join({ uid: adminUid }, { uid: adminUid, slug: 'global-moderators' });\n            assert(await Groups.isMember(adminUid, 'Global Moderators'));\n        });\n    });\n\n    describe('.leave()', () => {\n        it('should remove a user from a group', (done) => {\n            Groups.leave('Test', testUid, (err) => {\n                assert.ifError(err);\n\n                Groups.isMember(testUid, 'Test', (err, isMember) => {\n                    assert.ifError(err);\n                    assert.strictEqual(false, isMember);\n\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.leaveAllGroups()', () => {\n        it('should remove a user from all groups', (done) => {\n            Groups.leaveAllGroups(testUid, (err) => {\n                assert.ifError(err);\n\n                const groups = ['Test', 'Hidden'];\n                async.every(groups, (group, next) => {\n                    Groups.isMember(testUid, group, (err, isMember) => {\n                        next(err, !isMember);\n                    });\n                }, (err, result) => {\n                    assert.ifError(err);\n                    assert(result);\n\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.show()', () => {\n        it('should make a group visible', (done) => {\n            Groups.show('Test', function (err) {\n                assert.ifError(err);\n                assert.equal(arguments.length, 1);\n                db.isSortedSetMember('groups:visible:createtime', 'Test', (err, isMember) => {\n                    assert.ifError(err);\n                    assert.strictEqual(isMember, true);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('.hide()', () => {\n        it('should make a group hidden', (done) => {\n            Groups.hide('Test', function (err) {\n                assert.ifError(err);\n                assert.equal(arguments.length, 1);\n                db.isSortedSetMember('groups:visible:createtime', 'Test', (err, isMember) => {\n                    assert.ifError(err);\n                    assert.strictEqual(isMember, false);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('socket methods', () => {\n        it('should error if data is null', (done) => {\n            socketGroups.before({ uid: 0 }, 'groups.join', null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should not error if data is valid', (done) => {\n            socketGroups.before({ uid: 0 }, 'groups.join', {}, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should return error if not logged in', async () => {\n            try {\n                await apiGroups.join({ uid: 0 }, {});\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-uid]]');\n            }\n        });\n\n        it('should return error if group name is special', async () => {\n            try {\n                await apiGroups.join({ uid: testUid }, { slug: 'administrators', uid: testUid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:not-allowed]]');\n            }\n        });\n\n        it('should error if group does not exist', async () => {\n            try {\n                await apiGroups.join({ uid: adminUid }, { slug: 'doesnotexist', uid: adminUid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-group]]');\n            }\n        });\n\n        it('should join test group', async () => {\n            meta.config.allowPrivateGroups = 0;\n            await apiGroups.join({ uid: adminUid }, { slug: 'test', uid: adminUid });\n            const isMember = await Groups.isMember(adminUid, 'Test');\n            assert(isMember);\n        });\n\n        it('should error if not logged in', async () => {\n            try {\n                await apiGroups.leave({ uid: 0 }, {});\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-uid]]');\n            }\n        });\n\n        it('should return error if group name is special', async () => {\n            try {\n                await apiGroups.leave({ uid: adminUid }, { slug: 'administrators', uid: adminUid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:cant-remove-self-as-admin]]');\n            }\n        });\n\n        it('should leave test group', async () => {\n            await apiGroups.leave({ uid: adminUid }, { slug: 'test', uid: adminUid });\n            const isMember = await Groups.isMember(adminUid, 'Test');\n            assert(!isMember);\n        });\n\n        it('should fail to join if group is private and join requests are disabled', async () => {\n            meta.config.allowPrivateGroups = 1;\n            try {\n                await apiGroups.join({ uid: testUid }, { slug: 'privatenojoin', uid: testUid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:group-join-disabled]]');\n            }\n        });\n\n        it('should fail to leave if group is private and leave is disabled', async () => {\n            await Groups.join('PrivateNoLeave', testUid);\n            const isMember = await Groups.isMember(testUid, 'PrivateNoLeave');\n            assert(isMember);\n            try {\n                await apiGroups.leave({ uid: testUid }, { slug: 'privatenoleave', uid: testUid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:group-leave-disabled]]');\n            }\n        });\n\n        it('should join if user is admin', async () => {\n            await apiGroups.join({ uid: adminUid }, { slug: 'privatecanjoin', uid: adminUid });\n            const isMember = await Groups.isMember(adminUid, 'PrivateCanJoin');\n            assert(isMember);\n        });\n\n        it('should request membership for regular user', async () => {\n            await apiGroups.join({ uid: testUid }, { slug: 'privatecanjoin', uid: testUid });\n            const isPending = await Groups.isPending(testUid, 'PrivateCanJoin');\n            assert(isPending);\n        });\n\n        it('should reject membership of user', (done) => {\n            socketGroups.reject({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: testUid }, (err) => {\n                assert.ifError(err);\n                Groups.isInvited(testUid, 'PrivateCanJoin', (err, invited) => {\n                    assert.ifError(err);\n                    assert.equal(invited, false);\n                    done();\n                });\n            });\n        });\n\n        it('should error if not owner or admin', (done) => {\n            socketGroups.accept({ uid: 0 }, { groupName: 'PrivateCanJoin', toUid: testUid }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should accept membership of user', async () => {\n            await apiGroups.join({ uid: testUid }, { slug: 'privatecanjoin', uid: testUid });\n            await socketGroups.accept({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: testUid });\n            const isMember = await Groups.isMember(testUid, 'PrivateCanJoin');\n            assert(isMember);\n        });\n\n        it('should reject/accept all memberships requests', async () => {\n            async function requestMembership(uid1, uid2) {\n                await apiGroups.join({ uid: uid1 }, { slug: 'privatecanjoin', uid: uid1 });\n                await apiGroups.join({ uid: uid2 }, { slug: 'privatecanjoin', uid: uid2 });\n            }\n            const [uid1, uid2] = await Promise.all([\n                User.create({ username: 'groupuser1' }),\n                User.create({ username: 'groupuser2' }),\n            ]);\n            await requestMembership(uid1, uid2);\n            await socketGroups.rejectAll({ uid: adminUid }, { groupName: 'PrivateCanJoin' });\n            const pending = await Groups.getPending('PrivateCanJoin');\n            assert.equal(pending.length, 0);\n            await requestMembership(uid1, uid2);\n            await socketGroups.acceptAll({ uid: adminUid }, { groupName: 'PrivateCanJoin' });\n            const isMembers = await Groups.isMembers([uid1, uid2], 'PrivateCanJoin');\n            assert.deepStrictEqual(isMembers, [true, true]);\n        });\n\n        it('should issue invite to user', (done) => {\n            User.create({ username: 'invite1' }, (err, uid) => {\n                assert.ifError(err);\n                socketGroups.issueInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: uid }, (err) => {\n                    assert.ifError(err);\n                    Groups.isInvited(uid, 'PrivateCanJoin', (err, isInvited) => {\n                        assert.ifError(err);\n                        assert(isInvited);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketGroups.issueMassInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', usernames: null }, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should issue mass invite to users', (done) => {\n            User.create({ username: 'invite2' }, (err, uid) => {\n                assert.ifError(err);\n                socketGroups.issueMassInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', usernames: 'invite1, invite2' }, (err) => {\n                    assert.ifError(err);\n                    Groups.isInvited([adminUid, uid], 'PrivateCanJoin', (err, isInvited) => {\n                        assert.ifError(err);\n                        assert.deepStrictEqual(isInvited, [false, true]);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should rescind invite', (done) => {\n            User.create({ username: 'invite3' }, (err, uid) => {\n                assert.ifError(err);\n                socketGroups.issueInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: uid }, (err) => {\n                    assert.ifError(err);\n                    socketGroups.rescindInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: uid }, (err) => {\n                        assert.ifError(err);\n                        Groups.isInvited(uid, 'PrivateCanJoin', (err, isInvited) => {\n                            assert.ifError(err);\n                            assert(!isInvited);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should error if user is not invited', (done) => {\n            socketGroups.acceptInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin' }, (err) => {\n                assert.equal(err.message, '[[error:not-invited]]');\n                done();\n            });\n        });\n\n        it('should accept invite', (done) => {\n            User.create({ username: 'invite4' }, (err, uid) => {\n                assert.ifError(err);\n                socketGroups.issueInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: uid }, (err) => {\n                    assert.ifError(err);\n                    socketGroups.acceptInvite({ uid: uid }, { groupName: 'PrivateCanJoin' }, (err) => {\n                        assert.ifError(err);\n                        Groups.isMember(uid, 'PrivateCanJoin', (err, isMember) => {\n                            assert.ifError(err);\n                            assert(isMember);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should reject invite', (done) => {\n            User.create({ username: 'invite5' }, (err, uid) => {\n                assert.ifError(err);\n                socketGroups.issueInvite({ uid: adminUid }, { groupName: 'PrivateCanJoin', toUid: uid }, (err) => {\n                    assert.ifError(err);\n                    socketGroups.rejectInvite({ uid: uid }, { groupName: 'PrivateCanJoin' }, (err) => {\n                        assert.ifError(err);\n                        Groups.isInvited(uid, 'PrivateCanJoin', (err, isInvited) => {\n                            assert.ifError(err);\n                            assert(!isInvited);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should grant ownership to user', async () => {\n            await apiGroups.grant({ uid: adminUid }, { slug: 'privatecanjoin', uid: testUid });\n            const isOwner = await Groups.ownership.isOwner(testUid, 'PrivateCanJoin');\n            assert(isOwner);\n        });\n\n        it('should rescind ownership from user', async () => {\n            await apiGroups.rescind({ uid: adminUid }, { slug: 'privatecanjoin', uid: testUid });\n            const isOwner = await Groups.ownership.isOwner(testUid, 'PrivateCanJoin');\n            assert(!isOwner);\n        });\n\n        it('should fail to kick user with invalid data', (done) => {\n            socketGroups.kick({ uid: adminUid }, { groupName: 'PrivateCanJoin', uid: adminUid }, (err) => {\n                assert.equal(err.message, '[[error:cant-kick-self]]');\n                done();\n            });\n        });\n\n        it('should kick user from group', (done) => {\n            socketGroups.kick({ uid: adminUid }, { groupName: 'PrivateCanJoin', uid: testUid }, (err) => {\n                assert.ifError(err);\n                Groups.isMember(testUid, 'PrivateCanJoin', (err, isMember) => {\n                    assert.ifError(err);\n                    assert(!isMember);\n                    done();\n                });\n            });\n        });\n\n        it('should fail to create group with invalid data', async () => {\n            try {\n                await apiGroups.create({ uid: 0 }, {});\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should fail to create group if group creation is disabled', async () => {\n            try {\n                await apiGroups.create({ uid: testUid }, { name: 'avalidname' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should fail to create group if name is privilege group', async () => {\n            try {\n                await apiGroups.create({ uid: 1 }, { name: 'cid:1:privileges:groups:find' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n            }\n        });\n\n        it('should create/update group', async () => {\n            const groupData = await apiGroups.create({ uid: adminUid }, { name: 'createupdategroup' });\n            assert(groupData);\n            const data = {\n                slug: 'createupdategroup',\n                name: 'renamedupdategroup',\n                description: 'cat group',\n                userTitle: 'cats',\n                userTitleEnabled: 1,\n                disableJoinRequests: 1,\n                hidden: 1,\n                private: 0,\n            };\n            await apiGroups.update({ uid: adminUid }, data);\n            const updatedData = await Groups.get('renamedupdategroup', {});\n            assert.equal(updatedData.name, 'renamedupdategroup');\n            assert.equal(updatedData.userTitle, 'cats');\n            assert.equal(updatedData.description, 'cat group');\n            assert.equal(updatedData.hidden, true);\n            assert.equal(updatedData.disableJoinRequests, true);\n            assert.equal(updatedData.private, false);\n        });\n\n        it('should fail to create a group with name guests', async () => {\n            try {\n                await apiGroups.create({ uid: adminUid }, { name: 'guests' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n            }\n        });\n\n        it('should fail to rename guests group', async () => {\n            const data = {\n                slug: 'guests',\n                name: 'guests2',\n            };\n\n            try {\n                await apiGroups.update({ uid: adminUid }, data);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n            }\n        });\n\n        it('should delete group', async () => {\n            await apiGroups.delete({ uid: adminUid }, { slug: 'renamedupdategroup' });\n            const exists = await Groups.exists('renamedupdategroup');\n            assert(!exists);\n        });\n\n        it('should fail to delete group if name is special', async () => {\n            const specialGroups = [\n                'administrators', 'registered-users', 'verified-users',\n                'unverified-users', 'global-moderators',\n            ];\n            for (const slug of specialGroups) {\n                try {\n                    // eslint-disable-next-line no-await-in-loop\n                    await apiGroups.delete({ uid: adminUid }, { slug: slug });\n                    assert(false);\n                } catch (err) {\n                    assert.equal(err.message, '[[error:not-allowed]]');\n                }\n            }\n        });\n\n        it('should fail to delete group if name is special', async () => {\n            try {\n                await apiGroups.delete({ uid: adminUid }, { slug: 'guests' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-group-name]]');\n            }\n        });\n\n        it('should fail to load more groups with invalid data', (done) => {\n            socketGroups.loadMore({ uid: adminUid }, {}, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should load more groups', (done) => {\n            socketGroups.loadMore({ uid: adminUid }, { after: 0, sort: 'count' }, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data.groups));\n                done();\n            });\n        });\n\n        it('should fail to load more members with invalid data', (done) => {\n            socketGroups.loadMoreMembers({ uid: adminUid }, {}, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should load more members', (done) => {\n            socketGroups.loadMoreMembers({ uid: adminUid }, { after: 0, groupName: 'PrivateCanJoin' }, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data.users));\n                done();\n            });\n        });\n    });\n\n    describe('api methods', () => {\n        const apiGroups = require('../src/api/groups');\n        it('should fail to create group with invalid data', async () => {\n            let err;\n            try {\n                await apiGroups.create({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n\n        it('should fail to create group if group name is privilege group', async () => {\n            let err;\n            try {\n                await apiGroups.create({ uid: adminUid }, { name: 'cid:1:privileges:read' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-group-name]]');\n        });\n\n        it('should create a group', async () => {\n            const groupData = await apiGroups.create({ uid: adminUid }, { name: 'newgroup', description: 'group created by admin' });\n            assert.equal(groupData.name, 'newgroup');\n            assert.equal(groupData.description, 'group created by admin');\n            assert.equal(groupData.private, 1);\n            assert.equal(groupData.hidden, 0);\n            assert.equal(groupData.memberCount, 1);\n        });\n\n        it('should fail to join with invalid data', async () => {\n            let err;\n            try {\n                await apiGroups.join({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n\n        it('should add user to group', async () => {\n            await apiGroups.join({ uid: adminUid }, { uid: testUid, slug: 'newgroup' });\n            const isMember = await Groups.isMember(testUid, 'newgroup');\n            assert(isMember);\n        });\n\n        it('should not error if user is already member', async () => {\n            await apiGroups.join({ uid: adminUid }, { uid: testUid, slug: 'newgroup' });\n        });\n\n        it('it should fail with invalid data', async () => {\n            let err;\n            try {\n                await apiGroups.leave({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n\n        it('it should fail if admin tries to remove self', async () => {\n            let err;\n            try {\n                await apiGroups.leave({ uid: adminUid }, { uid: adminUid, slug: 'administrators' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:cant-remove-self-as-admin]]');\n        });\n\n        it('should not error if user is not member', async () => {\n            await apiGroups.leave({ uid: adminUid }, { uid: 3, slug: 'newgroup' });\n        });\n\n        it('should fail if trying to remove someone else from group', async () => {\n            let err;\n            try {\n                await apiGroups.leave({ uid: testUid }, { uid: adminUid, slug: 'newgroup' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:no-privileges]]');\n        });\n\n        it('should remove user from group', async () => {\n            await apiGroups.leave({ uid: adminUid }, { uid: testUid, slug: 'newgroup' });\n            const isMember = await Groups.isMember(testUid, 'newgroup');\n            assert(!isMember);\n        });\n\n        it('should fail with invalid data', async () => {\n            let err;\n            try {\n                await apiGroups.update({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n\n        it('should update group', async () => {\n            const data = {\n                slug: 'newgroup',\n                name: 'renamedgroup',\n                description: 'cat group',\n                userTitle: 'cats',\n                userTitleEnabled: 1,\n                disableJoinRequests: 1,\n                hidden: 1,\n                private: 0,\n            };\n            await apiGroups.update({ uid: adminUid }, data);\n            const groupData = await Groups.get('renamedgroup', {});\n            assert.equal(groupData.name, 'renamedgroup');\n            assert.equal(groupData.userTitle, 'cats');\n            assert.equal(groupData.description, 'cat group');\n            assert.equal(groupData.hidden, true);\n            assert.equal(groupData.disableJoinRequests, true);\n            assert.equal(groupData.private, false);\n        });\n    });\n\n    describe('groups cover', () => {\n        const socketGroups = require('../src/socket.io/groups');\n        let regularUid;\n        const logoPath = path.join(__dirname, '../test/files/test.png');\n        const imagePath = path.join(__dirname, '../test/files/groupcover.png');\n        before((done) => {\n            User.create({ username: 'regularuser', password: '123456' }, (err, uid) => {\n                assert.ifError(err);\n                regularUid = uid;\n                async.series([\n                    function (next) {\n                        Groups.join('Test', adminUid, next);\n                    },\n                    function (next) {\n                        Groups.join('Test', regularUid, next);\n                    },\n                    function (next) {\n                        helpers.copyFile(logoPath, imagePath, next);\n                    },\n                ], done);\n            });\n        });\n\n        it('should fail if user is not logged in or not owner', (done) => {\n            socketGroups.cover.update({ uid: 0 }, { imageData: 'asd' }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                socketGroups.cover.update({ uid: regularUid }, { groupName: 'Test', imageData: 'asd' }, (err) => {\n                    assert.equal(err.message, '[[error:no-privileges]]');\n                    done();\n                });\n            });\n        });\n\n        it('should upload group cover image from file', (done) => {\n            const data = {\n                groupName: 'Test',\n                file: {\n                    path: imagePath,\n                    type: 'image/png',\n                },\n            };\n            Groups.updateCover({ uid: adminUid }, data, (err, data) => {\n                assert.ifError(err);\n                Groups.getGroupFields('Test', ['cover:url'], (err, groupData) => {\n                    assert.ifError(err);\n                    assert.equal(nconf.get('relative_path') + data.url, groupData['cover:url']);\n                    if (nconf.get('relative_path')) {\n                        assert(!data.url.startsWith(nconf.get('relative_path')));\n                        assert(groupData['cover:url'].startsWith(nconf.get('relative_path')), groupData['cover:url']);\n                    }\n                    done();\n                });\n            });\n        });\n\n\n        it('should upload group cover image from data', (done) => {\n            const data = {\n                groupName: 'Test',\n                imageData: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAACcJJREFUeNqMl9tvnNV6xn/f+s5z8DCeg88Zj+NYdhJH4KShFoJAIkzVphLVJnsDaiV6gUKaC2qQUFVATbnoValAakuQYKMqBKUUJCgI9XBBSmOROMqGoCStHbA9sWM7nrFn/I3n9B17kcwoabfarj9gvet53+d9nmdJAwMDAAgh8DyPtbU1XNfFMAwkScK2bTzPw/M8dF1/SAhxKAiCxxVF2aeqqqTr+q+Af+7o6Ch0d3f/69TU1KwkSRiGwbFjx3jmmWd47rnn+OGHH1BVFYX/5QRBkPQ87xeSJP22YRi/oapqStM0PM/D931kWSYIgnHf98cXFxepVqtomjZt2/Zf2bb990EQ4Pv+PXfeU1CSpGYhfN9/TgjxQTQaJQgCwuEwQRBQKpUwDAPTNPF9n0ajAYDv+8zPzzM+Pr6/Wq2eqdVqfxOJRA6Zpnn57hrivyEC0IQQZ4Mg+MAwDCKRCJIkUa/XEUIQi8XQNI1QKIQkSQghUBQFIQSmaTI7OwtAuVxOTE9Pfzc9Pf27lUqlBUgulUoUi0VKpRKqqg4EQfAfiqLsDIfDAC0E4XCYaDSKEALXdalUKvfM1/d9hBBYlkUul2N4eJi3335bcl33mW+++aaUz+cvSJKE8uKLL6JpGo7j8Omnn/7d+vp6sr+/HyEEjuMgyzKu6yJJEsViEVVV8TyPjY2NVisV5fZkTNMkkUhw8+ZN6vU6Kysr7Nmzh9OnT7/12GOPDS8sLByT7rQR4A9XV1d/+cILLzA9PU0kEmF4eBhFUTh//jyWZaHrOkII0uk0jUaDWq1GJpOhWCyysrLC1tYWnuehqir79+9H13W6urp48803+f7773n++ef/4G7S/H4ikUCSJNbX11trcuvWLcrlMrIs4zgODzzwABMTE/i+T7lcpq2tjUqlwubmJrZts7y8jBCCkZERGo0G2WyWkydPkkql6Onp+eMmwihwc3JyMvrWW2+RTCYBcF0XWZbRdZ3l5WX27NnD008/TSwWQ1VVyuVy63GhUIhEIkEqlcJxHCzLIhaLMTQ0xJkzZ7Btm3379lmS53kIIczZ2dnFsbGxRK1Wo729HQDP8zAMg5WVFXp7e5mcnKSzs5N8Po/rutTrdVzXbQmHrutEo1FM00RVVXp7e0kkEgRBwMWLF9F1vaxUq1UikUjtlVdeuV6pVBJ9fX3Ytn2bwrLMysoKXV1dTE5OkslksCwLTdMwDANVVdnY2CAIApLJJJFIBMdxiMfj7Nq1C1VViUajLQCvvvrqkhKJRJiZmfmdb7/99jeTySSyLLfWodFoEAqFOH78OLt37yaXy2GaJoqisLy8zNTUFFevXiUIAtrb29m5cyePPPJIa+cymQz1eh2A0dFRCoXCsgIwNTW1J5/P093dTbFYRJZlJEmiWq1y4MABxsbGqNVqhEIh6vU6QRBQLpcxDIPh4WE8z2NxcZFTp05x7tw5Xn755ZY6dXZ2tliZzWa/EwD1ev3RsbExxsfHSafTVCoVGo0Gqqqya9cuIpEIQgh832dtbY3FxUUA+vr62LZtG2NjYxw5coTDhw+ztLTEyZMnuXr1KoVC4R4d3bt375R84sQJEY/H/2Jubq7N9326urqwbZt6vY5pmhw5coS+vr4W9YvFIrdu3WJqagohBFeuXOHcuXOtue7evRtN01rtfO+991haWmJkZGQrkUi8JIC9iqL0BkFAIpFACMETTzxBV1cXiUSC7u5uHMfB8zyCIMA0TeLxONlsFlmW8X2fwcFBHMdhfn6eer1Oe3s7Dz30EBMTE1y6dImjR49y6tSppR07dqwrjuM8+OWXXzI0NMTly5e5du0aQ0NDTExMkMvlCIKAIAhaIh2LxQiHw0QiEfL5POl0mlqtRq1Wo6OjA8uykGWZdDrN0tISvb29vPPOOzz++OPk83lELpf7rXfffRfDMOjo6MBxHEqlEocOHWLHjh00Gg0kSULTNIS4bS6qqhKPxxkaGmJ4eJjR0VH279/PwMAA27dvJ5vN4vs+X331FR9//DGzs7OEQiE++eQTlPb29keuX7/OtWvXOH78ONVqlZs3b9LW1kYmk8F13dZeCiGQJAnXdRFCYBgGsiwjhMC2bQqFAkEQoOs6P/74Iw8++CCDg4Pous6xY8f47LPPkIIguDo2Nrbzxo0bfPjhh9i2zczMTHNvcF2XpsZalkWj0cB1Xe4o1O3YoCisra3x008/EY/H6erqAuDAgQNEIhGCIODQoUP/ubCwMCKAjx599FHW19f56KOP6OjooFgsks/niUajKIqCbds4joMQAiFESxxs226xd2Zmhng8Tl9fH67r0mg0sG2bbDZLpVIhl8vd5gHwtysrKy8Dcdd1mZubo6enh1gsRrVabZlrk6VND/R9n3q9TqVSQdd1QqEQi4uLnD9/nlKpxODgIHv37gXAcRyCICiFQiHEzp07i1988cUfKYpCIpHANE22b9/eUhNFUVotDIKghc7zPCzLolKpsLW1RVtbG0EQ4DgOmqbR09NDM1qUSiWAPwdQ7ujjmf7+/kQymfxrSZJQVZWtra2WG+i63iKH53m4rku1WqVcLmNZFu3t7S2x7+/vJ51O89prr7VYfenSpcPAP1UqFeSHH36YeDxOKpW6eP/9988Bv9d09nw+T7VapVKptJjZnE2tVmNtbY1cLke5XGZra4vNzU16enp49tlnGRgYaD7iTxqNxgexWIzDhw+jNEPQHV87NT8/f+PChQtnR0ZGqFarrUVuOsDds2u2b2FhgVQqRSQSYWFhgStXrtDf308ymcwBf3nw4EEOHjx4O5c2lURVVRzHYXp6+t8uX7785IULFz7LZDLous59991HOBy+h31N9xgdHSWTyVCtVhkaGmLfvn1MT08zPz/PzMzM6c8//9xr+uE9QViWZer1OhsbGxiG8fns7OzPc7ncx729vXR3d1OpVNi2bRuhUAhZljEMA9/3sW0bVVVZWlri4sWLjI+P8/rrr/P111/z5JNPXrIs69cn76ZeGoaBpmm0tbX9Q6FQeHhubu7fC4UCkUiE1dVVstks8Xgc0zSRZZlGo9ESAdM02djYoNFo8MYbb2BZ1mYoFOKuZPjr/xZBEHCHred83x/b3Nz8l/X19aRlWWxsbNDZ2cnw8DDhcBjf96lWq/T09HD06FGeeuopXnrpJc6ePUs6nb4hhPi/C959ZFn+TtO0lG3bJ0ql0p85jsPW1haFQoG2tjYkSWpF/Uwmw9raGu+//z7A977vX2+GrP93wSZiTdNOGIbxy3K5/DPHcfYXCoVe27Yzpmm2m6bppVKp/Orqqnv69OmoZVn/mEwm/9TzvP9x138NAMpJ4VFTBr6SAAAAAElFTkSuQmCC',\n            };\n            socketGroups.cover.update({ uid: adminUid }, data, (err, data) => {\n                assert.ifError(err);\n                Groups.getGroupFields('Test', ['cover:url'], (err, groupData) => {\n                    assert.ifError(err);\n                    assert.equal(nconf.get('relative_path') + data.url, groupData['cover:url']);\n                    done();\n                });\n            });\n        });\n\n        it('should fail to upload group cover with invalid image', (done) => {\n            const data = {\n                groupName: 'Test',\n                file: {\n                    path: imagePath,\n                    type: 'image/png',\n                },\n            };\n            socketGroups.cover.update({ uid: adminUid }, data, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should fail to upload group cover with invalid image', (done) => {\n            const data = {\n                groupName: 'Test',\n                imageData: 'data:image/svg;base64,iVBORw0KGgoAAAANSUhEUgAAABwA',\n            };\n            socketGroups.cover.update({ uid: adminUid }, data, (err, data) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        it('should update group cover position', (done) => {\n            const data = {\n                groupName: 'Test',\n                position: '50% 50%',\n            };\n            socketGroups.cover.update({ uid: adminUid }, data, (err) => {\n                assert.ifError(err);\n                Groups.getGroupFields('Test', ['cover:position'], (err, groupData) => {\n                    assert.ifError(err);\n                    assert.equal('50% 50%', groupData['cover:position']);\n                    done();\n                });\n            });\n        });\n\n        it('should fail to update cover position if group name is missing', (done) => {\n            Groups.updateCoverPosition('', '50% 50%', (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should fail to remove cover if not logged in', (done) => {\n            socketGroups.cover.remove({ uid: 0 }, { groupName: 'Test' }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail to remove cover if not owner', (done) => {\n            socketGroups.cover.remove({ uid: regularUid }, { groupName: 'Test' }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should remove cover', async () => {\n            const fields = ['cover:url', 'cover:thumb:url'];\n            const values = await Groups.getGroupFields('Test', fields);\n            await socketGroups.cover.remove({ uid: adminUid }, { groupName: 'Test' });\n\n            fields.forEach((field) => {\n                const filename = values[field].split('/').pop();\n                const filePath = path.join(nconf.get('upload_path'), 'files', filename);\n                assert.strictEqual(fs.existsSync(filePath), false);\n            });\n\n            const groupData = await db.getObjectFields('group:Test', ['cover:url']);\n            assert(!groupData['cover:url']);\n        });\n    });\n});\n"},"test/i18n.js":{"tests":[{"id":"1549","name":"i18n should contain folders named after the language code"},{"id":"1550","name":"i18n "}],"source":"'use strict';\n\n// For tests relating to the translator module, check translator.js\n\nconst assert = require('assert');\nconst path = require('path');\nconst fs = require('fs');\n\nconst file = require('../src/file');\n\nconst db = require('./mocks/databasemock');\n\ndescribe('i18n', () => {\n    let folders;\n\n    before(async function () {\n        if (process.env.GITHUB_EVENT_NAME === 'pull_request') {\n            this.skip();\n        }\n\n        folders = await fs.promises.readdir(path.resolve(__dirname, '../public/language'));\n        folders = folders.filter(f => f !== 'README.md');\n    });\n\n    it('should contain folders named after the language code', async () => {\n        const valid = /(?:README.md|^[a-z]{2}(?:-[A-Z]{2})?$|^[a-z]{2}(?:-x-[a-z]+)?$)/; // good luck\n\n        folders.forEach((folder) => {\n            assert(valid.test(folder));\n        });\n    });\n\n    // There has to be a better way to generate tests asynchronously...\n    it('', async () => {\n        const sourcePath = path.resolve(__dirname, '../public/language/en-GB');\n        const fullPaths = await file.walk(sourcePath);\n        const sourceFiles = fullPaths.map(path => path.replace(sourcePath, ''));\n        const sourceStrings = new Map();\n\n        describe('source language file structure', () => {\n            it('should only contain valid JSON files', async () => {\n                try {\n                    fullPaths.forEach((fullPath) => {\n                        if (fullPath.endsWith('_DO_NOT_EDIT_FILES_HERE.md')) {\n                            return;\n                        }\n\n                        const hash = require(fullPath);\n                        sourceStrings.set(fullPath.replace(sourcePath, ''), hash);\n                    });\n                } catch (e) {\n                    assert(!e, `Invalid JSON found: ${e.message}`);\n                }\n            });\n        });\n\n        folders.forEach((language) => {\n            describe(`\"${language}\" file structure`, () => {\n                let files;\n\n                before(async () => {\n                    const translationPath = path.resolve(__dirname, `../public/language/${language}`);\n                    files = (await file.walk(translationPath)).map(path => path.replace(translationPath, ''));\n                });\n\n                it('translations should contain every language file contained in the source language directory', () => {\n                    sourceFiles.forEach((relativePath) => {\n                        assert(files.includes(relativePath), `${relativePath.slice(1)} was found in source files but was not found in language \"${language}\" (likely not internationalized)`);\n                    });\n                });\n\n                it('should not contain any extraneous files not included in the source language directory', () => {\n                    files.forEach((relativePath) => {\n                        assert(sourceFiles.includes(relativePath), `${relativePath.slice(1)} was found in language \"${language}\" but there is no source file for it (likely removed from en-GB)`);\n                    });\n                });\n            });\n\n            describe(`\"${language}\" file contents`, () => {\n                let fullPaths;\n                const translationPath = path.resolve(__dirname, `../public/language/${language}`);\n                const strings = new Map();\n\n                before(async () => {\n                    fullPaths = await file.walk(translationPath);\n                });\n\n                it('should contain only valid JSON files', () => {\n                    try {\n                        fullPaths.forEach((fullPath) => {\n                            if (fullPath.endsWith('_DO_NOT_EDIT_FILES_HERE.md')) {\n                                return;\n                            }\n\n                            const hash = require(fullPath);\n                            strings.set(fullPath.replace(translationPath, ''), hash);\n                        });\n                    } catch (e) {\n                        assert(!e, `Invalid JSON found: ${e.message}`);\n                    }\n                });\n\n                it('should contain every translation key contained in its source counterpart', () => {\n                    const sourceArr = Array.from(sourceStrings.keys());\n                    sourceArr.forEach((namespace) => {\n                        const sourceKeys = Object.keys(sourceStrings.get(namespace));\n                        const translationKeys = Object.keys(strings.get(namespace));\n\n                        assert(sourceKeys && translationKeys);\n                        sourceKeys.forEach((key) => {\n                            assert(translationKeys.includes(key), `${namespace.slice(1, -5)}:${key} missing in ${language}`);\n                        });\n                        assert.strictEqual(\n                            sourceKeys.length,\n                            translationKeys.length,\n                            `Extra keys found in namespace ${namespace.slice(1, -5)} for language \"${language}\"`\n                        );\n                    });\n                });\n            });\n        });\n    });\n});\n"},"test/image.js":{"tests":[{"id":"1551","name":"image should normalise image"},{"id":"1552","name":"image should resize an image"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst path = require('path');\n\nconst db = require('./mocks/databasemock');\nconst image = require('../src/image');\nconst file = require('../src/file');\n\ndescribe('image', () => {\n    it('should normalise image', (done) => {\n        image.normalise(path.join(__dirname, 'files/normalise.jpg'), '.jpg', (err) => {\n            assert.ifError(err);\n            file.exists(path.join(__dirname, 'files/normalise.jpg.png'), (err, exists) => {\n                assert.ifError(err);\n                assert(exists);\n                done();\n            });\n        });\n    });\n\n    it('should resize an image', (done) => {\n        image.resizeImage({\n            path: path.join(__dirname, 'files/normalise.jpg'),\n            target: path.join(__dirname, 'files/normalise-resized.jpg'),\n            width: 50,\n            height: 40,\n        }, (err) => {\n            assert.ifError(err);\n            image.size(path.join(__dirname, 'files/normalise-resized.jpg'), (err, bitmap) => {\n                assert.ifError(err);\n                assert.equal(bitmap.width, 50);\n                assert.equal(bitmap.height, 40);\n                done();\n            });\n        });\n    });\n});\n"},"test/locale-detect.js":{"tests":[{"id":"1553","name":"Language detection should detect the language for a guest"},{"id":"1554","name":"Language detection should do nothing when disabled"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst request = require('request');\n\nconst db = require('./mocks/databasemock');\nconst meta = require('../src/meta');\n\ndescribe('Language detection', () => {\n    it('should detect the language for a guest', (done) => {\n        meta.configs.set('autoDetectLang', 1, (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/config`, {\n                headers: {\n                    'Accept-Language': 'de-DE,de;q=0.5',\n                },\n                json: true,\n            }, (err, res, body) => {\n                assert.ifError(err);\n                assert.ok(body);\n\n                assert.strictEqual(body.userLang, 'de');\n                done();\n            });\n        });\n    });\n\n    it('should do nothing when disabled', (done) => {\n        meta.configs.set('autoDetectLang', 0, (err) => {\n            assert.ifError(err);\n            request(`${nconf.get('url')}/api/config`, {\n                headers: {\n                    'Accept-Language': 'de-DE,de;q=0.5',\n                },\n                json: true,\n            }, (err, res, body) => {\n                assert.ifError(err);\n                assert.ok(body);\n\n                assert.strictEqual(body.userLang, 'en-GB');\n                done();\n            });\n        });\n    });\n});\n"},"test/messaging.js":{"tests":[{"id":"1555","name":"Messaging Library .canMessage() should allow messages to be sent to an unrestricted user"},{"id":"1556","name":"Messaging Library .canMessage() should NOT allow messages to be sent to a restricted user"},{"id":"1557","name":"Messaging Library .canMessage() should always allow admins through"},{"id":"1558","name":"Messaging Library .canMessage() should allow messages to be sent to a restricted user if restricted user follows sender"},{"id":"1559","name":"Messaging Library rooms should fail to create a new chat room with invalid data"},{"id":"1560","name":"Messaging Library rooms should return rate limit error on second try"},{"id":"1561","name":"Messaging Library rooms should create a new chat room"},{"id":"1562","name":"Messaging Library rooms should send a user-join system message when a chat room is created"},{"id":"1563","name":"Messaging Library rooms should fail to add user to room with invalid data"},{"id":"1564","name":"Messaging Library rooms should add a user to room"},{"id":"1565","name":"Messaging Library rooms should get users in room"},{"id":"1566","name":"Messaging Library rooms should throw error if user is not in room"},{"id":"1567","name":"Messaging Library rooms should fail to add users to room if max is reached"},{"id":"1568","name":"Messaging Library rooms should fail to add users to room if user does not exist"},{"id":"1569","name":"Messaging Library rooms should fail to add self to room"},{"id":"1570","name":"Messaging Library rooms should fail to leave room with invalid data"},{"id":"1571","name":"Messaging Library rooms should leave the chat room"},{"id":"1572","name":"Messaging Library rooms should send a user-leave system message when a user leaves the chat room"},{"id":"1573","name":"Messaging Library rooms should not send a user-leave system message when a user tries to leave a room they are not in"},{"id":"1574","name":"Messaging Library rooms should change owner when owner leaves room"},{"id":"1575","name":"Messaging Library rooms should change owner if owner is deleted"},{"id":"1576","name":"Messaging Library rooms should fail to remove user from room"},{"id":"1577","name":"Messaging Library rooms should fail to remove user from room if user does not exist"},{"id":"1578","name":"Messaging Library rooms should remove user from room"},{"id":"1579","name":"Messaging Library rooms should fail to send a message to room with invalid data"},{"id":"1580","name":"Messaging Library rooms should fail to send chat if content is empty"},{"id":"1581","name":"Messaging Library rooms should send a message to a room"},{"id":"1582","name":"Messaging Library rooms should fail to send second message due to rate limit"},{"id":"1583","name":"Messaging Library rooms should return invalid-data error"},{"id":"1584","name":"Messaging Library rooms should return not allowed error if mid is not in room"},{"id":"1585","name":"Messaging Library rooms should notify offline users of message"},{"id":"1586","name":"Messaging Library rooms should fail to get messages from room with invalid data"},{"id":"1587","name":"Messaging Library rooms should get messages from room"},{"id":"1588","name":"Messaging Library rooms should fail to mark read with invalid data"},{"id":"1589","name":"Messaging Library rooms should not error if user is not in room"},{"id":"1590","name":"Messaging Library rooms should mark room read"},{"id":"1591","name":"Messaging Library rooms should mark all rooms read"},{"id":"1592","name":"Messaging Library rooms should fail to rename room with invalid data"},{"id":"1593","name":"Messaging Library rooms should rename room"},{"id":"1594","name":"Messaging Library rooms should send a room-rename system message when a room is renamed"},{"id":"1595","name":"Messaging Library rooms should fail to load room with invalid-data"},{"id":"1596","name":"Messaging Library rooms should fail to load room if user is not in"},{"id":"1597","name":"Messaging Library rooms should load chat room"},{"id":"1598","name":"Messaging Library rooms should return true if user is dnd"},{"id":"1599","name":"Messaging Library rooms should fail to load recent chats with invalid data"},{"id":"1600","name":"Messaging Library rooms should load recent chats of user"},{"id":"1601","name":"Messaging Library rooms should escape teaser"},{"id":"1602","name":"Messaging Library rooms should fail to check if user has private chat with invalid data"},{"id":"1603","name":"Messaging Library rooms should check if user has private chat with another uid"},{"id":"1604","name":"Messaging Library edit/delete should fail to edit message with invalid data"},{"id":"1605","name":"Messaging Library edit/delete should fail to edit message if new content is empty string"},{"id":"1606","name":"Messaging Library edit/delete should fail to edit message if not own message"},{"id":"1607","name":"Messaging Library edit/delete should fail to edit message if message not in room"},{"id":"1608","name":"Messaging Library edit/delete should edit message"},{"id":"1609","name":"Messaging Library edit/delete should fail to delete message with invalid data"},{"id":"1610","name":"Messaging Library edit/delete should fail to delete message if not owner"},{"id":"1611","name":"Messaging Library edit/delete should mark the message as deleted"},{"id":"1612","name":"Messaging Library edit/delete should show deleted message to original users"},{"id":"1613","name":"Messaging Library edit/delete should not show deleted message to other users"},{"id":"1614","name":"Messaging Library edit/delete should error out if a message is deleted again"},{"id":"1615","name":"Messaging Library edit/delete should restore the message"},{"id":"1616","name":"Messaging Library edit/delete should error out if a message is restored again"},{"id":"1617","name":"Messaging Library edit/delete disabled via ACP should error out for regular users"},{"id":"1618","name":"Messaging Library edit/delete disabled via ACP should succeed for administrators"},{"id":"1619","name":"Messaging Library edit/delete disabled via ACP should succeed for global moderators"},{"id":"1620","name":"Messaging Library controller should 404 if chat is disabled"},{"id":"1621","name":"Messaging Library controller should 500 for guest with no privilege error"},{"id":"1622","name":"Messaging Library controller should 404 for non-existent user"},{"id":"1623","name":"Messaging Library logged in chat controller should return chats page data"},{"id":"1624","name":"Messaging Library logged in chat controller should return room data"},{"id":"1625","name":"Messaging Library logged in chat controller should redirect to chats page"},{"id":"1626","name":"Messaging Library logged in chat controller should return 404 if user is not in room"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\nconst request = require('request-promise-native');\nconst nconf = require('nconf');\nconst util = require('util');\n\nconst sleep = util.promisify(setTimeout);\n\nconst db = require('./mocks/databasemock');\nconst meta = require('../src/meta');\nconst User = require('../src/user');\nconst Groups = require('../src/groups');\nconst Messaging = require('../src/messaging');\nconst helpers = require('./helpers');\nconst socketModules = require('../src/socket.io/modules');\nconst utils = require('../src/utils');\nconst translator = require('../src/translator');\n\ndescribe('Messaging Library', () => {\n    const mocks = {\n        users: {\n            foo: {}, // the admin\n            bar: {},\n            baz: {}, // the user with chat restriction enabled\n            herp: {},\n        },\n    };\n    let roomId;\n\n    let chatMessageDelay;\n\n    const callv3API = async (method, path, body, user) => {\n        const options = {\n            method,\n            body,\n            json: true,\n            jar: mocks.users[user].jar,\n            resolveWithFullResponse: true,\n            simple: false,\n        };\n\n        if (method !== 'get') {\n            options.headers = {\n                'x-csrf-token': mocks.users[user].csrf,\n            };\n        }\n\n        return request(`${nconf.get('url')}/api/v3${path}`, options);\n    };\n\n    before(async () => {\n        // Create 3 users: 1 admin, 2 regular\n        ({\n            foo: mocks.users.foo.uid,\n            bar: mocks.users.bar.uid,\n            baz: mocks.users.baz.uid,\n            herp: mocks.users.herp.uid,\n        } = await utils.promiseParallel({\n            foo: User.create({ username: 'foo', password: 'barbar' }), // admin\n            bar: User.create({ username: 'bar', password: 'bazbaz' }), // admin\n            baz: User.create({ username: 'baz', password: 'quuxquux' }), // restricted user\n            herp: User.create({ username: 'herp', password: 'derpderp' }), // a regular user\n        }));\n\n        await Groups.join('administrators', mocks.users.foo.uid);\n        await User.setSetting(mocks.users.baz.uid, 'restrictChat', '1');\n\n        ({ jar: mocks.users.foo.jar, csrf_token: mocks.users.foo.csrf } = await util.promisify(helpers.loginUser)('foo', 'barbar'));\n        ({ jar: mocks.users.bar.jar, csrf_token: mocks.users.bar.csrf } = await util.promisify(helpers.loginUser)('bar', 'bazbaz'));\n        ({ jar: mocks.users.baz.jar, csrf_token: mocks.users.baz.csrf } = await util.promisify(helpers.loginUser)('baz', 'quuxquux'));\n        ({ jar: mocks.users.herp.jar, csrf_token: mocks.users.herp.csrf } = await util.promisify(helpers.loginUser)('herp', 'derpderp'));\n\n        chatMessageDelay = meta.config.chatMessageDelay;\n        meta.config.chatMessageDelay = 0;\n    });\n\n    after(() => {\n        meta.configs.chatMessageDelay = chatMessageDelay;\n    });\n\n    describe('.canMessage()', () => {\n        it('should allow messages to be sent to an unrestricted user', (done) => {\n            Messaging.canMessageUser(mocks.users.baz.uid, mocks.users.herp.uid, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should NOT allow messages to be sent to a restricted user', async () => {\n            await User.setSetting(mocks.users.baz.uid, 'restrictChat', '1');\n            try {\n                await Messaging.canMessageUser(mocks.users.herp.uid, mocks.users.baz.uid);\n            } catch (err) {\n                assert.strictEqual(err.message, '[[error:chat-restricted]]');\n            }\n        });\n\n        it('should always allow admins through', (done) => {\n            Messaging.canMessageUser(mocks.users.foo.uid, mocks.users.baz.uid, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should allow messages to be sent to a restricted user if restricted user follows sender', (done) => {\n            User.follow(mocks.users.baz.uid, mocks.users.herp.uid, () => {\n                Messaging.canMessageUser(mocks.users.herp.uid, mocks.users.baz.uid, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('rooms', () => {\n        it('should fail to create a new chat room with invalid data', async () => {\n            const { body } = await callv3API('post', '/chats', {}, 'foo');\n            assert.equal(body.status.message, await translator.translate('[[error:required-parameters-missing, uids]]'));\n        });\n\n        it('should return rate limit error on second try', async () => {\n            const oldValue = meta.config.chatMessageDelay;\n            meta.config.chatMessageDelay = 1000;\n\n            await callv3API('post', '/chats', {\n                uids: [mocks.users.baz.uid],\n            }, 'foo');\n\n            const { statusCode, body } = await callv3API('post', `/chats`, {\n                uids: [mocks.users.baz.uid],\n            }, 'foo');\n\n            assert.equal(statusCode, 400);\n            assert.equal(body.status.code, 'bad-request');\n            assert.equal(body.status.message, await translator.translate('[[error:too-many-messages]]'));\n            meta.config.chatMessageDelay = oldValue;\n        });\n\n        it('should create a new chat room', async () => {\n            await User.setSetting(mocks.users.baz.uid, 'restrictChat', '0');\n            const { body } = await callv3API('post', `/chats`, {\n                uids: [mocks.users.baz.uid],\n            }, 'foo');\n            await User.setSetting(mocks.users.baz.uid, 'restrictChat', '1');\n\n            roomId = body.response.roomId;\n            assert(roomId);\n\n            await util.promisify(socketModules.chats.canMessage)({ uid: mocks.users.foo.uid }, roomId);\n        });\n\n        it('should send a user-join system message when a chat room is created', async () => {\n            const { body } = await callv3API('get', `/chats/${roomId}`, {}, 'foo');\n            const { messages } = body.response;\n            assert.equal(messages.length, 2);\n            assert.strictEqual(messages[0].system, true);\n            assert.strictEqual(messages[0].content, 'user-join');\n\n            const { statusCode, body: body2 } = await callv3API('put', `/chats/${roomId}/messages/${messages[0].messageId}`, {\n                message: 'test',\n            }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.equal(body2.status.message, await translator.translate('[[error:cant-edit-chat-message]]'));\n        });\n\n        it('should fail to add user to room with invalid data', async () => {\n            let { statusCode, body } = await callv3API('post', `/chats/${roomId}/users`, {}, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:required-parameters-missing, uids]]'));\n\n            ({ statusCode, body } = await callv3API('post', `/chats/${roomId}/users`, { uids: [null] }, 'foo'));\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-user]]'));\n        });\n\n        it('should add a user to room', async () => {\n            await callv3API('post', `/chats/${roomId}/users`, { uids: [mocks.users.herp.uid] }, 'foo');\n            const isInRoom = await Messaging.isUserInRoom(mocks.users.herp.uid, roomId);\n            assert(isInRoom);\n        });\n\n        it('should get users in room', async () => {\n            const { body } = await callv3API('get', `/chats/${roomId}/users`, {}, 'foo');\n            assert(Array.isArray(body.response.users));\n            assert.strictEqual(body.response.users.length, 3);\n        });\n\n        it('should throw error if user is not in room', async () => {\n            const { statusCode, body } = await callv3API('get', `/chats/${roomId}/users`, {}, 'bar');\n            assert.strictEqual(statusCode, 403);\n            assert.equal(body.status.message, await translator.translate('[[error:no-privileges]]'));\n        });\n\n        it('should fail to add users to room if max is reached', async () => {\n            meta.config.maximumUsersInChatRoom = 2;\n            const { statusCode, body } = await callv3API('post', `/chats/${roomId}/users`, { uids: [mocks.users.bar.uid] }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.equal(body.status.message, await translator.translate('[[error:cant-add-more-users-to-chat-room]]'));\n            meta.config.maximumUsersInChatRoom = 0;\n        });\n\n        it('should fail to add users to room if user does not exist', async () => {\n            const { statusCode, body } = await callv3API('post', `/chats/${roomId}/users`, { uids: [98237498234] }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-user]]'));\n        });\n\n        it('should fail to add self to room', async () => {\n            const { statusCode, body } = await callv3API('post', `/chats/${roomId}/users`, { uids: [mocks.users.foo.uid] }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:cant-chat-with-yourself]]'));\n        });\n\n        it('should fail to leave room with invalid data', async () => {\n            let { statusCode, body } = await callv3API('delete', `/chats/${roomId}/users`, {}, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:required-parameters-missing, uids]]'));\n\n            ({ statusCode, body } = await callv3API('delete', `/chats/${roomId}/users`, { uids: [98237423] }, 'foo'));\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-user]]'));\n        });\n\n        it('should leave the chat room', async () => {\n            await callv3API('delete', `/chats/${roomId}/users/${mocks.users.baz.uid}`, {}, 'baz');\n            const isUserInRoom = await Messaging.isUserInRoom(mocks.users.baz.uid, roomId);\n            assert.equal(isUserInRoom, false);\n            const data = await Messaging.getRoomData(roomId);\n            assert.equal(data.owner, mocks.users.foo.uid);\n        });\n\n        it('should send a user-leave system message when a user leaves the chat room', (done) => {\n            socketModules.chats.getMessages(\n                { uid: mocks.users.foo.uid },\n                { uid: mocks.users.foo.uid, roomId: roomId, start: 0 },\n                (err, messages) => {\n                    assert.ifError(err);\n                    assert.equal(messages.length, 4);\n                    const message = messages.pop();\n                    assert.strictEqual(message.system, true);\n                    assert.strictEqual(message.content, 'user-leave');\n                    done();\n                }\n            );\n        });\n\n        it('should not send a user-leave system message when a user tries to leave a room they are not in', async () => {\n            await callv3API('delete', `/chats/${roomId}/users/${mocks.users.baz.uid}`, {}, 'baz');\n            const messages = await socketModules.chats.getMessages(\n                { uid: mocks.users.foo.uid },\n                { uid: mocks.users.foo.uid, roomId: roomId, start: 0 }\n            );\n            assert.equal(messages.length, 4);\n            let message = messages.pop();\n            assert.strictEqual(message.system, true);\n            assert.strictEqual(message.content, 'user-leave');\n\n            // The message before should still be a user-join\n            message = messages.pop();\n            assert.strictEqual(message.system, true);\n            assert.strictEqual(message.content, 'user-join');\n        });\n\n        it('should change owner when owner leaves room', async () => {\n            const { body } = await callv3API('post', '/chats', {\n                uids: [mocks.users.foo.uid],\n            }, 'herp');\n\n            await callv3API('post', `/chats/${body.response.roomId}/users`, { uids: [mocks.users.baz.uid] }, 'herp');\n            await util.promisify(socketModules.chats.leave)({ uid: mocks.users.herp.uid }, body.response.roomId);\n\n            const data = await Messaging.getRoomData(body.response.roomId);\n            assert.equal(data.owner, mocks.users.foo.uid);\n        });\n\n        it('should change owner if owner is deleted', async () => {\n            const sender = await User.create({ username: 'deleted_chat_user', password: 'barbar' });\n            const { jar: senderJar, csrf_token: senderCsrf } = await util.promisify(helpers.loginUser)('deleted_chat_user', 'barbar');\n\n            const receiver = await User.create({ username: 'receiver' });\n            const { response } = await request(`${nconf.get('url')}/api/v3/chats`, {\n                method: 'post',\n                json: true,\n                jar: senderJar,\n                body: {\n                    uids: [receiver],\n                },\n                headers: {\n                    'x-csrf-token': senderCsrf,\n                },\n            });\n            await User.deleteAccount(sender);\n            const data = await Messaging.getRoomData(response.roomId);\n            assert.equal(data.owner, receiver);\n        });\n\n        it('should fail to remove user from room', async () => {\n            let { statusCode, body } = await callv3API('delete', `/chats/${roomId}/users`, {}, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:required-parameters-missing, uids]]'));\n\n            ({ statusCode, body } = await callv3API('delete', `/chats/${roomId}/users`, { uids: [null] }, 'foo'));\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-user]]'));\n        });\n\n        it('should fail to remove user from room if user does not exist', async () => {\n            const { statusCode, body } = await callv3API('delete', `/chats/${roomId}/users`, { uids: [99] }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-user]]'));\n        });\n\n        it('should remove user from room', async () => {\n            const { statusCode, body } = await callv3API('post', `/chats`, {\n                uids: [mocks.users.herp.uid],\n            }, 'foo');\n            const { roomId } = body.response;\n            assert.strictEqual(statusCode, 200);\n\n            let isInRoom = await Messaging.isUserInRoom(mocks.users.herp.uid, roomId);\n            assert(isInRoom);\n\n            await callv3API('delete', `/chats/${roomId}/users`, { uids: [mocks.users.herp.uid] }, 'foo');\n            isInRoom = await Messaging.isUserInRoom(mocks.users.herp.uid, roomId);\n            assert(!isInRoom);\n        });\n\n        it('should fail to send a message to room with invalid data', async () => {\n            let { body } = await callv3API('post', `/chats/abc`, { message: 'test' }, 'foo');\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-data]]'));\n\n            ({ body } = await callv3API('post', `/chats/1`, {}, 'foo'));\n            assert.strictEqual(body.status.message, await translator.translate('[[error:required-parameters-missing, message]]'));\n        });\n\n        it('should fail to send chat if content is empty', async () => {\n            const { body } = await callv3API('post', `/chats/${roomId}`, {\n                message: ' ',\n            }, 'foo');\n            const { status, response } = body;\n\n            assert.deepStrictEqual(response, {});\n            assert.equal(status.message, await translator.translate('[[error:invalid-chat-message]]'));\n        });\n\n        it('should send a message to a room', async () => {\n            const socketMock = { uid: mocks.users.foo.uid };\n            const { body } = await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'first chat message' }, 'foo');\n            const messageData = body.response;\n            assert(messageData);\n            assert.equal(messageData.content, 'first chat message');\n            assert(messageData.fromUser);\n            assert(messageData.roomId, roomId);\n            const raw =\n                await util.promisify(socketModules.chats.getRaw)(socketMock, { mid: messageData.mid });\n            assert.equal(raw, 'first chat message');\n        });\n\n        it('should fail to send second message due to rate limit', async () => {\n            const socketMock = { uid: mocks.users.foo.uid };\n            const oldValue = meta.config.chatMessageDelay;\n            meta.config.chatMessageDelay = 1000;\n\n            await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'first chat message' }, 'foo');\n            const { body } = await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'first chat message' }, 'foo');\n            const { status } = body;\n            assert.equal(status.message, await translator.translate('[[error:too-many-messages]]'));\n            meta.config.chatMessageDelay = oldValue;\n        });\n\n        it('should return invalid-data error', (done) => {\n            socketModules.chats.getRaw({ uid: mocks.users.foo.uid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.getRaw({ uid: mocks.users.foo.uid }, {}, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    done();\n                });\n            });\n        });\n\n        it('should return not allowed error if mid is not in room', async () => {\n            const socketMock = { uid: mocks.users.foo.uid };\n            const uids = await User.create({ username: 'dummy' });\n            let { body } = await callv3API('post', '/chats', { uids: [uids] }, 'baz');\n            const myRoomId = body.response.roomId;\n            assert(myRoomId);\n\n            try {\n                await util.promisify(socketModules.chats.getRaw)({ uid: mocks.users.baz.uid }, { mid: 200 });\n            } catch (err) {\n                assert(err);\n                assert.equal(err.message, '[[error:not-allowed]]');\n            }\n\n            ({ body } = await callv3API('post', `/chats/${myRoomId}`, { roomId: myRoomId, message: 'admin will see this' }, 'baz'));\n            const message = body.response;\n            const raw = await util.promisify(socketModules.chats.getRaw)(socketMock, { mid: message.mid });\n            assert.equal(raw, 'admin will see this');\n        });\n\n\n        it('should notify offline users of message', async () => {\n            meta.config.notificationSendDelay = 0.1;\n\n            const { body } = await callv3API('post', '/chats', { uids: [mocks.users.baz.uid] }, 'foo');\n            const { roomId } = body.response;\n            assert(roomId);\n\n            await callv3API('post', `/chats/${roomId}/users`, { uids: [mocks.users.herp.uid] }, 'foo');\n            await db.sortedSetAdd('users:online', Date.now() - ((meta.config.onlineCutoff * 60000) + 50000), mocks.users.herp.uid);\n\n            await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'second chat message **bold** text' }, 'foo');\n            await sleep(3000);\n            const data = await User.notifications.get(mocks.users.herp.uid);\n            assert(data.unread[0]);\n            const notification = data.unread[0];\n            assert.strictEqual(notification.bodyShort, '[[notifications:new_message_from, foo]]');\n            assert.strictEqual(notification.nid, `chat_${mocks.users.foo.uid}_${roomId}`);\n            assert.strictEqual(notification.path, `${nconf.get('relative_path')}/chats/${roomId}`);\n        });\n\n        it('should fail to get messages from room with invalid data', (done) => {\n            const socketMock = { uid: mocks.users.foo.uid };\n            socketModules.chats.getMessages({ uid: null }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.getMessages(socketMock, null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    socketModules.chats.getMessages(socketMock, { uid: null }, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        socketModules.chats.getMessages(socketMock, { uid: 1, roomId: null }, (err) => {\n                            assert.equal(err.message, '[[error:invalid-data]]');\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should get messages from room', (done) => {\n            socketModules.chats.getMessages({ uid: mocks.users.foo.uid }, {\n                uid: mocks.users.foo.uid,\n                roomId: roomId,\n                start: 0,\n            }, (err, messages) => {\n                assert.ifError(err);\n                assert(Array.isArray(messages));\n\n                // Filter out system messages\n                messages = messages.filter(message => !message.system);\n                assert.equal(messages[0].roomId, roomId);\n                assert.equal(messages[0].fromuid, mocks.users.foo.uid);\n                done();\n            });\n        });\n\n        it('should fail to mark read with invalid data', (done) => {\n            socketModules.chats.markRead({ uid: null }, roomId, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.markRead({ uid: mocks.users.foo.uid }, null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    done();\n                });\n            });\n        });\n\n        it('should not error if user is not in room', (done) => {\n            socketModules.chats.markRead({ uid: mocks.users.herp.uid }, 10, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should mark room read', (done) => {\n            socketModules.chats.markRead({ uid: mocks.users.foo.uid }, roomId, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should mark all rooms read', (done) => {\n            socketModules.chats.markAllRead({ uid: mocks.users.foo.uid }, {}, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should fail to rename room with invalid data', async () => {\n            let { body } = await callv3API('put', `/chats/${roomId}`, { name: null }, 'foo');\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-data]]'));\n\n            ({ body } = await callv3API('put', `/chats/${roomId}`, {}, 'foo'));\n            assert.strictEqual(body.status.message, await translator.translate('[[error:required-parameters-missing, name]]'));\n        });\n\n        it('should rename room', async () => {\n            const { statusCode } = await callv3API('put', `/chats/${roomId}`, { name: 'new room name' }, 'foo');\n            assert.strictEqual(statusCode, 200);\n        });\n\n        it('should send a room-rename system message when a room is renamed', (done) => {\n            socketModules.chats.getMessages(\n                { uid: mocks.users.foo.uid },\n                { uid: mocks.users.foo.uid, roomId: roomId, start: 0 },\n                (err, messages) => {\n                    assert.ifError(err);\n                    const message = messages.pop();\n                    assert.strictEqual(message.system, true);\n                    assert.strictEqual(message.content, 'room-rename, new room name');\n                    done();\n                }\n            );\n        });\n\n        it('should fail to load room with invalid-data', async () => {\n            const { body } = await callv3API('get', `/chats/abc`, {}, 'foo');\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-data]]'));\n        });\n\n        it('should fail to load room if user is not in', async () => {\n            const { body } = await callv3API('get', `/chats/${roomId}`, {}, 'baz');\n            assert.strictEqual(body.status.message, await translator.translate('[[error:no-privileges]]'));\n        });\n\n        it('should load chat room', async () => {\n            const { body } = await callv3API('get', `/chats/${roomId}`, {}, 'foo');\n            assert.strictEqual(body.response.roomName, 'new room name');\n        });\n\n        it('should return true if user is dnd', (done) => {\n            db.setObjectField(`user:${mocks.users.herp.uid}`, 'status', 'dnd', (err) => {\n                assert.ifError(err);\n                socketModules.chats.isDnD({ uid: mocks.users.foo.uid }, mocks.users.herp.uid, (err, isDnD) => {\n                    assert.ifError(err);\n                    assert(isDnD);\n                    done();\n                });\n            });\n        });\n\n        it('should fail to load recent chats with invalid data', (done) => {\n            socketModules.chats.getRecentChats({ uid: mocks.users.foo.uid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.getRecentChats({ uid: mocks.users.foo.uid }, { after: null }, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    socketModules.chats.getRecentChats({ uid: mocks.users.foo.uid }, { after: 0, uid: null }, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should load recent chats of user', (done) => {\n            socketModules.chats.getRecentChats(\n                { uid: mocks.users.foo.uid },\n                { after: 0, uid: mocks.users.foo.uid },\n                (err, data) => {\n                    assert.ifError(err);\n                    assert(Array.isArray(data.rooms));\n                    done();\n                }\n            );\n        });\n\n        it('should escape teaser', async () => {\n            await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: '<"+"svg/onload=alert(document.location);' }, 'foo');\n            const data = await util.promisify(socketModules.chats.getRecentChats)(\n                { uid: mocks.users.foo.uid },\n                { after: 0, uid: mocks.users.foo.uid }\n            );\n\n            assert.equal(data.rooms[0].teaser.content, '&lt;svg&#x2F;onload=alert(document.location);');\n        });\n\n        it('should fail to check if user has private chat with invalid data', (done) => {\n            socketModules.chats.hasPrivateChat({ uid: null }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.hasPrivateChat({ uid: mocks.users.foo.uid }, null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    done();\n                });\n            });\n        });\n\n        it('should check if user has private chat with another uid', (done) => {\n            socketModules.chats.hasPrivateChat({ uid: mocks.users.foo.uid }, mocks.users.herp.uid, (err, roomId) => {\n                assert.ifError(err);\n                assert(roomId);\n                done();\n            });\n        });\n    });\n\n    describe('edit/delete', () => {\n        const socketModules = require('../src/socket.io/modules');\n        let mid;\n        let mid2;\n        before(async () => {\n            await callv3API('post', `/chats/${roomId}/users`, { uids: [mocks.users.baz.uid] }, 'foo');\n            let { body } = await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'first chat message' }, 'foo');\n            mid = body.response.mid;\n            ({ body } = await callv3API('post', `/chats/${roomId}`, { roomId: roomId, message: 'second chat message' }, 'baz'));\n            mid2 = body.response.mid;\n        });\n\n        after(async () => {\n            await callv3API('delete', `/chats/${roomId}/users/${mocks.users.baz.uid}`, {}, 'baz');\n        });\n\n        it('should fail to edit message with invalid data', async () => {\n            let { statusCode, body } = await callv3API('put', `/chats/1/messages/10000`, { message: 'foo' }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-mid]]'));\n\n            ({ statusCode, body } = await callv3API('put', `/chats/${roomId}/messages/${mid}`, {}, 'foo'));\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-chat-message]]'));\n        });\n\n        it('should fail to edit message if new content is empty string', async () => {\n            const { statusCode, body } = await callv3API('put', `/chats/${roomId}/messages/${mid}`, { message: ' ' }, 'foo');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-chat-message]]'));\n        });\n\n        it('should fail to edit message if not own message', async () => {\n            const { statusCode, body } = await callv3API('put', `/chats/${roomId}/messages/${mid}`, { message: 'message edited' }, 'herp');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:cant-edit-chat-message]]'));\n        });\n\n        it('should fail to edit message if message not in room', async () => {\n            const { statusCode, body } = await callv3API('put', `/chats/${roomId}/messages/1014`, { message: 'message edited' }, 'herp');\n            assert.strictEqual(statusCode, 400);\n            assert.strictEqual(body.status.message, await translator.translate('[[error:invalid-mid]]'));\n        });\n\n        it('should edit message', async () => {\n            let { statusCode, body } = await callv3API('put', `/chats/${roomId}/messages/${mid}`, { message: 'message edited' }, 'foo');\n            assert.strictEqual(statusCode, 200);\n            assert.strictEqual(body.response.content, 'message edited');\n\n            ({ statusCode, body } = await callv3API('get', `/chats/${roomId}/messages/${mid}`, {}, 'foo'));\n            assert.strictEqual(statusCode, 200);\n            assert.strictEqual(body.response.content, 'message edited');\n        });\n\n        it('should fail to delete message with invalid data', (done) => {\n            socketModules.chats.delete({ uid: mocks.users.foo.uid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                socketModules.chats.delete({ uid: mocks.users.foo.uid }, { roomId: null }, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    socketModules.chats.delete({ uid: mocks.users.foo.uid }, { roomId: 1, messageId: null }, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should fail to delete message if not owner', (done) => {\n            socketModules.chats.delete({ uid: mocks.users.herp.uid }, { messageId: mid, roomId: roomId }, (err) => {\n                assert.equal(err.message, '[[error:cant-delete-chat-message]]');\n                done();\n            });\n        });\n\n        it('should mark the message as deleted', (done) => {\n            socketModules.chats.delete({ uid: mocks.users.foo.uid }, { messageId: mid, roomId: roomId }, (err) => {\n                assert.ifError(err);\n                db.getObjectField(`message:${mid}`, 'deleted', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(1, parseInt(value, 10));\n                    done();\n                });\n            });\n        });\n\n        it('should show deleted message to original users', (done) => {\n            socketModules.chats.getMessages(\n                { uid: mocks.users.foo.uid },\n                { uid: mocks.users.foo.uid, roomId: roomId, start: 0 },\n                (err, messages) => {\n                    assert.ifError(err);\n\n                    // Reduce messages to their mids\n                    const mids = messages.reduce((mids, cur) => {\n                        mids.push(cur.messageId);\n                        return mids;\n                    }, []);\n\n                    assert(mids.includes(mid));\n                    done();\n                }\n            );\n        });\n\n        it('should not show deleted message to other users', (done) => {\n            socketModules.chats.getMessages(\n                { uid: mocks.users.herp.uid },\n                { uid: mocks.users.herp.uid, roomId: roomId, start: 0 },\n                (err, messages) => {\n                    assert.ifError(err);\n                    messages.forEach((msg) => {\n                        assert(!msg.deleted || msg.content === '[[modules:chat.message-deleted]]', msg.content);\n                        assert(!msg.deleted || msg.cleanedContent, '[[modules:chat.message-deleted]]', msg.content);\n                    });\n                    done();\n                }\n            );\n        });\n\n        it('should error out if a message is deleted again', (done) => {\n            socketModules.chats.delete({ uid: mocks.users.foo.uid }, { messageId: mid, roomId: roomId }, (err) => {\n                assert.strictEqual('[[error:chat-deleted-already]]', err.message);\n                done();\n            });\n        });\n\n        it('should restore the message', (done) => {\n            socketModules.chats.restore({ uid: mocks.users.foo.uid }, { messageId: mid, roomId: roomId }, (err) => {\n                assert.ifError(err);\n                db.getObjectField(`message:${mid}`, 'deleted', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(0, parseInt(value, 10));\n                    done();\n                });\n            });\n        });\n\n        it('should error out if a message is restored again', (done) => {\n            socketModules.chats.restore({ uid: mocks.users.foo.uid }, { messageId: mid, roomId: roomId }, (err) => {\n                assert.strictEqual('[[error:chat-restored-already]]', err.message);\n                done();\n            });\n        });\n\n        describe('disabled via ACP', () => {\n            before(async () => {\n                meta.config.disableChatMessageEditing = true;\n            });\n\n            after(async () => {\n                meta.config.disableChatMessageEditing = false;\n            });\n\n            it('should error out for regular users', async () => {\n                try {\n                    await socketModules.chats.delete({ uid: mocks.users.baz.uid }, { messageId: mid2, roomId: roomId });\n                } catch (err) {\n                    assert.strictEqual('[[error:chat-message-editing-disabled]]', err.message);\n                }\n            });\n\n            it('should succeed for administrators', async () => {\n                await socketModules.chats.delete({ uid: mocks.users.foo.uid }, { messageId: mid2, roomId: roomId });\n                await socketModules.chats.restore({ uid: mocks.users.foo.uid }, { messageId: mid2, roomId: roomId });\n            });\n\n            it('should succeed for global moderators', async () => {\n                await Groups.join(['Global Moderators'], mocks.users.baz.uid);\n\n                await socketModules.chats.delete({ uid: mocks.users.foo.uid }, { messageId: mid2, roomId: roomId });\n                await socketModules.chats.restore({ uid: mocks.users.foo.uid }, { messageId: mid2, roomId: roomId });\n\n                await Groups.leave(['Global Moderators'], mocks.users.baz.uid);\n            });\n        });\n    });\n\n    describe('controller', () => {\n        it('should 404 if chat is disabled', async () => {\n            meta.config.disableChat = 1;\n            const response = await request(`${nconf.get('url')}/user/baz/chats`, {\n                resolveWithFullResponse: true,\n                simple: false,\n            });\n\n            assert.equal(response.statusCode, 404);\n        });\n\n        it('should 500 for guest with no privilege error', async () => {\n            meta.config.disableChat = 0;\n            const response = await request(`${nconf.get('url')}/api/user/baz/chats`, {\n                resolveWithFullResponse: true,\n                simple: false,\n                json: true,\n            });\n            const { body } = response;\n\n            assert.equal(response.statusCode, 500);\n            assert.equal(body.error, '[[error:no-privileges]]');\n        });\n\n        it('should 404 for non-existent user', async () => {\n            const response = await request(`${nconf.get('url')}/user/doesntexist/chats`, {\n                resolveWithFullResponse: true,\n                simple: false,\n            });\n\n            assert.equal(response.statusCode, 404);\n        });\n    });\n\n    describe('logged in chat controller', () => {\n        let jar;\n        before(async () => {\n            ({ jar } = await helpers.loginUser('herp', 'derpderp'));\n        });\n\n        it('should return chats page data', async () => {\n            const response = await request(`${nconf.get('url')}/api/user/herp/chats`, {\n                resolveWithFullResponse: true,\n                simple: false,\n                json: true,\n                jar,\n            });\n            const { body } = response;\n\n            assert.equal(response.statusCode, 200);\n            assert(Array.isArray(body.rooms));\n            assert.equal(body.rooms.length, 2);\n            assert.equal(body.title, '[[pages:chats]]');\n        });\n\n        it('should return room data', async () => {\n            const response = await request(`${nconf.get('url')}/api/user/herp/chats/${roomId}`, {\n                resolveWithFullResponse: true,\n                simple: false,\n                json: true,\n                jar,\n            });\n            const { body } = response;\n\n            assert.equal(response.statusCode, 200);\n            assert.equal(body.roomId, roomId);\n            assert.equal(body.isOwner, false);\n        });\n\n        it('should redirect to chats page', async () => {\n            const res = await request(`${nconf.get('url')}/api/chats`, {\n                resolveWithFullResponse: true,\n                simple: false,\n                jar,\n                json: true,\n            });\n            const { body } = res;\n\n            assert.equal(res.statusCode, 200);\n            assert.equal(res.headers['x-redirect'], '/user/herp/chats');\n            assert.equal(body, '/user/herp/chats');\n        });\n\n        it('should return 404 if user is not in room', async () => {\n            const data = await util.promisify(helpers.loginUser)('baz', 'quuxquux');\n            const response = await request(`${nconf.get('url')}/api/user/baz/chats/${roomId}`, {\n                resolveWithFullResponse: true,\n                simple: false,\n                json: true,\n                jar: data.jar,\n            });\n\n            assert.equal(response.statusCode, 404);\n        });\n    });\n});\n"},"test/meta.js":{"tests":[{"id":"1627","name":"meta should log targets"},{"id":"1628","name":"meta settings it should set setting"},{"id":"1629","name":"meta settings it should get setting"},{"id":"1630","name":"meta settings should not set setting if not empty"},{"id":"1631","name":"meta settings should set setting if empty"},{"id":"1632","name":"meta settings should set one and get one"},{"id":"1633","name":"meta settings should return null if setting field does not exist"},{"id":"1634","name":"meta settings should set setting with sorted list"},{"id":"1635","name":"meta settings should get setting with sorted list"},{"id":"1636","name":"meta settings should not set setting with sorted list if not empty"},{"id":"1637","name":"meta settings should set setting with sorted list if empty"},{"id":"1638","name":"meta settings should set one and get one sorted list"},{"id":"1639","name":"meta config should get config fields"},{"id":"1640","name":"meta config should get the correct type and default value"},{"id":"1641","name":"meta config should get the correct type and correct value"},{"id":"1642","name":"meta config should get the correct value"},{"id":"1643","name":"meta config should use default value if value is null"},{"id":"1644","name":"meta config should fail if field is invalid"},{"id":"1645","name":"meta config should fail if data is invalid"},{"id":"1646","name":"meta config should set multiple config values"},{"id":"1647","name":"meta config should set config value"},{"id":"1648","name":"meta config should get back string if field is not in defaults"},{"id":"1649","name":"meta config should set boolean config value"},{"id":"1650","name":"meta config should set string config value"},{"id":"1651","name":"meta config should set multiple values"},{"id":"1652","name":"meta config should not set config if not empty"},{"id":"1653","name":"meta config should remove config field"},{"id":"1654","name":"meta session TTL should return 14 days in seconds"},{"id":"1655","name":"meta session TTL should return 7 days in seconds"},{"id":"1656","name":"meta session TTL should return 2 days in seconds"},{"id":"1657","name":"meta dependencies should return ENOENT if module is not found"},{"id":"1658","name":"meta dependencies should not error if module is a nodebb-plugin-*"},{"id":"1659","name":"meta dependencies should not error if module is nodebb-theme-*"},{"id":"1660","name":"meta dependencies should parse json package data"},{"id":"1661","name":"meta dependencies should return null data with invalid json"},{"id":"1662","name":"meta dependencies should return false if moduleData is falsy"},{"id":"1663","name":"meta dependencies should return false if moduleData doesnt not satisfy package.json"},{"id":"1664","name":"meta dependencies should return true if _resolved is from github"},{"id":"1665","name":"meta debugFork should detect debugging"},{"id":"1666","name":"meta Access-Control-Allow-Origin Access-Control-Allow-Origin header should be empty"},{"id":"1667","name":"meta Access-Control-Allow-Origin should set proper Access-Control-Allow-Origin header"},{"id":"1668","name":"meta Access-Control-Allow-Origin Access-Control-Allow-Origin header should be empty if origin does not match"},{"id":"1669","name":"meta Access-Control-Allow-Origin should not error with invalid regexp"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\nconst request = require('request');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst meta = require('../src/meta');\nconst User = require('../src/user');\nconst Groups = require('../src/groups');\n\ndescribe('meta', () => {\n    let fooUid;\n    let bazUid;\n    let herpUid;\n\n    before((done) => {\n        Groups.cache.reset();\n        // Create 3 users: 1 admin, 2 regular\n        async.series([\n            async.apply(User.create, { username: 'foo', password: 'barbar' }), // admin\n            async.apply(User.create, { username: 'baz', password: 'quuxquux' }), // restricted user\n            async.apply(User.create, { username: 'herp', password: 'derpderp' }), // regular user\n        ], (err, uids) => {\n            if (err) {\n                return done(err);\n            }\n\n            fooUid = uids[0];\n            bazUid = uids[1];\n            herpUid = uids[2];\n\n            Groups.join('administrators', fooUid, done);\n        });\n    });\n\n    describe('settings', () => {\n        const socketAdmin = require('../src/socket.io/admin');\n        it('it should set setting', (done) => {\n            socketAdmin.settings.set({ uid: fooUid }, { hash: 'some:hash', values: { foo: '1', derp: 'value' } }, (err) => {\n                assert.ifError(err);\n                db.getObject('settings:some:hash', (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    done();\n                });\n            });\n        });\n\n        it('it should get setting', (done) => {\n            socketAdmin.settings.get({ uid: fooUid }, { hash: 'some:hash' }, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.foo, '1');\n                assert.equal(data.derp, 'value');\n                done();\n            });\n        });\n\n        it('should not set setting if not empty', (done) => {\n            meta.settings.setOnEmpty('some:hash', { foo: 2 }, (err) => {\n                assert.ifError(err);\n                db.getObject('settings:some:hash', (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    done();\n                });\n            });\n        });\n\n        it('should set setting if empty', (done) => {\n            meta.settings.setOnEmpty('some:hash', { empty: '2' }, (err) => {\n                assert.ifError(err);\n                db.getObject('settings:some:hash', (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    assert.equal(data.empty, '2');\n                    done();\n                });\n            });\n        });\n\n        it('should set one and get one', (done) => {\n            meta.settings.setOne('some:hash', 'myField', 'myValue', (err) => {\n                assert.ifError(err);\n                meta.settings.getOne('some:hash', 'myField', (err, myValue) => {\n                    assert.ifError(err);\n                    assert.equal(myValue, 'myValue');\n                    done();\n                });\n            });\n        });\n\n        it('should return null if setting field does not exist', async () => {\n            const val = await meta.settings.getOne('some:hash', 'does not exist');\n            assert.strictEqual(val, null);\n        });\n\n        const someList = [\n            { name: 'andrew', status: 'best' },\n            { name: 'baris', status: 'wurst' },\n        ];\n        const anotherList = [];\n\n        it('should set setting with sorted list', (done) => {\n            socketAdmin.settings.set({ uid: fooUid }, { hash: 'another:hash', values: { foo: '1', derp: 'value', someList: someList, anotherList: anotherList } }, (err) => {\n                if (err) {\n                    return done(err);\n                }\n\n                db.getObject('settings:another:hash', (err, data) => {\n                    if (err) {\n                        return done(err);\n                    }\n\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    assert.equal(data.someList, undefined);\n                    assert.equal(data.anotherList, undefined);\n                    done();\n                });\n            });\n        });\n\n        it('should get setting with sorted list', (done) => {\n            socketAdmin.settings.get({ uid: fooUid }, { hash: 'another:hash' }, (err, data) => {\n                assert.ifError(err);\n                assert.strictEqual(data.foo, '1');\n                assert.strictEqual(data.derp, 'value');\n                assert.deepStrictEqual(data.someList, someList);\n                assert.deepStrictEqual(data.anotherList, anotherList);\n                done();\n            });\n        });\n\n        it('should not set setting if not empty', (done) => {\n            meta.settings.setOnEmpty('some:hash', { foo: 2 }, (err) => {\n                assert.ifError(err);\n                db.getObject('settings:some:hash', (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    done();\n                });\n            });\n        });\n\n        it('should not set setting with sorted list if not empty', (done) => {\n            meta.settings.setOnEmpty('another:hash', { foo: anotherList }, (err) => {\n                assert.ifError(err);\n                socketAdmin.settings.get({ uid: fooUid }, { hash: 'another:hash' }, (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    done();\n                });\n            });\n        });\n\n        it('should set setting with sorted list if empty', (done) => {\n            meta.settings.setOnEmpty('another:hash', { empty: someList }, (err) => {\n                assert.ifError(err);\n                socketAdmin.settings.get({ uid: fooUid }, { hash: 'another:hash' }, (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.foo, '1');\n                    assert.equal(data.derp, 'value');\n                    assert.deepEqual(data.empty, someList);\n                    done();\n                });\n            });\n        });\n\n        it('should set one and get one sorted list', (done) => {\n            meta.settings.setOne('another:hash', 'someList', someList, (err) => {\n                assert.ifError(err);\n                meta.settings.getOne('another:hash', 'someList', (err, _someList) => {\n                    assert.ifError(err);\n                    assert.deepEqual(_someList, someList);\n                    done();\n                });\n            });\n        });\n    });\n\n\n    describe('config', () => {\n        const socketAdmin = require('../src/socket.io/admin');\n        before((done) => {\n            db.setObject('config', { minimumTagLength: 3, maximumTagLength: 15 }, done);\n        });\n\n        it('should get config fields', (done) => {\n            meta.configs.getFields(['minimumTagLength', 'maximumTagLength'], (err, data) => {\n                assert.ifError(err);\n                assert.strictEqual(data.minimumTagLength, 3);\n                assert.strictEqual(data.maximumTagLength, 15);\n                done();\n            });\n        });\n\n        it('should get the correct type and default value', (done) => {\n            meta.configs.set('loginAttempts', '', (err) => {\n                assert.ifError(err);\n                meta.configs.get('loginAttempts', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, 5);\n                    done();\n                });\n            });\n        });\n\n        it('should get the correct type and correct value', (done) => {\n            meta.configs.set('loginAttempts', '0', (err) => {\n                assert.ifError(err);\n                meta.configs.get('loginAttempts', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, 0);\n                    done();\n                });\n            });\n        });\n\n        it('should get the correct value', (done) => {\n            meta.configs.set('title', 123, (err) => {\n                assert.ifError(err);\n                meta.configs.get('title', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, '123');\n                    done();\n                });\n            });\n        });\n\n        it('should get the correct value', (done) => {\n            meta.configs.set('title', 0, (err) => {\n                assert.ifError(err);\n                meta.configs.get('title', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, '0');\n                    done();\n                });\n            });\n        });\n\n        it('should get the correct value', (done) => {\n            meta.configs.set('title', '', (err) => {\n                assert.ifError(err);\n                meta.configs.get('title', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, '');\n                    done();\n                });\n            });\n        });\n\n        it('should use default value if value is null', (done) => {\n            meta.configs.set('teaserPost', null, (err) => {\n                assert.ifError(err);\n                meta.configs.get('teaserPost', (err, value) => {\n                    assert.ifError(err);\n                    assert.strictEqual(value, 'last-reply');\n                    done();\n                });\n            });\n        });\n\n        it('should fail if field is invalid', (done) => {\n            meta.configs.set('', 'someValue', (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should fail if data is invalid', (done) => {\n            socketAdmin.config.set({ uid: fooUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should set multiple config values', (done) => {\n            socketAdmin.config.set({ uid: fooUid }, { key: 'someKey', value: 'someValue' }, (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['someKey'], (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.someKey, 'someValue');\n                    done();\n                });\n            });\n        });\n\n        it('should set config value', (done) => {\n            meta.configs.set('someField', 'someValue', (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['someField'], (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.someField, 'someValue');\n                    done();\n                });\n            });\n        });\n\n        it('should get back string if field is not in defaults', (done) => {\n            meta.configs.set('numericField', 123, (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['numericField'], (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.numericField, 123);\n                    done();\n                });\n            });\n        });\n\n        it('should set boolean config value', (done) => {\n            meta.configs.set('booleanField', true, (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['booleanField'], (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.booleanField, true);\n                    done();\n                });\n            });\n        });\n\n        it('should set boolean config value', (done) => {\n            meta.configs.set('booleanField', 'false', (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['booleanField'], (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.booleanField, false);\n                    done();\n                });\n            });\n        });\n\n        it('should set string config value', (done) => {\n            meta.configs.set('stringField', '123', (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['stringField'], (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.stringField, 123);\n                    done();\n                });\n            });\n        });\n\n        it('should fail if data is invalid', (done) => {\n            socketAdmin.config.setMultiple({ uid: fooUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should set multiple values', (done) => {\n            socketAdmin.config.setMultiple({ uid: fooUid }, {\n                someField1: 'someValue1',\n                someField2: 'someValue2',\n                customCSS: '.derp{color:#00ff00;}',\n            }, (err) => {\n                assert.ifError(err);\n                meta.configs.getFields(['someField1', 'someField2'], (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data.someField1, 'someValue1');\n                    assert.equal(data.someField2, 'someValue2');\n                    done();\n                });\n            });\n        });\n\n        it('should not set config if not empty', (done) => {\n            meta.configs.setOnEmpty({ someField1: 'foo' }, (err) => {\n                assert.ifError(err);\n                meta.configs.get('someField1', (err, value) => {\n                    assert.ifError(err);\n                    assert.equal(value, 'someValue1');\n                    done();\n                });\n            });\n        });\n\n        it('should remove config field', (done) => {\n            socketAdmin.config.remove({ uid: fooUid }, 'someField1', (err) => {\n                assert.ifError(err);\n                db.isObjectField('config', 'someField1', (err, isObjectField) => {\n                    assert.ifError(err);\n                    assert(!isObjectField);\n                    done();\n                });\n            });\n        });\n    });\n\n\n    describe('session TTL', () => {\n        it('should return 14 days in seconds', (done) => {\n            assert(meta.getSessionTTLSeconds(), 1209600);\n            done();\n        });\n\n        it('should return 7 days in seconds', (done) => {\n            meta.config.loginDays = 7;\n            assert(meta.getSessionTTLSeconds(), 604800);\n            done();\n        });\n\n        it('should return 2 days in seconds', (done) => {\n            meta.config.loginSeconds = 172800;\n            assert(meta.getSessionTTLSeconds(), 172800);\n            done();\n        });\n    });\n\n    describe('dependencies', () => {\n        it('should return ENOENT if module is not found', (done) => {\n            meta.dependencies.checkModule('some-module-that-does-not-exist', (err) => {\n                assert.equal(err.code, 'ENOENT');\n                done();\n            });\n        });\n\n        it('should not error if module is a nodebb-plugin-*', (done) => {\n            meta.dependencies.checkModule('nodebb-plugin-somePlugin', (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should not error if module is nodebb-theme-*', (done) => {\n            meta.dependencies.checkModule('nodebb-theme-someTheme', (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should parse json package data', (done) => {\n            const pkgData = meta.dependencies.parseModuleData('nodebb-plugin-test', '{\"a\": 1}');\n            assert.equal(pkgData.a, 1);\n            done();\n        });\n\n        it('should return null data with invalid json', (done) => {\n            const pkgData = meta.dependencies.parseModuleData('nodebb-plugin-test', 'asdasd');\n            assert.strictEqual(pkgData, null);\n            done();\n        });\n\n        it('should return false if moduleData is falsy', (done) => {\n            assert(!meta.dependencies.doesSatisfy(null, '1.0.0'));\n            done();\n        });\n\n        it('should return false if moduleData doesnt not satisfy package.json', (done) => {\n            assert(!meta.dependencies.doesSatisfy({ name: 'nodebb-plugin-test', version: '0.9.0' }, '1.0.0'));\n            done();\n        });\n\n        it('should return true if _resolved is from github', (done) => {\n            assert(meta.dependencies.doesSatisfy({ name: 'nodebb-plugin-test', _resolved: 'https://github.com/some/repo', version: '0.9.0' }, '1.0.0'));\n            done();\n        });\n    });\n\n    describe('debugFork', () => {\n        let oldArgv;\n        before(() => {\n            oldArgv = process.execArgv;\n            process.execArgv = ['--debug=5858', '--foo=1'];\n        });\n\n        it('should detect debugging', (done) => {\n            let debugFork = require('../src/meta/debugFork');\n            assert(!debugFork.debugging);\n\n            const debugForkPath = require.resolve('../src/meta/debugFork');\n            delete require.cache[debugForkPath];\n\n            debugFork = require('../src/meta/debugFork');\n            assert(debugFork.debugging);\n\n            done();\n        });\n\n        after(() => {\n            process.execArgv = oldArgv;\n        });\n    });\n\n    describe('Access-Control-Allow-Origin', () => {\n        it('Access-Control-Allow-Origin header should be empty', (done) => {\n            const jar = request.jar();\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {},\n                json: true,\n                jar: jar,\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], undefined);\n                done();\n            });\n        });\n\n        it('should set proper Access-Control-Allow-Origin header', (done) => {\n            const jar = request.jar();\n            const oldValue = meta.config['access-control-allow-origin'];\n            meta.config['access-control-allow-origin'] = 'test.com, mydomain.com';\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    origin: 'mydomain.com',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], 'mydomain.com');\n                meta.config['access-control-allow-origin'] = oldValue;\n                done(err);\n            });\n        });\n\n        it('Access-Control-Allow-Origin header should be empty if origin does not match', (done) => {\n            const jar = request.jar();\n            const oldValue = meta.config['access-control-allow-origin'];\n            meta.config['access-control-allow-origin'] = 'test.com, mydomain.com';\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    origin: 'notallowed.com',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], undefined);\n                meta.config['access-control-allow-origin'] = oldValue;\n                done(err);\n            });\n        });\n\n        it('should set proper Access-Control-Allow-Origin header', (done) => {\n            const jar = request.jar();\n            const oldValue = meta.config['access-control-allow-origin-regex'];\n            meta.config['access-control-allow-origin-regex'] = 'match\\\\.this\\\\..+\\\\.domain.com, mydomain\\\\.com';\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    origin: 'match.this.anything123.domain.com',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], 'match.this.anything123.domain.com');\n                meta.config['access-control-allow-origin-regex'] = oldValue;\n                done(err);\n            });\n        });\n\n        it('Access-Control-Allow-Origin header should be empty if origin does not match', (done) => {\n            const jar = request.jar();\n            const oldValue = meta.config['access-control-allow-origin-regex'];\n            meta.config['access-control-allow-origin-regex'] = 'match\\\\.this\\\\..+\\\\.domain.com, mydomain\\\\.com';\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    origin: 'notallowed.com',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], undefined);\n                meta.config['access-control-allow-origin-regex'] = oldValue;\n                done(err);\n            });\n        });\n\n        it('should not error with invalid regexp', (done) => {\n            const jar = request.jar();\n            const oldValue = meta.config['access-control-allow-origin-regex'];\n            meta.config['access-control-allow-origin-regex'] = '[match\\\\.this\\\\..+\\\\.domain.com, mydomain\\\\.com';\n            request.get(`${nconf.get('url')}/api/search?term=bug`, {\n                form: {\n                },\n                json: true,\n                jar: jar,\n                headers: {\n                    origin: 'mydomain.com',\n                },\n            }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.headers['access-control-allow-origin'], 'mydomain.com');\n                meta.config['access-control-allow-origin-regex'] = oldValue;\n                done(err);\n            });\n        });\n    });\n\n    it('should log targets', (done) => {\n        const aliases = require('../src/meta/aliases');\n        aliases.buildTargets();\n        done();\n    });\n});\n"},"test/middleware.js":{"tests":[{"id":"1670","name":"Middlewares expose should expose res.locals.isAdmin = false"},{"id":"1671","name":"Middlewares expose should expose res.locals.isAdmin = true"},{"id":"1672","name":"Middlewares expose should expose privileges in res.locals.privileges and isSelf=true"},{"id":"1673","name":"Middlewares expose should expose privileges in res.locals.privileges and isSelf=false"},{"id":"1674","name":"Middlewares expose should expose privilege set"},{"id":"1675","name":"Middlewares cache-control header should be absent on non-existent routes, for guests"},{"id":"1676","name":"Middlewares cache-control header should be set to \"private\" on non-existent routes, for logged in users"},{"id":"1677","name":"Middlewares cache-control header should be absent on regular routes, for guests"},{"id":"1678","name":"Middlewares cache-control header should be absent on api routes, for guests"},{"id":"1679","name":"Middlewares cache-control header should be set to \"private\" on regular routes, for logged-in users"},{"id":"1680","name":"Middlewares cache-control header should be set to \"private\" on api routes, for logged-in users"},{"id":"1681","name":"Middlewares cache-control header should be set to \"private\" on apiv3 routes, for logged-in users"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst request = require('request-promise-native');\nconst db = require('./mocks/databasemock');\n\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst utils = require('../src/utils');\n\nconst helpers = require('./helpers');\n\ndescribe('Middlewares', () => {\n    describe('expose', () => {\n        let adminUid;\n\n        before(async () => {\n            adminUid = await user.create({ username: 'admin', password: '123456' });\n            await groups.join('administrators', adminUid);\n        });\n\n        it('should expose res.locals.isAdmin = false', (done) => {\n            const middleware = require('../src/middleware');\n            const resMock = { locals: {} };\n            middleware.exposeAdmin({}, resMock, () => {\n                assert.strictEqual(resMock.locals.isAdmin, false);\n                done();\n            });\n        });\n\n        it('should expose res.locals.isAdmin = true', (done) => {\n            const middleware = require('../src/middleware');\n            const reqMock = { user: { uid: adminUid } };\n            const resMock = { locals: {} };\n            middleware.exposeAdmin(reqMock, resMock, () => {\n                assert.strictEqual(resMock.locals.isAdmin, true);\n                done();\n            });\n        });\n\n        it('should expose privileges in res.locals.privileges and isSelf=true', (done) => {\n            const middleware = require('../src/middleware');\n            const reqMock = { user: { uid: adminUid }, params: { uid: adminUid } };\n            const resMock = { locals: {} };\n            middleware.exposePrivileges(reqMock, resMock, () => {\n                assert(resMock.locals.privileges);\n                assert.strictEqual(resMock.locals.privileges.isAdmin, true);\n                assert.strictEqual(resMock.locals.privileges.isGmod, false);\n                assert.strictEqual(resMock.locals.privileges.isPrivileged, true);\n                assert.strictEqual(resMock.locals.privileges.isSelf, true);\n                done();\n            });\n        });\n\n        it('should expose privileges in res.locals.privileges and isSelf=false', (done) => {\n            const middleware = require('../src/middleware');\n            const reqMock = { user: { uid: 0 }, params: { uid: adminUid } };\n            const resMock = { locals: {} };\n            middleware.exposePrivileges(reqMock, resMock, () => {\n                assert(resMock.locals.privileges);\n                assert.strictEqual(resMock.locals.privileges.isAdmin, false);\n                assert.strictEqual(resMock.locals.privileges.isGmod, false);\n                assert.strictEqual(resMock.locals.privileges.isPrivileged, false);\n                assert.strictEqual(resMock.locals.privileges.isSelf, false);\n                done();\n            });\n        });\n\n        it('should expose privilege set', (done) => {\n            const middleware = require('../src/middleware');\n            const reqMock = { user: { uid: adminUid } };\n            const resMock = { locals: {} };\n            middleware.exposePrivilegeSet(reqMock, resMock, () => {\n                assert(resMock.locals.privileges);\n                assert.deepStrictEqual(resMock.locals.privileges, {\n                    chat: true,\n                    'upload:post:image': true,\n                    'upload:post:file': true,\n                    signature: true,\n                    invite: true,\n                    'group:create': true,\n                    'search:content': true,\n                    'search:users': true,\n                    'search:tags': true,\n                    'view:users': true,\n                    'view:tags': true,\n                    'view:groups': true,\n                    'local:login': true,\n                    ban: true,\n                    mute: true,\n                    'view:users:info': true,\n                    'admin:dashboard': true,\n                    'admin:categories': true,\n                    'admin:privileges': true,\n                    'admin:admins-mods': true,\n                    'admin:users': true,\n                    'admin:groups': true,\n                    'admin:tags': true,\n                    'admin:settings': true,\n                    superadmin: true,\n                });\n                done();\n            });\n        });\n    });\n\n    describe('cache-control header', () => {\n        let uid;\n        let jar;\n\n        before(async () => {\n            uid = await user.create({ username: 'testuser', password: '123456' });\n            ({ jar } = await helpers.loginUser('testuser', '123456'));\n        });\n\n        it('should be absent on non-existent routes, for guests', async () => {\n            const res = await request(`${nconf.get('url')}/${utils.generateUUID()}`, {\n                simple: false,\n                resolveWithFullResponse: true,\n            });\n\n            assert.strictEqual(res.statusCode, 404);\n            assert(!Object.keys(res.headers).includes('cache-control'));\n        });\n\n        it('should be set to \"private\" on non-existent routes, for logged in users', async () => {\n            const res = await request(`${nconf.get('url')}/${utils.generateUUID()}`, {\n                simple: false,\n                resolveWithFullResponse: true,\n                jar,\n            });\n\n            assert.strictEqual(res.statusCode, 404);\n            assert(Object.keys(res.headers).includes('cache-control'));\n            assert.strictEqual(res.headers['cache-control'], 'private');\n        });\n\n        it('should be absent on regular routes, for guests', async () => {\n            const res = await request(nconf.get('url'), {\n                simple: false,\n                resolveWithFullResponse: true,\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert(!Object.keys(res.headers).includes('cache-control'));\n        });\n\n        it('should be absent on api routes, for guests', async () => {\n            const res = await request(`${nconf.get('url')}/api`, {\n                simple: false,\n                resolveWithFullResponse: true,\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert(!Object.keys(res.headers).includes('cache-control'));\n        });\n\n        it('should be set to \"private\" on regular routes, for logged-in users', async () => {\n            const res = await request(nconf.get('url'), {\n                simple: false,\n                resolveWithFullResponse: true,\n                jar,\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert(Object.keys(res.headers).includes('cache-control'));\n            assert.strictEqual(res.headers['cache-control'], 'private');\n        });\n\n        it('should be set to \"private\" on api routes, for logged-in users', async () => {\n            const res = await request(`${nconf.get('url')}/api`, {\n                simple: false,\n                resolveWithFullResponse: true,\n                jar,\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert(Object.keys(res.headers).includes('cache-control'));\n            assert.strictEqual(res.headers['cache-control'], 'private');\n        });\n\n        it('should be set to \"private\" on apiv3 routes, for logged-in users', async () => {\n            const res = await request(`${nconf.get('url')}/api/v3/users/${uid}`, {\n                simple: false,\n                resolveWithFullResponse: true,\n                jar,\n            });\n\n            assert.strictEqual(res.statusCode, 200);\n            assert(Object.keys(res.headers).includes('cache-control'));\n            assert.strictEqual(res.headers['cache-control'], 'private');\n        });\n    });\n});\n\n"},"test/notifications.js":{"tests":[{"id":"1682","name":"Notifications should fail to create notification without a nid"},{"id":"1683","name":"Notifications should create a notification"},{"id":"1684","name":"Notifications should return null if pid is same and importance is lower"},{"id":"1685","name":"Notifications should get empty array"},{"id":"1686","name":"Notifications should get notifications"},{"id":"1687","name":"Notifications should do nothing"},{"id":"1688","name":"Notifications should push a notification to uid"},{"id":"1689","name":"Notifications should push a notification to a group"},{"id":"1690","name":"Notifications should push a notification to groups"},{"id":"1691","name":"Notifications should not mark anything with invalid uid or nid"},{"id":"1692","name":"Notifications should mark a notification read"},{"id":"1693","name":"Notifications should error if notification does not exist"},{"id":"1694","name":"Notifications should mark a notification unread"},{"id":"1695","name":"Notifications should mark all notifications read"},{"id":"1696","name":"Notifications should not do anything"},{"id":"1697","name":"Notifications should link to the first unread post in a watched topic"},{"id":"1698","name":"Notifications should get notification by nid"},{"id":"1699","name":"Notifications should get user's notifications"},{"id":"1700","name":"Notifications should error if not logged in"},{"id":"1701","name":"Notifications should delete all user notifications"},{"id":"1702","name":"Notifications should return empty with falsy uid"},{"id":"1703","name":"Notifications should get all notifications and filter"},{"id":"1704","name":"Notifications should not get anything if notifications does not exist"},{"id":"1705","name":"Notifications should get daily notifications"},{"id":"1706","name":"Notifications should return empty array for invalid interval"},{"id":"1707","name":"Notifications should return 0 for falsy uid"},{"id":"1708","name":"Notifications should not do anything if uid is falsy"},{"id":"1709","name":"Notifications should send notification to followers of user when he posts"},{"id":"1710","name":"Notifications should send welcome notification"},{"id":"1711","name":"Notifications should prune notifications"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst async = require('async');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst meta = require('../src/meta');\nconst user = require('../src/user');\nconst topics = require('../src/topics');\nconst categories = require('../src/categories');\nconst groups = require('../src/groups');\nconst notifications = require('../src/notifications');\nconst socketNotifications = require('../src/socket.io/notifications');\n\ndescribe('Notifications', () => {\n    let uid;\n    let notification;\n\n    before((done) => {\n        user.create({ username: 'poster' }, (err, _uid) => {\n            if (err) {\n                return done(err);\n            }\n\n            uid = _uid;\n            done();\n        });\n    });\n\n    it('should fail to create notification without a nid', (done) => {\n        notifications.create({}, (err) => {\n            assert.equal(err.message, '[[error:no-notification-id]]');\n            done();\n        });\n    });\n\n    it('should create a notification', (done) => {\n        notifications.create({\n            bodyShort: 'bodyShort',\n            nid: 'notification_id',\n            path: '/notification/path',\n            pid: 1,\n        }, (err, _notification) => {\n            notification = _notification;\n            assert.ifError(err);\n            assert(notification);\n            db.exists(`notifications:${notification.nid}`, (err, exists) => {\n                assert.ifError(err);\n                assert(exists);\n                db.isSortedSetMember('notifications', notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should return null if pid is same and importance is lower', (done) => {\n        notifications.create({\n            bodyShort: 'bodyShort',\n            nid: 'notification_id',\n            path: '/notification/path',\n            pid: 1,\n            importance: 1,\n        }, (err, notification) => {\n            assert.ifError(err);\n            assert.strictEqual(notification, null);\n            done();\n        });\n    });\n\n    it('should get empty array', (done) => {\n        notifications.getMultiple(null, (err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            assert.equal(data.length, 0);\n            done();\n        });\n    });\n\n    it('should get notifications', (done) => {\n        notifications.getMultiple([notification.nid], (err, notificationsData) => {\n            assert.ifError(err);\n            assert(Array.isArray(notificationsData));\n            assert(notificationsData[0]);\n            assert.equal(notification.nid, notificationsData[0].nid);\n            done();\n        });\n    });\n\n    it('should do nothing', (done) => {\n        notifications.push(null, [], (err) => {\n            assert.ifError(err);\n            notifications.push({ nid: null }, [], (err) => {\n                assert.ifError(err);\n                notifications.push(notification, [], (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should push a notification to uid', (done) => {\n        notifications.push(notification, [uid], (err) => {\n            assert.ifError(err);\n            setTimeout(() => {\n                db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            }, 2000);\n        });\n    });\n\n    it('should push a notification to a group', (done) => {\n        notifications.pushGroup(notification, 'registered-users', (err) => {\n            assert.ifError(err);\n            setTimeout(() => {\n                db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            }, 2000);\n        });\n    });\n\n    it('should push a notification to groups', (done) => {\n        notifications.pushGroups(notification, ['registered-users', 'administrators'], (err) => {\n            assert.ifError(err);\n            setTimeout(() => {\n                db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert(isMember);\n                    done();\n                });\n            }, 2000);\n        });\n    });\n\n    it('should not mark anything with invalid uid or nid', (done) => {\n        socketNotifications.markRead({ uid: null }, null, (err) => {\n            assert.ifError(err);\n            socketNotifications.markRead({ uid: uid }, null, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n    });\n\n    it('should mark a notification read', (done) => {\n        socketNotifications.markRead({ uid: uid }, notification.nid, (err) => {\n            assert.ifError(err);\n            db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                assert.ifError(err);\n                assert.equal(isMember, false);\n                db.isSortedSetMember(`uid:${uid}:notifications:read`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert.equal(isMember, true);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should not mark anything with invalid uid or nid', (done) => {\n        socketNotifications.markUnread({ uid: null }, null, (err) => {\n            assert.ifError(err);\n            socketNotifications.markUnread({ uid: uid }, null, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n    });\n\n    it('should error if notification does not exist', (done) => {\n        socketNotifications.markUnread({ uid: uid }, 123123, (err) => {\n            assert.equal(err.message, '[[error:no-notification]]');\n            done();\n        });\n    });\n\n    it('should mark a notification unread', (done) => {\n        socketNotifications.markUnread({ uid: uid }, notification.nid, (err) => {\n            assert.ifError(err);\n            db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                assert.ifError(err);\n                assert.equal(isMember, true);\n                db.isSortedSetMember(`uid:${uid}:notifications:read`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert.equal(isMember, false);\n                    socketNotifications.getCount({ uid: uid }, null, (err, count) => {\n                        assert.ifError(err);\n                        assert.equal(count, 1);\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    it('should mark all notifications read', (done) => {\n        socketNotifications.markAllRead({ uid: uid }, null, (err) => {\n            assert.ifError(err);\n            db.isSortedSetMember(`uid:${uid}:notifications:unread`, notification.nid, (err, isMember) => {\n                assert.ifError(err);\n                assert.equal(isMember, false);\n                db.isSortedSetMember(`uid:${uid}:notifications:read`, notification.nid, (err, isMember) => {\n                    assert.ifError(err);\n                    assert.equal(isMember, true);\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should not do anything', (done) => {\n        socketNotifications.markAllRead({ uid: 1000 }, null, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should link to the first unread post in a watched topic', (done) => {\n        const categories = require('../src/categories');\n        const topics = require('../src/topics');\n        let watcherUid;\n        let cid;\n        let tid;\n        let pid;\n\n        async.waterfall([\n            function (next) {\n                user.create({ username: 'watcher' }, next);\n            },\n            function (_watcherUid, next) {\n                watcherUid = _watcherUid;\n\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n            function (category, next) {\n                cid = category.cid;\n\n                topics.post({\n                    uid: watcherUid,\n                    cid: cid,\n                    title: 'Test Topic Title',\n                    content: 'The content of test topic',\n                }, next);\n            },\n            function (topic, next) {\n                tid = topic.topicData.tid;\n\n                topics.follow(tid, watcherUid, next);\n            },\n            function (next) {\n                topics.reply({\n                    uid: uid,\n                    content: 'This is the first reply.',\n                    tid: tid,\n                }, next);\n            },\n            function (post, next) {\n                pid = post.pid;\n\n                topics.reply({\n                    uid: uid,\n                    content: 'This is the second reply.',\n                    tid: tid,\n                }, next);\n            },\n            function (post, next) {\n                // notifications are sent asynchronously with a 1 second delay.\n                setTimeout(next, 3000);\n            },\n            function (next) {\n                user.notifications.get(watcherUid, next);\n            },\n            function (notifications, next) {\n                assert.equal(notifications.unread.length, 1, 'there should be 1 unread notification');\n                assert.equal(`${nconf.get('relative_path')}/post/${pid}`, notifications.unread[0].path, 'the notification should link to the first unread post');\n                next();\n            },\n        ], (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should get notification by nid', (done) => {\n        socketNotifications.get({ uid: uid }, { nids: [notification.nid] }, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data[0].bodyShort, 'bodyShort');\n            assert.equal(data[0].nid, 'notification_id');\n            assert.equal(data[0].path, `${nconf.get('relative_path')}/notification/path`);\n            done();\n        });\n    });\n\n    it('should get user\\'s notifications', (done) => {\n        socketNotifications.get({ uid: uid }, {}, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.unread.length, 0);\n            assert.equal(data.read[0].nid, 'notification_id');\n            done();\n        });\n    });\n\n    it('should error if not logged in', (done) => {\n        socketNotifications.deleteAll({ uid: 0 }, null, (err) => {\n            assert.equal(err.message, '[[error:no-privileges]]');\n            done();\n        });\n    });\n\n    it('should delete all user notifications', (done) => {\n        socketNotifications.deleteAll({ uid: uid }, null, (err) => {\n            assert.ifError(err);\n            socketNotifications.get({ uid: uid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.unread.length, 0);\n                assert.equal(data.read.length, 0);\n                done();\n            });\n        });\n    });\n\n    it('should return empty with falsy uid', (done) => {\n        user.notifications.get(0, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.read.length, 0);\n            assert.equal(data.unread.length, 0);\n            done();\n        });\n    });\n\n    it('should get all notifications and filter', (done) => {\n        const nid = 'willbefiltered';\n        notifications.create({\n            bodyShort: 'bodyShort',\n            nid: nid,\n            path: '/notification/path',\n            type: 'post',\n        }, (err, notification) => {\n            assert.ifError(err);\n            notifications.push(notification, [uid], (err) => {\n                assert.ifError(err);\n                setTimeout(() => {\n                    user.notifications.getAll(uid, 'post', (err, nids) => {\n                        assert.ifError(err);\n                        assert(nids.includes(nid));\n                        done();\n                    });\n                }, 3000);\n            });\n        });\n    });\n\n    it('should not get anything if notifications does not exist', (done) => {\n        user.notifications.getNotifications(['doesnotexistnid1', 'doesnotexistnid2'], uid, (err, data) => {\n            assert.ifError(err);\n            assert.deepEqual(data, []);\n            done();\n        });\n    });\n\n    it('should get daily notifications', (done) => {\n        user.notifications.getDailyUnread(uid, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data[0].nid, 'willbefiltered');\n            done();\n        });\n    });\n\n    it('should return empty array for invalid interval', (done) => {\n        user.notifications.getUnreadInterval(uid, '2 aeons', (err, data) => {\n            assert.ifError(err);\n            assert.deepEqual(data, []);\n            done();\n        });\n    });\n\n    it('should return 0 for falsy uid', (done) => {\n        user.notifications.getUnreadCount(0, (err, count) => {\n            assert.ifError(err);\n            assert.equal(count, 0);\n            done();\n        });\n    });\n\n    it('should not do anything if uid is falsy', (done) => {\n        user.notifications.deleteAll(0, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should send notification to followers of user when he posts', (done) => {\n        let followerUid;\n        async.waterfall([\n            function (next) {\n                user.create({ username: 'follower' }, next);\n            },\n            function (_followerUid, next) {\n                followerUid = _followerUid;\n                user.follow(followerUid, uid, next);\n            },\n            function (next) {\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n            function (category, next) {\n                topics.post({\n                    uid: uid,\n                    cid: category.cid,\n                    title: 'Test Topic Title',\n                    content: 'The content of test topic',\n                }, next);\n            },\n            function (data, next) {\n                setTimeout(next, 1100);\n            },\n            function (next) {\n                user.notifications.getAll(followerUid, '', next);\n            },\n        ], (err, data) => {\n            assert.ifError(err);\n            assert(data);\n            done();\n        });\n    });\n\n    it('should send welcome notification', (done) => {\n        meta.config.welcomeNotification = 'welcome to the forums';\n        user.notifications.sendWelcomeNotification(uid, (err) => {\n            assert.ifError(err);\n            user.notifications.sendWelcomeNotification(uid, (err) => {\n                assert.ifError(err);\n                setTimeout(() => {\n                    user.notifications.getAll(uid, '', (err, data) => {\n                        meta.config.welcomeNotification = '';\n                        assert.ifError(err);\n                        assert(data.includes(`welcome_${uid}`), data);\n                        done();\n                    });\n                }, 2000);\n            });\n        });\n    });\n\n    it('should prune notifications', (done) => {\n        notifications.create({\n            bodyShort: 'bodyShort',\n            nid: 'tobedeleted',\n            path: '/notification/path',\n        }, (err, notification) => {\n            assert.ifError(err);\n            notifications.prune((err) => {\n                assert.ifError(err);\n                const month = 2592000000;\n                db.sortedSetAdd('notifications', Date.now() - (2 * month), notification.nid, (err) => {\n                    assert.ifError(err);\n                    notifications.prune((err) => {\n                        assert.ifError(err);\n                        notifications.get(notification.nid, (err, data) => {\n                            assert.ifError(err);\n                            assert(!data);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n    });\n});\n"},"test/package-install.js":{"tests":[{"id":"1712","name":"Package install lib updatePackageFile() should remove non-`nodebb-` modules not specified in `install/package.json`"},{"id":"1713","name":"Package install lib updatePackageFile() should merge new root level properties from `install/package.json` into `package.json`"},{"id":"1714","name":"Package install lib updatePackageFile() should add new dependencies"},{"id":"1715","name":"Package install lib updatePackageFile() should update version on dependencies"},{"id":"1716","name":"Package install lib updatePackageFile() should deep merge nested objects"},{"id":"1717","name":"Package install lib updatePackageFile() should remove extraneous devDependencies"},{"id":"1718","name":"Package install lib updatePackageFile() should handle if there is no package.json"}],"source":"'use strict';\n\nconst path = require('path');\nconst fs = require('fs').promises;\nconst assert = require('assert');\n\nconst pkgInstall = require('../src/cli/package-install');\n\ndescribe('Package install lib', () => {\n    /**\n     * Important:\n     *   - The tests here have a beforeEach() run prior to each test, it resets\n     *     package.json and install/package.json back to identical states.\n     *   - Update `source` and `current` for testing.\n     */\n    describe('updatePackageFile()', () => {\n        let source;\n        let current;\n        const sourcePackagePath = path.resolve(__dirname, '../install/package.json');\n        const packageFilePath = path.resolve(__dirname, '../package.json');\n\n        before(async () => {\n            // Move `install/package.json` and `package.json` out of the way for now\n            await fs.copyFile(sourcePackagePath, path.resolve(__dirname, '../install/package.json.bak')); // safekeeping\n            await fs.copyFile(packageFilePath, path.resolve(__dirname, '../package.json.bak')); // safekeeping\n        });\n\n        beforeEach(async () => {\n            await fs.copyFile(path.resolve(__dirname, '../install/package.json.bak'), sourcePackagePath);\n            await fs.copyFile(sourcePackagePath, packageFilePath); // match files for testing\n            source = JSON.parse(await fs.readFile(sourcePackagePath));\n            current = JSON.parse(await fs.readFile(packageFilePath));\n        });\n\n        it('should remove non-`nodebb-` modules not specified in `install/package.json`', async () => {\n            source.dependencies.dotenv = '16.0.0';\n            await fs.writeFile(packageFilePath, JSON.stringify(source, null, 4));\n            delete source.dependencies.dotenv;\n\n            pkgInstall.updatePackageFile();\n\n            // assert it removed the extra package\n            const packageCleaned = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert(!packageCleaned.dependencies.dotenv, 'dependency was not removed');\n        });\n\n        it('should merge new root level properties from `install/package.json` into `package.json`', async () => {\n            source.bin = './nodebb';\n            await fs.writeFile(sourcePackagePath, JSON.stringify(source, null, 4));\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.deepStrictEqual(updated, source);\n        });\n\n        it('should add new dependencies', async () => {\n            source.dependencies['nodebb-plugin-foobar'] = '1.0.0';\n            await fs.writeFile(sourcePackagePath, JSON.stringify(source, null, 4));\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.deepStrictEqual(updated, source);\n        });\n\n        it('should update version on dependencies', async () => {\n            source.dependencies['nodebb-plugin-mentions'] = '1.0.0';\n            await fs.writeFile(sourcePackagePath, JSON.stringify(source, null, 4));\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.deepStrictEqual(updated, source);\n        });\n\n        it('should deep merge nested objects', async () => {\n            current.scripts.postinstall = 'echo \"I am a silly bean\";';\n            await fs.writeFile(packageFilePath, JSON.stringify(current, null, 4));\n            source.scripts.preinstall = 'echo \"What are you?\";';\n            await fs.writeFile(sourcePackagePath, JSON.stringify(source, null, 4));\n            source.scripts.postinstall = 'echo \"I am a silly bean\";';\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.deepStrictEqual(updated, source);\n            assert.strictEqual(updated.scripts.postinstall, 'echo \"I am a silly bean\";');\n            assert.strictEqual(updated.scripts.preinstall, 'echo \"What are you?\";');\n        });\n\n        it('should remove extraneous devDependencies', async () => {\n            current.devDependencies.expect = '27.5.1';\n            await fs.writeFile(packageFilePath, JSON.stringify(current, null, 4));\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.strictEqual(updated.devDependencies.hasOwnProperty('expect'), false);\n        });\n\n        it('should handle if there is no package.json', async () => {\n            await fs.unlink(packageFilePath);\n\n            pkgInstall.updatePackageFile();\n            const updated = JSON.parse(await fs.readFile(packageFilePath, 'utf8'));\n            assert.deepStrictEqual(updated, source);\n        });\n\n        after(async () => {\n            // Clean up\n            await fs.rename(path.resolve(__dirname, '../install/package.json.bak'), sourcePackagePath);\n            await fs.rename(path.resolve(__dirname, '../package.json.bak'), packageFilePath);\n        });\n    });\n});\n"},"test/pagination.js":{"tests":[{"id":"1719","name":"Pagination should create empty pagination for 1 page"},{"id":"1720","name":"Pagination should create pagination for 10 pages"},{"id":"1721","name":"Pagination should create pagination for 3 pages with query params"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst pagination = require('../src/pagination');\n\ndescribe('Pagination', () => {\n    it('should create empty pagination for 1 page', (done) => {\n        const data = pagination.create(1, 1);\n        assert.equal(data.pages.length, 0);\n        assert.equal(data.rel.length, 0);\n        assert.equal(data.pageCount, 1);\n        assert.equal(data.prev.page, 1);\n        assert.equal(data.next.page, 1);\n        done();\n    });\n\n    it('should create pagination for 10 pages', (done) => {\n        const data = pagination.create(2, 10);\n        // [1, (2), 3, 4, 5, separator, 9, 10]\n        assert.equal(data.pages.length, 8);\n        assert.equal(data.rel.length, 2);\n        assert.equal(data.pageCount, 10);\n        assert.equal(data.prev.page, 1);\n        assert.equal(data.next.page, 3);\n        done();\n    });\n\n    it('should create pagination for 3 pages with query params', (done) => {\n        const data = pagination.create(1, 3, { key: 'value' });\n        assert.equal(data.pages.length, 3);\n        assert.equal(data.rel.length, 1);\n        assert.equal(data.pageCount, 3);\n        assert.equal(data.prev.page, 1);\n        assert.equal(data.next.page, 2);\n        assert.equal(data.pages[0].qs, 'key=value&page=1');\n        done();\n    });\n});\n"},"test/password.js":{"tests":[{"id":"1722","name":"Password .hash() should return a password hash when called"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst bcrypt = require('bcryptjs');\n\nconst password = require('../src/password');\n\ndescribe('Password', () => {\n    describe('.hash()', () => {\n        it('should return a password hash when called', async () => {\n            const hash = await password.hash(12, 'test');\n            assert(hash.startsWith('$2a$'));\n        });\n    });\n\n    describe('.compare()', async () => {\n        const salt = await bcrypt.genSalt(12);\n\n        it('should correctly compare a password and a hash', async () => {\n            const hash = await password.hash(12, 'test');\n            const match = await password.compare('test', hash, true);\n            assert(match);\n        });\n\n        it('should correctly handle comparison with no sha wrapping of the input (backwards compatibility)', async () => {\n            const hash = await bcrypt.hash('test', salt);\n            const match = await password.compare('test', hash, false);\n            assert(match);\n        });\n\n        it('should continue to function even with passwords > 73 characters', async () => {\n            const arr = [];\n            arr.length = 100;\n            const hash = await password.hash(12, arr.join('a'));\n\n            arr.length = 150;\n            const match = await password.compare(arr.join('a'), hash, true);\n            assert.strictEqual(match, false);\n        });\n\n        it('should process a million-character long password quickly', async () => {\n            // ... because sha512 reduces it to a constant size\n            const arr = [];\n            const start = Date.now();\n            arr.length = 1000000;\n            await password.hash(12, arr.join('a'));\n            const end = Date.now();\n\n            assert(end - start <"+" 5000);\n        });\n    });\n});\n"},"test/posts.js":{"tests":[{"id":"1723","name":"Post's should update category teaser properly"},{"id":"1724","name":"Post's should change owner of post and topic properly"},{"id":"1725","name":"Post's should fail to change owner if new owner does not exist"},{"id":"1726","name":"Post's should fail to change owner if user is not authorized"},{"id":"1727","name":"Post's should return falsy if post does not exist"},{"id":"1728","name":"Post's should get recent poster uids"},{"id":"1729","name":"Post's should error if user does not exist"},{"id":"1730","name":"Post's voting should fail to upvote post if group does not have upvote permission"},{"id":"1731","name":"Post's voting should upvote a post"},{"id":"1732","name":"Post's voting should add the pid to the :votes sorted set for that user"},{"id":"1733","name":"Post's voting should get voters"},{"id":"1734","name":"Post's voting should get upvoters"},{"id":"1735","name":"Post's voting should unvote a post"},{"id":"1736","name":"Post's voting should downvote a post"},{"id":"1737","name":"Post's voting should prevent downvoting more than total daily limit"},{"id":"1738","name":"Post's voting should prevent downvoting target user more than total daily limit"},{"id":"1739","name":"Post's bookmarking should bookmark a post"},{"id":"1740","name":"Post's bookmarking should unbookmark a post"},{"id":"1741","name":"Post's endorsing should not endorse a post if the endorser is not instructor"},{"id":"1742","name":"Post's endorsing should not unendorse a post if the endorser is not instructor"},{"id":"1743","name":"Post's endorsing should endorse a post if the endorser is instructor"},{"id":"1744","name":"Post's endorsing should unendorse a post if the endorser is instructor"},{"id":"1745","name":"Post's endorsing should return multiple endorse status if requested for multiple posts"},{"id":"1746","name":"Post's post tools should error if data is invalid"},{"id":"1747","name":"Post's post tools should load post tools"},{"id":"1748","name":"Post's delete/restore/purge should error with invalid data"},{"id":"1749","name":"Post's delete/restore/purge should delete a post"},{"id":"1750","name":"Post's delete/restore/purge should not see post content if global mod does not have posts:view_deleted privilege"},{"id":"1751","name":"Post's delete/restore/purge should restore a post"},{"id":"1752","name":"Post's delete/restore/purge should delete topic if last main post is deleted"},{"id":"1753","name":"Post's delete/restore/purge should purge posts and purge topic"},{"id":"1754","name":"Post's edit should error if user is not logged in"},{"id":"1755","name":"Post's edit should error if data is invalid or missing"},{"id":"1756","name":"Post's edit should error if title is too short"},{"id":"1757","name":"Post's edit should error if title is too long"},{"id":"1758","name":"Post's edit should error with too few tags"},{"id":"1759","name":"Post's edit should error with too many tags"},{"id":"1760","name":"Post's edit should error if content is too short"},{"id":"1761","name":"Post's edit should error if content is too long"},{"id":"1762","name":"Post's edit should edit post"},{"id":"1763","name":"Post's edit should disallow post editing for new users if post was made past the threshold for editing"},{"id":"1764","name":"Post's edit should edit a deleted post"},{"id":"1765","name":"Post's edit should edit a reply post"},{"id":"1766","name":"Post's edit should return diffs"},{"id":"1767","name":"Post's edit should load diffs and reconstruct post"},{"id":"1768","name":"Post's edit should not allow guests to view diffs"},{"id":"1769","name":"Post's edit should allow registered-users group to view diffs"},{"id":"1770","name":"Post's edit should not delete first diff of a post"},{"id":"1771","name":"Post's edit should delete a post diff"},{"id":"1772","name":"Post's edit should load (oldest) diff and reconstruct post correctly after a diff deletion"},{"id":"1773","name":"Post's move should error if uid is not logged in"},{"id":"1774","name":"Post's move should error if data is invalid"},{"id":"1775","name":"Post's move should error if user does not have move privilege"},{"id":"1776","name":"Post's move should move a post"},{"id":"1777","name":"Post's move should fail to move post if not moderator of target category"},{"id":"1778","name":"Post's getPostSummaryByPids should return empty array for empty pids"},{"id":"1779","name":"Post's getPostSummaryByPids should get post summaries"},{"id":"1780","name":"Post's parse should not crash and return falsy if post data is falsy"},{"id":"1781","name":"Post's parse should store post content in cache"},{"id":"1782","name":"Post's parse should parse signature and remove links and images"},{"id":"1783","name":"Post's parse should turn relative links in post body to absolute urls"},{"id":"1784","name":"Post's socket methods should error with invalid data"},{"id":"1785","name":"Post's socket methods should error with invalid tid"},{"id":"1786","name":"Post's socket methods should fail to get raw post because of privilege"},{"id":"1787","name":"Post's socket methods should fail to get raw post because post is deleted"},{"id":"1788","name":"Post's socket methods should get raw post content"},{"id":"1789","name":"Post's socket methods should get post"},{"id":"1790","name":"Post's socket methods should get post category"},{"id":"1791","name":"Post's socket methods should get pid index"},{"id":"1792","name":"Post's socket methods should get pid index in reverse"},{"id":"1793","name":"Post's filterPidsByCid should return pids as is if cid is falsy"},{"id":"1794","name":"Post's filterPidsByCid should filter pids by single cid"},{"id":"1795","name":"Post's filterPidsByCid should filter pids by multiple cids"},{"id":"1796","name":"Post's post queue should add topic to post queue"},{"id":"1797","name":"Post's post queue should add reply to post queue"},{"id":"1798","name":"Post's post queue should load queued posts"},{"id":"1799","name":"Post's post queue should error if data is invalid"},{"id":"1800","name":"Post's post queue should edit post in queue"},{"id":"1801","name":"Post's post queue should edit topic title in queue"},{"id":"1802","name":"Post's post queue should edit topic category in queue"},{"id":"1803","name":"Post's post queue should prevent regular users from approving posts"},{"id":"1804","name":"Post's post queue should prevent regular users from approving non existing posts"},{"id":"1805","name":"Post's post queue should accept queued posts and submit"},{"id":"1806","name":"Post's post queue should not crash if id does not exist"},{"id":"1807","name":"Post's post queue should bypass post queue if user is in exempt group"},{"id":"1808","name":"Post's post queue should update queued post's topic if target topic is merged"},{"id":"1809","name":"Post's Topic Backlinks .syncBacklinks() should error on invalid data"},{"id":"1810","name":"Post's Topic Backlinks .syncBacklinks() should do nothing if the post does not contain a link to a topic"},{"id":"1811","name":"Post's Topic Backlinks .syncBacklinks() should create a backlink if it detects a topic link in a post"},{"id":"1812","name":"Post's Topic Backlinks .syncBacklinks() should remove the backlink (but keep the event) if the post no longer contains a link to a topic"},{"id":"1813","name":"Post's Topic Backlinks integration tests should create a topic event in the referenced topic"},{"id":"1814","name":"Post's Topic Backlinks integration tests should not create a topic event if referenced topic is the same as current topic"},{"id":"1815","name":"Post's Topic Backlinks integration tests should not show backlink events if the feature is disabled"},{"id":"1816","name":"Posts' subfolder tests"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst async = require('async');\nconst request = require('request');\nconst nconf = require('nconf');\nconst path = require('path');\nconst util = require('util');\n\nconst sleep = util.promisify(setTimeout);\n\nconst db = require('./mocks/databasemock');\nconst topics = require('../src/topics');\nconst posts = require('../src/posts');\nconst categories = require('../src/categories');\nconst privileges = require('../src/privileges');\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst socketPosts = require('../src/socket.io/posts');\nconst apiPosts = require('../src/api/posts');\nconst apiTopics = require('../src/api/topics');\nconst meta = require('../src/meta');\nconst file = require('../src/file');\nconst helpers = require('./helpers');\n\ndescribe('Post\\'s', () => {\n    let voterUid;\n    let voteeUid;\n    let instructorUid;\n    let globalModUid;\n    let postData;\n    let topicData;\n    let cid;\n\n    before((done) => {\n        async.series({\n            voterUid: function (next) {\n                user.create({ username: 'upvoter' }, next);\n            },\n            instructorUid: function (next) {\n                user.create({ username: 'admin' }, next);\n            },\n            voteeUid: function (next) {\n                user.create({ username: 'upvotee' }, next);\n            },\n            globalModUid: function (next) {\n                user.create({ username: 'globalmod', password: 'globalmodpwd' }, next);\n            },\n            category: function (next) {\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n        }, (err, results) => {\n            if (err) {\n                return done(err);\n            }\n\n            voterUid = results.voterUid;\n            voteeUid = results.voteeUid;\n            instructorUid = results.instructorUid;\n            globalModUid = results.globalModUid;\n            cid = results.category.cid;\n\n            topics.post({\n                uid: results.voteeUid,\n                cid: results.category.cid,\n                title: 'Test Topic Title',\n                content: 'The content of test topic',\n            }, (err, data) => {\n                if (err) {\n                    return done(err);\n                }\n                postData = data.postData;\n                topicData = data.topicData;\n                groups.join('instructors', instructorUid);\n                groups.join('Global Moderators', globalModUid, done);\n            });\n        });\n    });\n\n    it('should update category teaser properly', async () => {\n        const util = require('util');\n        const getCategoriesAsync = util.promisify(async (callback) => {\n            request(`${nconf.get('url')}/api/categories`, { json: true }, (err, res, body) => {\n                callback(err, body);\n            });\n        });\n\n        const postResult = await topics.post({ uid: globalModUid, cid: cid, title: 'topic title', content: '123456789' });\n\n        let data = await getCategoriesAsync();\n        assert.equal(data.categories[0].teaser.pid, postResult.postData.pid);\n        assert.equal(data.categories[0].posts[0].content, '123456789');\n        assert.equal(data.categories[0].posts[0].pid, postResult.postData.pid);\n\n        const newUid = await user.create({ username: 'teaserdelete' });\n        const newPostResult = await topics.post({ uid: newUid, cid: cid, title: 'topic title', content: 'xxxxxxxx' });\n\n        data = await getCategoriesAsync();\n        assert.equal(data.categories[0].teaser.pid, newPostResult.postData.pid);\n        assert.equal(data.categories[0].posts[0].content, 'xxxxxxxx');\n        assert.equal(data.categories[0].posts[0].pid, newPostResult.postData.pid);\n\n        await user.delete(1, newUid);\n\n        data = await getCategoriesAsync();\n        assert.equal(data.categories[0].teaser.pid, postResult.postData.pid);\n        assert.equal(data.categories[0].posts[0].content, '123456789');\n        assert.equal(data.categories[0].posts[0].pid, postResult.postData.pid);\n    });\n\n    it('should change owner of post and topic properly', async () => {\n        const oldUid = await user.create({ username: 'olduser' });\n        const newUid = await user.create({ username: 'newuser' });\n        const postResult = await topics.post({ uid: oldUid, cid: cid, title: 'change owner', content: 'original post' });\n        const postData = await topics.reply({ uid: oldUid, tid: postResult.topicData.tid, content: 'firstReply' });\n        const pid1 = postResult.postData.pid;\n        const pid2 = postData.pid;\n\n        assert.deepStrictEqual(await db.sortedSetScores(`tid:${postResult.topicData.tid}:posters`, [oldUid, newUid]), [2, null]);\n\n        await posts.changeOwner([pid1, pid2], newUid);\n\n        assert.deepStrictEqual(await db.sortedSetScores(`tid:${postResult.topicData.tid}:posters`, [oldUid, newUid]), [0, 2]);\n\n        assert.deepStrictEqual(await posts.isOwner([pid1, pid2], oldUid), [false, false]);\n        assert.deepStrictEqual(await posts.isOwner([pid1, pid2], newUid), [true, true]);\n\n        assert.strictEqual(await user.getUserField(oldUid, 'postcount'), 0);\n        assert.strictEqual(await user.getUserField(newUid, 'postcount'), 2);\n\n        assert.strictEqual(await user.getUserField(oldUid, 'topiccount'), 0);\n        assert.strictEqual(await user.getUserField(newUid, 'topiccount'), 1);\n\n        assert.strictEqual(await db.sortedSetScore('users:postcount', oldUid), 0);\n        assert.strictEqual(await db.sortedSetScore('users:postcount', newUid), 2);\n\n        assert.strictEqual(await topics.isOwner(postResult.topicData.tid, oldUid), false);\n        assert.strictEqual(await topics.isOwner(postResult.topicData.tid, newUid), true);\n    });\n\n    it('should fail to change owner if new owner does not exist', async () => {\n        try {\n            await posts.changeOwner([1], '9999999');\n        } catch (err) {\n            assert.strictEqual(err.message, '[[error:no-user]]');\n        }\n    });\n\n    it('should fail to change owner if user is not authorized', async () => {\n        try {\n            await socketPosts.changeOwner({ uid: voterUid }, { pids: [1, 2], toUid: voterUid });\n        } catch (err) {\n            assert.strictEqual(err.message, '[[error:no-privileges]]');\n        }\n    });\n\n    it('should return falsy if post does not exist', (done) => {\n        posts.getPostData(9999, (err, postData) => {\n            assert.ifError(err);\n            assert.equal(postData, null);\n            done();\n        });\n    });\n\n    describe('voting', () => {\n        it('should fail to upvote post if group does not have upvote permission', async () => {\n            await privileges.categories.rescind(['groups:posts:upvote', 'groups:posts:downvote'], cid, 'registered-users');\n            let err;\n            try {\n                await apiPosts.upvote({ uid: voterUid }, { pid: postData.pid, room_id: 'topic_1' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, '[[error:no-privileges]]');\n            try {\n                await apiPosts.downvote({ uid: voterUid }, { pid: postData.pid, room_id: 'topic_1' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, '[[error:no-privileges]]');\n            await privileges.categories.give(['groups:posts:upvote', 'groups:posts:downvote'], cid, 'registered-users');\n        });\n\n        it('should upvote a post', async () => {\n            const result = await apiPosts.upvote({ uid: voterUid }, { pid: postData.pid, room_id: 'topic_1' });\n            assert.equal(result.post.upvotes, 1);\n            assert.equal(result.post.downvotes, 0);\n            assert.equal(result.post.votes, 1);\n            assert.equal(result.user.reputation, 1);\n            const data = await posts.hasVoted(postData.pid, voterUid);\n            assert.equal(data.upvoted, true);\n            assert.equal(data.downvoted, false);\n        });\n\n        it('should add the pid to the :votes sorted set for that user', async () => {\n            const cid = await posts.getCidByPid(postData.pid);\n            const { uid, pid } = postData;\n\n            const score = await db.sortedSetScore(`cid:${cid}:uid:${uid}:pids:votes`, pid);\n            assert.strictEqual(score, 1);\n        });\n\n        it('should get voters', (done) => {\n            socketPosts.getVoters({ uid: globalModUid }, { pid: postData.pid, cid: cid }, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.upvoteCount, 1);\n                assert.equal(data.downvoteCount, 0);\n                assert(Array.isArray(data.upvoters));\n                assert.equal(data.upvoters[0].username, 'upvoter');\n                done();\n            });\n        });\n\n        it('should get upvoters', (done) => {\n            socketPosts.getUpvoters({ uid: globalModUid }, [postData.pid], (err, data) => {\n                assert.ifError(err);\n                assert.equal(data[0].otherCount, 0);\n                assert.equal(data[0].usernames, 'upvoter');\n                done();\n            });\n        });\n\n        it('should unvote a post', async () => {\n            const result = await apiPosts.unvote({ uid: voterUid }, { pid: postData.pid, room_id: 'topic_1' });\n            assert.equal(result.post.upvotes, 0);\n            assert.equal(result.post.downvotes, 0);\n            assert.equal(result.post.votes, 0);\n            assert.equal(result.user.reputation, 0);\n            const data = await posts.hasVoted(postData.pid, voterUid);\n            assert.equal(data.upvoted, false);\n            assert.equal(data.downvoted, false);\n        });\n\n        it('should downvote a post', async () => {\n            const result = await apiPosts.downvote({ uid: voterUid }, { pid: postData.pid, room_id: 'topic_1' });\n            assert.equal(result.post.upvotes, 0);\n            assert.equal(result.post.downvotes, 1);\n            assert.equal(result.post.votes, -1);\n            assert.equal(result.user.reputation, -1);\n            const data = await posts.hasVoted(postData.pid, voterUid);\n            assert.equal(data.upvoted, false);\n            assert.equal(data.downvoted, true);\n        });\n\n        it('should add the pid to the :votes sorted set for that user', async () => {\n            const cid = await posts.getCidByPid(postData.pid);\n            const { uid, pid } = postData;\n\n            const score = await db.sortedSetScore(`cid:${cid}:uid:${uid}:pids:votes`, pid);\n            assert.strictEqual(score, -1);\n        });\n\n        it('should prevent downvoting more than total daily limit', async () => {\n            const oldValue = meta.config.downvotesPerDay;\n            meta.config.downvotesPerDay = 1;\n            let err;\n            const p1 = await topics.reply({\n                uid: voteeUid,\n                tid: topicData.tid,\n                content: 'raw content',\n            });\n            try {\n                await apiPosts.downvote({ uid: voterUid }, { pid: p1.pid, room_id: 'topic_1' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, '[[error:too-many-downvotes-today, 1]]');\n            meta.config.downvotesPerDay = oldValue;\n        });\n\n        it('should prevent downvoting target user more than total daily limit', async () => {\n            const oldValue = meta.config.downvotesPerUserPerDay;\n            meta.config.downvotesPerUserPerDay = 1;\n            let err;\n            const p1 = await topics.reply({\n                uid: voteeUid,\n                tid: topicData.tid,\n                content: 'raw content',\n            });\n            try {\n                await apiPosts.downvote({ uid: voterUid }, { pid: p1.pid, room_id: 'topic_1' });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, '[[error:too-many-downvotes-today-user, 1]]');\n            meta.config.downvotesPerUserPerDay = oldValue;\n        });\n    });\n\n    describe('bookmarking', () => {\n        it('should bookmark a post', async () => {\n            const data = await apiPosts.bookmark({ uid: voterUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            assert.equal(data.isBookmarked, true);\n            const hasBookmarked = await posts.hasBookmarked(postData.pid, voterUid);\n            assert.equal(hasBookmarked, true);\n        });\n\n        it('should unbookmark a post', async () => {\n            const data = await apiPosts.unbookmark({ uid: voterUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            assert.equal(data.isBookmarked, false);\n            const hasBookmarked = await posts.hasBookmarked([postData.pid], voterUid);\n            assert.equal(hasBookmarked[0], false);\n        });\n    });\n\n    describe('endorsing', () => {\n        it('should not endorse a post if the endorser is not instructor', async () => {\n            try {\n                await apiPosts.endorse({ uid: voterUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            } catch (err) {\n                return assert.equal(err.message, '[[error:not-instructor]]');\n            }\n        });\n\n        it('should not unendorse a post if the endorser is not instructor', async () => {\n            try {\n                await apiPosts.unendorse({ uid: voterUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            } catch (err) {\n                return assert.equal(err.message, '[[error:not-instructor]]');\n            }\n        });\n\n        it('should endorse a post if the endorser is instructor', async () => {\n            const data = await apiPosts.endorse({ uid: instructorUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            assert.equal(data.isEndorsed, true);\n            const hasEndorsed = await posts.hasEndorsed(postData.pid, instructorUid);\n            assert.equal(hasEndorsed, true);\n        });\n\n        it('should unendorse a post if the endorser is instructor', async () => {\n            const data = await apiPosts.unendorse({ uid: instructorUid }, { pid: postData.pid, room_id: `topic_${postData.tid}` });\n            assert.equal(data.isEndorsed, false);\n            const hasEndorsed = await posts.hasEndorsed(postData.pid, instructorUid);\n            assert.equal(hasEndorsed, false);\n        });\n\n        it('should return multiple endorse status if requested for multiple posts', async () => {\n            const userOneUid = await user.create({ username: 'user1' });\n            const postResult = await topics.post({ uid: userOneUid, cid: cid, title: 'change owner', content: 'original post' });\n            const postData = await topics.reply({ uid: userOneUid, tid: postResult.topicData.tid, content: 'firstReply' });\n            const pid1 = postResult.postData.pid;\n            const pid2 = postData.pid;\n            const data1 = await apiPosts.endorse({ uid: instructorUid }, { pid: pid1, room_id: `topic_${postData.tid}` });\n            const data2 = await apiPosts.unendorse({ uid: instructorUid }, { pid: pid2, room_id: `topic_${postData.tid}` });\n            assert.equal(data1.isEndorsed, true);\n            assert.equal(data2.isEndorsed, false);\n            const hasEndorsed = await posts.hasEndorsed([pid1, pid2], instructorUid);\n            assert.equal(hasEndorsed[0], true);\n            assert.equal(hasEndorsed[1], false);\n        });\n    });\n\n    describe('post tools', () => {\n        it('should error if data is invalid', (done) => {\n            socketPosts.loadPostTools({ uid: globalModUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should load post tools', (done) => {\n            socketPosts.loadPostTools({ uid: globalModUid }, { pid: postData.pid, cid: cid }, (err, data) => {\n                assert.ifError(err);\n                assert(data.posts.display_edit_tools);\n                assert(data.posts.display_delete_tools);\n                assert(data.posts.display_moderator_tools);\n                assert(data.posts.display_move_tools);\n                done();\n            });\n        });\n    });\n\n    describe('delete/restore/purge', () => {\n        async function createTopicWithReply() {\n            const topicPostData = await topics.post({\n                uid: voterUid,\n                cid: cid,\n                title: 'topic to delete/restore/purge',\n                content: 'A post to delete/restore/purge',\n            });\n\n            const replyData = await topics.reply({\n                uid: voterUid,\n                tid: topicPostData.topicData.tid,\n                timestamp: Date.now(),\n                content: 'A post to delete/restore and purge',\n            });\n            return [topicPostData, replyData];\n        }\n\n        let tid;\n        let mainPid;\n        let replyPid;\n\n        before(async () => {\n            const [topicPostData, replyData] = await createTopicWithReply();\n            tid = topicPostData.topicData.tid;\n            mainPid = topicPostData.postData.pid;\n            replyPid = replyData.pid;\n            await privileges.categories.give(['groups:purge'], cid, 'registered-users');\n        });\n\n        it('should error with invalid data', async () => {\n            try {\n                await apiPosts.delete({ uid: voterUid }, null);\n            } catch (err) {\n                return assert.equal(err.message, '[[error:invalid-data]]');\n            }\n            assert(false);\n        });\n\n        it('should delete a post', async () => {\n            await apiPosts.delete({ uid: voterUid }, { pid: replyPid, tid: tid });\n            const isDeleted = await posts.getPostField(replyPid, 'deleted');\n            assert.strictEqual(isDeleted, 1);\n        });\n\n        it('should not see post content if global mod does not have posts:view_deleted privilege', (done) => {\n            async.waterfall([\n                function (next) {\n                    user.create({ username: 'global mod', password: '123456' }, next);\n                },\n                function (uid, next) {\n                    groups.join('Global Moderators', uid, next);\n                },\n                function (next) {\n                    privileges.categories.rescind(['groups:posts:view_deleted'], cid, 'Global Moderators', next);\n                },\n                function (next) {\n                    helpers.loginUser('global mod', '123456', (err, data) => {\n                        assert.ifError(err);\n                        request(`${nconf.get('url')}/api/topic/${tid}`, { jar: data.jar, json: true }, (err, res, body) => {\n                            assert.ifError(err);\n                            assert.equal(body.posts[1].content, '[[topic:post_is_deleted]]');\n                            privileges.categories.give(['groups:posts:view_deleted'], cid, 'Global Moderators', next);\n                        });\n                    });\n                },\n            ], done);\n        });\n\n        it('should restore a post', async () => {\n            await apiPosts.restore({ uid: voterUid }, { pid: replyPid, tid: tid });\n            const isDeleted = await posts.getPostField(replyPid, 'deleted');\n            assert.strictEqual(isDeleted, 0);\n        });\n\n        it('should delete topic if last main post is deleted', async () => {\n            const data = await topics.post({ uid: voterUid, cid: cid, title: 'test topic', content: 'test topic' });\n            await apiPosts.delete({ uid: globalModUid }, { pid: data.postData.pid });\n            const deleted = await topics.getTopicField(data.topicData.tid, 'deleted');\n            assert.strictEqual(deleted, 1);\n        });\n\n        it('should purge posts and purge topic', async () => {\n            const [topicPostData, replyData] = await createTopicWithReply();\n            await apiPosts.purge({ uid: voterUid }, { pid: replyData.pid });\n            await apiPosts.purge({ uid: voterUid }, { pid: topicPostData.postData.pid });\n            const pidExists = await posts.exists(replyData.pid);\n            assert.strictEqual(pidExists, false);\n            const tidExists = await topics.exists(topicPostData.topicData.tid);\n            assert.strictEqual(tidExists, false);\n        });\n    });\n\n    describe('edit', () => {\n        let pid;\n        let replyPid;\n        let tid;\n        before((done) => {\n            topics.post({\n                uid: voterUid,\n                cid: cid,\n                title: 'topic to edit',\n                content: 'A post to edit',\n                tags: ['nodebb'],\n            }, (err, data) => {\n                assert.ifError(err);\n                pid = data.postData.pid;\n                tid = data.topicData.tid;\n                topics.reply({\n                    uid: voterUid,\n                    tid: tid,\n                    timestamp: Date.now(),\n                    content: 'A reply to edit',\n                }, (err, data) => {\n                    assert.ifError(err);\n                    replyPid = data.pid;\n                    privileges.categories.give(['groups:posts:edit'], cid, 'registered-users', done);\n                });\n            });\n        });\n\n        it('should error if user is not logged in', async () => {\n            try {\n                await apiPosts.edit({ uid: 0 }, { pid: pid, content: 'gg' });\n            } catch (err) {\n                return assert.equal(err.message, '[[error:not-logged-in]]');\n            }\n            assert(false);\n        });\n\n        it('should error if data is invalid or missing', async () => {\n            try {\n                await apiPosts.edit({ uid: voterUid }, {});\n            } catch (err) {\n                return assert.equal(err.message, '[[error:invalid-data]]');\n            }\n            assert(false);\n        });\n\n        it('should error if title is too short', async () => {\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited post content', title: 'a' });\n            } catch (err) {\n                return assert.equal(err.message, `[[error:title-too-short, ${meta.config.minimumTitleLength}]]`);\n            }\n            assert(false);\n        });\n\n        it('should error if title is too long', async () => {\n            const longTitle = new Array(meta.config.maximumTitleLength + 2).join('a');\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited post content', title: longTitle });\n            } catch (err) {\n                return assert.equal(err.message, `[[error:title-too-long, ${meta.config.maximumTitleLength}]]`);\n            }\n            assert(false);\n        });\n\n        it('should error with too few tags', async () => {\n            const oldValue = meta.config.minimumTagsPerTopic;\n            meta.config.minimumTagsPerTopic = 1;\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited post content', tags: [] });\n            } catch (err) {\n                assert.equal(err.message, `[[error:not-enough-tags, ${meta.config.minimumTagsPerTopic}]]`);\n                meta.config.minimumTagsPerTopic = oldValue;\n                return;\n            }\n            assert(false);\n        });\n\n        it('should error with too many tags', async () => {\n            const tags = [];\n            for (let i = 0; i <"+" meta.config.maximumTagsPerTopic + 1; i += 1) {\n                tags.push(`tag${i}`);\n            }\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited post content', tags: tags });\n            } catch (err) {\n                return assert.equal(err.message, `[[error:too-many-tags, ${meta.config.maximumTagsPerTopic}]]`);\n            }\n            assert(false);\n        });\n\n        it('should error if content is too short', async () => {\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'e' });\n            } catch (err) {\n                return assert.equal(err.message, `[[error:content-too-short, ${meta.config.minimumPostLength}]]`);\n            }\n            assert(false);\n        });\n\n        it('should error if content is too long', async () => {\n            const longContent = new Array(meta.config.maximumPostLength + 2).join('a');\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: longContent });\n            } catch (err) {\n                return assert.equal(err.message, `[[error:content-too-long, ${meta.config.maximumPostLength}]]`);\n            }\n            assert(false);\n        });\n\n        it('should edit post', async () => {\n            const data = await apiPosts.edit({ uid: voterUid }, {\n                pid: pid,\n                content: 'edited post content',\n                title: 'edited title',\n                tags: ['edited'],\n            });\n\n            assert.strictEqual(data.content, 'edited post content');\n            assert.strictEqual(data.editor, voterUid);\n            assert.strictEqual(data.topic.title, 'edited title');\n            assert.strictEqual(data.topic.tags[0].value, 'edited');\n            const res = await db.getObject(`post:${pid}`);\n            assert(!res.hasOwnProperty('bookmarks'));\n        });\n\n        it('should disallow post editing for new users if post was made past the threshold for editing', async () => {\n            meta.config.newbiePostEditDuration = 1;\n            await sleep(1000);\n            try {\n                await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited post content again', title: 'edited title again', tags: ['edited-twice'] });\n            } catch (err) {\n                assert.equal(err.message, '[[error:post-edit-duration-expired, 1]]');\n                meta.config.newbiePostEditDuration = 3600;\n                return;\n            }\n            assert(false);\n        });\n\n        it('should edit a deleted post', async () => {\n            await apiPosts.delete({ uid: voterUid }, { pid: pid, tid: tid });\n            const data = await apiPosts.edit({ uid: voterUid }, { pid: pid, content: 'edited deleted content', title: 'edited deleted title', tags: ['deleted'] });\n            assert.equal(data.content, 'edited deleted content');\n            assert.equal(data.editor, voterUid);\n            assert.equal(data.topic.title, 'edited deleted title');\n            assert.equal(data.topic.tags[0].value, 'deleted');\n        });\n\n        it('should edit a reply post', async () => {\n            const data = await apiPosts.edit({ uid: voterUid }, { pid: replyPid, content: 'edited reply' });\n            assert.equal(data.content, 'edited reply');\n            assert.equal(data.editor, voterUid);\n            assert.equal(data.topic.isMainPost, false);\n            assert.equal(data.topic.renamed, false);\n        });\n\n        it('should return diffs', (done) => {\n            posts.diffs.get(replyPid, 0, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                assert(data[0].pid, replyPid);\n                assert(data[0].patch);\n                done();\n            });\n        });\n\n        it('should load diffs and reconstruct post', (done) => {\n            posts.diffs.load(replyPid, 0, voterUid, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.content, 'A reply to edit');\n                done();\n            });\n        });\n\n        it('should not allow guests to view diffs', async () => {\n            let err = {};\n            try {\n                await apiPosts.getDiffs({ uid: 0 }, { pid: 1 });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:no-privileges]]');\n        });\n\n        it('should allow registered-users group to view diffs', async () => {\n            const data = await apiPosts.getDiffs({ uid: 1 }, { pid: 1 });\n\n            assert.strictEqual('boolean', typeof data.editable);\n            assert.strictEqual(false, data.editable);\n\n            assert.equal(true, Array.isArray(data.timestamps));\n            assert.strictEqual(1, data.timestamps.length);\n\n            assert.equal(true, Array.isArray(data.revisions));\n            assert.strictEqual(data.timestamps.length, data.revisions.length);\n            ['timestamp', 'username'].every(prop => Object.keys(data.revisions[0]).includes(prop));\n        });\n\n        it('should not delete first diff of a post', async () => {\n            const timestamps = await posts.diffs.list(replyPid);\n            await assert.rejects(async () => {\n                await posts.diffs.delete(replyPid, timestamps[0], voterUid);\n            }, {\n                message: '[[error:invalid-data]]',\n            });\n        });\n\n        it('should delete a post diff', async () => {\n            await apiPosts.edit({ uid: voterUid }, { pid: replyPid, content: 'another edit has been made' });\n            await apiPosts.edit({ uid: voterUid }, { pid: replyPid, content: 'most recent edit' });\n            const timestamp = (await posts.diffs.list(replyPid)).pop();\n            await posts.diffs.delete(replyPid, timestamp, voterUid);\n            const differentTimestamp = (await posts.diffs.list(replyPid)).pop();\n            assert.notStrictEqual(timestamp, differentTimestamp);\n        });\n\n        it('should load (oldest) diff and reconstruct post correctly after a diff deletion', async () => {\n            const data = await posts.diffs.load(replyPid, 0, voterUid);\n            assert.strictEqual(data.content, 'A reply to edit');\n        });\n    });\n\n    describe('move', () => {\n        let replyPid;\n        let tid;\n        let moveTid;\n\n        before(async () => {\n            const topic1 = await topics.post({\n                uid: voterUid,\n                cid: cid,\n                title: 'topic 1',\n                content: 'some content',\n            });\n            tid = topic1.topicData.tid;\n            const topic2 = await topics.post({\n                uid: voterUid,\n                cid: cid,\n                title: 'topic 2',\n                content: 'some content',\n            });\n            moveTid = topic2.topicData.tid;\n\n            const reply = await topics.reply({\n                uid: voterUid,\n                tid: tid,\n                timestamp: Date.now(),\n                content: 'A reply to move',\n            });\n            replyPid = reply.pid;\n        });\n\n        it('should error if uid is not logged in', async () => {\n            try {\n                await apiPosts.move({ uid: 0 }, {});\n            } catch (err) {\n                return assert.equal(err.message, '[[error:not-logged-in]]');\n            }\n            assert(false);\n        });\n\n        it('should error if data is invalid', async () => {\n            try {\n                await apiPosts.move({ uid: globalModUid }, {});\n            } catch (err) {\n                return assert.equal(err.message, '[[error:invalid-data]]');\n            }\n            assert(false);\n        });\n\n        it('should error if user does not have move privilege', async () => {\n            try {\n                await apiPosts.move({ uid: voterUid }, { pid: replyPid, tid: moveTid });\n            } catch (err) {\n                return assert.equal(err.message, '[[error:no-privileges]]');\n            }\n            assert(false);\n        });\n\n        it('should move a post', async () => {\n            await apiPosts.move({ uid: globalModUid }, { pid: replyPid, tid: moveTid });\n            const tid = await posts.getPostField(replyPid, 'tid');\n            assert(tid, moveTid);\n        });\n\n        it('should fail to move post if not moderator of target category', async () => {\n            const cat1 = await categories.create({ name: 'Test Category', description: 'Test category created by testing script' });\n            const cat2 = await categories.create({ name: 'Test Category', description: 'Test category created by testing script' });\n            const result = await apiTopics.create({ uid: globalModUid }, { title: 'target topic', content: 'queued topic', cid: cat2.cid });\n            const modUid = await user.create({ username: 'modofcat1' });\n            const userPrivilegeList = await privileges.categories.getUserPrivilegeList();\n            await privileges.categories.give(userPrivilegeList, cat1.cid, modUid);\n            let err;\n            try {\n                await apiPosts.move({ uid: modUid }, { pid: replyPid, tid: result.tid });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:no-privileges]]');\n        });\n    });\n\n    describe('getPostSummaryByPids', () => {\n        it('should return empty array for empty pids', (done) => {\n            posts.getPostSummaryByPids([], 0, {}, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.length, 0);\n                done();\n            });\n        });\n\n        it('should get post summaries', (done) => {\n            posts.getPostSummaryByPids([postData.pid], 0, {}, (err, data) => {\n                assert.ifError(err);\n                assert(data[0].user);\n                assert(data[0].topic);\n                assert(data[0].category);\n                done();\n            });\n        });\n    });\n\n    it('should get recent poster uids', (done) => {\n        topics.reply({\n            uid: voterUid,\n            tid: topicData.tid,\n            timestamp: Date.now(),\n            content: 'some content',\n        }, (err) => {\n            assert.ifError(err);\n            posts.getRecentPosterUids(0, 1, (err, uids) => {\n                assert.ifError(err);\n                assert(Array.isArray(uids));\n                assert.equal(uids.length, 2);\n                assert.equal(uids[0], voterUid);\n                done();\n            });\n        });\n    });\n\n    describe('parse', () => {\n        it('should not crash and return falsy if post data is falsy', (done) => {\n            posts.parsePost(null, (err, postData) => {\n                assert.ifError(err);\n                assert.strictEqual(postData, null);\n                done();\n            });\n        });\n\n        it('should store post content in cache', (done) => {\n            const oldValue = global.env;\n            global.env = 'production';\n            const postData = {\n                pid: 9999,\n                content: 'some post content',\n            };\n            posts.parsePost(postData, (err) => {\n                assert.ifError(err);\n                posts.parsePost(postData, (err) => {\n                    assert.ifError(err);\n                    global.env = oldValue;\n                    done();\n                });\n            });\n        });\n\n        it('should parse signature and remove links and images', (done) => {\n            meta.config['signatures:disableLinks'] = 1;\n            meta.config['signatures:disableImages'] = 1;\n            const userData = {\n                signature: '<"+"img src=\"boop\"/><"+"a href=\"link\">test<"+"/a> derp',\n            };\n\n            posts.parseSignature(userData, 1, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.userData.signature, 'test derp');\n                meta.config['signatures:disableLinks'] = 0;\n                meta.config['signatures:disableImages'] = 0;\n                done();\n            });\n        });\n\n        it('should turn relative links in post body to absolute urls', (done) => {\n            const nconf = require('nconf');\n            const content = '<"+"a href=\"/users\">test<"+"/a> <"+"a href=\"youtube.com\">youtube<"+"/a>';\n            const parsedContent = posts.relativeToAbsolute(content, posts.urlRegex);\n            assert.equal(parsedContent, `<"+"a href=\"${nconf.get('base_url')}/users\">test<"+"/a> <"+"a href=\"//youtube.com\">youtube<"+"/a>`);\n            done();\n        });\n\n        it('should turn relative links in post body to absolute urls', (done) => {\n            const nconf = require('nconf');\n            const content = '<"+"a href=\"/users\">test<"+"/a> <"+"a href=\"youtube.com\">youtube<"+"/a> some test <"+"img src=\"/path/to/img\"/>';\n            let parsedContent = posts.relativeToAbsolute(content, posts.urlRegex);\n            parsedContent = posts.relativeToAbsolute(parsedContent, posts.imgRegex);\n            assert.equal(parsedContent, `<"+"a href=\"${nconf.get('base_url')}/users\">test<"+"/a> <"+"a href=\"//youtube.com\">youtube<"+"/a> some test <"+"img src=\"${nconf.get('base_url')}/path/to/img\"/>`);\n            done();\n        });\n    });\n\n    describe('socket methods', () => {\n        let pid;\n        before((done) => {\n            topics.reply({\n                uid: voterUid,\n                tid: topicData.tid,\n                timestamp: Date.now(),\n                content: 'raw content',\n            }, (err, postData) => {\n                assert.ifError(err);\n                pid = postData.pid;\n                privileges.categories.rescind(['groups:topics:read'], cid, 'guests', done);\n            });\n        });\n\n        it('should error with invalid data', async () => {\n            try {\n                await apiTopics.reply({ uid: 0 }, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should error with invalid tid', async () => {\n            try {\n                await apiTopics.reply({ uid: 0 }, { tid: 0, content: 'derp' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should fail to get raw post because of privilege', (done) => {\n            socketPosts.getRawPost({ uid: 0 }, pid, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail to get raw post because post is deleted', (done) => {\n            posts.setPostField(pid, 'deleted', 1, (err) => {\n                assert.ifError(err);\n                socketPosts.getRawPost({ uid: voterUid }, pid, (err) => {\n                    assert.equal(err.message, '[[error:no-post]]');\n                    done();\n                });\n            });\n        });\n\n        it('should get raw post content', (done) => {\n            posts.setPostField(pid, 'deleted', 0, (err) => {\n                assert.ifError(err);\n                socketPosts.getRawPost({ uid: voterUid }, pid, (err, postContent) => {\n                    assert.ifError(err);\n                    assert.equal(postContent, 'raw content');\n                    done();\n                });\n            });\n        });\n\n        it('should get post', async () => {\n            const postData = await apiPosts.get({ uid: voterUid }, { pid });\n            assert(postData);\n        });\n\n        it('should get post category', (done) => {\n            socketPosts.getCategory({ uid: voterUid }, pid, (err, postCid) => {\n                assert.ifError(err);\n                assert.equal(cid, postCid);\n                done();\n            });\n        });\n\n        it('should error with invalid data', (done) => {\n            socketPosts.getPidIndex({ uid: voterUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should get pid index', (done) => {\n            socketPosts.getPidIndex({ uid: voterUid }, { pid: pid, tid: topicData.tid, topicPostSort: 'oldest_to_newest' }, (err, index) => {\n                assert.ifError(err);\n                assert.equal(index, 4);\n                done();\n            });\n        });\n\n        it('should get pid index in reverse', (done) => {\n            topics.reply({\n                uid: voterUid,\n                tid: topicData.tid,\n                content: 'raw content',\n            }, (err, postData) => {\n                assert.ifError(err);\n\n                socketPosts.getPidIndex({ uid: voterUid }, { pid: postData.pid, tid: topicData.tid, topicPostSort: 'newest_to_oldest' }, (err, index) => {\n                    assert.ifError(err);\n                    assert.equal(index, 1);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('filterPidsByCid', () => {\n        it('should return pids as is if cid is falsy', (done) => {\n            posts.filterPidsByCid([1, 2, 3], null, (err, pids) => {\n                assert.ifError(err);\n                assert.deepEqual([1, 2, 3], pids);\n                done();\n            });\n        });\n\n        it('should filter pids by single cid', (done) => {\n            posts.filterPidsByCid([postData.pid, 100, 101], cid, (err, pids) => {\n                assert.ifError(err);\n                assert.deepEqual([postData.pid], pids);\n                done();\n            });\n        });\n\n        it('should filter pids by multiple cids', (done) => {\n            posts.filterPidsByCid([postData.pid, 100, 101], [cid, 2, 3], (err, pids) => {\n                assert.ifError(err);\n                assert.deepEqual([postData.pid], pids);\n                done();\n            });\n        });\n\n        it('should filter pids by multiple cids', (done) => {\n            posts.filterPidsByCid([postData.pid, 100, 101], [cid], (err, pids) => {\n                assert.ifError(err);\n                assert.deepEqual([postData.pid], pids);\n                done();\n            });\n        });\n    });\n\n    it('should error if user does not exist', (done) => {\n        user.isReadyToPost(21123123, 1, (err) => {\n            assert.equal(err.message, '[[error:no-user]]');\n            done();\n        });\n    });\n\n    describe('post queue', () => {\n        let uid;\n        let queueId;\n        let topicQueueId;\n        let jar;\n        before((done) => {\n            meta.config.postQueue = 1;\n            user.create({ username: 'newuser' }, (err, _uid) => {\n                assert.ifError(err);\n                uid = _uid;\n                done();\n            });\n        });\n\n        after((done) => {\n            meta.config.postQueue = 0;\n            meta.config.groupsExemptFromPostQueue = [];\n            done();\n        });\n\n        it('should add topic to post queue', async () => {\n            const result = await apiTopics.create({ uid: uid }, { title: 'should be queued', content: 'queued topic content', cid: cid });\n            assert.strictEqual(result.queued, true);\n            assert.equal(result.message, '[[success:post-queued]]');\n            topicQueueId = result.id;\n        });\n\n        it('should add reply to post queue', async () => {\n            const result = await apiTopics.reply({ uid: uid }, { content: 'this is a queued reply', tid: topicData.tid });\n            assert.strictEqual(result.queued, true);\n            assert.equal(result.message, '[[success:post-queued]]');\n            queueId = result.id;\n        });\n\n        it('should load queued posts', (done) => {\n            helpers.loginUser('globalmod', 'globalmodpwd', (err, data) => {\n                jar = data.jar;\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/post-queue`, { jar: jar, json: true }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(body.posts[0].type, 'topic');\n                    assert.equal(body.posts[0].data.content, 'queued topic content');\n                    assert.equal(body.posts[1].type, 'reply');\n                    assert.equal(body.posts[1].data.content, 'this is a queued reply');\n                    done();\n                });\n            });\n        });\n\n        it('should error if data is invalid', (done) => {\n            socketPosts.editQueuedContent({ uid: globalModUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should edit post in queue', (done) => {\n            socketPosts.editQueuedContent({ uid: globalModUid }, { id: queueId, content: 'newContent' }, (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/post-queue`, { jar: jar, json: true }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(body.posts[1].type, 'reply');\n                    assert.equal(body.posts[1].data.content, 'newContent');\n                    done();\n                });\n            });\n        });\n\n        it('should edit topic title in queue', (done) => {\n            socketPosts.editQueuedContent({ uid: globalModUid }, { id: topicQueueId, title: 'new topic title' }, (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/post-queue`, { jar: jar, json: true }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(body.posts[0].type, 'topic');\n                    assert.equal(body.posts[0].data.title, 'new topic title');\n                    done();\n                });\n            });\n        });\n\n        it('should edit topic category in queue', (done) => {\n            socketPosts.editQueuedContent({ uid: globalModUid }, { id: topicQueueId, cid: 2 }, (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/post-queue`, { jar: jar, json: true }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(body.posts[0].type, 'topic');\n                    assert.equal(body.posts[0].data.cid, 2);\n                    socketPosts.editQueuedContent({ uid: globalModUid }, { id: topicQueueId, cid: cid }, (err) => {\n                        assert.ifError(err);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should prevent regular users from approving posts', (done) => {\n            socketPosts.accept({ uid: uid }, { id: queueId }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should prevent regular users from approving non existing posts', (done) => {\n            socketPosts.accept({ uid: uid }, { id: 123123 }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should accept queued posts and submit', (done) => {\n            let ids;\n            async.waterfall([\n                function (next) {\n                    db.getSortedSetRange('post:queue', 0, -1, next);\n                },\n                function (_ids, next) {\n                    ids = _ids;\n                    socketPosts.accept({ uid: globalModUid }, { id: ids[0] }, next);\n                },\n                function (next) {\n                    socketPosts.accept({ uid: globalModUid }, { id: ids[1] }, next);\n                },\n            ], done);\n        });\n\n        it('should not crash if id does not exist', (done) => {\n            socketPosts.reject({ uid: globalModUid }, { id: '123123123' }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should bypass post queue if user is in exempt group', async () => {\n            const oldValue = meta.config.groupsExemptFromPostQueue;\n            meta.config.groupsExemptFromPostQueue = ['registered-users'];\n            const uid = await user.create({ username: 'mergeexemptuser' });\n            const result = await apiTopics.create({ uid: uid, emit: () => {} }, { title: 'should not be queued', content: 'topic content', cid: cid });\n            assert.strictEqual(result.title, 'should not be queued');\n            meta.config.groupsExemptFromPostQueue = oldValue;\n        });\n\n        it('should update queued post\\'s topic if target topic is merged', async () => {\n            const uid = await user.create({ username: 'mergetestsuser' });\n            const result1 = await apiTopics.create({ uid: globalModUid }, { title: 'topic A', content: 'topic A content', cid: cid });\n            const result2 = await apiTopics.create({ uid: globalModUid }, { title: 'topic B', content: 'topic B content', cid: cid });\n\n            const result = await apiTopics.reply({ uid: uid }, { content: 'the moved queued post', tid: result1.tid });\n\n            await topics.merge([\n                result1.tid, result2.tid,\n            ], globalModUid, { mainTid: result2.tid });\n\n            let postData = await posts.getQueuedPosts();\n            postData = postData.filter(p => parseInt(p.data.tid, 10) === parseInt(result2.tid, 10));\n            assert.strictEqual(postData.length, 1);\n            assert.strictEqual(postData[0].data.content, 'the moved queued post');\n            assert.strictEqual(postData[0].data.tid, result2.tid);\n        });\n    });\n\n    describe('Topic Backlinks', () => {\n        let tid1;\n        before(async () => {\n            tid1 = await topics.post({\n                uid: 1,\n                cid,\n                title: 'Topic backlink testing - topic 1',\n                content: 'Some text here for the OP',\n            });\n            tid1 = tid1.topicData.tid;\n        });\n\n        describe('.syncBacklinks()', () => {\n            it('should error on invalid data', async () => {\n                try {\n                    await topics.syncBacklinks();\n                } catch (e) {\n                    assert(e);\n                    assert.strictEqual(e.message, '[[error:invalid-data]]');\n                }\n            });\n\n            it('should do nothing if the post does not contain a link to a topic', async () => {\n                const backlinks = await topics.syncBacklinks({\n                    content: 'This is a post\\'s content',\n                });\n\n                assert.strictEqual(backlinks, 0);\n            });\n\n            it('should create a backlink if it detects a topic link in a post', async () => {\n                const count = await topics.syncBacklinks({\n                    pid: 2,\n                    content: `This is a link to [topic 1](${nconf.get('url')}/topic/1/abcdef)`,\n                });\n                const events = await topics.events.get(1, 1);\n                const backlinks = await db.getSortedSetMembers('pid:2:backlinks');\n\n                assert.strictEqual(count, 1);\n                assert(events);\n                assert.strictEqual(events.length, 1);\n                assert(backlinks);\n                assert(backlinks.includes('1'));\n            });\n\n            it('should remove the backlink (but keep the event) if the post no longer contains a link to a topic', async () => {\n                const count = await topics.syncBacklinks({\n                    pid: 2,\n                    content: 'This is a link to [nothing](http://example.org)',\n                });\n                const events = await topics.events.get(1, 1);\n                const backlinks = await db.getSortedSetMembers('pid:2:backlinks');\n\n                assert.strictEqual(count, 0);\n                assert(events);\n                assert.strictEqual(events.length, 1);\n                assert(backlinks);\n                assert.strictEqual(backlinks.length, 0);\n            });\n        });\n\n        describe('integration tests', () => {\n            it('should create a topic event in the referenced topic', async () => {\n                const topic = await topics.post({\n                    uid: 1,\n                    cid,\n                    title: 'Topic backlink testing - topic 2',\n                    content: `Some text here for the OP &ndash; ${nconf.get('url')}/topic/${tid1}`,\n                });\n\n                const events = await topics.events.get(tid1, 1);\n                assert(events);\n                assert.strictEqual(events.length, 1);\n                assert.strictEqual(events[0].type, 'backlink');\n                assert.strictEqual(parseInt(events[0].uid, 10), 1);\n                assert.strictEqual(events[0].href, `/post/${topic.postData.pid}`);\n            });\n\n            it('should not create a topic event if referenced topic is the same as current topic', async () => {\n                await topics.reply({\n                    uid: 1,\n                    tid: tid1,\n                    content: `Referencing itself &ndash; ${nconf.get('url')}/topic/${tid1}`,\n                });\n\n                const events = await topics.events.get(tid1, 1);\n                assert(events);\n                assert.strictEqual(events.length, 1); // should still equal 1\n            });\n\n            it('should not show backlink events if the feature is disabled', async () => {\n                meta.config.topicBacklinks = 0;\n\n                await topics.post({\n                    uid: 1,\n                    cid,\n                    title: 'Topic backlink testing - topic 3',\n                    content: `Some text here for the OP &ndash; ${nconf.get('url')}/topic/${tid1}`,\n                });\n\n                const events = await topics.events.get(tid1, 1);\n                assert(events);\n                assert.strictEqual(events.length, 0);\n            });\n        });\n    });\n});\n\ndescribe('Posts\\'', async () => {\n    let files;\n\n    before(async () => {\n        files = await file.walk(path.resolve(__dirname, './posts'));\n    });\n\n    it('subfolder tests', () => {\n        files.forEach((filePath) => {\n            require(filePath);\n        });\n    });\n});\n"},"test/pubsub.js":{"tests":[{"id":"1817","name":"pubsub should use the plain event emitter"},{"id":"1818","name":"pubsub should use same event emitter"},{"id":"1819","name":"pubsub should use singleHostCluster"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst pubsub = require('../src/pubsub');\n\ndescribe('pubsub', () => {\n    it('should use the plain event emitter', (done) => {\n        nconf.set('isCluster', false);\n        pubsub.reset();\n        pubsub.on('testEvent', (message) => {\n            assert.equal(message.foo, 1);\n            pubsub.removeAllListeners('testEvent');\n            done();\n        });\n        pubsub.publish('testEvent', { foo: 1 });\n    });\n\n    it('should use same event emitter', (done) => {\n        pubsub.on('dummyEvent', (message) => {\n            assert.equal(message.foo, 2);\n            pubsub.removeAllListeners('dummyEvent');\n            pubsub.reset();\n            done();\n        });\n        pubsub.publish('dummyEvent', { foo: 2 });\n    });\n\n    it('should use singleHostCluster', (done) => {\n        const oldValue = nconf.get('singleHostCluster');\n        nconf.set('singleHostCluster', true);\n        pubsub.on('testEvent', (message) => {\n            assert.equal(message.foo, 3);\n            nconf.set('singleHostCluster', oldValue);\n            pubsub.removeAllListeners('testEvent');\n            done();\n        });\n        pubsub.publish('testEvent', { foo: 3 });\n    });\n\n    it('should use same event emitter', (done) => {\n        const oldValue = nconf.get('singleHostCluster');\n        pubsub.on('dummyEvent', (message) => {\n            assert.equal(message.foo, 4);\n            nconf.set('singleHostCluster', oldValue);\n            pubsub.removeAllListeners('dummyEvent');\n            pubsub.reset();\n            done();\n        });\n        pubsub.publish('dummyEvent', { foo: 4 });\n    });\n});\n"},"test/rewards.js":{"tests":[{"id":"1820","name":"rewards rewards create it should save a reward"},{"id":"1821","name":"rewards rewards create should check condition"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\n\nconst db = require('./mocks/databasemock');\nconst meta = require('../src/meta');\nconst User = require('../src/user');\nconst Groups = require('../src/groups');\n\ndescribe('rewards', () => {\n    let adminUid;\n    let bazUid;\n    let herpUid;\n\n    before((done) => {\n        // Create 3 users: 1 admin, 2 regular\n        async.series([\n            async.apply(User.create, { username: 'foo' }),\n            async.apply(User.create, { username: 'baz' }),\n            async.apply(User.create, { username: 'herp' }),\n        ], (err, uids) => {\n            if (err) {\n                return done(err);\n            }\n\n            adminUid = uids[0];\n            bazUid = uids[1];\n            herpUid = uids[2];\n\n            async.series([\n                function (next) {\n                    Groups.join('administrators', adminUid, next);\n                },\n                function (next) {\n                    Groups.join('rewardGroup', adminUid, next);\n                },\n            ], done);\n        });\n    });\n\n    describe('rewards create', () => {\n        const socketAdmin = require('../src/socket.io/admin');\n        const rewards = require('../src/rewards');\n        it('it should save a reward', (done) => {\n            const data = [\n                {\n                    rewards: { groupname: 'Gamers' },\n                    condition: 'essentials/user.postcount',\n                    conditional: 'greaterthan',\n                    value: '10',\n                    rid: 'essentials/add-to-group',\n                    claimable: '1',\n                    id: '',\n                    disabled: false,\n                },\n            ];\n\n            socketAdmin.rewards.save({ uid: adminUid }, data, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should check condition', (done) => {\n            function method(next) {\n                next(null, 1);\n            }\n            rewards.checkConditionAndRewardUser({\n                uid: adminUid,\n                condition: 'essentials/user.postcount',\n                method: method,\n            }, (err, data) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n    });\n});\n"},"test/search-admin.js":{"tests":[{"id":"1822","name":"admin search filterDirectories should resolve all paths to relative paths"},{"id":"1823","name":"admin search filterDirectories should exclude .js files"},{"id":"1824","name":"admin search filterDirectories should exclude partials"},{"id":"1825","name":"admin search filterDirectories should exclude files in the admin directory"},{"id":"1826","name":"admin search sanitize should strip out scripts"},{"id":"1827","name":"admin search sanitize should remove all tags"},{"id":"1828","name":"admin search simplify should remove all mustaches"},{"id":"1829","name":"admin search simplify should collapse all whitespace"}],"source":"'use strict';\n\n\nconst assert = require('assert');\nconst search = require('../src/admin/search');\n\ndescribe('admin search', () => {\n    describe('filterDirectories', () => {\n        it('should resolve all paths to relative paths', (done) => {\n            assert.deepEqual(search.filterDirectories([\n                'hfjksfd/fdsgagag/admin/gdhgfsdg/sggag.tpl',\n            ]), [\n                'admin/gdhgfsdg/sggag',\n            ]);\n            done();\n        });\n        it('should exclude .js files', (done) => {\n            assert.deepEqual(search.filterDirectories([\n                'hfjksfd/fdsgagag/admin/gdhgfsdg/sggag.tpl',\n                'dfahdfsgf/admin/hgkfds/fdhsdfh.js',\n            ]), [\n                'admin/gdhgfsdg/sggag',\n            ]);\n            done();\n        });\n        it('should exclude partials', (done) => {\n            assert.deepEqual(search.filterDirectories([\n                'hfjksfd/fdsgagag/admin/gdhgfsdg/sggag.tpl',\n                'dfahdfsgf/admin/partials/hgkfds/fdhsdfh.tpl',\n            ]), [\n                'admin/gdhgfsdg/sggag',\n            ]);\n            done();\n        });\n        it('should exclude files in the admin directory', (done) => {\n            assert.deepEqual(search.filterDirectories([\n                'hfjksfd/fdsgagag/admin/gdhgfsdg/sggag.tpl',\n                'dfdasg/admin/hjkdfsk.tpl',\n            ]), [\n                'admin/gdhgfsdg/sggag',\n            ]);\n            done();\n        });\n    });\n\n    describe('sanitize', () => {\n        it('should strip out scripts', (done) => {\n            assert.equal(\n                search.sanitize('Pellentesque tristique senectus' +\n                    '<"+"script>alert(\"nope\");<"+"/script> habitant morbi'),\n                'Pellentesque tristique senectus' +\n                    ' habitant morbi'\n            );\n            done();\n        });\n        it('should remove all tags', (done) => {\n            assert.equal(\n                search.sanitize('<"+"p>Pellentesque <"+"b>habitant morbi<"+"/b> tristique senectus' +\n                    'Aenean <"+"i>vitae<"+"/i> est.Mauris <"+"a href=\"placerat\">eleifend<"+"/a> leo.<"+"/p>'),\n                'Pellentesque habitant morbi tristique senectus' +\n                    'Aenean vitae est.Mauris eleifend leo.'\n            );\n            done();\n        });\n    });\n\n    describe('simplify', () => {\n        it('should remove all mustaches', (done) => {\n            assert.equal(\n                search.simplify('Pellentesque tristique {{senectus}}habitant morbi' +\n                    'liquam tincidunt {mauris.eu}risus'),\n                'Pellentesque tristique habitant morbi' +\n                    'liquam tincidunt risus'\n            );\n            done();\n        });\n        it('should collapse all whitespace', (done) => {\n            assert.equal(\n                search.simplify('Pellentesque tristique   habitant morbi' +\n                    '  \\n\\n    liquam tincidunt mauris eu risus.'),\n                'Pellentesque tristique habitant morbi' +\n                    '\\nliquam tincidunt mauris eu risus.'\n            );\n            done();\n        });\n    });\n});\n"},"test/settings.js":{"tests":[{"id":"1830","name":"settings v3 should create a new settings object"},{"id":"1831","name":"settings v3 should get the saved settings "},{"id":"1832","name":"settings v3 should create a new settings instance for same key"},{"id":"1833","name":"settings v3 should pass change between settings object over pubsub"},{"id":"1834","name":"settings v3 should set a nested value"},{"id":"1835","name":"settings v3 should reset the settings to default"},{"id":"1836","name":"settings v3 should get value from default value"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst nconf = require('nconf');\n\nconst db = require('./mocks/databasemock');\nconst settings = require('../src/settings');\n\ndescribe('settings v3', () => {\n    let settings1;\n    let settings2;\n\n    it('should create a new settings object', (done) => {\n        settings1 = new settings('my-plugin', '1.0', { foo: 1, bar: { derp: 2 } }, done);\n    });\n\n    it('should get the saved settings ', (done) => {\n        assert.equal(settings1.get('foo'), 1);\n        assert.equal(settings1.get('bar.derp'), 2);\n        done();\n    });\n\n    it('should create a new settings instance for same key', (done) => {\n        settings2 = new settings('my-plugin', '1.0', { foo: 1, bar: { derp: 2 } }, done);\n    });\n\n    it('should pass change between settings object over pubsub', (done) => {\n        settings1.set('foo', 3);\n        settings1.persist((err) => {\n            assert.ifError(err);\n            // give pubsub time to complete\n            setTimeout(() => {\n                assert.equal(settings2.get('foo'), 3);\n                done();\n            }, 500);\n        });\n    });\n\n    it('should set a nested value', (done) => {\n        settings1.set('bar.derp', 5);\n        assert.equal(settings1.get('bar.derp'), 5);\n        done();\n    });\n\n    it('should reset the settings to default', (done) => {\n        settings1.reset((err) => {\n            assert.ifError(err);\n            assert.equal(settings1.get('foo'), 1);\n            assert.equal(settings1.get('bar.derp'), 2);\n            done();\n        });\n    });\n\n    it('should get value from default value', (done) => {\n        const newSettings = new settings('some-plugin', '1.0', { default: { value: 1 } });\n        assert.equal(newSettings.get('default.value'), 1);\n        done();\n    });\n});\n"},"test/socket.io.js":{"tests":[{"id":"1837","name":"socket.io should connect and auth properly"},{"id":"1838","name":"socket.io should return error for unknown event"},{"id":"1839","name":"socket.io should get installed themes"},{"id":"1840","name":"socket.io should ban a user"},{"id":"1841","name":"socket.io should return ban reason"},{"id":"1842","name":"socket.io should unban a user"},{"id":"1843","name":"socket.io should make user admin"},{"id":"1844","name":"socket.io should make user non-admin"},{"id":"1845","name":"socket.io should load user groups"},{"id":"1846","name":"socket.io should reset lockouts"},{"id":"1847","name":"socket.io should push unread notifications on reconnect"},{"id":"1848","name":"socket.io should error if the room is missing"},{"id":"1849","name":"socket.io should return if uid is 0"},{"id":"1850","name":"socket.io should join a room"},{"id":"1851","name":"socket.io should leave current room"},{"id":"1852","name":"socket.io should get server time"},{"id":"1853","name":"socket.io should error to get daily analytics with invalid data"},{"id":"1854","name":"socket.io should get daily analytics"},{"id":"1855","name":"socket.io should get hourly analytics"},{"id":"1856","name":"socket.io should allow a custom date range for traffic graph analytics"},{"id":"1857","name":"socket.io should return error"},{"id":"1858","name":"socket.io should get room stats"},{"id":"1859","name":"socket.io should get admin search dictionary"},{"id":"1860","name":"socket.io should fire event"},{"id":"1861","name":"socket.io should error with invalid data"},{"id":"1862","name":"socket.io should set theme to bootswatch"},{"id":"1863","name":"socket.io should set theme to local persona"},{"id":"1864","name":"socket.io should toggle plugin active"},{"id":"1865","name":"socket.io should toggle plugin install"},{"id":"1866","name":"socket.io should get list of active plugins"},{"id":"1867","name":"socket.io should order active plugins"},{"id":"1868","name":"socket.io should upgrade plugin"},{"id":"1869","name":"socket.io should clear sitemap cache"},{"id":"1870","name":"socket.io should send test email"},{"id":"1871","name":"socket.io should not error when resending digests"},{"id":"1872","name":"socket.io should error with invalid interval"},{"id":"1873","name":"socket.io should get logs"},{"id":"1874","name":"socket.io should clear logs"},{"id":"1875","name":"socket.io should clear errors"},{"id":"1876","name":"socket.io should delete a single event"},{"id":"1877","name":"socket.io should delete all events"},{"id":"1878","name":"socket.io should clear caches"},{"id":"1879","name":"socket.io should toggle caches"},{"id":"1880","name":"socket.io user create/delete should create a user"},{"id":"1881","name":"socket.io user create/delete should delete users"},{"id":"1882","name":"socket.io user create/delete should error if user does not exist"},{"id":"1883","name":"socket.io user create/delete should delete users and their content"},{"id":"1884","name":"socket.io user create/delete should error with invalid data"},{"id":"1885","name":"socket.io validation emails should validate emails"},{"id":"1886","name":"socket.io validation emails should error with invalid uids"},{"id":"1887","name":"socket.io validation emails should send validation email"},{"id":"1888","name":"socket.io logger should enable logging"},{"id":"1889","name":"socket.io password reset should error if uids is not array"},{"id":"1890","name":"socket.io password reset should error if uid doesnt have email"},{"id":"1891","name":"socket.io password reset should send password reset email"},{"id":"1892","name":"socket.io password reset should for password reset"},{"id":"1893","name":"socket.io password reset should not error on valid email"},{"id":"1894","name":"socket.io password reset should not generate code if rate limited"},{"id":"1895","name":"socket.io password reset should not error on invalid email (but not generate reset code)"},{"id":"1896","name":"socket.io password reset should error on no email"}],"source":"'use strict';\n\n// see https://gist.github.com/jfromaniello/4087861#gistcomment-1447029\n\n\nprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\n\nconst util = require('util');\n\nconst sleep = util.promisify(setTimeout);\nconst assert = require('assert');\nconst async = require('async');\nconst nconf = require('nconf');\nconst request = require('request');\n\nconst cookies = request.jar();\n\nconst db = require('./mocks/databasemock');\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst categories = require('../src/categories');\nconst helpers = require('./helpers');\nconst meta = require('../src/meta');\nconst events = require('../src/events');\n\nconst socketAdmin = require('../src/socket.io/admin');\n\ndescribe('socket.io', () => {\n    let io;\n    let cid;\n    let tid;\n    let adminUid;\n    let regularUid;\n\n    before(async () => {\n        const data = await Promise.all([\n            user.create({ username: 'admin', password: 'adminpwd' }),\n            user.create({ username: 'regular', password: 'regularpwd' }),\n            categories.create({\n                name: 'Test Category',\n                description: 'Test category created by testing script',\n            }),\n        ]);\n        adminUid = data[0];\n        await groups.join('administrators', data[0]);\n\n        regularUid = data[1];\n        await user.setUserField(regularUid, 'email', 'regular@test.com');\n        await user.email.confirmByUid(regularUid);\n\n        cid = data[2].cid;\n    });\n\n\n    it('should connect and auth properly', (done) => {\n        request.get({\n            url: `${nconf.get('url')}/api/config`,\n            jar: cookies,\n            json: true,\n        }, (err, res, body) => {\n            assert.ifError(err);\n\n            request.post(`${nconf.get('url')}/login`, {\n                jar: cookies,\n                form: {\n                    username: 'admin',\n                    password: 'adminpwd',\n                },\n                headers: {\n                    'x-csrf-token': body.csrf_token,\n                },\n                json: true,\n            }, (err, res) => {\n                assert.ifError(err);\n\n                helpers.connectSocketIO(res, (err, _io) => {\n                    io = _io;\n                    assert.ifError(err);\n\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should return error for unknown event', (done) => {\n        io.emit('unknown.event', (err) => {\n            assert(err);\n            assert.equal(err.message, '[[error:invalid-event, unknown.event]]');\n            done();\n        });\n    });\n\n    it('should return error for unknown event', (done) => {\n        io.emit('user.gdpr.__proto__.constructor.toString', (err) => {\n            assert(err);\n            assert.equal(err.message, '[[error:invalid-event, user.gdpr.__proto__.constructor.toString]]');\n            done();\n        });\n    });\n\n    it('should return error for unknown event', (done) => {\n        io.emit('constructor.toString', (err) => {\n            assert(err);\n            assert.equal(err.message, '[[error:invalid-event, constructor.toString]]');\n            done();\n        });\n    });\n\n    it('should get installed themes', (done) => {\n        const themes = ['nodebb-theme-persona'];\n        io.emit('admin.themes.getInstalled', (err, data) => {\n            assert.ifError(err);\n            assert(data);\n            const installed = data.map(theme => theme.id);\n            themes.forEach((theme) => {\n                assert.notEqual(installed.indexOf(theme), -1);\n            });\n            done();\n        });\n    });\n\n    it('should ban a user', async () => {\n        const apiUser = require('../src/api/users');\n        await apiUser.ban({ uid: adminUid }, { uid: regularUid, reason: 'spammer' });\n        const data = await user.getLatestBanInfo(regularUid);\n        assert(data.uid);\n        assert(data.timestamp);\n        assert(data.hasOwnProperty('banned_until'));\n        assert(data.hasOwnProperty('banned_until_readable'));\n        assert.equal(data.reason, 'spammer');\n    });\n\n    it('should return ban reason', (done) => {\n        user.bans.getReason(regularUid, (err, reason) => {\n            assert.ifError(err);\n            assert.equal(reason, 'spammer');\n            done();\n        });\n    });\n\n    it('should unban a user', async () => {\n        const apiUser = require('../src/api/users');\n        await apiUser.unban({ uid: adminUid }, { uid: regularUid });\n        const isBanned = await user.bans.isBanned(regularUid);\n        assert(!isBanned);\n    });\n\n    it('should make user admin', (done) => {\n        socketAdmin.user.makeAdmins({ uid: adminUid }, [regularUid], (err) => {\n            assert.ifError(err);\n            groups.isMember(regularUid, 'administrators', (err, isMember) => {\n                assert.ifError(err);\n                assert(isMember);\n                done();\n            });\n        });\n    });\n\n    it('should make user non-admin', (done) => {\n        socketAdmin.user.removeAdmins({ uid: adminUid }, [regularUid], (err) => {\n            assert.ifError(err);\n            groups.isMember(regularUid, 'administrators', (err, isMember) => {\n                assert.ifError(err);\n                assert(!isMember);\n                done();\n            });\n        });\n    });\n\n    describe('user create/delete', () => {\n        let uid;\n        const apiUsers = require('../src/api/users');\n        it('should create a user', async () => {\n            const userData = await apiUsers.create({ uid: adminUid }, { username: 'foo1' });\n            uid = userData.uid;\n            const isMember = await groups.isMember(userData.uid, 'registered-users');\n            assert(isMember);\n        });\n\n        it('should delete users', async () => {\n            await apiUsers.delete({ uid: adminUid }, { uid });\n            await sleep(500);\n            const isMember = await groups.isMember(uid, 'registered-users');\n            assert(!isMember);\n        });\n\n        it('should error if user does not exist', async () => {\n            let err;\n            try {\n                await apiUsers.deleteMany({ uid: adminUid }, { uids: [uid] });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:no-user]]');\n        });\n\n        it('should delete users and their content', async () => {\n            const userData = await apiUsers.create({ uid: adminUid }, { username: 'foo2' });\n            await apiUsers.deleteMany({ uid: adminUid }, { uids: [userData.uid] });\n            await sleep(500);\n            const isMember = await groups.isMember(userData.uid, 'registered-users');\n            assert(!isMember);\n        });\n\n        it('should error with invalid data', async () => {\n            let err;\n            try {\n                await apiUsers.create({ uid: adminUid }, null);\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:invalid-data]]');\n        });\n    });\n\n    it('should load user groups', async () => {\n        const { users } = await socketAdmin.user.loadGroups({ uid: adminUid }, [adminUid]);\n        assert.strictEqual(users[0].username, 'admin');\n        assert(Array.isArray(users[0].groups));\n    });\n\n    it('should reset lockouts', (done) => {\n        socketAdmin.user.resetLockouts({ uid: adminUid }, [regularUid], (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    describe('validation emails', () => {\n        const plugins = require('../src/plugins');\n\n        async function dummyEmailerHook(data) {\n            // pretend to handle sending emails\n        }\n        before(() => {\n            // Attach an emailer hook so related requests do not error\n            plugins.hooks.register('emailer-test', {\n                hook: 'filter:email.send',\n                method: dummyEmailerHook,\n            });\n        });\n        after(() => {\n            plugins.hooks.unregister('emailer-test', 'filter:email.send');\n        });\n\n        it('should validate emails', (done) => {\n            socketAdmin.user.validateEmail({ uid: adminUid }, [regularUid], (err) => {\n                assert.ifError(err);\n                user.getUserField(regularUid, 'email:confirmed', (err, emailConfirmed) => {\n                    assert.ifError(err);\n                    assert.equal(parseInt(emailConfirmed, 10), 1);\n                    done();\n                });\n            });\n        });\n\n        it('should error with invalid uids', (done) => {\n            socketAdmin.user.sendValidationEmail({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should send validation email', (done) => {\n            socketAdmin.user.sendValidationEmail({ uid: adminUid }, [regularUid], (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n    });\n\n    it('should push unread notifications on reconnect', (done) => {\n        const socketMeta = require('../src/socket.io/meta');\n        socketMeta.reconnected({ uid: 1 }, {}, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n\n    it('should error if the room is missing', (done) => {\n        io.emit('meta.rooms.enter', null, (err) => {\n            assert.equal(err.message, '[[error:invalid-data]]');\n            done();\n        });\n    });\n\n    it('should return if uid is 0', (done) => {\n        const socketMeta = require('../src/socket.io/meta');\n        socketMeta.rooms.enter({ uid: 0 }, null, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should join a room', (done) => {\n        io.emit('meta.rooms.enter', { enter: 'recent_topics' }, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should leave current room', (done) => {\n        io.emit('meta.rooms.leaveCurrent', {}, (err) => {\n            assert.ifError(err);\n            done();\n        });\n    });\n\n    it('should get server time', (done) => {\n        io.emit('admin.getServerTime', null, (err, time) => {\n            assert.ifError(err);\n            assert(time);\n            done();\n        });\n    });\n\n    it('should error to get daily analytics with invalid data', (done) => {\n        io.emit('admin.analytics.get', null, (err) => {\n            assert.equal(err.message, '[[error:invalid-data]]');\n            done();\n        });\n    });\n\n    it('should get daily analytics', (done) => {\n        io.emit('admin.analytics.get', { graph: 'traffic', units: 'days' }, (err, data) => {\n            assert.ifError(err);\n            assert(data);\n            assert(data.summary);\n            done();\n        });\n    });\n\n    it('should get hourly analytics', (done) => {\n        io.emit('admin.analytics.get', { graph: 'traffic', units: 'hours' }, (err, data) => {\n            assert.ifError(err);\n            assert(data);\n            assert(data.summary);\n            done();\n        });\n    });\n\n    it('should allow a custom date range for traffic graph analytics', (done) => {\n        io.emit('admin.analytics.get', { graph: 'traffic', units: 'days', amount: '7' }, (err, data) => {\n            assert.ifError(err);\n            assert(data);\n            assert(data.pageviews);\n            assert(data.uniqueVisitors);\n            assert.strictEqual(7, data.pageviews.length);\n            assert.strictEqual(7, data.uniqueVisitors.length);\n            done();\n        });\n    });\n\n    it('should return error', (done) => {\n        socketAdmin.before({ uid: 10 }, 'someMethod', {}, (err) => {\n            assert.equal(err.message, '[[error:no-privileges]]');\n            done();\n        });\n    });\n\n    it('should get room stats', (done) => {\n        io.emit('meta.rooms.enter', { enter: 'topic_1' }, (err) => {\n            assert.ifError(err);\n            socketAdmin.rooms.getAll({ uid: 10 }, {}, (err) => {\n                assert.ifError(err);\n                setTimeout(() => {\n                    socketAdmin.rooms.getAll({ uid: 10 }, {}, (err, data) => {\n                        assert.ifError(err);\n                        assert(data.hasOwnProperty('onlineGuestCount'));\n                        assert(data.hasOwnProperty('onlineRegisteredCount'));\n                        assert(data.hasOwnProperty('socketCount'));\n                        assert(data.hasOwnProperty('topics'));\n                        assert(data.hasOwnProperty('users'));\n                        done();\n                    });\n                }, 1000);\n            });\n        });\n    });\n\n    it('should get room stats', (done) => {\n        io.emit('meta.rooms.enter', { enter: 'category_1' }, (err) => {\n            assert.ifError(err);\n            socketAdmin.rooms.getAll({ uid: 10 }, {}, (err) => {\n                assert.ifError(err);\n                setTimeout(() => {\n                    socketAdmin.rooms.getAll({ uid: 10 }, {}, (err, data) => {\n                        assert.ifError(err);\n                        assert.equal(data.users.category, 1, JSON.stringify(data, null, 4));\n                        done();\n                    });\n                }, 1000);\n            });\n        });\n    });\n\n    it('should get admin search dictionary', (done) => {\n        socketAdmin.getSearchDict({ uid: adminUid }, {}, (err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            assert(data[0].namespace);\n            assert(data[0].translations);\n            assert(data[0].title);\n            done();\n        });\n    });\n\n    it('should fire event', (done) => {\n        io.on('testEvent', (data) => {\n            assert.equal(data.foo, 1);\n            done();\n        });\n        socketAdmin.fireEvent({ uid: adminUid }, { name: 'testEvent', payload: { foo: 1 } }, (err) => {\n            assert.ifError(err);\n        });\n    });\n\n    it('should error with invalid data', (done) => {\n        socketAdmin.themes.set({ uid: adminUid }, null, (err) => {\n            assert.equal(err.message, '[[error:invalid-data]]');\n            done();\n        });\n    });\n\n    it('should set theme to bootswatch', (done) => {\n        socketAdmin.themes.set({ uid: adminUid }, {\n            type: 'bootswatch',\n            src: '//maxcdn.bootstrapcdn.com/bootswatch/latest/darkly/bootstrap.min.css',\n            id: 'darkly',\n        }, (err) => {\n            assert.ifError(err);\n            meta.configs.getFields(['theme:src', 'bootswatchSkin'], (err, fields) => {\n                assert.ifError(err);\n                assert.equal(fields['theme:src'], '//maxcdn.bootstrapcdn.com/bootswatch/latest/darkly/bootstrap.min.css');\n                assert.equal(fields.bootswatchSkin, 'darkly');\n                done();\n            });\n        });\n    });\n\n    it('should set theme to local persona', (done) => {\n        socketAdmin.themes.set({ uid: adminUid }, { type: 'local', id: 'nodebb-theme-persona' }, (err) => {\n            assert.ifError(err);\n            meta.configs.get('theme:id', (err, id) => {\n                assert.ifError(err);\n                assert.equal(id, 'nodebb-theme-persona');\n                done();\n            });\n        });\n    });\n\n    it('should toggle plugin active', (done) => {\n        socketAdmin.plugins.toggleActive({ uid: adminUid }, 'nodebb-plugin-location-to-map', (err, data) => {\n            assert.ifError(err);\n            assert.deepEqual(data, { id: 'nodebb-plugin-location-to-map', active: true });\n            done();\n        });\n    });\n\n    it('should toggle plugin install', function (done) {\n        this.timeout(0);\n        const oldValue = process.env.NODE_ENV;\n        process.env.NODE_ENV = 'development';\n        socketAdmin.plugins.toggleInstall({\n            uid: adminUid,\n        }, {\n            id: 'nodebb-plugin-location-to-map',\n            version: 'latest',\n        }, (err, data) => {\n            assert.ifError(err);\n            assert.equal(data.name, 'nodebb-plugin-location-to-map');\n            process.env.NODE_ENV = oldValue;\n            done();\n        });\n    });\n\n    it('should get list of active plugins', (done) => {\n        socketAdmin.plugins.getActive({ uid: adminUid }, {}, (err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            done();\n        });\n    });\n\n    it('should order active plugins', (done) => {\n        const data = [\n            { name: 'nodebb-theme-persona', order: 0 },\n            { name: 'nodebb-plugin-dbsearch', order: 1 },\n            { name: 'nodebb-plugin-markdown', order: 2 },\n            { ignoreme: 'wrong data' },\n        ];\n        socketAdmin.plugins.orderActivePlugins({ uid: adminUid }, data, (err) => {\n            assert.ifError(err);\n            db.sortedSetRank('plugins:active', 'nodebb-plugin-dbsearch', (err, rank) => {\n                assert.ifError(err);\n                assert.equal(rank, 1);\n                done();\n            });\n        });\n    });\n\n    it('should upgrade plugin', function (done) {\n        this.timeout(0);\n        const oldValue = process.env.NODE_ENV;\n        process.env.NODE_ENV = 'development';\n        socketAdmin.plugins.upgrade({\n            uid: adminUid,\n        }, {\n            id: 'nodebb-plugin-location-to-map',\n            version: 'latest',\n        }, (err) => {\n            assert.ifError(err);\n            process.env.NODE_ENV = oldValue;\n            done();\n        });\n    });\n\n    it('should error with invalid data', (done) => {\n        socketAdmin.widgets.set({ uid: adminUid }, null, (err) => {\n            assert.equal(err.message, '[[error:invalid-data]]');\n            done();\n        });\n    });\n\n    it('should error with invalid data', (done) => {\n        const data = [\n            {\n                template: 'global',\n                location: 'sidebar',\n                widgets: [{ widget: 'html', data: { html: 'test', title: 'test', container: '' } }],\n            },\n        ];\n        socketAdmin.widgets.set({ uid: adminUid }, data, (err) => {\n            assert.ifError(err);\n            db.getObjectField('widgets:global', 'sidebar', (err, widgetData) => {\n                assert.ifError(err);\n\n                assert.equal(JSON.parse(widgetData)[0].data.html, 'test');\n                done();\n            });\n        });\n    });\n\n    it('should clear sitemap cache', async () => {\n        await socketAdmin.settings.clearSitemapCache({ uid: adminUid }, {});\n    });\n\n    it('should send test email', async () => {\n        const tpls = ['digest', 'banned', 'verify', 'welcome', 'notification', 'invitation'];\n        try {\n            for (const tpl of tpls) {\n                // eslint-disable-next-line no-await-in-loop\n                await socketAdmin.email.test({ uid: adminUid }, { template: tpl });\n            }\n        } catch (err) {\n            if (err.message !== '[[error:sendmail-not-found]]') {\n                assert.ifError(err);\n            }\n        }\n    });\n\n    it('should not error when resending digests', async () => {\n        await socketAdmin.digest.resend({ uid: adminUid }, { action: 'resend-day', uid: adminUid });\n        await socketAdmin.digest.resend({ uid: adminUid }, { action: 'resend-day' });\n    });\n\n    it('should error with invalid interval', async () => {\n        const oldValue = meta.config.dailyDigestFreq;\n        meta.config.dailyDigestFreq = 'off';\n        try {\n            await socketAdmin.digest.resend({ uid: adminUid }, { action: 'resend-' });\n        } catch (err) {\n            assert.strictEqual(err.message, '[[error:digest-not-enabled]]');\n        }\n        meta.config.dailyDigestFreq = oldValue;\n    });\n\n    it('should get logs', (done) => {\n        const fs = require('fs');\n        const path = require('path');\n        meta.logs.path = path.join(nconf.get('base_dir'), 'test/files', 'output.log');\n        fs.appendFile(meta.logs.path, 'some logs', (err) => {\n            assert.ifError(err);\n\n            socketAdmin.logs.get({ uid: adminUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert(data);\n                done();\n            });\n        });\n    });\n\n    it('should clear logs', (done) => {\n        socketAdmin.logs.clear({ uid: adminUid }, {}, (err) => {\n            assert.ifError(err);\n            socketAdmin.logs.get({ uid: adminUid }, {}, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.length, 0);\n                done();\n            });\n        });\n    });\n\n    it('should clear errors', (done) => {\n        socketAdmin.errors.clear({ uid: adminUid }, {}, (err) => {\n            assert.ifError(err);\n            db.exists('error:404', (err, exists) => {\n                assert.ifError(err);\n                assert(!exists);\n                done();\n            });\n        });\n    });\n\n    it('should delete a single event', (done) => {\n        db.getSortedSetRevRange('events:time', 0, 0, (err, eids) => {\n            assert.ifError(err);\n            events.deleteEvents(eids, (err) => {\n                assert.ifError(err);\n                db.isSortedSetMembers('events:time', eids, (err, isMembers) => {\n                    assert.ifError(err);\n                    assert(!isMembers.includes(true));\n                    done();\n                });\n            });\n        });\n    });\n\n    it('should delete all events', (done) => {\n        events.deleteAll((err) => {\n            assert.ifError(err);\n            db.sortedSetCard('events:time', (err, count) => {\n                assert.ifError(err);\n                assert.equal(count, 0);\n                done();\n            });\n        });\n    });\n\n    describe('logger', () => {\n        const logger = require('../src/logger');\n        const index = require('../src/socket.io');\n        const fs = require('fs');\n        const path = require('path');\n\n        it('should enable logging', (done) => {\n            meta.config.loggerStatus = 1;\n            meta.config.loggerIOStatus = 1;\n            const loggerPath = path.join(__dirname, '..', 'logs', 'logger.log');\n            logger.monitorConfig({ io: index.server }, { key: 'loggerPath', value: loggerPath });\n            setTimeout(() => {\n                io.emit('meta.rooms.enter', { enter: 'recent_topics' }, (err) => {\n                    assert.ifError(err);\n                    fs.readFile(loggerPath, 'utf-8', (err, content) => {\n                        assert.ifError(err);\n                        assert(content);\n                        done();\n                    });\n                });\n            }, 500);\n        });\n\n        after((done) => {\n            meta.config.loggerStatus = 0;\n            meta.config.loggerIOStatus = 0;\n            done();\n        });\n    });\n\n    describe('password reset', () => {\n        const socketUser = require('../src/socket.io/user');\n\n        it('should error if uids is not array', (done) => {\n            socketAdmin.user.sendPasswordResetEmail({ uid: adminUid }, null, (err) => {\n                assert.strictEqual(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should error if uid doesnt have email', (done) => {\n            socketAdmin.user.sendPasswordResetEmail({ uid: adminUid }, [adminUid], (err) => {\n                assert.strictEqual(err.message, '[[error:user-doesnt-have-email, admin]]');\n                done();\n            });\n        });\n\n        it('should send password reset email', async () => {\n            await user.setUserField(adminUid, 'email', 'admin_test@nodebb.org');\n            await user.email.confirmByUid(adminUid);\n            await socketAdmin.user.sendPasswordResetEmail({ uid: adminUid }, [adminUid]);\n        });\n\n        it('should error if uids is not array', (done) => {\n            socketAdmin.user.forcePasswordReset({ uid: adminUid }, null, (err) => {\n                assert.strictEqual(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should for password reset', async () => {\n            const then = Date.now();\n            const uid = await user.create({ username: 'forceme', password: '123345' });\n            await socketAdmin.user.forcePasswordReset({ uid: adminUid }, [uid]);\n            const pwExpiry = await user.getUserField(uid, 'passwordExpiry');\n            const sleep = util.promisify(setTimeout);\n            await sleep(500);\n            assert(pwExpiry > then && pwExpiry <"+" Date.now());\n        });\n\n        it('should not error on valid email', (done) => {\n            socketUser.reset.send({ uid: 0 }, 'regular@test.com', (err) => {\n                assert.ifError(err);\n\n                async.parallel({\n                    count: async.apply(db.sortedSetCount.bind(db), 'reset:issueDate', 0, Date.now()),\n                    event: async.apply(events.getEvents, '', 0, 0),\n                }, (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.count, 2);\n\n                    // Event validity\n                    assert.strictEqual(data.event.length, 1);\n                    const event = data.event[0];\n                    assert.strictEqual(event.type, 'password-reset');\n                    assert.strictEqual(event.text, '[[success:success]]');\n\n                    done();\n                });\n            });\n        });\n\n        it('should not generate code if rate limited', (done) => {\n            socketUser.reset.send({ uid: 0 }, 'regular@test.com', (err) => {\n                assert.ifError(err);\n\n                async.parallel({\n                    count: async.apply(db.sortedSetCount.bind(db), 'reset:issueDate', 0, Date.now()),\n                    event: async.apply(events.getEvents, '', 0, 0),\n                }, (err, data) => {\n                    assert.ifError(err);\n                    assert.strictEqual(data.count, 2);\n\n                    // Event validity\n                    assert.strictEqual(data.event.length, 1);\n                    const event = data.event[0];\n                    assert.strictEqual(event.type, 'password-reset');\n                    assert.strictEqual(event.text, '[[error:reset-rate-limited]]');\n\n                    done();\n                });\n            });\n        });\n\n        it('should not error on invalid email (but not generate reset code)', (done) => {\n            socketUser.reset.send({ uid: 0 }, 'irregular@test.com', (err) => {\n                assert.ifError(err);\n\n                db.sortedSetCount('reset:issueDate', 0, Date.now(), (err, count) => {\n                    assert.ifError(err);\n                    assert.strictEqual(count, 2);\n                    done();\n                });\n            });\n        });\n\n        it('should error on no email', (done) => {\n            socketUser.reset.send({ uid: 0 }, '', (err) => {\n                assert(err instanceof Error);\n                assert.strictEqual(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n    });\n\n    it('should clear caches', async () => {\n        await socketAdmin.cache.clear({ uid: adminUid }, { name: 'post' });\n        await socketAdmin.cache.clear({ uid: adminUid }, { name: 'object' });\n        await socketAdmin.cache.clear({ uid: adminUid }, { name: 'group' });\n        await socketAdmin.cache.clear({ uid: adminUid }, { name: 'local' });\n    });\n\n    it('should toggle caches', async () => {\n        const caches = {\n            post: require('../src/posts/cache'),\n            object: require('../src/database').objectCache,\n            group: require('../src/groups').cache,\n            local: require('../src/cache'),\n        };\n\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'post', enabled: !caches.post.enabled });\n        if (caches.object) {\n            await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'object', enabled: !caches.object.enabled });\n        }\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'group', enabled: !caches.group.enabled });\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'local', enabled: !caches.local.enabled });\n\n        // call again to return back to original state\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'post', enabled: !caches.post.enabled });\n        if (caches.object) {\n            await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'object', enabled: !caches.object.enabled });\n        }\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'group', enabled: !caches.group.enabled });\n        await socketAdmin.cache.toggle({ uid: adminUid }, { name: 'local', enabled: !caches.local.enabled });\n    });\n});\n"},"test/template-helpers.js":{"tests":[{"id":"1897","name":"helpers should return false if item doesn't exist"},{"id":"1898","name":"helpers should return false if route is /users and user does not have view:users privilege"},{"id":"1899","name":"helpers should return false if route is /tags and user does not have view:tags privilege"},{"id":"1900","name":"helpers should return false if route is /groups and user does not have view:groups privilege"},{"id":"1901","name":"helpers should stringify object"},{"id":"1902","name":"helpers should escape html"},{"id":"1903","name":"helpers should return empty string if category is falsy"},{"id":"1904","name":"helpers should generate category background"},{"id":"1905","name":"helpers should return empty string if category has no children"},{"id":"1906","name":"helpers should generate html for children"},{"id":"1907","name":"helpers should generate topic class"},{"id":"1908","name":"helpers should show leave button if isMember and group is not administrators"},{"id":"1909","name":"helpers should show pending button if isPending and group is not administrators"},{"id":"1910","name":"helpers should show reject invite button if isInvited"},{"id":"1911","name":"helpers should show join button if join requests are not disabled and group is not administrators"},{"id":"1912","name":"helpers should show nothing if group is administrators "},{"id":"1913","name":"helpers should spawn privilege states"},{"id":"1914","name":"helpers should render thumb as topic image"},{"id":"1915","name":"helpers should render user picture as topic image"},{"id":"1916","name":"helpers should render digest avatar"},{"id":"1917","name":"helpers shoud render user agent/browser icons"}],"source":"'use strict';\n\nconst nconf = require('nconf');\nconst assert = require('assert');\n\nconst db = require('./mocks/databasemock');\nconst helpers = require('../src/helpers');\n\ndescribe('helpers', () => {\n    it('should return false if item doesn\\'t exist', (done) => {\n        const flag = helpers.displayMenuItem({ navigation: [] }, 0);\n        assert(!flag);\n        done();\n    });\n\n    it('should return false if route is /users and user does not have view:users privilege', (done) => {\n        const flag = helpers.displayMenuItem({\n            navigation: [{ route: '/users' }],\n            user: {\n                privileges: {\n                    'view:users': false,\n                },\n            },\n        }, 0);\n        assert(!flag);\n        done();\n    });\n\n    it('should return false if route is /tags and user does not have view:tags privilege', (done) => {\n        const flag = helpers.displayMenuItem({\n            navigation: [{ route: '/tags' }],\n            user: {\n                privileges: {\n                    'view:tags': false,\n                },\n            },\n        }, 0);\n        assert(!flag);\n        done();\n    });\n\n    it('should return false if route is /groups and user does not have view:groups privilege', (done) => {\n        const flag = helpers.displayMenuItem({\n            navigation: [{ route: '/groups' }],\n            user: {\n                privileges: {\n                    'view:groups': false,\n                },\n            },\n        }, 0);\n        assert(!flag);\n        done();\n    });\n\n    it('should stringify object', (done) => {\n        const str = helpers.stringify({ a: 'herp <"+" derp > and & quote \"' });\n        assert.equal(str, '{&quot;a&quot;:&quot;herp &lt; derp &gt; and &amp; quote \\\\&quot;&quot;}');\n        done();\n    });\n\n    it('should escape html', (done) => {\n        const str = helpers.escape('gdkfhgk <"+" some > and &');\n        assert.equal(str, 'gdkfhgk &lt; some &gt; and &amp;');\n        done();\n    });\n\n    it('should return empty string if category is falsy', (done) => {\n        assert.equal(helpers.generateCategoryBackground(null), '');\n        done();\n    });\n\n    it('should generate category background', (done) => {\n        const category = {\n            bgColor: '#ff0000',\n            color: '#00ff00',\n            backgroundImage: '/assets/uploads/image.png',\n            imageClass: 'auto',\n        };\n        const bg = helpers.generateCategoryBackground(category);\n        assert.equal(bg, 'background-color: #ff0000; color: #00ff00; background-image: url(/assets/uploads/image.png); background-size: auto;');\n        done();\n    });\n\n    it('should return empty string if category has no children', (done) => {\n        const category = {\n            children: [],\n        };\n        const bg = helpers.generateChildrenCategories(category);\n        assert.equal(bg, '');\n        done();\n    });\n\n    it('should generate html for children', (done) => {\n        const category = {\n            children: [\n                {\n                    link: '',\n                    bgColor: '#ff0000',\n                    color: '#00ff00',\n                    name: 'children',\n                },\n            ],\n        };\n        const html = helpers.generateChildrenCategories(category);\n        assert.equal(html, `<"+"span class=\"category-children\"><"+"span class=\"category-children-item pull-left\"><"+"div role=\"presentation\" class=\"icon pull-left\" style=\"background-color: #ff0000; color: #00ff00;\"><"+"i class=\"fa fa-fw undefined\"><"+"/i><"+"/div><"+"a href=\"${nconf.get('relative_path')}/category/undefined\"><"+"small>children<"+"/small><"+"/a><"+"/span><"+"/span>`);\n        done();\n    });\n\n    it('should generate topic class', (done) => {\n        const className = helpers.generateTopicClass({ locked: true, pinned: true, deleted: true, unread: true });\n        assert.equal(className, 'locked pinned deleted unread');\n        done();\n    });\n\n    it('should show leave button if isMember and group is not administrators', (done) => {\n        const btn = helpers.membershipBtn({ displayName: 'some group', name: 'some group', isMember: true });\n        assert.equal(btn, '<"+"button class=\"btn btn-danger\" data-action=\"leave\" data-group=\"some group\"><"+"i class=\"fa fa-times\"><"+"/i> [[groups:membership.leave-group]]<"+"/button>');\n        done();\n    });\n\n    it('should show pending button if isPending and group is not administrators', (done) => {\n        const btn = helpers.membershipBtn({ displayName: 'some group', name: 'some group', isPending: true });\n        assert.equal(btn, '<"+"button class=\"btn btn-warning disabled\"><"+"i class=\"fa fa-clock-o\"><"+"/i> [[groups:membership.invitation-pending]]<"+"/button>');\n        done();\n    });\n\n    it('should show reject invite button if isInvited', (done) => {\n        const btn = helpers.membershipBtn({ displayName: 'some group', name: 'some group', isInvited: true });\n        assert.equal(btn, '<"+"button class=\"btn btn-link\" data-action=\"rejectInvite\" data-group=\"some group\">[[groups:membership.reject]]<"+"/button><"+"button class=\"btn btn-success\" data-action=\"acceptInvite\" data-group=\"some group\"><"+"i class=\"fa fa-plus\"><"+"/i> [[groups:membership.accept-invitation]]<"+"/button>');\n        done();\n    });\n\n    it('should show join button if join requests are not disabled and group is not administrators', (done) => {\n        const btn = helpers.membershipBtn({ displayName: 'some group', name: 'some group', disableJoinRequests: false });\n        assert.equal(btn, '<"+"button class=\"btn btn-success\" data-action=\"join\" data-group=\"some group\"><"+"i class=\"fa fa-plus\"><"+"/i> [[groups:membership.join-group]]<"+"/button>');\n        done();\n    });\n\n    it('should show nothing if group is administrators ', (done) => {\n        const btn = helpers.membershipBtn({ displayName: 'administrators', name: 'administrators' });\n        assert.equal(btn, '');\n        done();\n    });\n\n    it('should spawn privilege states', (done) => {\n        const privs = {\n            find: true,\n            read: true,\n        };\n        const html = helpers.spawnPrivilegeStates('guests', privs);\n        assert.equal(html, '<"+"td class=\"text-center\" data-privilege=\"find\" data-value=\"true\"><"+"input autocomplete=\"off\" type=\"checkbox\" checked /><"+"/td><"+"td class=\"text-center\" data-privilege=\"read\" data-value=\"true\"><"+"input autocomplete=\"off\" type=\"checkbox\" checked /><"+"/td>');\n        done();\n    });\n\n    it('should render thumb as topic image', (done) => {\n        const topicObj = { thumb: '/uploads/1.png', user: { username: 'baris' } };\n        const html = helpers.renderTopicImage(topicObj);\n        assert.equal(html, `<"+"img src=\"${topicObj.thumb}\" class=\"img-circle user-img\" title=\"${topicObj.user.username}\" />`);\n        done();\n    });\n\n    it('should render user picture as topic image', (done) => {\n        const topicObj = { thumb: '', user: { uid: 1, username: 'baris', picture: '/uploads/2.png' } };\n        const html = helpers.renderTopicImage(topicObj);\n        assert.equal(html, `<"+"img component=\"user/picture\" data-uid=\"${topicObj.user.uid}\" src=\"${topicObj.user.picture}\" class=\"user-img\" title=\"${topicObj.user.username}\" />`);\n        done();\n    });\n\n    it('should render digest avatar', (done) => {\n        const block = { teaser: { user: { username: 'baris', picture: '/uploads/1.png' } } };\n        const html = helpers.renderDigestAvatar(block);\n        assert.equal(html, `<"+"img style=\"vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;\" src=\"${block.teaser.user.picture}\" title=\"${block.teaser.user.username}\" />`);\n        done();\n    });\n\n    it('should render digest avatar', (done) => {\n        const block = { teaser: { user: { username: 'baris', 'icon:text': 'B', 'icon:bgColor': '#ff000' } } };\n        const html = helpers.renderDigestAvatar(block);\n        assert.equal(html, `<"+"div style=\"vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: ${block.teaser.user['icon:bgColor']}; color: white; text-align: center; display: inline-block; border-radius: 50%;\">${block.teaser.user['icon:text']}<"+"/div>`);\n        done();\n    });\n\n    it('should render digest avatar', (done) => {\n        const block = { user: { username: 'baris', picture: '/uploads/1.png' } };\n        const html = helpers.renderDigestAvatar(block);\n        assert.equal(html, `<"+"img style=\"vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;\" src=\"${block.user.picture}\" title=\"${block.user.username}\" />`);\n        done();\n    });\n\n    it('should render digest avatar', (done) => {\n        const block = { user: { username: 'baris', 'icon:text': 'B', 'icon:bgColor': '#ff000' } };\n        const html = helpers.renderDigestAvatar(block);\n        assert.equal(html, `<"+"div style=\"vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: ${block.user['icon:bgColor']}; color: white; text-align: center; display: inline-block; border-radius: 50%;\">${block.user['icon:text']}<"+"/div>`);\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'Linux', browser: 'Chrome' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-linux\"><"+"/i><"+"i class=\"fa fa-fw fa-chrome\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'Microsoft Windows', browser: 'Firefox' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-windows\"><"+"/i><"+"i class=\"fa fa-fw fa-firefox\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'Apple Mac', browser: 'Safari' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-apple\"><"+"/i><"+"i class=\"fa fa-fw fa-safari\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'Android', browser: 'IE' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-android\"><"+"/i><"+"i class=\"fa fa-fw fa-internet-explorer\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'iPad', browser: 'Edge' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-tablet\"><"+"/i><"+"i class=\"fa fa-fw fa-edge\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'iPhone', browser: 'unknow' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-mobile\"><"+"/i><"+"i class=\"fa fa-fw fa-question-circle\"><"+"/i>');\n        done();\n    });\n\n    it('shoud render user agent/browser icons', (done) => {\n        const html = helpers.userAgentIcons({ platform: 'unknow', browser: 'unknown' });\n        assert.equal(html, '<"+"i class=\"fa fa-fw fa-question-circle\"><"+"/i><"+"i class=\"fa fa-fw fa-question-circle\"><"+"/i>');\n        done();\n    });\n});\n"},"test/topics.js":{"tests":[{"id":"1918","name":"Topic's should check if user is moderator"},{"id":"1919","name":"Topic's .post should fail to create topic with invalid data"},{"id":"1920","name":"Topic's .post should create a new topic with proper parameters"},{"id":"1921","name":"Topic's .post should get post count"},{"id":"1922","name":"Topic's .post should load topic"},{"id":"1923","name":"Topic's .post should fail to create new topic with invalid user id"},{"id":"1924","name":"Topic's .post should fail to create new topic with empty title"},{"id":"1925","name":"Topic's .post should fail to create new topic with empty content"},{"id":"1926","name":"Topic's .post should fail to create new topic with non-existant category id"},{"id":"1927","name":"Topic's .post should return false for falsy uid"},{"id":"1928","name":"Topic's .post should fail to post a topic as guest with invalid csrf_token"},{"id":"1929","name":"Topic's .post should fail to post a topic as guest if no privileges"},{"id":"1930","name":"Topic's .post should post a topic as guest if guest group has privileges"},{"id":"1931","name":"Topic's .post should post a topic/reply as guest with handle if guest group has privileges"},{"id":"1932","name":"Topic's .reply should create a new reply with proper parameters"},{"id":"1933","name":"Topic's .reply should handle direct replies"},{"id":"1934","name":"Topic's .reply should error if pid is not a number"},{"id":"1935","name":"Topic's .reply should fail to create new reply with invalid user id"},{"id":"1936","name":"Topic's .reply should fail to create new reply with empty content"},{"id":"1937","name":"Topic's .reply should fail to create new reply with invalid topic id"},{"id":"1938","name":"Topic's .reply should fail to create new reply with invalid toPid"},{"id":"1939","name":"Topic's .reply should delete nested relies properly"},{"id":"1940","name":"Topic's Get methods should not receive errors"},{"id":"1941","name":"Topic's Get methods should get a single field"},{"id":"1942","name":"Topic's Get methods should get topic title by pid"},{"id":"1943","name":"Topic's Get methods should get topic data by pid"},{"id":"1944","name":"Topic's Get methods .getTopicWithPosts should get a topic with posts and other data"},{"id":"1945","name":"Topic's Get methods .getTopicWithPosts should return first 3 posts including main post"},{"id":"1946","name":"Topic's Get methods .getTopicWithPosts should return 3 posts from 1 to 3 excluding main post"},{"id":"1947","name":"Topic's Get methods .getTopicWithPosts should return main post and last 2 posts"},{"id":"1948","name":"Topic's Get methods .getTopicWithPosts should return last 3 posts and not main post"},{"id":"1949","name":"Topic's Get methods .getTopicWithPosts should return posts 29 to 27 posts and not main post"},{"id":"1950","name":"Topic's Get methods .getTopicWithPosts should return 3 posts in reverse"},{"id":"1951","name":"Topic's Get methods .getTopicWithPosts should get all posts with main post at the start"},{"id":"1952","name":"Topic's Get methods .getTopicWithPosts should get all posts in reverse with main post at the start followed by reply 30"},{"id":"1953","name":"Topic's Get methods .getTopicWithPosts should return empty array if first param is falsy"},{"id":"1954","name":"Topic's Get methods .getTopicWithPosts should only return main post"},{"id":"1955","name":"Topic's Get methods .getTopicWithPosts should only return first reply"},{"id":"1956","name":"Topic's Get methods .getTopicWithPosts should return main post and first reply"},{"id":"1957","name":"Topic's Get methods .getTopicWithPosts should return posts in correct order"},{"id":"1958","name":"Topic's Get methods .getTopicWithPosts should return posts in correct order in reverse direction"},{"id":"1959","name":"Topic's Get methods .getTopicWithPosts should return all posts in correct order"},{"id":"1960","name":"Topic's Title escaping should properly escape topic title"},{"id":"1961","name":"Topic's tools/delete/restore/purge should load topic tools"},{"id":"1962","name":"Topic's tools/delete/restore/purge should delete the topic"},{"id":"1963","name":"Topic's tools/delete/restore/purge should restore the topic"},{"id":"1964","name":"Topic's tools/delete/restore/purge should lock topic"},{"id":"1965","name":"Topic's tools/delete/restore/purge should unlock topic"},{"id":"1966","name":"Topic's tools/delete/restore/purge should pin topic"},{"id":"1967","name":"Topic's tools/delete/restore/purge should unpin topic"},{"id":"1968","name":"Topic's tools/delete/restore/purge should move all topics"},{"id":"1969","name":"Topic's tools/delete/restore/purge should move a topic"},{"id":"1970","name":"Topic's tools/delete/restore/purge should properly update sets when post is moved"},{"id":"1971","name":"Topic's tools/delete/restore/purge should fail to purge topic if user does not have privilege"},{"id":"1972","name":"Topic's tools/delete/restore/purge should purge the topic"},{"id":"1973","name":"Topic's tools/delete/restore/purge should not allow user to restore their topic if it was deleted by an admin"},{"id":"1974","name":"Topic's order pinned topics should error with invalid data"},{"id":"1975","name":"Topic's order pinned topics should error with unprivileged user"},{"id":"1976","name":"Topic's order pinned topics should not do anything if topics are not pinned"},{"id":"1977","name":"Topic's order pinned topics should order pinned topics"},{"id":"1978","name":"Topic's .ignore should not appear in the unread list"},{"id":"1979","name":"Topic's .ignore should not appear as unread in the recent list"},{"id":"1980","name":"Topic's .ignore should appear as unread again when marked as reading"},{"id":"1981","name":"Topic's .ignore should appear as unread again when marked as following"},{"id":"1982","name":"Topic's .fork should fail with invalid data"},{"id":"1983","name":"Topic's .fork should have 12 replies"},{"id":"1984","name":"Topic's .fork should not update the user's bookmark"},{"id":"1985","name":"Topic's .fork should update the user's bookmark "},{"id":"1986","name":"Topic's .fork should properly update topic vote count after forking"},{"id":"1987","name":"Topic's controller should load topic"},{"id":"1988","name":"Topic's controller should load topic api data"},{"id":"1989","name":"Topic's controller should 404 if post index is invalid"},{"id":"1990","name":"Topic's controller should 404 if topic does not exist"},{"id":"1991","name":"Topic's controller should 401 if not allowed to read as guest"},{"id":"1992","name":"Topic's controller should redirect to correct topic if slug is missing"},{"id":"1993","name":"Topic's controller should redirect if post index is out of range"},{"id":"1994","name":"Topic's controller should 404 if page is out of bounds"},{"id":"1995","name":"Topic's controller should mark topic read"},{"id":"1996","name":"Topic's controller should 404 if tid is not a number"},{"id":"1997","name":"Topic's controller should 403 if cant read"},{"id":"1998","name":"Topic's controller should load topic teaser"},{"id":"1999","name":"Topic's controller should 404 if tid does not exist"},{"id":"2000","name":"Topic's controller should load pagination"},{"id":"2001","name":"Topic's infinitescroll should error with invalid data"},{"id":"2002","name":"Topic's infinitescroll should infinite load topic posts"},{"id":"2003","name":"Topic's suggested topics should return suggested topics"},{"id":"2004","name":"Topic's unread should fail with invalid data"},{"id":"2005","name":"Topic's unread should fail if topic does not exist"},{"id":"2006","name":"Topic's unread should mark topic unread"},{"id":"2007","name":"Topic's unread should mark topic read"},{"id":"2008","name":"Topic's unread should mark topic notifications read"},{"id":"2009","name":"Topic's unread should mark all read"},{"id":"2010","name":"Topic's unread should mark category topics read"},{"id":"2011","name":"Topic's unread should fail if user is not admin"},{"id":"2012","name":"Topic's unread should mark topic unread for everyone"},{"id":"2013","name":"Topic's unread should not do anything if tids is empty array"},{"id":"2014","name":"Topic's unread should not return topics in category you cant read"},{"id":"2015","name":"Topic's unread should not return topics in category you ignored/not watching"},{"id":"2016","name":"Topic's unread should not return topic as unread if new post is from blocked user"},{"id":"2017","name":"Topic's unread should not return topic as unread if topic is deleted"},{"id":"2018","name":"Topic's tags should return empty array if query is falsy"},{"id":"2019","name":"Topic's tags should autocomplete tags"},{"id":"2020","name":"Topic's tags should search tags"},{"id":"2021","name":"Topic's tags should search and load tags"},{"id":"2022","name":"Topic's tags should return error if data is invalid"},{"id":"2023","name":"Topic's tags should load more tags"},{"id":"2024","name":"Topic's tags should error if data is invalid"},{"id":"2025","name":"Topic's tags should error if tag is invalid"},{"id":"2026","name":"Topic's tags should error if tag is too short"},{"id":"2027","name":"Topic's tags should create empty tag"},{"id":"2028","name":"Topic's tags should do nothing if tag exists"},{"id":"2029","name":"Topic's tags should rename tags"},{"id":"2030","name":"Topic's tags should return related topics"},{"id":"2031","name":"Topic's tags should return error with invalid data"},{"id":"2032","name":"Topic's tags should do nothing if arrays is empty"},{"id":"2033","name":"Topic's tags should delete tags"},{"id":"2034","name":"Topic's tags should delete tag"},{"id":"2035","name":"Topic's tags should delete category tag as well"},{"id":"2036","name":"Topic's tags should add and remove tags from topics properly"},{"id":"2037","name":"Topic's tags should respect minTags"},{"id":"2038","name":"Topic's tags should respect maxTags"},{"id":"2039","name":"Topic's tags should respect minTags per category"},{"id":"2040","name":"Topic's tags should respect maxTags per category"},{"id":"2041","name":"Topic's tags should create and delete category tags properly"},{"id":"2042","name":"Topic's tags should update counts correctly if topic is moved between categories"},{"id":"2043","name":"Topic's tags should not allow regular user to use system tags"},{"id":"2044","name":"Topic's tags should allow admin user to use system tags"},{"id":"2045","name":"Topic's tags should not error if regular user edits topic after admin adds system tags"},{"id":"2046","name":"Topic's follow/unfollow should error if not logged in"},{"id":"2047","name":"Topic's follow/unfollow should filter ignoring uids"},{"id":"2048","name":"Topic's follow/unfollow should error with topic that does not exist"},{"id":"2049","name":"Topic's follow/unfollow should follow topic"},{"id":"2050","name":"Topic's topics search should error with invalid data"},{"id":"2051","name":"Topic's topics search should return results"},{"id":"2052","name":"Topic's teasers should return empty array if first param is empty"},{"id":"2053","name":"Topic's teasers should get teasers with 2 params"},{"id":"2054","name":"Topic's teasers should get teasers with first posts"},{"id":"2055","name":"Topic's teasers should get teasers even if one topic is falsy"},{"id":"2056","name":"Topic's teasers should get teasers with last posts"},{"id":"2057","name":"Topic's teasers should get teasers by tids"},{"id":"2058","name":"Topic's teasers should return empty array "},{"id":"2059","name":"Topic's teasers should get teaser by tid"},{"id":"2060","name":"Topic's teasers should not return teaser if user is blocked"},{"id":"2061","name":"Topic's tag privilege should fail to post if user does not have tag privilege"},{"id":"2062","name":"Topic's tag privilege should fail to edit if user does not have tag privilege"},{"id":"2063","name":"Topic's tag privilege should be able to edit topic and add tags if allowed"},{"id":"2064","name":"Topic's topic merge should error if data is not an array"},{"id":"2065","name":"Topic's topic merge should error if user does not have privileges"},{"id":"2066","name":"Topic's topic merge should merge 2 topics"},{"id":"2067","name":"Topic's topic merge should return properly for merged topic"},{"id":"2068","name":"Topic's topic merge should merge 2 topics with options mainTid"},{"id":"2069","name":"Topic's topic merge should merge 2 topics with options newTopicTitle"},{"id":"2070","name":"Topic's sorted topics should get sorted topics in category"},{"id":"2071","name":"Topic's sorted topics should get topics recent replied first"},{"id":"2072","name":"Topic's sorted topics should get topics recent replied last"},{"id":"2073","name":"Topic's scheduled topics should create a scheduled topic as pinned, deleted, included in \"topics:scheduled\" zset and with a timestamp in future"},{"id":"2074","name":"Topic's scheduled topics should update poster's lastposttime with \"action time\""},{"id":"2075","name":"Topic's scheduled topics should not load topic for an unprivileged user"},{"id":"2076","name":"Topic's scheduled topics should load topic for a privileged user"},{"id":"2077","name":"Topic's scheduled topics should not be amongst topics of the category for an unprivileged user"},{"id":"2078","name":"Topic's scheduled topics should be amongst topics of the category for a privileged user"},{"id":"2079","name":"Topic's scheduled topics should load topic for guests if privilege is given"},{"id":"2080","name":"Topic's scheduled topics should be amongst topics of the category for guests if privilege is given"},{"id":"2081","name":"Topic's scheduled topics should not allow deletion of a scheduled topic"},{"id":"2082","name":"Topic's scheduled topics should not allow to unpin a scheduled topic"},{"id":"2083","name":"Topic's scheduled topics should not allow to restore a scheduled topic"},{"id":"2084","name":"Topic's scheduled topics should not allow unprivileged to reply"},{"id":"2085","name":"Topic's scheduled topics should allow guests to reply if privilege is given"},{"id":"2086","name":"Topic's scheduled topics should have replies with greater timestamp than the scheduled topics itself"},{"id":"2087","name":"Topic's scheduled topics should have post edits with greater timestamp than the original"},{"id":"2088","name":"Topic's scheduled topics should able to reschedule"},{"id":"2089","name":"Topic's scheduled topics should able to publish a scheduled topic"},{"id":"2090","name":"Topic's scheduled topics should update poster's lastposttime after a ST published"},{"id":"2091","name":"Topic's scheduled topics should not be able to schedule a \"published\" topic"},{"id":"2092","name":"Topic's scheduled topics should allow to purge a scheduled topic"},{"id":"2093","name":"Topic's scheduled topics should remove from topics:scheduled on purge"},{"id":"2094","name":"Topics' subfolder tests"}],"source":"'use strict';\n\nconst async = require('async');\nconst path = require('path');\nconst assert = require('assert');\nconst validator = require('validator');\nconst mockdate = require('mockdate');\nconst nconf = require('nconf');\nconst request = require('request');\nconst util = require('util');\n\nconst sleep = util.promisify(setTimeout);\n\nconst db = require('./mocks/databasemock');\nconst file = require('../src/file');\nconst topics = require('../src/topics');\nconst posts = require('../src/posts');\nconst categories = require('../src/categories');\nconst privileges = require('../src/privileges');\nconst meta = require('../src/meta');\nconst User = require('../src/user');\nconst groups = require('../src/groups');\nconst helpers = require('./helpers');\nconst socketPosts = require('../src/socket.io/posts');\nconst socketTopics = require('../src/socket.io/topics');\nconst apiTopics = require('../src/api/topics');\n\nconst requestType = util.promisify((type, url, opts, cb) => {\n    request[type](url, opts, (err, res, body) => cb(err, { res: res, body: body }));\n});\n\ndescribe('Topic\\'s', () => {\n    let topic;\n    let categoryObj;\n    let adminUid;\n    let adminJar;\n    let csrf_token;\n    let fooUid;\n\n    before(async () => {\n        adminUid = await User.create({ username: 'admin', password: '123456' });\n        fooUid = await User.create({ username: 'foo' });\n        await groups.join('administrators', adminUid);\n        const adminLogin = await helpers.loginUser('admin', '123456');\n        adminJar = adminLogin.jar;\n        csrf_token = adminLogin.csrf_token;\n\n        categoryObj = await categories.create({\n            name: 'Test Category',\n            description: 'Test category created by testing script',\n        });\n        topic = {\n            userId: adminUid,\n            categoryId: categoryObj.cid,\n            title: 'Test Topic Title',\n            content: 'The content of test topic',\n        };\n    });\n\n    describe('.post', () => {\n        it('should fail to create topic with invalid data', async () => {\n            try {\n                await apiTopics.create({ uid: 0 }, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should create a new topic with proper parameters', (done) => {\n            topics.post({\n                uid: topic.userId,\n                title: topic.title,\n                content: topic.content,\n                cid: topic.categoryId,\n            }, (err, result) => {\n                assert.ifError(err);\n                assert(result);\n                topic.tid = result.topicData.tid;\n                done();\n            });\n        });\n\n        it('should get post count', (done) => {\n            socketTopics.postcount({ uid: adminUid }, topic.tid, (err, count) => {\n                assert.ifError(err);\n                assert.equal(count, 1);\n                done();\n            });\n        });\n\n        it('should load topic', async () => {\n            const data = await apiTopics.get({ uid: adminUid }, { tid: topic.tid });\n            assert.equal(data.tid, topic.tid);\n        });\n\n        it('should fail to create new topic with invalid user id', (done) => {\n            topics.post({ uid: null, title: topic.title, content: topic.content, cid: topic.categoryId }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail to create new topic with empty title', (done) => {\n            topics.post({ uid: topic.userId, title: '', content: topic.content, cid: topic.categoryId }, (err) => {\n                assert.ok(err);\n                done();\n            });\n        });\n\n        it('should fail to create new topic with empty content', (done) => {\n            topics.post({ uid: topic.userId, title: topic.title, content: '', cid: topic.categoryId }, (err) => {\n                assert.ok(err);\n                done();\n            });\n        });\n\n        it('should fail to create new topic with non-existant category id', (done) => {\n            topics.post({ uid: topic.userId, title: topic.title, content: topic.content, cid: 99 }, (err) => {\n                assert.equal(err.message, '[[error:no-category]]', 'received no error');\n                done();\n            });\n        });\n\n        it('should return false for falsy uid', (done) => {\n            topics.isOwner(topic.tid, 0, (err, isOwner) => {\n                assert.ifError(err);\n                assert(!isOwner);\n                done();\n            });\n        });\n\n        it('should fail to post a topic as guest with invalid csrf_token', async () => {\n            const categoryObj = await categories.create({\n                name: 'Test Category',\n                description: 'Test category created by testing script',\n            });\n            await privileges.categories.give(['groups:topics:create'], categoryObj.cid, 'guests');\n            await privileges.categories.give(['groups:topics:reply'], categoryObj.cid, 'guests');\n            const result = await requestType('post', `${nconf.get('url')}/api/v3/topics`, {\n                form: {\n                    title: 'just a title',\n                    cid: categoryObj.cid,\n                    content: 'content for the main post',\n                },\n                headers: {\n                    'x-csrf-token': 'invalid',\n                },\n                json: true,\n            });\n            assert.strictEqual(result.res.statusCode, 403);\n            assert.strictEqual(result.body, 'Forbidden');\n        });\n\n        it('should fail to post a topic as guest if no privileges', async () => {\n            const categoryObj = await categories.create({\n                name: 'Test Category',\n                description: 'Test category created by testing script',\n            });\n            const jar = request.jar();\n            const result = await helpers.request('post', `/api/v3/topics`, {\n                form: {\n                    title: 'just a title',\n                    cid: categoryObj.cid,\n                    content: 'content for the main post',\n                },\n                jar: jar,\n                json: true,\n            });\n            assert.strictEqual(result.body.status.message, 'You do not have enough privileges for this action.');\n        });\n\n        it('should post a topic as guest if guest group has privileges', async () => {\n            const categoryObj = await categories.create({\n                name: 'Test Category',\n                description: 'Test category created by testing script',\n            });\n            await privileges.categories.give(['groups:topics:create'], categoryObj.cid, 'guests');\n            await privileges.categories.give(['groups:topics:reply'], categoryObj.cid, 'guests');\n\n            const jar = request.jar();\n            const result = await helpers.request('post', `/api/v3/topics`, {\n                form: {\n                    title: 'just a title',\n                    cid: categoryObj.cid,\n                    content: 'content for the main post',\n                },\n                jar: jar,\n                json: true,\n            });\n\n            assert.strictEqual(result.body.status.code, 'ok');\n            assert.strictEqual(result.body.response.title, 'just a title');\n            assert.strictEqual(result.body.response.user.username, '[[global:guest]]');\n\n            const replyResult = await helpers.request('post', `/api/v3/topics/${result.body.response.tid}`, {\n                form: {\n                    content: 'a reply by guest',\n                },\n                jar: jar,\n                json: true,\n            });\n            assert.strictEqual(replyResult.body.response.content, 'a reply by guest');\n            assert.strictEqual(replyResult.body.response.user.username, '[[global:guest]]');\n        });\n\n        it('should post a topic/reply as guest with handle if guest group has privileges', async () => {\n            const categoryObj = await categories.create({\n                name: 'Test Category',\n                description: 'Test category created by testing script',\n            });\n            await privileges.categories.give(['groups:topics:create'], categoryObj.cid, 'guests');\n            await privileges.categories.give(['groups:topics:reply'], categoryObj.cid, 'guests');\n            const oldValue = meta.config.allowGuestHandles;\n            meta.config.allowGuestHandles = 1;\n            const result = await helpers.request('post', `/api/v3/topics`, {\n                form: {\n                    title: 'just a title',\n                    cid: categoryObj.cid,\n                    content: 'content for the main post',\n                    handle: 'guest123',\n                },\n                jar: request.jar(),\n                json: true,\n            });\n\n            assert.strictEqual(result.body.status.code, 'ok');\n            assert.strictEqual(result.body.response.title, 'just a title');\n            assert.strictEqual(result.body.response.user.username, 'guest123');\n            assert.strictEqual(result.body.response.user.displayname, 'guest123');\n\n            const replyResult = await helpers.request('post', `/api/v3/topics/${result.body.response.tid}`, {\n                form: {\n                    content: 'a reply by guest',\n                    handle: 'guest124',\n                },\n                jar: request.jar(),\n                json: true,\n            });\n            assert.strictEqual(replyResult.body.response.content, 'a reply by guest');\n            assert.strictEqual(replyResult.body.response.user.username, 'guest124');\n            assert.strictEqual(replyResult.body.response.user.displayname, 'guest124');\n            meta.config.allowGuestHandles = oldValue;\n        });\n    });\n\n    describe('.reply', () => {\n        let newTopic;\n        let newPost;\n\n        before((done) => {\n            topics.post({\n                uid: topic.userId,\n                title: topic.title,\n                content: topic.content,\n                cid: topic.categoryId,\n            }, (err, result) => {\n                if (err) {\n                    return done(err);\n                }\n\n                newTopic = result.topicData;\n                newPost = result.postData;\n                done();\n            });\n        });\n\n        it('should create a new reply with proper parameters', (done) => {\n            topics.reply({ uid: topic.userId, content: 'test post', tid: newTopic.tid }, (err, result) => {\n                assert.equal(err, null, 'was created with error');\n                assert.ok(result);\n\n                done();\n            });\n        });\n\n        it('should handle direct replies', (done) => {\n            topics.reply({ uid: topic.userId, content: 'test reply', tid: newTopic.tid, toPid: newPost.pid }, (err, result) => {\n                assert.equal(err, null, 'was created with error');\n                assert.ok(result);\n\n                socketPosts.getReplies({ uid: 0 }, newPost.pid, (err, postData) => {\n                    assert.ifError(err);\n\n                    assert.ok(postData);\n\n                    assert.equal(postData.length, 1, 'should have 1 result');\n                    assert.equal(postData[0].pid, result.pid, 'result should be the reply we added');\n\n                    done();\n                });\n            });\n        });\n\n        it('should error if pid is not a number', (done) => {\n            socketPosts.getReplies({ uid: 0 }, 'abc', (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should fail to create new reply with invalid user id', (done) => {\n            topics.reply({ uid: null, content: 'test post', tid: newTopic.tid }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail to create new reply with empty content', (done) => {\n            topics.reply({ uid: topic.userId, content: '', tid: newTopic.tid }, (err) => {\n                assert.ok(err);\n                done();\n            });\n        });\n\n        it('should fail to create new reply with invalid topic id', (done) => {\n            topics.reply({ uid: null, content: 'test post', tid: 99 }, (err) => {\n                assert.equal(err.message, '[[error:no-topic]]');\n                done();\n            });\n        });\n\n        it('should fail to create new reply with invalid toPid', (done) => {\n            topics.reply({ uid: topic.userId, content: 'test post', tid: newTopic.tid, toPid: '\"onmouseover=alert(1);//' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-pid]]');\n                done();\n            });\n        });\n\n        it('should delete nested relies properly', async () => {\n            const result = await topics.post({ uid: fooUid, title: 'nested test', content: 'main post', cid: topic.categoryId });\n            const reply1 = await topics.reply({ uid: fooUid, content: 'reply post 1', tid: result.topicData.tid });\n            const reply2 = await topics.reply({ uid: fooUid, content: 'reply post 2', tid: result.topicData.tid, toPid: reply1.pid });\n            let replies = await socketPosts.getReplies({ uid: fooUid }, reply1.pid);\n            assert.strictEqual(replies.length, 1);\n            assert.strictEqual(replies[0].content, 'reply post 2');\n            let toPid = await posts.getPostField(reply2.pid, 'toPid');\n            assert.strictEqual(parseInt(toPid, 10), parseInt(reply1.pid, 10));\n            await posts.purge(reply1.pid, fooUid);\n            replies = await socketPosts.getReplies({ uid: fooUid }, reply1.pid);\n            assert.strictEqual(replies.length, 0);\n            toPid = await posts.getPostField(reply2.pid, 'toPid');\n            assert.strictEqual(toPid, null);\n        });\n    });\n\n    describe('Get methods', () => {\n        let newTopic;\n        let newPost;\n\n        before((done) => {\n            topics.post({\n                uid: topic.userId,\n                title: topic.title,\n                content: topic.content,\n                cid: topic.categoryId,\n            }, (err, result) => {\n                if (err) {\n                    return done(err);\n                }\n\n                newTopic = result.topicData;\n                newPost = result.postData;\n                done();\n            });\n        });\n\n\n        it('should not receive errors', (done) => {\n            topics.getTopicData(newTopic.tid, (err, topicData) => {\n                assert.ifError(err);\n                assert(typeof topicData.tid === 'number');\n                assert(typeof topicData.uid === 'number');\n                assert(typeof topicData.cid === 'number');\n                assert(typeof topicData.mainPid === 'number');\n\n                assert(typeof topicData.timestamp === 'number');\n                assert.strictEqual(topicData.postcount, 1);\n                assert.strictEqual(topicData.viewcount, 0);\n                assert.strictEqual(topicData.upvotes, 0);\n                assert.strictEqual(topicData.downvotes, 0);\n                assert.strictEqual(topicData.votes, 0);\n                assert.strictEqual(topicData.deleted, 0);\n                assert.strictEqual(topicData.locked, 0);\n                assert.strictEqual(topicData.pinned, 0);\n                done();\n            });\n        });\n\n        it('should get a single field', (done) => {\n            topics.getTopicFields(newTopic.tid, ['slug'], (err, data) => {\n                assert.ifError(err);\n                assert(Object.keys(data).length === 1);\n                assert(data.hasOwnProperty('slug'));\n                done();\n            });\n        });\n\n        it('should get topic title by pid', (done) => {\n            topics.getTitleByPid(newPost.pid, (err, title) => {\n                assert.ifError(err);\n                assert.equal(title, topic.title);\n                done();\n            });\n        });\n\n        it('should get topic data by pid', (done) => {\n            topics.getTopicDataByPid(newPost.pid, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.tid, newTopic.tid);\n                done();\n            });\n        });\n\n        describe('.getTopicWithPosts', () => {\n            let tid;\n            before(async () => {\n                const result = await topics.post({ uid: topic.userId, title: 'page test', content: 'main post', cid: topic.categoryId });\n                tid = result.topicData.tid;\n                for (let i = 0; i <"+" 30; i++) {\n                    // eslint-disable-next-line no-await-in-loop\n                    await topics.reply({ uid: adminUid, content: `topic reply ${i + 1}`, tid: tid });\n                }\n            });\n\n            it('should get a topic with posts and other data', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, 0, -1, false);\n                assert(data);\n                assert.equal(data.category.cid, topic.categoryId);\n                assert.equal(data.unreplied, false);\n                assert.equal(data.deleted, false);\n                assert.equal(data.locked, false);\n                assert.equal(data.pinned, false);\n            });\n\n            it('should return first 3 posts including main post', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, 0, 2, false);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'main post');\n                assert.strictEqual(data.posts[1].content, 'topic reply 1');\n                assert.strictEqual(data.posts[2].content, 'topic reply 2');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index);\n                });\n            });\n\n            it('should return 3 posts from 1 to 3 excluding main post', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const start = 1;\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, start, 3, false);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'topic reply 1');\n                assert.strictEqual(data.posts[1].content, 'topic reply 2');\n                assert.strictEqual(data.posts[2].content, 'topic reply 3');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index + start);\n                });\n            });\n\n            it('should return main post and last 2 posts', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, 0, 2, true);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'main post');\n                assert.strictEqual(data.posts[1].content, 'topic reply 30');\n                assert.strictEqual(data.posts[2].content, 'topic reply 29');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index);\n                });\n            });\n\n            it('should return last 3 posts and not main post', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const start = 1;\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, start, 3, true);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'topic reply 30');\n                assert.strictEqual(data.posts[1].content, 'topic reply 29');\n                assert.strictEqual(data.posts[2].content, 'topic reply 28');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index + start);\n                });\n            });\n\n            it('should return posts 29 to 27 posts and not main post', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const start = 2;\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, start, 4, true);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'topic reply 29');\n                assert.strictEqual(data.posts[1].content, 'topic reply 28');\n                assert.strictEqual(data.posts[2].content, 'topic reply 27');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index + start);\n                });\n            });\n\n            it('should return 3 posts in reverse', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const start = 28;\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, start, 30, true);\n                assert.strictEqual(data.posts.length, 3);\n                assert.strictEqual(data.posts[0].content, 'topic reply 3');\n                assert.strictEqual(data.posts[1].content, 'topic reply 2');\n                assert.strictEqual(data.posts[2].content, 'topic reply 1');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index + start);\n                });\n            });\n\n            it('should get all posts with main post at the start', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, 0, -1, false);\n                assert.strictEqual(data.posts.length, 31);\n                assert.strictEqual(data.posts[0].content, 'main post');\n                assert.strictEqual(data.posts[1].content, 'topic reply 1');\n                assert.strictEqual(data.posts[data.posts.length - 1].content, 'topic reply 30');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index);\n                });\n            });\n\n            it('should get all posts in reverse with main post at the start followed by reply 30', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const data = await topics.getTopicWithPosts(topicData, `tid:${tid}:posts`, topic.userId, 0, -1, true);\n                assert.strictEqual(data.posts.length, 31);\n                assert.strictEqual(data.posts[0].content, 'main post');\n                assert.strictEqual(data.posts[1].content, 'topic reply 30');\n                assert.strictEqual(data.posts[data.posts.length - 1].content, 'topic reply 1');\n                data.posts.forEach((post, index) => {\n                    assert.strictEqual(post.index, index);\n                });\n            });\n\n            it('should return empty array if first param is falsy', async () => {\n                const posts = await topics.getTopicPosts(null, `tid:${tid}:posts`, 0, 9, topic.userId, true);\n                assert.deepStrictEqual(posts, []);\n            });\n\n            it('should only return main post', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const postsData = await topics.getTopicPosts(topicData, `tid:${tid}:posts`, 0, 0, topic.userId, false);\n                assert.strictEqual(postsData.length, 1);\n                assert.strictEqual(postsData[0].content, 'main post');\n            });\n\n            it('should only return first reply', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const postsData = await topics.getTopicPosts(topicData, `tid:${tid}:posts`, 1, 1, topic.userId, false);\n                assert.strictEqual(postsData.length, 1);\n                assert.strictEqual(postsData[0].content, 'topic reply 1');\n            });\n\n            it('should return main post and first reply', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const postsData = await topics.getTopicPosts(topicData, `tid:${tid}:posts`, 0, 1, topic.userId, false);\n                assert.strictEqual(postsData.length, 2);\n                assert.strictEqual(postsData[0].content, 'main post');\n                assert.strictEqual(postsData[1].content, 'topic reply 1');\n            });\n\n            it('should return posts in correct order', async () => {\n                const data = await socketTopics.loadMore({ uid: topic.userId }, { tid: tid, after: 20, direction: 1 });\n                assert.strictEqual(data.posts.length, 11);\n                assert.strictEqual(data.posts[0].content, 'topic reply 20');\n                assert.strictEqual(data.posts[1].content, 'topic reply 21');\n            });\n\n            it('should return posts in correct order in reverse direction', async () => {\n                const data = await socketTopics.loadMore({ uid: topic.userId }, { tid: tid, after: 25, direction: -1 });\n                assert.strictEqual(data.posts.length, 20);\n                assert.strictEqual(data.posts[0].content, 'topic reply 5');\n                assert.strictEqual(data.posts[1].content, 'topic reply 6');\n            });\n\n            it('should return all posts in correct order', async () => {\n                const topicData = await topics.getTopicData(tid);\n                const postsData = await topics.getTopicPosts(topicData, `tid:${tid}:posts`, 0, -1, topic.userId, false);\n                assert.strictEqual(postsData.length, 31);\n                assert.strictEqual(postsData[0].content, 'main post');\n                for (let i = 1; i <"+" 30; i++) {\n                    assert.strictEqual(postsData[i].content, `topic reply ${i}`);\n                }\n            });\n        });\n    });\n\n    describe('Title escaping', () => {\n        it('should properly escape topic title', (done) => {\n            const title = '\"<"+"script>alert(\\'ok1\\');<"+"/script> new topic test';\n            const titleEscaped = validator.escape(title);\n\n            const topicPostData = { uid: topic.userId, title: title, content: topic.content, cid: topic.categoryId };\n            topics.post(topicPostData, (err, result) => {\n                assert.ifError(err);\n                topics.getTopicData(result.topicData.tid, (err, topicData) => {\n                    assert.ifError(err);\n                    assert.strictEqual(topicData.titleRaw, title);\n                    assert.strictEqual(topicData.title, titleEscaped);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('tools/delete/restore/purge', () => {\n        let newTopic;\n        let followerUid;\n        let moveCid;\n\n        before((done) => {\n            async.waterfall([\n                function (next) {\n                    topics.post({\n                        uid: topic.userId,\n                        title: topic.title,\n                        content: topic.content,\n                        cid: topic.categoryId,\n                    }, (err, result) => {\n                        assert.ifError(err);\n                        newTopic = result.topicData;\n                        next();\n                    });\n                },\n                function (next) {\n                    User.create({ username: 'topicFollower', password: '123456' }, next);\n                },\n                function (_uid, next) {\n                    followerUid = _uid;\n                    topics.follow(newTopic.tid, _uid, next);\n                },\n                function (next) {\n                    categories.create({\n                        name: 'Test Category',\n                        description: 'Test category created by testing script',\n                    }, (err, category) => {\n                        if (err) {\n                            return next(err);\n                        }\n                        moveCid = category.cid;\n                        next();\n                    });\n                },\n            ], done);\n        });\n\n        it('should load topic tools', (done) => {\n            socketTopics.loadTopicTools({ uid: adminUid }, { tid: newTopic.tid }, (err, data) => {\n                assert.ifError(err);\n                assert(data);\n                done();\n            });\n        });\n\n        it('should delete the topic', async () => {\n            await apiTopics.delete({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const deleted = await topics.getTopicField(newTopic.tid, 'deleted');\n            assert.strictEqual(deleted, 1);\n        });\n\n        it('should restore the topic', async () => {\n            await apiTopics.restore({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const deleted = await topics.getTopicField(newTopic.tid, 'deleted');\n            assert.strictEqual(deleted, 0);\n        });\n\n        it('should lock topic', async () => {\n            await apiTopics.lock({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const isLocked = await topics.isLocked(newTopic.tid);\n            assert(isLocked);\n        });\n\n        it('should unlock topic', async () => {\n            await apiTopics.unlock({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const isLocked = await topics.isLocked(newTopic.tid);\n            assert(!isLocked);\n        });\n\n        it('should pin topic', async () => {\n            await apiTopics.pin({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const pinned = await topics.getTopicField(newTopic.tid, 'pinned');\n            assert.strictEqual(pinned, 1);\n        });\n\n        it('should unpin topic', async () => {\n            await apiTopics.unpin({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const pinned = await topics.getTopicField(newTopic.tid, 'pinned');\n            assert.strictEqual(pinned, 0);\n        });\n\n        it('should move all topics', (done) => {\n            socketTopics.moveAll({ uid: adminUid }, { cid: moveCid, currentCid: categoryObj.cid }, (err) => {\n                assert.ifError(err);\n                topics.getTopicField(newTopic.tid, 'cid', (err, cid) => {\n                    assert.ifError(err);\n                    assert.equal(cid, moveCid);\n                    done();\n                });\n            });\n        });\n\n        it('should move a topic', (done) => {\n            socketTopics.move({ uid: adminUid }, { cid: categoryObj.cid, tids: [newTopic.tid] }, (err) => {\n                assert.ifError(err);\n                topics.getTopicField(newTopic.tid, 'cid', (err, cid) => {\n                    assert.ifError(err);\n                    assert.equal(cid, categoryObj.cid);\n                    done();\n                });\n            });\n        });\n\n        it('should properly update sets when post is moved', (done) => {\n            let movedPost;\n            let previousPost;\n            let topic2LastReply;\n            let tid1;\n            let tid2;\n            const cid1 = topic.categoryId;\n            let cid2;\n            function checkCidSets(post1, post2, callback) {\n                async.waterfall([\n                    function (next) {\n                        async.parallel({\n                            topicData: function (next) {\n                                topics.getTopicsFields([tid1, tid2], ['lastposttime', 'postcount'], next);\n                            },\n                            scores1: function (next) {\n                                db.sortedSetsScore([\n                                    `cid:${cid1}:tids`,\n                                    `cid:${cid1}:tids:lastposttime`,\n                                    `cid:${cid1}:tids:posts`,\n                                ], tid1, next);\n                            },\n                            scores2: function (next) {\n                                db.sortedSetsScore([\n                                    `cid:${cid2}:tids`,\n                                    `cid:${cid2}:tids:lastposttime`,\n                                    `cid:${cid2}:tids:posts`,\n                                ], tid2, next);\n                            },\n                            posts1: function (next) {\n                                db.getSortedSetRangeWithScores(`tid:${tid1}:posts`, 0, -1, next);\n                            },\n                            posts2: function (next) {\n                                db.getSortedSetRangeWithScores(`tid:${tid2}:posts`, 0, -1, next);\n                            },\n                        }, next);\n                    },\n                    function (results, next) {\n                        const assertMsg = `${JSON.stringify(results.posts1)}\\n${JSON.stringify(results.posts2)}`;\n                        assert.equal(results.topicData[0].postcount, results.scores1[2], assertMsg);\n                        assert.equal(results.topicData[1].postcount, results.scores2[2], assertMsg);\n                        assert.equal(results.topicData[0].lastposttime, post1.timestamp, assertMsg);\n                        assert.equal(results.topicData[1].lastposttime, post2.timestamp, assertMsg);\n                        assert.equal(results.topicData[0].lastposttime, results.scores1[0], assertMsg);\n                        assert.equal(results.topicData[1].lastposttime, results.scores2[0], assertMsg);\n                        assert.equal(results.topicData[0].lastposttime, results.scores1[1], assertMsg);\n                        assert.equal(results.topicData[1].lastposttime, results.scores2[1], assertMsg);\n\n                        next();\n                    },\n                ], callback);\n            }\n\n            async.waterfall([\n                function (next) {\n                    categories.create({\n                        name: 'move to this category',\n                        description: 'Test category created by testing script',\n                    }, next);\n                },\n                function (category, next) {\n                    cid2 = category.cid;\n                    topics.post({ uid: adminUid, title: 'topic1', content: 'topic 1 mainPost', cid: cid1 }, next);\n                },\n                function (result, next) {\n                    tid1 = result.topicData.tid;\n                    topics.reply({ uid: adminUid, content: 'topic 1 reply 1', tid: tid1 }, next);\n                },\n                function (postData, next) {\n                    previousPost = postData;\n                    topics.reply({ uid: adminUid, content: 'topic 1 reply 2', tid: tid1 }, next);\n                },\n                function (postData, next) {\n                    movedPost = postData;\n                    topics.post({ uid: adminUid, title: 'topic2', content: 'topic 2 mainpost', cid: cid2 }, next);\n                },\n                function (results, next) {\n                    tid2 = results.topicData.tid;\n                    topics.reply({ uid: adminUid, content: 'topic 2 reply 1', tid: tid2 }, next);\n                },\n                function (postData, next) {\n                    topic2LastReply = postData;\n                    checkCidSets(movedPost, postData, next);\n                },\n                function (next) {\n                    db.isMemberOfSortedSets([`cid:${cid1}:pids`, `cid:${cid2}:pids`], movedPost.pid, next);\n                },\n                function (isMember, next) {\n                    assert.deepEqual(isMember, [true, false]);\n                    categories.getCategoriesFields([cid1, cid2], ['post_count'], next);\n                },\n                function (categoryData, next) {\n                    assert.equal(categoryData[0].post_count, 4);\n                    assert.equal(categoryData[1].post_count, 2);\n                    topics.movePostToTopic(1, movedPost.pid, tid2, next);\n                },\n                function (next) {\n                    checkCidSets(previousPost, topic2LastReply, next);\n                },\n                function (next) {\n                    db.isMemberOfSortedSets([`cid:${cid1}:pids`, `cid:${cid2}:pids`], movedPost.pid, next);\n                },\n                function (isMember, next) {\n                    assert.deepEqual(isMember, [false, true]);\n                    categories.getCategoriesFields([cid1, cid2], ['post_count'], next);\n                },\n                function (categoryData, next) {\n                    assert.equal(categoryData[0].post_count, 3);\n                    assert.equal(categoryData[1].post_count, 3);\n                    next();\n                },\n            ], done);\n        });\n\n        it('should fail to purge topic if user does not have privilege', async () => {\n            const topic1 = await topics.post({\n                uid: adminUid,\n                title: 'topic for purge test',\n                content: 'topic content',\n                cid: categoryObj.cid,\n            });\n            const tid1 = topic1.topicData.tid;\n            const globalModUid = await User.create({ username: 'global mod' });\n            await groups.join('Global Moderators', globalModUid);\n            await privileges.categories.rescind(['groups:purge'], categoryObj.cid, 'Global Moderators');\n            try {\n                await apiTopics.purge({ uid: globalModUid }, { tids: [tid1], cid: categoryObj.cid });\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                await privileges.categories.give(['groups:purge'], categoryObj.cid, 'Global Moderators');\n                return;\n            }\n            assert(false);\n        });\n\n        it('should purge the topic', async () => {\n            await apiTopics.purge({ uid: adminUid }, { tids: [newTopic.tid], cid: categoryObj.cid });\n            const isMember = await db.isSortedSetMember(`uid:${followerUid}:followed_tids`, newTopic.tid);\n            assert.strictEqual(false, isMember);\n        });\n\n        it('should not allow user to restore their topic if it was deleted by an admin', async () => {\n            const result = await topics.post({\n                uid: fooUid,\n                title: 'topic for restore test',\n                content: 'topic content',\n                cid: categoryObj.cid,\n            });\n            await apiTopics.delete({ uid: adminUid }, { tids: [result.topicData.tid], cid: categoryObj.cid });\n            try {\n                await apiTopics.restore({ uid: fooUid }, { tids: [result.topicData.tid], cid: categoryObj.cid });\n            } catch (err) {\n                return assert.strictEqual(err.message, '[[error:no-privileges]]');\n            }\n            assert(false);\n        });\n    });\n\n    describe('order pinned topics', () => {\n        let tid1;\n        let tid2;\n        let tid3;\n        before((done) => {\n            function createTopic(callback) {\n                topics.post({\n                    uid: topic.userId,\n                    title: 'topic for test',\n                    content: 'topic content',\n                    cid: topic.categoryId,\n                }, callback);\n            }\n            async.series({\n                topic1: function (next) {\n                    createTopic(next);\n                },\n                topic2: function (next) {\n                    createTopic(next);\n                },\n                topic3: function (next) {\n                    createTopic(next);\n                },\n            }, (err, results) => {\n                assert.ifError(err);\n                tid1 = results.topic1.topicData.tid;\n                tid2 = results.topic2.topicData.tid;\n                tid3 = results.topic3.topicData.tid;\n                async.series([\n                    function (next) {\n                        topics.tools.pin(tid1, adminUid, next);\n                    },\n                    function (next) {\n                        // artificial timeout so pin time is different on redis sometimes scores are indentical\n                        setTimeout(() => {\n                            topics.tools.pin(tid2, adminUid, next);\n                        }, 5);\n                    },\n                ], done);\n            });\n        });\n\n        const socketTopics = require('../src/socket.io/topics');\n        it('should error with invalid data', (done) => {\n            socketTopics.orderPinnedTopics({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should error with invalid data', (done) => {\n            socketTopics.orderPinnedTopics({ uid: adminUid }, [null, null], (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should error with unprivileged user', (done) => {\n            socketTopics.orderPinnedTopics({ uid: 0 }, { tid: tid1, order: 1 }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should not do anything if topics are not pinned', (done) => {\n            socketTopics.orderPinnedTopics({ uid: adminUid }, { tid: tid3, order: 1 }, (err) => {\n                assert.ifError(err);\n                db.isSortedSetMember(`cid:${topic.categoryId}:tids:pinned`, tid3, (err, isMember) => {\n                    assert.ifError(err);\n                    assert(!isMember);\n                    done();\n                });\n            });\n        });\n\n        it('should order pinned topics', (done) => {\n            db.getSortedSetRevRange(`cid:${topic.categoryId}:tids:pinned`, 0, -1, (err, pinnedTids) => {\n                assert.ifError(err);\n                assert.equal(pinnedTids[0], tid2);\n                assert.equal(pinnedTids[1], tid1);\n                socketTopics.orderPinnedTopics({ uid: adminUid }, { tid: tid1, order: 0 }, (err) => {\n                    assert.ifError(err);\n                    db.getSortedSetRevRange(`cid:${topic.categoryId}:tids:pinned`, 0, -1, (err, pinnedTids) => {\n                        assert.ifError(err);\n                        assert.equal(pinnedTids[0], tid1);\n                        assert.equal(pinnedTids[1], tid2);\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n\n    describe('.ignore', () => {\n        let newTid;\n        let uid;\n        let newTopic;\n        before((done) => {\n            uid = topic.userId;\n            async.waterfall([\n                function (done) {\n                    topics.post({ uid: topic.userId, title: 'Topic to be ignored', content: 'Just ignore me, please!', cid: topic.categoryId }, (err, result) => {\n                        if (err) {\n                            return done(err);\n                        }\n\n                        newTopic = result.topicData;\n                        newTid = newTopic.tid;\n                        done();\n                    });\n                },\n                function (done) {\n                    topics.markUnread(newTid, uid, done);\n                },\n            ], done);\n        });\n\n        it('should not appear in the unread list', (done) => {\n            async.waterfall([\n                function (done) {\n                    topics.ignore(newTid, uid, done);\n                },\n                function (done) {\n                    topics.getUnreadTopics({ cid: 0, uid: uid, start: 0, stop: -1, filter: '' }, done);\n                },\n                function (results, done) {\n                    const { topics } = results;\n                    const tids = topics.map(topic => topic.tid);\n                    assert.equal(tids.indexOf(newTid), -1, 'The topic appeared in the unread list.');\n                    done();\n                },\n            ], done);\n        });\n\n        it('should not appear as unread in the recent list', (done) => {\n            async.waterfall([\n                function (done) {\n                    topics.ignore(newTid, uid, done);\n                },\n                function (done) {\n                    topics.getLatestTopics({\n                        uid: uid,\n                        start: 0,\n                        stop: -1,\n                        term: 'year',\n                    }, done);\n                },\n                function (results, done) {\n                    const { topics } = results;\n                    let topic;\n                    let i;\n                    for (i = 0; i <"+" topics.length; i += 1) {\n                        if (topics[i].tid === parseInt(newTid, 10)) {\n                            assert.equal(false, topics[i].unread, 'ignored topic was marked as unread in recent list');\n                            return done();\n                        }\n                    }\n                    assert.ok(topic, 'topic didn\\'t appear in the recent list');\n                    done();\n                },\n            ], done);\n        });\n\n        it('should appear as unread again when marked as reading', (done) => {\n            async.waterfall([\n                function (done) {\n                    topics.ignore(newTid, uid, done);\n                },\n                function (done) {\n                    topics.follow(newTid, uid, done);\n                },\n                function (done) {\n                    topics.getUnreadTopics({ cid: 0, uid: uid, start: 0, stop: -1, filter: '' }, done);\n                },\n                function (results, done) {\n                    const { topics } = results;\n                    const tids = topics.map(topic => topic.tid);\n                    assert.notEqual(tids.indexOf(newTid), -1, 'The topic did not appear in the unread list.');\n                    done();\n                },\n            ], done);\n        });\n\n        it('should appear as unread again when marked as following', (done) => {\n            async.waterfall([\n                function (done) {\n                    topics.ignore(newTid, uid, done);\n                },\n                function (done) {\n                    topics.follow(newTid, uid, done);\n                },\n                function (done) {\n                    topics.getUnreadTopics({ cid: 0, uid: uid, start: 0, stop: -1, filter: '' }, done);\n                },\n                function (results, done) {\n                    const { topics } = results;\n                    const tids = topics.map(topic => topic.tid);\n                    assert.notEqual(tids.indexOf(newTid), -1, 'The topic did not appear in the unread list.');\n                    done();\n                },\n            ], done);\n        });\n    });\n\n    describe('.fork', () => {\n        let newTopic;\n        const replies = [];\n        let topicPids;\n        const originalBookmark = 6;\n        function postReply(next) {\n            topics.reply({ uid: topic.userId, content: `test post ${replies.length}`, tid: newTopic.tid }, (err, result) => {\n                assert.equal(err, null, 'was created with error');\n                assert.ok(result);\n                replies.push(result);\n                next();\n            });\n        }\n\n        before((done) => {\n            async.waterfall([\n                function (next) {\n                    groups.join('administrators', topic.userId, next);\n                },\n                function (next) {\n                    topics.post({\n                        uid: topic.userId,\n                        title: topic.title,\n                        content: topic.content,\n                        cid: topic.categoryId,\n                    }, (err, result) => {\n                        assert.ifError(err);\n                        newTopic = result.topicData;\n                        next();\n                    });\n                },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) { postReply(next); },\n                function (next) {\n                    topicPids = replies.map(reply => reply.pid);\n                    socketTopics.bookmark({ uid: topic.userId }, { tid: newTopic.tid, index: originalBookmark }, next);\n                },\n            ], done);\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.bookmark({ uid: topic.userId }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should have 12 replies', (done) => {\n            assert.equal(12, replies.length);\n            done();\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.createTopicFromPosts({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:not-logged-in]]');\n                done();\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.createTopicFromPosts({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should not update the user\\'s bookmark', (done) => {\n            async.waterfall([\n                function (next) {\n                    socketTopics.createTopicFromPosts({ uid: topic.userId }, {\n                        title: 'Fork test, no bookmark update',\n                        pids: topicPids.slice(-2),\n                        fromTid: newTopic.tid,\n                    }, next);\n                },\n                function (forkedTopicData, next) {\n                    topics.getUserBookmark(newTopic.tid, topic.userId, next);\n                },\n                function (bookmark, next) {\n                    assert.equal(originalBookmark, bookmark);\n                    next();\n                },\n            ], done);\n        });\n\n        it('should update the user\\'s bookmark ', (done) => {\n            async.waterfall([\n                function (next) {\n                    topics.createTopicFromPosts(\n                        topic.userId,\n                        'Fork test, no bookmark update',\n                        topicPids.slice(1, 3),\n                        newTopic.tid,\n                        next\n                    );\n                },\n                function (forkedTopicData, next) {\n                    topics.getUserBookmark(newTopic.tid, topic.userId, next);\n                },\n                function (bookmark, next) {\n                    assert.equal(originalBookmark - 2, bookmark);\n                    next();\n                },\n            ], done);\n        });\n\n        it('should properly update topic vote count after forking', async () => {\n            const result = await topics.post({ uid: fooUid, cid: categoryObj.cid, title: 'fork vote test', content: 'main post' });\n            const reply1 = await topics.reply({ tid: result.topicData.tid, uid: fooUid, content: 'test reply 1' });\n            const reply2 = await topics.reply({ tid: result.topicData.tid, uid: fooUid, content: 'test reply 2' });\n            const reply3 = await topics.reply({ tid: result.topicData.tid, uid: fooUid, content: 'test reply 3' });\n            await posts.upvote(result.postData.pid, adminUid);\n            await posts.upvote(reply1.pid, adminUid);\n            assert.strictEqual(await db.sortedSetScore('topics:votes', result.topicData.tid), 1);\n            assert.strictEqual(await db.sortedSetScore(`cid:${categoryObj.cid}:tids:votes`, result.topicData.tid), 1);\n            const newTopic = await topics.createTopicFromPosts(adminUid, 'Fork test, vote update', [reply1.pid, reply2.pid], result.topicData.tid);\n\n            assert.strictEqual(await db.sortedSetScore('topics:votes', newTopic.tid), 1);\n            assert.strictEqual(await db.sortedSetScore(`cid:${categoryObj.cid}:tids:votes`, newTopic.tid), 1);\n            assert.strictEqual(await topics.getTopicField(newTopic.tid, 'upvotes'), 1);\n        });\n    });\n\n    describe('controller', () => {\n        let topicData;\n\n        before((done) => {\n            topics.post({\n                uid: topic.userId,\n                title: 'topic for controller test',\n                content: 'topic content',\n                cid: topic.categoryId,\n                thumb: 'http://i.imgur.com/64iBdBD.jpg',\n            }, (err, result) => {\n                assert.ifError(err);\n                assert.ok(result);\n                topicData = result.topicData;\n                done();\n            });\n        });\n\n        it('should load topic', (done) => {\n            request(`${nconf.get('url')}/topic/${topicData.slug}`, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n\n        it('should load topic api data', (done) => {\n            request(`${nconf.get('url')}/api/topic/${topicData.slug}`, { json: true }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert.strictEqual(body._header.tags.meta.find(t => t.name === 'description').content, 'topic content');\n                assert.strictEqual(body._header.tags.meta.find(t => t.property === 'og:description').content, 'topic content');\n                done();\n            });\n        });\n\n        it('should 404 if post index is invalid', (done) => {\n            request(`${nconf.get('url')}/topic/${topicData.slug}/derp`, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should 404 if topic does not exist', (done) => {\n            request(`${nconf.get('url')}/topic/123123/does-not-exist`, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should 401 if not allowed to read as guest', (done) => {\n            const privileges = require('../src/privileges');\n            privileges.categories.rescind(['groups:topics:read'], topicData.cid, 'guests', (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/topic/${topicData.slug}`, (err, response, body) => {\n                    assert.ifError(err);\n                    assert.equal(response.statusCode, 401);\n                    assert(body);\n                    privileges.categories.give(['groups:topics:read'], topicData.cid, 'guests', done);\n                });\n            });\n        });\n\n        it('should redirect to correct topic if slug is missing', (done) => {\n            request(`${nconf.get('url')}/topic/${topicData.tid}/herpderp/1?page=2`, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n\n        it('should redirect if post index is out of range', (done) => {\n            request(`${nconf.get('url')}/api/topic/${topicData.slug}/-1`, { json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert.equal(res.headers['x-redirect'], `/topic/${topicData.tid}/topic-for-controller-test`);\n                assert.equal(body, `/topic/${topicData.tid}/topic-for-controller-test`);\n                done();\n            });\n        });\n\n        it('should 404 if page is out of bounds', (done) => {\n            const meta = require('../src/meta');\n            meta.config.usePagination = 1;\n            request(`${nconf.get('url')}/topic/${topicData.slug}?page=100`, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should mark topic read', (done) => {\n            request(`${nconf.get('url')}/topic/${topicData.slug}`, {\n                jar: adminJar,\n            }, (err, res) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                topics.hasReadTopics([topicData.tid], adminUid, (err, hasRead) => {\n                    assert.ifError(err);\n                    assert.equal(hasRead[0], true);\n                    done();\n                });\n            });\n        });\n\n        it('should 404 if tid is not a number', (done) => {\n            request(`${nconf.get('url')}/api/topic/teaser/nan`, { json: true }, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should 403 if cant read', (done) => {\n            request(`${nconf.get('url')}/api/topic/teaser/${123123}`, { json: true }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 403);\n                assert.equal(body, '[[error:no-privileges]]');\n\n                done();\n            });\n        });\n\n        it('should load topic teaser', (done) => {\n            request(`${nconf.get('url')}/api/topic/teaser/${topicData.tid}`, { json: true }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert(body);\n                assert.equal(body.tid, topicData.tid);\n                assert.equal(body.content, 'topic content');\n                assert(body.user);\n                assert(body.topic);\n                assert(body.category);\n                done();\n            });\n        });\n\n\n        it('should 404 if tid is not a number', (done) => {\n            request(`${nconf.get('url')}/api/topic/pagination/nan`, { json: true }, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should 404 if tid does not exist', (done) => {\n            request(`${nconf.get('url')}/api/topic/pagination/1231231`, { json: true }, (err, response) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 404);\n                done();\n            });\n        });\n\n        it('should load pagination', (done) => {\n            request(`${nconf.get('url')}/api/topic/pagination/${topicData.tid}`, { json: true }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert(body);\n                assert.deepEqual(body.pagination, {\n                    prev: { page: 1, active: false },\n                    next: { page: 1, active: false },\n                    first: { page: 1, active: true },\n                    last: { page: 1, active: true },\n                    rel: [],\n                    pages: [],\n                    currentPage: 1,\n                    pageCount: 1,\n                });\n                done();\n            });\n        });\n    });\n\n\n    describe('infinitescroll', () => {\n        const socketTopics = require('../src/socket.io/topics');\n        let tid;\n        before((done) => {\n            topics.post({\n                uid: topic.userId,\n                title: topic.title,\n                content: topic.content,\n                cid: topic.categoryId,\n            }, (err, result) => {\n                assert.ifError(err);\n                tid = result.topicData.tid;\n                done();\n            });\n        });\n\n        it('should error with invalid data', (done) => {\n            socketTopics.loadMore({ uid: adminUid }, {}, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should infinite load topic posts', (done) => {\n            socketTopics.loadMore({ uid: adminUid }, { tid: tid, after: 0, count: 10 }, (err, data) => {\n                assert.ifError(err);\n                assert(data.posts);\n                assert(data.privileges);\n                done();\n            });\n        });\n    });\n\n    describe('suggested topics', () => {\n        let tid1;\n        let tid3;\n        before((done) => {\n            async.series({\n                topic1: function (next) {\n                    topics.post({ uid: adminUid, tags: ['nodebb'], title: 'topic title 1', content: 'topic 1 content', cid: topic.categoryId }, next);\n                },\n                topic2: function (next) {\n                    topics.post({ uid: adminUid, tags: ['nodebb'], title: 'topic title 2', content: 'topic 2 content', cid: topic.categoryId }, next);\n                },\n                topic3: function (next) {\n                    topics.post({ uid: adminUid, tags: [], title: 'topic title 3', content: 'topic 3 content', cid: topic.categoryId }, next);\n                },\n            }, (err, results) => {\n                assert.ifError(err);\n                tid1 = results.topic1.topicData.tid;\n                tid3 = results.topic3.topicData.tid;\n                done();\n            });\n        });\n\n        it('should return suggested topics', (done) => {\n            topics.getSuggestedTopics(tid1, adminUid, 0, -1, (err, topics) => {\n                assert.ifError(err);\n                assert(Array.isArray(topics));\n                done();\n            });\n        });\n\n        it('should return suggested topics', (done) => {\n            topics.getSuggestedTopics(tid3, adminUid, 0, 2, (err, topics) => {\n                assert.ifError(err);\n                assert(Array.isArray(topics));\n                done();\n            });\n        });\n    });\n\n    describe('unread', () => {\n        const socketTopics = require('../src/socket.io/topics');\n        let tid;\n        let mainPid;\n        let uid;\n        before((done) => {\n            async.parallel({\n                topic: function (next) {\n                    topics.post({ uid: topic.userId, title: 'unread topic', content: 'unread topic content', cid: topic.categoryId }, next);\n                },\n                joeUid: function (next) {\n                    User.create({ username: 'regularJoe' }, next);\n                },\n            }, (err, results) => {\n                assert.ifError(err);\n                tid = results.topic.topicData.tid;\n                mainPid = results.topic.postData.pid;\n                uid = results.joeUid;\n                done();\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markUnread({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should fail if topic does not exist', (done) => {\n            socketTopics.markUnread({ uid: adminUid }, 1231082, (err) => {\n                assert.equal(err.message, '[[error:no-topic]]');\n                done();\n            });\n        });\n\n        it('should mark topic unread', (done) => {\n            socketTopics.markUnread({ uid: adminUid }, tid, (err) => {\n                assert.ifError(err);\n                topics.hasReadTopic(tid, adminUid, (err, hasRead) => {\n                    assert.ifError(err);\n                    assert.equal(hasRead, false);\n                    done();\n                });\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markAsRead({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should mark topic read', (done) => {\n            socketTopics.markAsRead({ uid: adminUid }, [tid], (err) => {\n                assert.ifError(err);\n                topics.hasReadTopic(tid, adminUid, (err, hasRead) => {\n                    assert.ifError(err);\n                    assert(hasRead);\n                    done();\n                });\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markTopicNotificationsRead({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should mark topic notifications read', async () => {\n            await apiTopics.follow({ uid: adminUid }, { tid: tid });\n            const data = await topics.reply({ uid: uid, timestamp: Date.now(), content: 'some content', tid: tid });\n            await sleep(2500);\n            let count = await User.notifications.getUnreadCount(adminUid);\n            assert.strictEqual(count, 1);\n            await socketTopics.markTopicNotificationsRead({ uid: adminUid }, [tid]);\n            count = await User.notifications.getUnreadCount(adminUid);\n            assert.strictEqual(count, 0);\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markAllRead({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-uid]]');\n                done();\n            });\n        });\n\n        it('should mark all read', (done) => {\n            socketTopics.markUnread({ uid: adminUid }, tid, (err) => {\n                assert.ifError(err);\n                socketTopics.markAllRead({ uid: adminUid }, {}, (err) => {\n                    assert.ifError(err);\n                    topics.hasReadTopic(tid, adminUid, (err, hasRead) => {\n                        assert.ifError(err);\n                        assert(hasRead);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should mark category topics read', (done) => {\n            socketTopics.markUnread({ uid: adminUid }, tid, (err) => {\n                assert.ifError(err);\n                socketTopics.markCategoryTopicsRead({ uid: adminUid }, topic.categoryId, (err) => {\n                    assert.ifError(err);\n                    topics.hasReadTopic(tid, adminUid, (err, hasRead) => {\n                        assert.ifError(err);\n                        assert(hasRead);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markAsUnreadForAll({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-tid]]');\n                done();\n            });\n        });\n\n        it('should fail with invalid data', (done) => {\n            socketTopics.markAsUnreadForAll({ uid: 0 }, [tid], (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail if user is not admin', (done) => {\n            socketTopics.markAsUnreadForAll({ uid: uid }, [tid], (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should fail if topic does not exist', (done) => {\n            socketTopics.markAsUnreadForAll({ uid: uid }, [12312313], (err) => {\n                assert.equal(err.message, '[[error:no-topic]]');\n                done();\n            });\n        });\n\n        it('should mark topic unread for everyone', (done) => {\n            socketTopics.markAsUnreadForAll({ uid: adminUid }, [tid], (err) => {\n                assert.ifError(err);\n                async.parallel({\n                    adminRead: function (next) {\n                        topics.hasReadTopic(tid, adminUid, next);\n                    },\n                    regularRead: function (next) {\n                        topics.hasReadTopic(tid, uid, next);\n                    },\n                }, (err, results) => {\n                    assert.ifError(err);\n                    assert.equal(results.adminRead, false);\n                    assert.equal(results.regularRead, false);\n                    done();\n                });\n            });\n        });\n\n        it('should not do anything if tids is empty array', (done) => {\n            socketTopics.markAsRead({ uid: adminUid }, [], (err, markedRead) => {\n                assert.ifError(err);\n                assert(!markedRead);\n                done();\n            });\n        });\n\n        it('should not return topics in category you cant read', (done) => {\n            let privateCid;\n            let privateTid;\n            async.waterfall([\n                function (next) {\n                    categories.create({\n                        name: 'private category',\n                        description: 'private category',\n                    }, next);\n                },\n                function (category, next) {\n                    privateCid = category.cid;\n                    privileges.categories.rescind(['groups:topics:read'], category.cid, 'registered-users', next);\n                },\n                function (next) {\n                    topics.post({ uid: adminUid, title: 'topic in private category', content: 'registered-users cant see this', cid: privateCid }, next);\n                },\n                function (data, next) {\n                    privateTid = data.topicData.tid;\n                    topics.getUnreadTids({ uid: uid }, next);\n                },\n                function (unreadTids, next) {\n                    unreadTids = unreadTids.map(String);\n                    assert(!unreadTids.includes(String(privateTid)));\n                    next();\n                },\n            ], done);\n        });\n\n        it('should not return topics in category you ignored/not watching', (done) => {\n            let ignoredCid;\n            let tid;\n            async.waterfall([\n                function (next) {\n                    categories.create({\n                        name: 'ignored category',\n                        description: 'ignored category',\n                    }, next);\n                },\n                function (category, next) {\n                    ignoredCid = category.cid;\n                    privileges.categories.rescind(['groups:topics:read'], category.cid, 'registered-users', next);\n                },\n                function (next) {\n                    topics.post({ uid: adminUid, title: 'topic in private category', content: 'registered-users cant see this', cid: ignoredCid }, next);\n                },\n                function (data, next) {\n                    tid = data.topicData.tid;\n                    User.ignoreCategory(uid, ignoredCid, next);\n                },\n                function (next) {\n                    topics.getUnreadTids({ uid: uid }, next);\n                },\n                function (unreadTids, next) {\n                    unreadTids = unreadTids.map(String);\n                    assert(!unreadTids.includes(String(tid)));\n                    next();\n                },\n            ], done);\n        });\n\n        it('should not return topic as unread if new post is from blocked user', (done) => {\n            let blockedUid;\n            let topic;\n            async.waterfall([\n                function (next) {\n                    topics.post({ uid: adminUid, title: 'will not get as unread', content: 'not unread', cid: categoryObj.cid }, next);\n                },\n                function (result, next) {\n                    topic = result.topicData;\n                    User.create({ username: 'blockedunread' }, next);\n                },\n                function (uid, next) {\n                    blockedUid = uid;\n                    User.blocks.add(uid, adminUid, next);\n                },\n                function (next) {\n                    topics.reply({ uid: blockedUid, content: 'post from blocked user', tid: topic.tid }, next);\n                },\n                function (result, next) {\n                    topics.getUnreadTids({ cid: 0, uid: adminUid }, next);\n                },\n                function (unreadTids, next) {\n                    assert(!unreadTids.includes(topic.tid));\n                    User.blocks.remove(blockedUid, adminUid, next);\n                },\n            ], done);\n        });\n\n        it('should not return topic as unread if topic is deleted', async () => {\n            const uid = await User.create({ username: 'regularJoe' });\n            const result = await topics.post({ uid: adminUid, title: 'deleted unread', content: 'not unread', cid: categoryObj.cid });\n            await topics.delete(result.topicData.tid, adminUid);\n            const unreadTids = await topics.getUnreadTids({ cid: 0, uid: uid });\n            assert(!unreadTids.includes(result.topicData.tid));\n        });\n    });\n\n    describe('tags', () => {\n        const socketTopics = require('../src/socket.io/topics');\n        const socketAdmin = require('../src/socket.io/admin');\n\n        before((done) => {\n            async.series([\n                function (next) {\n                    topics.post({ uid: adminUid, tags: ['php', 'nosql', 'psql', 'nodebb', 'node icon'], title: 'topic title 1', content: 'topic 1 content', cid: topic.categoryId }, next);\n                },\n                function (next) {\n                    topics.post({ uid: adminUid, tags: ['javascript', 'mysql', 'python', 'nodejs'], title: 'topic title 2', content: 'topic 2 content', cid: topic.categoryId }, next);\n                },\n            ], (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should return empty array if query is falsy', (done) => {\n            socketTopics.autocompleteTags({ uid: adminUid }, { query: '' }, (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual([], data);\n                done();\n            });\n        });\n\n        it('should autocomplete tags', (done) => {\n            socketTopics.autocompleteTags({ uid: adminUid }, { query: 'p' }, (err, data) => {\n                assert.ifError(err);\n                ['php', 'psql', 'python'].forEach((tag) => {\n                    assert.notEqual(data.indexOf(tag), -1);\n                });\n                done();\n            });\n        });\n\n        it('should return empty array if query is falsy', (done) => {\n            socketTopics.searchTags({ uid: adminUid }, { query: '' }, (err, data) => {\n                assert.ifError(err);\n                assert.deepEqual([], data);\n                done();\n            });\n        });\n\n        it('should search tags', (done) => {\n            socketTopics.searchTags({ uid: adminUid }, { query: 'no' }, (err, data) => {\n                assert.ifError(err);\n                ['nodebb', 'nodejs', 'nosql'].forEach((tag) => {\n                    assert.notEqual(data.indexOf(tag), -1);\n                });\n                done();\n            });\n        });\n\n        it('should return empty array if query is falsy', (done) => {\n            socketTopics.searchAndLoadTags({ uid: adminUid }, { query: '' }, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.matchCount, 0);\n                assert.equal(data.pageCount, 1);\n                assert.deepEqual(data.tags, []);\n                done();\n            });\n        });\n\n        it('should search and load tags', (done) => {\n            socketTopics.searchAndLoadTags({ uid: adminUid }, { query: 'no' }, (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.matchCount, 4);\n                assert.equal(data.pageCount, 1);\n                const tagData = [\n                    { value: 'nodebb', valueEscaped: 'nodebb', valueEncoded: 'nodebb', score: 3, class: 'nodebb' },\n                    { value: 'node icon', valueEscaped: 'node icon', valueEncoded: 'node%20icon', score: 1, class: 'node-icon' },\n                    { value: 'nodejs', valueEscaped: 'nodejs', valueEncoded: 'nodejs', score: 1, class: 'nodejs' },\n                    { value: 'nosql', valueEscaped: 'nosql', valueEncoded: 'nosql', score: 1, class: 'nosql' },\n                ];\n                assert.deepEqual(data.tags, tagData);\n\n                done();\n            });\n        });\n\n        it('should return error if data is invalid', (done) => {\n            socketTopics.loadMoreTags({ uid: adminUid }, { after: 'asd' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should load more tags', (done) => {\n            socketTopics.loadMoreTags({ uid: adminUid }, { after: 0 }, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data.tags));\n                assert.equal(data.nextStart, 100);\n                done();\n            });\n        });\n\n        it('should error if data is invalid', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should error if tag is invalid', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, { tag: '' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-tag]]');\n                done();\n            });\n        });\n\n        it('should error if tag is too short', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, { tag: 'as' }, (err) => {\n                assert.equal(err.message, '[[error:tag-too-short]]');\n                done();\n            });\n        });\n\n        it('should create empty tag', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, { tag: 'emptytag' }, (err) => {\n                assert.ifError(err);\n                db.sortedSetScore('tags:topic:count', 'emptytag', (err, score) => {\n                    assert.ifError(err);\n                    assert.equal(score, 0);\n                    done();\n                });\n            });\n        });\n\n        it('should do nothing if tag exists', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, { tag: 'emptytag' }, (err) => {\n                assert.ifError(err);\n                db.sortedSetScore('tags:topic:count', 'emptytag', (err, score) => {\n                    assert.ifError(err);\n                    assert.equal(score, 0);\n                    done();\n                });\n            });\n        });\n\n\n        it('should rename tags', async () => {\n            const result1 = await topics.post({ uid: adminUid, tags: ['plugins'], title: 'topic tagged with plugins', content: 'topic 1 content', cid: topic.categoryId });\n            const result2 = await topics.post({ uid: adminUid, tags: ['plugin'], title: 'topic tagged with plugin', content: 'topic 2 content', cid: topic.categoryId });\n            const data1 = await topics.getTopicData(result2.topicData.tid);\n\n            await socketAdmin.tags.rename({ uid: adminUid }, [{\n                value: 'plugin',\n                newName: 'plugins',\n            }]);\n\n            const tids = await topics.getTagTids('plugins', 0, -1);\n            assert.strictEqual(tids.length, 2);\n            const tags = await topics.getTopicTags(result2.topicData.tid);\n\n            const data = await topics.getTopicData(result2.topicData.tid);\n            assert.strictEqual(tags.length, 1);\n            assert.strictEqual(tags[0], 'plugins');\n        });\n\n        it('should return related topics', (done) => {\n            const meta = require('../src/meta');\n            meta.config.maximumRelatedTopics = 2;\n            const topicData = {\n                tags: [{ value: 'javascript' }],\n            };\n            topics.getRelatedTopics(topicData, 0, (err, data) => {\n                assert.ifError(err);\n                assert(Array.isArray(data));\n                assert.equal(data[0].title, 'topic title 2');\n                meta.config.maximumRelatedTopics = 0;\n                done();\n            });\n        });\n\n        it('should return error with invalid data', (done) => {\n            socketAdmin.tags.deleteTags({ uid: adminUid }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should do nothing if arrays is empty', (done) => {\n            socketAdmin.tags.deleteTags({ uid: adminUid }, { tags: [] }, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should delete tags', (done) => {\n            socketAdmin.tags.create({ uid: adminUid }, { tag: 'emptytag2' }, (err) => {\n                assert.ifError(err);\n                socketAdmin.tags.deleteTags({ uid: adminUid }, { tags: ['emptytag', 'emptytag2', 'nodebb', 'nodejs'] }, (err) => {\n                    assert.ifError(err);\n                    db.getObjects(['tag:emptytag', 'tag:emptytag2'], (err, data) => {\n                        assert.ifError(err);\n                        assert(!data[0]);\n                        assert(!data[1]);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should delete tag', (done) => {\n            topics.deleteTag('javascript', (err) => {\n                assert.ifError(err);\n                db.getObject('tag:javascript', (err, data) => {\n                    assert.ifError(err);\n                    assert(!data);\n                    done();\n                });\n            });\n        });\n\n        it('should delete category tag as well', async () => {\n            const category = await categories.create({ name: 'delete category' });\n            const { cid } = category;\n            await topics.post({ uid: adminUid, tags: ['willbedeleted', 'notthis'], title: 'tag topic', content: 'topic 1 content', cid: cid });\n            let categoryTags = await topics.getCategoryTags(cid, 0, -1);\n            assert(categoryTags.includes('willbedeleted'));\n            assert(categoryTags.includes('notthis'));\n            await topics.deleteTags(['willbedeleted']);\n            categoryTags = await topics.getCategoryTags(cid, 0, -1);\n            assert(!categoryTags.includes('willbedeleted'));\n            assert(categoryTags.includes('notthis'));\n        });\n\n        it('should add and remove tags from topics properly', async () => {\n            const category = await categories.create({ name: 'add/remove category' });\n            const { cid } = category;\n            const result = await topics.post({ uid: adminUid, tags: ['tag4', 'tag2', 'tag1', 'tag3'], title: 'tag topic', content: 'topic 1 content', cid: cid });\n            const { tid } = result.topicData;\n\n            let tags = await topics.getTopicTags(tid);\n            let categoryTags = await topics.getCategoryTags(cid, 0, -1);\n            assert.deepStrictEqual(tags.sort(), ['tag1', 'tag2', 'tag3', 'tag4']);\n            assert.deepStrictEqual(categoryTags.sort(), ['tag1', 'tag2', 'tag3', 'tag4']);\n\n            await topics.addTags(['tag7', 'tag6', 'tag5'], [tid]);\n            tags = await topics.getTopicTags(tid);\n            categoryTags = await topics.getCategoryTags(cid, 0, -1);\n            assert.deepStrictEqual(tags.sort(), ['tag1', 'tag2', 'tag3', 'tag4', 'tag5', 'tag6', 'tag7']);\n            assert.deepStrictEqual(categoryTags.sort(), ['tag1', 'tag2', 'tag3', 'tag4', 'tag5', 'tag6', 'tag7']);\n\n            await topics.removeTags(['tag1', 'tag3', 'tag5', 'tag7'], [tid]);\n            tags = await topics.getTopicTags(tid);\n            categoryTags = await topics.getCategoryTags(cid, 0, -1);\n            assert.deepStrictEqual(tags.sort(), ['tag2', 'tag4', 'tag6']);\n            assert.deepStrictEqual(categoryTags.sort(), ['tag2', 'tag4', 'tag6']);\n        });\n\n        it('should respect minTags', async () => {\n            const oldValue = meta.config.minimumTagsPerTopic;\n            meta.config.minimumTagsPerTopic = 2;\n            let err;\n            try {\n                await topics.post({ uid: adminUid, tags: ['tag4'], title: 'tag topic', content: 'topic 1 content', cid: topic.categoryId });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, `[[error:not-enough-tags, ${meta.config.minimumTagsPerTopic}]]`);\n            meta.config.minimumTagsPerTopic = oldValue;\n        });\n\n        it('should respect maxTags', async () => {\n            const oldValue = meta.config.maximumTagsPerTopic;\n            meta.config.maximumTagsPerTopic = 2;\n            let err;\n            try {\n                await topics.post({ uid: adminUid, tags: ['tag1', 'tag2', 'tag3'], title: 'tag topic', content: 'topic 1 content', cid: topic.categoryId });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, `[[error:too-many-tags, ${meta.config.maximumTagsPerTopic}]]`);\n            meta.config.maximumTagsPerTopic = oldValue;\n        });\n\n        it('should respect minTags per category', async () => {\n            const minTags = 2;\n            await categories.setCategoryField(topic.categoryId, 'minTags', minTags);\n            let err;\n            try {\n                await topics.post({ uid: adminUid, tags: ['tag4'], title: 'tag topic', content: 'topic 1 content', cid: topic.categoryId });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, `[[error:not-enough-tags, ${minTags}]]`);\n            await db.deleteObjectField(`category:${topic.categoryId}`, 'minTags');\n        });\n\n        it('should respect maxTags per category', async () => {\n            const maxTags = 2;\n            await categories.setCategoryField(topic.categoryId, 'maxTags', maxTags);\n            let err;\n            try {\n                await topics.post({ uid: adminUid, tags: ['tag1', 'tag2', 'tag3'], title: 'tag topic', content: 'topic 1 content', cid: topic.categoryId });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.equal(err.message, `[[error:too-many-tags, ${maxTags}]]`);\n            await db.deleteObjectField(`category:${topic.categoryId}`, 'maxTags');\n        });\n\n        it('should create and delete category tags properly', async () => {\n            const category = await categories.create({ name: 'tag category 2' });\n            const { cid } = category;\n            const title = 'test title';\n            const postResult = await topics.post({ uid: adminUid, tags: ['cattag1', 'cattag2', 'cattag3'], title: title, content: 'topic 1 content', cid: cid });\n            await topics.post({ uid: adminUid, tags: ['cattag1', 'cattag2'], title: title, content: 'topic 1 content', cid: cid });\n            await topics.post({ uid: adminUid, tags: ['cattag1'], title: title, content: 'topic 1 content', cid: cid });\n            let result = await topics.getCategoryTagsData(cid, 0, -1);\n            assert.deepStrictEqual(result, [\n                { value: 'cattag1', score: 3, valueEscaped: 'cattag1', valueEncoded: 'cattag1', class: 'cattag1' },\n                { value: 'cattag2', score: 2, valueEscaped: 'cattag2', valueEncoded: 'cattag2', class: 'cattag2' },\n                { value: 'cattag3', score: 1, valueEscaped: 'cattag3', valueEncoded: 'cattag3', class: 'cattag3' },\n            ]);\n\n            // after purging values should update properly\n            await topics.purge(postResult.topicData.tid, adminUid);\n            result = await topics.getCategoryTagsData(cid, 0, -1);\n            assert.deepStrictEqual(result, [\n                { value: 'cattag1', score: 2, valueEscaped: 'cattag1', valueEncoded: 'cattag1', class: 'cattag1' },\n                { value: 'cattag2', score: 1, valueEscaped: 'cattag2', valueEncoded: 'cattag2', class: 'cattag2' },\n            ]);\n        });\n\n        it('should update counts correctly if topic is moved between categories', async () => {\n            const category1 = await categories.create({ name: 'tag category 2' });\n            const category2 = await categories.create({ name: 'tag category 2' });\n            const cid1 = category1.cid;\n            const cid2 = category2.cid;\n\n            const title = 'test title';\n            const postResult = await topics.post({ uid: adminUid, tags: ['movedtag1', 'movedtag2'], title: title, content: 'topic 1 content', cid: cid1 });\n\n            await topics.post({ uid: adminUid, tags: ['movedtag1'], title: title, content: 'topic 1 content', cid: cid1 });\n            await topics.post({ uid: adminUid, tags: ['movedtag2'], title: title, content: 'topic 1 content', cid: cid2 });\n\n            let result1 = await topics.getCategoryTagsData(cid1, 0, -1);\n            let result2 = await topics.getCategoryTagsData(cid2, 0, -1);\n            assert.deepStrictEqual(result1, [\n                { value: 'movedtag1', score: 2, valueEscaped: 'movedtag1', valueEncoded: 'movedtag1', class: 'movedtag1' },\n                { value: 'movedtag2', score: 1, valueEscaped: 'movedtag2', valueEncoded: 'movedtag2', class: 'movedtag2' },\n            ]);\n            assert.deepStrictEqual(result2, [\n                { value: 'movedtag2', score: 1, valueEscaped: 'movedtag2', valueEncoded: 'movedtag2', class: 'movedtag2' },\n            ]);\n\n            // after moving values should update properly\n            await topics.tools.move(postResult.topicData.tid, { cid: cid2, uid: adminUid });\n\n            result1 = await topics.getCategoryTagsData(cid1, 0, -1);\n            result2 = await topics.getCategoryTagsData(cid2, 0, -1);\n            assert.deepStrictEqual(result1, [\n                { value: 'movedtag1', score: 1, valueEscaped: 'movedtag1', valueEncoded: 'movedtag1', class: 'movedtag1' },\n            ]);\n            assert.deepStrictEqual(result2, [\n                { value: 'movedtag2', score: 2, valueEscaped: 'movedtag2', valueEncoded: 'movedtag2', class: 'movedtag2' },\n                { value: 'movedtag1', score: 1, valueEscaped: 'movedtag1', valueEncoded: 'movedtag1', class: 'movedtag1' },\n            ]);\n        });\n\n        it('should not allow regular user to use system tags', async () => {\n            const oldValue = meta.config.systemTags;\n            meta.config.systemTags = 'moved,locked';\n            let err;\n            try {\n                await topics.post({\n                    uid: fooUid,\n                    tags: ['locked'],\n                    title: 'i cant use this',\n                    content: 'topic 1 content',\n                    cid: categoryObj.cid,\n                });\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:cant-use-system-tag]]');\n            meta.config.systemTags = oldValue;\n        });\n\n        it('should allow admin user to use system tags', async () => {\n            const oldValue = meta.config.systemTags;\n            meta.config.systemTags = 'moved,locked';\n            const result = await topics.post({\n                uid: adminUid,\n                tags: ['locked'],\n                title: 'I can use this tag',\n                content: 'topic 1 content',\n                cid: categoryObj.cid,\n            });\n            assert.strictEqual(result.topicData.tags[0].value, 'locked');\n            meta.config.systemTags = oldValue;\n        });\n\n        it('should not error if regular user edits topic after admin adds system tags', async () => {\n            const oldValue = meta.config.systemTags;\n            meta.config.systemTags = 'moved,locked';\n            const result = await topics.post({\n                uid: fooUid,\n                tags: ['one', 'two'],\n                title: 'topic with 2 tags',\n                content: 'topic content',\n                cid: categoryObj.cid,\n            });\n            await posts.edit({\n                pid: result.postData.pid,\n                uid: adminUid,\n                content: 'edited content',\n                tags: ['one', 'two', 'moved'],\n            });\n            await posts.edit({\n                pid: result.postData.pid,\n                uid: fooUid,\n                content: 'edited content',\n                tags: ['one', 'moved', 'two'],\n            });\n            const tags = await topics.getTopicTags(result.topicData.tid);\n            assert.deepStrictEqual(tags.sort(), ['moved', 'one', 'two']);\n            meta.config.systemTags = oldValue;\n        });\n    });\n\n    describe('follow/unfollow', () => {\n        const socketTopics = require('../src/socket.io/topics');\n        let tid;\n        let followerUid;\n        before((done) => {\n            User.create({ username: 'follower' }, (err, uid) => {\n                if (err) {\n                    return done(err);\n                }\n                followerUid = uid;\n                topics.post({ uid: adminUid, title: 'topic title', content: 'some content', cid: topic.categoryId }, (err, result) => {\n                    if (err) {\n                        return done(err);\n                    }\n                    tid = result.topicData.tid;\n                    done();\n                });\n            });\n        });\n\n        it('should error if not logged in', async () => {\n            try {\n                await apiTopics.ignore({ uid: 0 }, { tid: tid });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:not-logged-in]]');\n            }\n        });\n\n        it('should filter ignoring uids', async () => {\n            await apiTopics.ignore({ uid: followerUid }, { tid: tid });\n            const uids = await topics.filterIgnoringUids(tid, [adminUid, followerUid]);\n            assert.equal(uids.length, 1);\n            assert.equal(uids[0], adminUid);\n        });\n\n        it('should error with topic that does not exist', async () => {\n            try {\n                await apiTopics.follow({ uid: followerUid }, { tid: -1 });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-topic]]');\n            }\n        });\n\n        it('should follow topic', (done) => {\n            topics.toggleFollow(tid, followerUid, (err, isFollowing) => {\n                assert.ifError(err);\n                assert(isFollowing);\n                socketTopics.isFollowed({ uid: followerUid }, tid, (err, isFollowing) => {\n                    assert.ifError(err);\n                    assert(isFollowing);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('topics search', () => {\n        it('should error with invalid data', async () => {\n            try {\n                await topics.search(null, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should return results', async () => {\n            const plugins = require('../src/plugins');\n            plugins.hooks.register('myTestPlugin', {\n                hook: 'filter:topic.search',\n                method: function (data, callback) {\n                    callback(null, [1, 2, 3]);\n                },\n            });\n            const results = await topics.search(topic.tid, 'test');\n            assert.deepEqual(results, [1, 2, 3]);\n        });\n    });\n\n    it('should check if user is moderator', (done) => {\n        socketTopics.isModerator({ uid: adminUid }, topic.tid, (err, isModerator) => {\n            assert.ifError(err);\n            assert(!isModerator);\n            done();\n        });\n    });\n\n    describe('teasers', () => {\n        let topic1;\n        let topic2;\n        before((done) => {\n            async.series([\n                function (next) {\n                    topics.post({ uid: adminUid, title: 'topic 1', content: 'content 1', cid: categoryObj.cid }, next);\n                },\n                function (next) {\n                    topics.post({ uid: adminUid, title: 'topic 2', content: 'content 2', cid: categoryObj.cid }, next);\n                },\n            ], (err, results) => {\n                assert.ifError(err);\n                topic1 = results[0];\n                topic2 = results[1];\n                done();\n            });\n        });\n\n        after((done) => {\n            meta.config.teaserPost = '';\n            done();\n        });\n\n\n        it('should return empty array if first param is empty', (done) => {\n            topics.getTeasers([], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert.equal(0, teasers.length);\n                done();\n            });\n        });\n\n        it('should get teasers with 2 params', (done) => {\n            topics.getTeasers([topic1.topicData, topic2.topicData], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert.deepEqual([undefined, undefined], teasers);\n                done();\n            });\n        });\n\n        it('should get teasers with first posts', (done) => {\n            meta.config.teaserPost = 'first';\n            topics.getTeasers([topic1.topicData, topic2.topicData], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert.equal(2, teasers.length);\n                assert(teasers[0]);\n                assert(teasers[1]);\n                assert(teasers[0].tid, topic1.topicData.tid);\n                assert(teasers[0].content, 'content 1');\n                assert(teasers[0].user.username, 'admin');\n                done();\n            });\n        });\n\n        it('should get teasers even if one topic is falsy', (done) => {\n            topics.getTeasers([null, topic2.topicData], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert.equal(2, teasers.length);\n                assert.equal(undefined, teasers[0]);\n                assert(teasers[1]);\n                assert(teasers[1].tid, topic2.topicData.tid);\n                assert(teasers[1].content, 'content 2');\n                assert(teasers[1].user.username, 'admin');\n                done();\n            });\n        });\n\n        it('should get teasers with last posts', (done) => {\n            meta.config.teaserPost = 'last-post';\n            topics.reply({ uid: adminUid, content: 'reply 1 content', tid: topic1.topicData.tid }, (err, result) => {\n                assert.ifError(err);\n                topic1.topicData.teaserPid = result.pid;\n                topics.getTeasers([topic1.topicData, topic2.topicData], 1, (err, teasers) => {\n                    assert.ifError(err);\n                    assert(teasers[0]);\n                    assert(teasers[1]);\n                    assert(teasers[0].tid, topic1.topicData.tid);\n                    assert(teasers[0].content, 'reply 1 content');\n                    done();\n                });\n            });\n        });\n\n        it('should get teasers by tids', (done) => {\n            topics.getTeasersByTids([topic2.topicData.tid, topic1.topicData.tid], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert(2, teasers.length);\n                assert.equal(teasers[1].content, 'reply 1 content');\n                done();\n            });\n        });\n\n        it('should return empty array ', (done) => {\n            topics.getTeasersByTids([], 1, (err, teasers) => {\n                assert.ifError(err);\n                assert.equal(0, teasers.length);\n                done();\n            });\n        });\n\n        it('should get teaser by tid', (done) => {\n            topics.getTeaser(topic2.topicData.tid, 1, (err, teaser) => {\n                assert.ifError(err);\n                assert(teaser);\n                assert.equal(teaser.content, 'content 2');\n                done();\n            });\n        });\n\n        it('should not return teaser if user is blocked', (done) => {\n            let blockedUid;\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'blocked' }, next);\n                },\n                function (uid, next) {\n                    blockedUid = uid;\n                    User.blocks.add(uid, adminUid, next);\n                },\n                function (next) {\n                    topics.reply({ uid: blockedUid, content: 'post from blocked user', tid: topic2.topicData.tid }, next);\n                },\n                function (result, next) {\n                    topics.getTeaser(topic2.topicData.tid, adminUid, next);\n                },\n                function (teaser, next) {\n                    assert.equal(teaser.content, 'content 2');\n                    User.blocks.remove(blockedUid, adminUid, next);\n                },\n            ], done);\n        });\n    });\n\n    describe('tag privilege', () => {\n        let uid;\n        let cid;\n        before((done) => {\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'tag_poster' }, next);\n                },\n                function (_uid, next) {\n                    uid = _uid;\n                    categories.create({ name: 'tag category' }, next);\n                },\n                function (categoryObj, next) {\n                    cid = categoryObj.cid;\n                    next();\n                },\n            ], done);\n        });\n\n        it('should fail to post if user does not have tag privilege', (done) => {\n            privileges.categories.rescind(['groups:topics:tag'], cid, 'registered-users', (err) => {\n                assert.ifError(err);\n                topics.post({ uid: uid, cid: cid, tags: ['tag1'], title: 'topic with tags', content: 'some content here' }, (err) => {\n                    assert.equal(err.message, '[[error:no-privileges]]');\n                    done();\n                });\n            });\n        });\n\n        it('should fail to edit if user does not have tag privilege', (done) => {\n            topics.post({ uid: uid, cid: cid, title: 'topic with tags', content: 'some content here' }, (err, result) => {\n                assert.ifError(err);\n                const { pid } = result.postData;\n                posts.edit({ pid: pid, uid: uid, content: 'edited content', tags: ['tag2'] }, (err) => {\n                    assert.equal(err.message, '[[error:no-privileges]]');\n                    done();\n                });\n            });\n        });\n\n        it('should be able to edit topic and add tags if allowed', (done) => {\n            privileges.categories.give(['groups:topics:tag'], cid, 'registered-users', (err) => {\n                assert.ifError(err);\n                topics.post({ uid: uid, cid: cid, tags: ['tag1'], title: 'topic with tags', content: 'some content here' }, (err, result) => {\n                    assert.ifError(err);\n                    posts.edit({ pid: result.postData.pid, uid: uid, content: 'edited content', tags: ['tag1', 'tag2'] }, (err, result) => {\n                        assert.ifError(err);\n                        const tags = result.topic.tags.map(tag => tag.value);\n                        assert(tags.includes('tag1'));\n                        assert(tags.includes('tag2'));\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    describe('topic merge', () => {\n        let uid;\n        let topic1Data;\n        let topic2Data;\n\n        async function getTopic(tid) {\n            const topicData = await topics.getTopicData(tid);\n            return await topics.getTopicWithPosts(topicData, `tid:${topicData.tid}:posts`, adminUid, 0, 19, false);\n        }\n\n        before((done) => {\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'mergevictim' }, next);\n                },\n                function (_uid, next) {\n                    uid = _uid;\n                    topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 1', content: 'topic 1 OP' }, next);\n                },\n                function (result, next) {\n                    topic1Data = result.topicData;\n                    topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 2', content: 'topic 2 OP' }, next);\n                },\n                function (result, next) {\n                    topic2Data = result.topicData;\n                    topics.reply({ uid: uid, content: 'topic 1 reply', tid: topic1Data.tid }, next);\n                },\n                function (postData, next) {\n                    topics.reply({ uid: uid, content: 'topic 2 reply', tid: topic2Data.tid }, next);\n                },\n            ], done);\n        });\n\n        it('should error if data is not an array', (done) => {\n            socketTopics.merge({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should error if user does not have privileges', (done) => {\n            socketTopics.merge({ uid: 0 }, { tids: [topic2Data.tid, topic1Data.tid] }, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n\n        it('should merge 2 topics', async () => {\n            await socketTopics.merge({ uid: adminUid }, {\n                tids: [topic2Data.tid, topic1Data.tid],\n            });\n\n            const [topic1, topic2] = await Promise.all([\n                getTopic(topic1Data.tid),\n                getTopic(topic2Data.tid),\n            ]);\n\n            assert.equal(topic1.posts.length, 4);\n            assert.equal(topic2.posts.length, 0);\n            assert.equal(topic2.deleted, true);\n\n            assert.equal(topic1.posts[0].content, 'topic 1 OP');\n            assert.equal(topic1.posts[1].content, 'topic 2 OP');\n            assert.equal(topic1.posts[2].content, 'topic 1 reply');\n            assert.equal(topic1.posts[3].content, 'topic 2 reply');\n            assert.equal(topic1.title, 'topic 1');\n        });\n\n        it('should return properly for merged topic', (done) => {\n            request(`${nconf.get('url')}/api/topic/${topic2Data.slug}`, { jar: adminJar, json: true }, (err, response, body) => {\n                assert.ifError(err);\n                assert.equal(response.statusCode, 200);\n                assert(body);\n                assert.deepStrictEqual(body.posts, []);\n                done();\n            });\n        });\n\n        it('should merge 2 topics with options mainTid', async () => {\n            const topic1Result = await topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 1', content: 'topic 1 OP' });\n            const topic2Result = await topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 2', content: 'topic 2 OP' });\n            await topics.reply({ uid: uid, content: 'topic 1 reply', tid: topic1Result.topicData.tid });\n            await topics.reply({ uid: uid, content: 'topic 2 reply', tid: topic2Result.topicData.tid });\n            await socketTopics.merge({ uid: adminUid }, {\n                tids: [topic2Result.topicData.tid, topic1Result.topicData.tid],\n                options: {\n                    mainTid: topic2Result.topicData.tid,\n                },\n            });\n\n            const [topic1, topic2] = await Promise.all([\n                getTopic(topic1Result.topicData.tid),\n                getTopic(topic2Result.topicData.tid),\n            ]);\n\n            assert.equal(topic1.posts.length, 0);\n            assert.equal(topic2.posts.length, 4);\n            assert.equal(topic1.deleted, true);\n\n            assert.equal(topic2.posts[0].content, 'topic 2 OP');\n            assert.equal(topic2.posts[1].content, 'topic 1 OP');\n            assert.equal(topic2.posts[2].content, 'topic 1 reply');\n            assert.equal(topic2.posts[3].content, 'topic 2 reply');\n            assert.equal(topic2.title, 'topic 2');\n        });\n\n        it('should merge 2 topics with options newTopicTitle', async () => {\n            const topic1Result = await topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 1', content: 'topic 1 OP' });\n            const topic2Result = await topics.post({ uid: uid, cid: categoryObj.cid, title: 'topic 2', content: 'topic 2 OP' });\n            await topics.reply({ uid: uid, content: 'topic 1 reply', tid: topic1Result.topicData.tid });\n            await topics.reply({ uid: uid, content: 'topic 2 reply', tid: topic2Result.topicData.tid });\n            const mergeTid = await socketTopics.merge({ uid: adminUid }, {\n                tids: [topic2Result.topicData.tid, topic1Result.topicData.tid],\n                options: {\n                    newTopicTitle: 'new merge topic',\n                },\n            });\n\n            const [topic1, topic2, topic3] = await Promise.all([\n                getTopic(topic1Result.topicData.tid),\n                getTopic(topic2Result.topicData.tid),\n                getTopic(mergeTid),\n            ]);\n\n            assert.equal(topic1.posts.length, 0);\n            assert.equal(topic2.posts.length, 0);\n            assert.equal(topic3.posts.length, 4);\n            assert.equal(topic1.deleted, true);\n            assert.equal(topic2.deleted, true);\n\n            assert.equal(topic3.posts[0].content, 'topic 1 OP');\n            assert.equal(topic3.posts[1].content, 'topic 2 OP');\n            assert.equal(topic3.posts[2].content, 'topic 1 reply');\n            assert.equal(topic3.posts[3].content, 'topic 2 reply');\n            assert.equal(topic3.title, 'new merge topic');\n        });\n    });\n\n    describe('sorted topics', () => {\n        let category;\n        before(async () => {\n            category = await categories.create({ name: 'sorted' });\n            const topic1Result = await topics.post({ uid: topic.userId, cid: category.cid, title: 'old replied', content: 'topic 1 OP' });\n            const topic2Result = await topics.post({ uid: topic.userId, cid: category.cid, title: 'most recent replied', content: 'topic 2 OP' });\n            await topics.reply({ uid: topic.userId, content: 'topic 1 reply', tid: topic1Result.topicData.tid });\n            await topics.reply({ uid: topic.userId, content: 'topic 2 reply', tid: topic2Result.topicData.tid });\n        });\n\n        it('should get sorted topics in category', (done) => {\n            const filters = ['', 'watched', 'unreplied', 'new'];\n            async.map(filters, (filter, next) => {\n                topics.getSortedTopics({\n                    cids: [category.cid],\n                    uid: topic.userId,\n                    start: 0,\n                    stop: -1,\n                    filter: filter,\n                    sort: 'votes',\n                }, next);\n            }, (err, data) => {\n                assert.ifError(err);\n                assert(data);\n                data.forEach((filterTopics) => {\n                    assert(Array.isArray(filterTopics.topics));\n                });\n                done();\n            });\n        });\n        it('should get topics recent replied first', async () => {\n            const data = await topics.getSortedTopics({\n                cids: [category.cid],\n                uid: topic.userId,\n                start: 0,\n                stop: -1,\n                sort: 'recent',\n            });\n            assert.strictEqual(data.topics[0].title, 'most recent replied');\n            assert.strictEqual(data.topics[1].title, 'old replied');\n        });\n\n        it('should get topics recent replied last', async () => {\n            const data = await topics.getSortedTopics({\n                cids: [category.cid],\n                uid: topic.userId,\n                start: 0,\n                stop: -1,\n                sort: 'old',\n            });\n            assert.strictEqual(data.topics[0].title, 'old replied');\n            assert.strictEqual(data.topics[1].title, 'most recent replied');\n        });\n    });\n\n    describe('scheduled topics', () => {\n        let categoryObj;\n        let topicData;\n        let topic;\n        let adminApiOpts;\n        let postData;\n        const replyData = {\n            form: {\n                content: 'a reply by guest',\n            },\n            json: true,\n        };\n\n        before(async () => {\n            adminApiOpts = {\n                json: true,\n                jar: adminJar,\n                headers: {\n                    'x-csrf-token': csrf_token,\n                },\n            };\n            categoryObj = await categories.create({\n                name: 'Another Test Category',\n                description: 'Another test category created by testing script',\n            });\n            topic = {\n                uid: adminUid,\n                cid: categoryObj.cid,\n                title: 'Scheduled Test Topic Title',\n                content: 'The content of scheduled test topic',\n                timestamp: new Date(Date.now() + 86400000).getTime(),\n            };\n        });\n\n        it('should create a scheduled topic as pinned, deleted, included in \"topics:scheduled\" zset and with a timestamp in future', async () => {\n            topicData = (await topics.post(topic)).topicData;\n            topicData = await topics.getTopicData(topicData.tid);\n\n            assert(topicData.pinned);\n            assert(topicData.deleted);\n            assert(topicData.scheduled);\n            assert(topicData.timestamp > Date.now());\n            const score = await db.sortedSetScore('topics:scheduled', topicData.tid);\n            assert(score);\n            // should not be in regular category zsets\n            const isMember = await db.isMemberOfSortedSets([\n                `cid:${categoryObj.cid}:tids`,\n                `cid:${categoryObj.cid}:tids:votes`,\n                `cid:${categoryObj.cid}:tids:posts`,\n            ], topicData.tid);\n            assert.deepStrictEqual(isMember, [false, false, false]);\n        });\n\n        it('should update poster\\'s lastposttime with \"action time\"', async () => {\n            // src/user/posts.js:56\n            const data = await User.getUsersFields([adminUid], ['lastposttime']);\n            assert.notStrictEqual(data[0].lastposttime, topicData.lastposttime);\n        });\n\n        it('should not load topic for an unprivileged user', async () => {\n            const response = await requestType('get', `${nconf.get('url')}/topic/${topicData.slug}`);\n            assert.strictEqual(response.statusCode, 404);\n            assert(response.body);\n        });\n\n        it('should load topic for a privileged user', async () => {\n            const response = (await requestType('get', `${nconf.get('url')}/topic/${topicData.slug}`, { jar: adminJar })).res;\n            assert.strictEqual(response.statusCode, 200);\n            assert(response.body);\n        });\n\n        it('should not be amongst topics of the category for an unprivileged user', async () => {\n            const response = await requestType('get', `${nconf.get('url')}/api/category/${categoryObj.slug}`, { json: true });\n            assert.strictEqual(response.body.topics.filter(topic => topic.tid === topicData.tid).length, 0);\n        });\n\n        it('should be amongst topics of the category for a privileged user', async () => {\n            const response = await requestType('get', `${nconf.get('url')}/api/category/${categoryObj.slug}`, { json: true, jar: adminJar });\n            const topic = response.body.topics.filter(topic => topic.tid === topicData.tid)[0];\n            assert.strictEqual(topic && topic.tid, topicData.tid);\n        });\n\n        it('should load topic for guests if privilege is given', async () => {\n            await privileges.categories.give(['groups:topics:schedule'], categoryObj.cid, 'guests');\n            const response = await requestType('get', `${nconf.get('url')}/topic/${topicData.slug}`);\n            assert.strictEqual(response.statusCode, 200);\n            assert(response.body);\n        });\n\n        it('should be amongst topics of the category for guests if privilege is given', async () => {\n            const response = await requestType('get', `${nconf.get('url')}/api/category/${categoryObj.slug}`, { json: true });\n            const topic = response.body.topics.filter(topic => topic.tid === topicData.tid)[0];\n            assert.strictEqual(topic && topic.tid, topicData.tid);\n        });\n\n        it('should not allow deletion of a scheduled topic', async () => {\n            const response = await requestType('delete', `${nconf.get('url')}/api/v3/topics/${topicData.tid}/state`, adminApiOpts);\n            assert.strictEqual(response.res.statusCode, 400);\n        });\n\n        it('should not allow to unpin a scheduled topic', async () => {\n            const response = await requestType('delete', `${nconf.get('url')}/api/v3/topics/${topicData.tid}/pin`, adminApiOpts);\n            assert.strictEqual(response.res.statusCode, 400);\n        });\n\n        it('should not allow to restore a scheduled topic', async () => {\n            const response = await requestType('put', `${nconf.get('url')}/api/v3/topics/${topicData.tid}/state`, adminApiOpts);\n            assert.strictEqual(response.res.statusCode, 400);\n        });\n\n        it('should not allow unprivileged to reply', async () => {\n            await privileges.categories.rescind(['groups:topics:schedule'], categoryObj.cid, 'guests');\n            await privileges.categories.give(['groups:topics:reply'], categoryObj.cid, 'guests');\n            const response = await requestType('post', `${nconf.get('url')}/api/v3/topics/${topicData.tid}`, replyData);\n            assert.strictEqual(response.res.statusCode, 403);\n        });\n\n        it('should allow guests to reply if privilege is given', async () => {\n            await privileges.categories.give(['groups:topics:schedule'], categoryObj.cid, 'guests');\n            const response = await helpers.request('post', `/api/v3/topics/${topicData.tid}`, {\n                ...replyData,\n                jar: request.jar(),\n            });\n            assert.strictEqual(response.body.response.content, 'a reply by guest');\n            assert.strictEqual(response.body.response.user.username, '[[global:guest]]');\n        });\n\n        it('should have replies with greater timestamp than the scheduled topics itself', async () => {\n            const response = await requestType('get', `${nconf.get('url')}/api/topic/${topicData.slug}`, { json: true });\n            postData = response.body.posts[1];\n            assert(postData.timestamp > response.body.posts[0].timestamp);\n        });\n\n        it('should have post edits with greater timestamp than the original', async () => {\n            const editData = { ...adminApiOpts, form: { content: 'an edit by the admin' } };\n            const result = await requestType('put', `${nconf.get('url')}/api/v3/posts/${postData.pid}`, editData);\n            assert(result.body.response.edited > postData.timestamp);\n\n            const diffsResult = await requestType('get', `${nconf.get('url')}/api/v3/posts/${postData.pid}/diffs`, adminApiOpts);\n            const { revisions } = diffsResult.body.response;\n            // diffs are LIFO\n            assert(revisions[0].timestamp > revisions[1].timestamp);\n        });\n\n        it('should able to reschedule', async () => {\n            const newDate = new Date(Date.now() + (5 * 86400000)).getTime();\n            const editData = { ...adminApiOpts, form: { ...topic, pid: topicData.mainPid, timestamp: newDate } };\n            const response = await requestType('put', `${nconf.get('url')}/api/v3/posts/${topicData.mainPid}`, editData);\n\n            const editedTopic = await topics.getTopicFields(topicData.tid, ['lastposttime', 'timestamp']);\n            const editedPost = await posts.getPostFields(postData.pid, ['timestamp']);\n            assert(editedTopic.timestamp === newDate);\n            assert(editedPost.timestamp > editedTopic.timestamp);\n\n            const scores = await db.sortedSetsScore([\n                'topics:scheduled',\n                `uid:${adminUid}:topics`,\n                'topics:tid',\n                `cid:${topicData.cid}:uid:${adminUid}:tids`,\n            ], topicData.tid);\n            assert(scores.every(publishTime => publishTime === editedTopic.timestamp));\n        });\n\n        it('should able to publish a scheduled topic', async () => {\n            const topicTimestamp = await topics.getTopicField(topicData.tid, 'timestamp');\n\n            mockdate.set(topicTimestamp);\n            await topics.scheduled.handleExpired();\n\n            topicData = await topics.getTopicData(topicData.tid);\n            assert(!topicData.pinned);\n            assert(!topicData.deleted);\n            // Should remove from topics:scheduled upon publishing\n            const score = await db.sortedSetScore('topics:scheduled', topicData.tid);\n            assert(!score);\n        });\n\n        it('should update poster\\'s lastposttime after a ST published', async () => {\n            const data = await User.getUsersFields([adminUid], ['lastposttime']);\n            assert.strictEqual(adminUid, topicData.uid);\n            assert.strictEqual(data[0].lastposttime, topicData.lastposttime);\n        });\n\n        it('should not be able to schedule a \"published\" topic', async () => {\n            const newDate = new Date(Date.now() + 86400000).getTime();\n            const editData = { ...adminApiOpts, form: { ...topic, pid: topicData.mainPid, timestamp: newDate } };\n            const response = await requestType('put', `${nconf.get('url')}/api/v3/posts/${topicData.mainPid}`, editData);\n            assert.strictEqual(response.body.response.timestamp, Date.now());\n\n            mockdate.reset();\n        });\n\n        it('should allow to purge a scheduled topic', async () => {\n            topicData = (await topics.post(topic)).topicData;\n            const response = await requestType('delete', `${nconf.get('url')}/api/v3/topics/${topicData.tid}`, adminApiOpts);\n            assert.strictEqual(response.res.statusCode, 200);\n        });\n\n        it('should remove from topics:scheduled on purge', async () => {\n            const score = await db.sortedSetScore('topics:scheduled', topicData.tid);\n            assert(!score);\n        });\n    });\n});\n\ndescribe('Topics\\'', async () => {\n    let files;\n\n    before(async () => {\n        files = await file.walk(path.resolve(__dirname, './topics'));\n    });\n\n    it('subfolder tests', () => {\n        files.forEach((filePath) => {\n            require(filePath);\n        });\n    });\n});\n"},"test/translator.js":{"tests":[{"id":"2095","name":"Translator shim .translate() should translate correctly"},{"id":"2096","name":"Translator shim .translate() should accept a language parameter and adjust accordingly"},{"id":"2097","name":"Translator shim .translate() should translate empty string properly"},{"id":"2098","name":"Translator shim .translate() should not allow path traversal"},{"id":"2099","name":"new Translator(language) should throw if not passed a language"},{"id":"2100","name":"new Translator(language) .translate() should handle basic translations"},{"id":"2101","name":"new Translator(language) .translate() should handle language keys in regular text"},{"id":"2102","name":"new Translator(language) .translate() should handle language keys in regular text with another language specified"},{"id":"2103","name":"new Translator(language) .translate() should handle language keys with parameters"},{"id":"2104","name":"new Translator(language) .translate() should handle language keys inside language keys"},{"id":"2105","name":"new Translator(language) .translate() should handle language keys inside language keys with multiple parameters"},{"id":"2106","name":"new Translator(language) .translate() should handle language keys inside language keys with all parameters as language keys"},{"id":"2107","name":"new Translator(language) .translate() should properly handle parameters that contain square brackets"},{"id":"2108","name":"new Translator(language) .translate() should properly handle parameters that contain parentheses"},{"id":"2109","name":"new Translator(language) .translate() should escape language key parameters with HTML in them"},{"id":"2110","name":"new Translator(language) .translate() should not unescape html in parameters"},{"id":"2111","name":"new Translator(language) .translate() should translate escaped translation arguments properly"},{"id":"2112","name":"new Translator(language) .translate() should properly escape and ignore % and \\, in arguments"},{"id":"2113","name":"new Translator(language) .translate() should not escape regular %"},{"id":"2114","name":"new Translator(language) .translate() should not translate [[derp] some text"},{"id":"2115","name":"new Translator(language) .translate() should not translate [[derp]] some text"},{"id":"2116","name":"new Translator(language) .translate() should not translate [[derp:xyz] some text"},{"id":"2117","name":"new Translator(language) .translate() should translate keys with slashes properly"},{"id":"2118","name":"new Translator(language) .translate() should use key for unknown keys without arguments"},{"id":"2119","name":"new Translator(language) .translate() should use backup for unknown keys with arguments"},{"id":"2120","name":"new Translator(language) .translate() should ignore unclosed tokens"},{"id":"2121","name":"Translator.create() should return an instance of Translator"},{"id":"2122","name":"Translator.create() should return the same object for the same language"},{"id":"2123","name":"Translator.create() should default to defaultLang"},{"id":"2124","name":"Translator modules should work before registered"},{"id":"2125","name":"Translator modules should work after registered"},{"id":"2126","name":"Translator modules registerModule be passed the language"},{"id":"2127","name":"Translator static methods .removePatterns should remove translator patterns from text"},{"id":"2128","name":"Translator static methods .escape should escape translation patterns within text"},{"id":"2129","name":"Translator static methods .unescape should unescape escaped translation patterns within text"},{"id":"2130","name":"Translator static methods .compile should create a translator pattern from a key and list of arguments"},{"id":"2131","name":"Translator static methods .compile should escape `%` and `,` in arguments"},{"id":"2132","name":"Translator static methods add translation should add custom translations"},{"id":"2133","name":"Translator static methods translate nested keys should handle nested translations"},{"id":"2134","name":"Translator static methods translate nested keys should try the defaults if it didn't reach a string in a nested translation"}],"source":"'use strict';\n\n// For tests relating to Transifex configuration, check i18n.js\n\nconst assert = require('assert');\nconst shim = require('../src/translator');\n\nconst { Translator } = shim;\nconst db = require('./mocks/databasemock');\n\ndescribe('Translator shim', () => {\n    describe('.translate()', () => {\n        it('should translate correctly', (done) => {\n            shim.translate('[[global:pagination.out_of, (foobar), [[global:home]]]]', (translated) => {\n                assert.strictEqual(translated, '(foobar) out of Home');\n                done();\n            });\n        });\n\n        it('should accept a language parameter and adjust accordingly', (done) => {\n            shim.translate('[[global:home]]', 'de', (translated) => {\n                assert.strictEqual(translated, 'Übersicht');\n                done();\n            });\n        });\n\n        it('should translate empty string properly', (done) => {\n            shim.translate('', 'en-GB', (translated) => {\n                assert.strictEqual(translated, '');\n                done();\n            });\n        });\n\n        it('should translate empty string properly', async () => {\n            const translated = await shim.translate('', 'en-GB');\n            assert.strictEqual(translated, '');\n        });\n\n        it('should not allow path traversal', async () => {\n            const t = await shim.translate('[[../../../../config:secret]]');\n            assert.strictEqual(t, 'secret');\n        });\n    });\n});\n\ndescribe('new Translator(language)', () => {\n    it('should throw if not passed a language', (done) => {\n        assert.throws(() => {\n            new Translator();\n        }, /language string/);\n        done();\n    });\n\n    describe('.translate()', () => {\n        it('should handle basic translations', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[global:home]]').then((translated) => {\n                assert.strictEqual(translated, 'Home');\n            });\n        });\n\n        it('should handle language keys in regular text', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('Let\\'s go [[global:home]]').then((translated) => {\n                assert.strictEqual(translated, 'Let\\'s go Home');\n            });\n        });\n\n        it('should handle language keys in regular text with another language specified', () => {\n            const translator = Translator.create('de');\n\n            return translator.translate('[[global:home]] test').then((translated) => {\n                assert.strictEqual(translated, 'Übersicht test');\n            });\n        });\n\n        it('should handle language keys with parameters', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[global:pagination.out_of, 1, 5]]').then((translated) => {\n                assert.strictEqual(translated, '1 out of 5');\n            });\n        });\n\n        it('should handle language keys inside language keys', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[notifications:outgoing_link_message, [[global:guest]]]]').then((translated) => {\n                assert.strictEqual(translated, 'You are now leaving Guest');\n            });\n        });\n\n        it('should handle language keys inside language keys with multiple parameters', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[notifications:user_posted_to, [[global:guest]], My Topic]]').then((translated) => {\n                assert.strictEqual(translated, '<"+"strong>Guest<"+"/strong> has posted a reply to: <"+"strong>My Topic<"+"/strong>');\n            });\n        });\n\n        it('should handle language keys inside language keys with all parameters as language keys', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[notifications:user_posted_to, [[global:guest]], [[global:guest]]]]').then((translated) => {\n                assert.strictEqual(translated, '<"+"strong>Guest<"+"/strong> has posted a reply to: <"+"strong>Guest<"+"/strong>');\n            });\n        });\n\n        it('should properly handle parameters that contain square brackets', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[global:pagination.out_of, [guest], [[global:home]]]]').then((translated) => {\n                assert.strictEqual(translated, '[guest] out of Home');\n            });\n        });\n\n        it('should properly handle parameters that contain parentheses', () => {\n            const translator = Translator.create('en-GB');\n\n            return translator.translate('[[global:pagination.out_of, (foobar), [[global:home]]]]').then((translated) => {\n                assert.strictEqual(translated, '(foobar) out of Home');\n            });\n        });\n\n        it('should escape language key parameters with HTML in them', () => {\n            const translator = Translator.create('en-GB');\n\n            const key = '[[global:403.login, <"+"strong>test<"+"/strong>]]';\n            return translator.translate(key).then((translated) => {\n                assert.strictEqual(translated, 'Perhaps you should <"+"a href=\\'&lt;strong&gt;test&lt;/strong&gt;/login\\'>try logging in<"+"/a>?');\n            });\n        });\n\n        it('should not unescape html in parameters', () => {\n            const translator = Translator.create('en-GB');\n\n            const key = '[[pages:tag, some&amp;tag]]';\n            return translator.translate(key).then((translated) => {\n                assert.strictEqual(translated, 'Topics tagged under &quot;some&amp;tag&quot;');\n            });\n        });\n\n        it('should translate escaped translation arguments properly', () => {\n            // https://github.com/NodeBB/NodeBB/issues/9206\n            const translator = Translator.create('en-GB');\n\n            const key = '[[notifications:upvoted_your_post_in, test1, error: Error: &lsqb;&lsqb;error:group-name-too-long&rsqb;&rsqb; on NodeBB Upgrade]]';\n            return translator.translate(key).then((translated) => {\n                assert.strictEqual(translated, '<"+"strong>test1<"+"/strong> has upvoted your post in <"+"strong>error: Error: &lsqb;&lsqb;error:group-name-too-long&rsqb;&rsqb; on NodeBB Upgrade<"+"/strong>.');\n            });\n        });\n\n        it('should properly escape and ignore % and \\\\, in arguments', () => {\n            const translator = Translator.create('en-GB');\n\n            const title = 'Test 1\\\\, 2\\\\, 3 %2 salmon';\n            const key = `[[topic:composer.replying_to, ${title}]]`;\n            return translator.translate(key).then((translated) => {\n                assert.strictEqual(translated, 'Replying to Test 1&#44; 2&#44; 3 &#37;2 salmon');\n            });\n        });\n\n        it('should not escape regular %', () => {\n            const translator = Translator.create('en-GB');\n\n            const title = '3 % salmon';\n            const key = `[[topic:composer.replying_to, ${title}]]`;\n            return translator.translate(key).then((translated) => {\n                assert.strictEqual(translated, 'Replying to 3 % salmon');\n            });\n        });\n\n        it('should not translate [[derp] some text', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[derp] some text').then((translated) => {\n                assert.strictEqual('[[derp] some text', translated);\n            });\n        });\n\n        it('should not translate [[derp]] some text', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[derp]] some text').then((translated) => {\n                assert.strictEqual('[[derp]] some text', translated);\n            });\n        });\n\n        it('should not translate [[derp:xyz] some text', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[derp:xyz] some text').then((translated) => {\n                assert.strictEqual('[[derp:xyz] some text', translated);\n            });\n        });\n\n        it('should translate keys with slashes properly', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[pages:users/latest]]').then((translated) => {\n                assert.strictEqual(translated, 'Latest Users');\n            });\n        });\n\n        it('should use key for unknown keys without arguments', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[unknown:key.without.args]]').then((translated) => {\n                assert.strictEqual(translated, 'key.without.args');\n            });\n        });\n\n        it('should use backup for unknown keys with arguments', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('[[unknown:key.with.args, arguments are here, derpity, derp]]').then((translated) => {\n                assert.strictEqual(translated, 'unknown:key.with.args, arguments are here, derpity, derp');\n            });\n        });\n\n        it('should ignore unclosed tokens', () => {\n            const translator = Translator.create('en-GB');\n            return translator.translate('here is some stuff and other things [[abc:xyz, other random stuff should be fine here [[global:home]] and more things [[pages:users/latest]]').then((translated) => {\n                assert.strictEqual(translated, 'here is some stuff and other things abc:xyz, other random stuff should be fine here Home and more things Latest Users');\n            });\n        });\n    });\n});\n\ndescribe('Translator.create()', () => {\n    it('should return an instance of Translator', (done) => {\n        const translator = Translator.create('en-GB');\n\n        assert(translator instanceof Translator);\n        done();\n    });\n    it('should return the same object for the same language', (done) => {\n        const one = Translator.create('de');\n        const two = Translator.create('de');\n\n        assert.strictEqual(one, two);\n        done();\n    });\n    it('should default to defaultLang', (done) => {\n        const translator = Translator.create();\n\n        assert.strictEqual(translator.lang, 'en-GB');\n        done();\n    });\n});\n\ndescribe('Translator modules', () => {\n    it('should work before registered', () => {\n        const translator = Translator.create();\n\n        Translator.registerModule('test-custom-integer-format', lang => function (key, args) {\n            const num = parseInt(args[0], 10) || 0;\n            if (key === 'binary') {\n                return num.toString(2);\n            }\n            if (key === 'hex') {\n                return num.toString(16);\n            }\n            if (key === 'octal') {\n                return num.toString(8);\n            }\n            return num.toString();\n        });\n\n        return translator.translate('[[test-custom-integer-format:octal, 24]]').then((translation) => {\n            assert.strictEqual(translation, '30');\n        });\n    });\n\n    it('should work after registered', () => {\n        const translator = Translator.create('de');\n\n        return translator.translate('[[test-custom-integer-format:octal, 23]]').then((translation) => {\n            assert.strictEqual(translation, '27');\n        });\n    });\n\n    it('registerModule be passed the language', (done) => {\n        Translator.registerModule('something', (lang) => {\n            assert.ok(lang);\n        });\n\n        const translator = Translator.create('fr_FR');\n        done();\n    });\n});\n\ndescribe('Translator static methods', () => {\n    describe('.removePatterns', () => {\n        it('should remove translator patterns from text', (done) => {\n            assert.strictEqual(\n                Translator.removePatterns('Lorem ipsum dolor [[sit:amet]], consectetur adipiscing elit. [[sed:vitae, [[semper:dolor]]]] lorem'),\n                'Lorem ipsum dolor , consectetur adipiscing elit.  lorem'\n            );\n            done();\n        });\n    });\n    describe('.escape', () => {\n        it('should escape translation patterns within text', (done) => {\n            assert.strictEqual(\n                Translator.escape('some nice text [[global:home]] here'),\n                'some nice text &lsqb;&lsqb;global:home&rsqb;&rsqb; here'\n            );\n            done();\n        });\n    });\n\n    describe('.unescape', () => {\n        it('should unescape escaped translation patterns within text', (done) => {\n            assert.strictEqual(\n                Translator.unescape('some nice text \\\\[\\\\[global:home\\\\]\\\\] here'),\n                'some nice text [[global:home]] here'\n            );\n            assert.strictEqual(\n                Translator.unescape('some nice text &lsqb;&lsqb;global:home&rsqb;&rsqb; here'),\n                'some nice text [[global:home]] here'\n            );\n            done();\n        });\n    });\n\n    describe('.compile', () => {\n        it('should create a translator pattern from a key and list of arguments', (done) => {\n            assert.strictEqual(\n                Translator.compile('amazing:cool', 'awesome', 'great'),\n                '[[amazing:cool, awesome, great]]'\n            );\n            done();\n        });\n\n        it('should escape `%` and `,` in arguments', (done) => {\n            assert.strictEqual(\n                Translator.compile('amazing:cool', '100% awesome!', 'one, two, and three'),\n                '[[amazing:cool, 100&#37; awesome!, one&#44; two&#44; and three]]'\n            );\n            done();\n        });\n    });\n\n    describe('add translation', () => {\n        it('should add custom translations', async () => {\n            shim.addTranslation('en-GB', 'my-namespace', { foo: 'a custom translation' });\n            const t = await shim.translate('this is best [[my-namespace:foo]]');\n            assert.strictEqual(t, 'this is best a custom translation');\n        });\n    });\n\n    describe('translate nested keys', () => {\n        it('should handle nested translations', async () => {\n            shim.addTranslation('en-GB', 'my-namespace', {\n                key: {\n                    key1: 'key1 translated',\n                    key2: {\n                        key3: 'key3 translated',\n                    },\n                },\n            });\n            const t1 = await shim.translate('this is best [[my-namespace:key.key1]]');\n            const t2 = await shim.translate('this is best [[my-namespace:key.key2.key3]]');\n            assert.strictEqual(t1, 'this is best key1 translated');\n            assert.strictEqual(t2, 'this is best key3 translated');\n        });\n        it(\"should try the defaults if it didn't reach a string in a nested translation\", async () => {\n            shim.addTranslation('en-GB', 'my-namespace', {\n                default1: {\n                    default1: 'default1 translated',\n                    '': 'incorrect priority',\n                },\n                default2: {\n                    '': 'default2 translated',\n                },\n            });\n            const d1 = await shim.translate('this is best [[my-namespace:default1]]');\n            const d2 = await shim.translate('this is best [[my-namespace:default2]]');\n            assert.strictEqual(d1, 'this is best default1 translated');\n            assert.strictEqual(d2, 'this is best default2 translated');\n        });\n    });\n});\n"},"test/uploads.js":{"tests":[{"id":"2135","name":"Upload Controllers regular user uploads rate limits should fail if the user exceeds the upload rate limit threshold"},{"id":"2136","name":"Upload Controllers regular user uploads should upload an image to a post"},{"id":"2137","name":"Upload Controllers regular user uploads should upload an image to a post and then delete the upload"},{"id":"2138","name":"Upload Controllers regular user uploads should not allow deleting if path is not correct"},{"id":"2139","name":"Upload Controllers regular user uploads should resize and upload an image to a post"},{"id":"2140","name":"Upload Controllers regular user uploads should upload a file to a post"},{"id":"2141","name":"Upload Controllers regular user uploads should fail to upload image to post if image dimensions are too big"},{"id":"2142","name":"Upload Controllers regular user uploads should fail to upload image to post if image is broken"},{"id":"2143","name":"Upload Controllers regular user uploads should fail if file is not an image"},{"id":"2144","name":"Upload Controllers regular user uploads should fail if file is missing"},{"id":"2145","name":"Upload Controllers regular user uploads should not allow non image uploads"},{"id":"2146","name":"Upload Controllers regular user uploads should not allow svg uploads"},{"id":"2147","name":"Upload Controllers regular user uploads should delete users uploads if account is deleted"},{"id":"2148","name":"Upload Controllers admin uploads should upload site logo"},{"id":"2149","name":"Upload Controllers admin uploads should fail to upload invalid file type"},{"id":"2150","name":"Upload Controllers admin uploads should fail to upload category image with invalid json params"},{"id":"2151","name":"Upload Controllers admin uploads should upload category image"},{"id":"2152","name":"Upload Controllers admin uploads should upload default avatar"},{"id":"2153","name":"Upload Controllers admin uploads should upload og image"},{"id":"2154","name":"Upload Controllers admin uploads should upload favicon"},{"id":"2155","name":"Upload Controllers admin uploads should upload touch icon"},{"id":"2156","name":"Upload Controllers admin uploads should upload regular file"},{"id":"2157","name":"Upload Controllers admin uploads should fail to upload regular file in wrong directory"},{"id":"2158","name":"Upload Controllers admin uploads ACP uploads screen should create a folder"},{"id":"2159","name":"Upload Controllers admin uploads ACP uploads screen should fail to create a folder if it already exists"},{"id":"2160","name":"Upload Controllers admin uploads ACP uploads screen should fail to create a folder as a non-admin"},{"id":"2161","name":"Upload Controllers admin uploads ACP uploads screen should fail to create a folder in wrong directory"},{"id":"2162","name":"Upload Controllers admin uploads ACP uploads screen should use basename of given folderName to create new folder"},{"id":"2163","name":"Upload Controllers admin uploads ACP uploads screen should fail to delete a file as a non-admin"},{"id":"2164","name":"Upload Controllers library methods .getOrphans() should return files with no post associated with them"},{"id":"2165","name":"Upload Controllers library methods .cleanOrphans() should not touch orphans if not configured to do so"},{"id":"2166","name":"Upload Controllers library methods .cleanOrphans() should not touch orphans if they are newer than the configured expiry"},{"id":"2167","name":"Upload Controllers library methods .cleanOrphans() should delete orphans older than the configured number of days"}],"source":"'use strict';\n\nconst async = require('async');\nconst assert = require('assert');\nconst nconf = require('nconf');\nconst path = require('path');\nconst fs = require('fs').promises;\nconst request = require('request');\nconst requestAsync = require('request-promise-native');\nconst util = require('util');\n\nconst db = require('./mocks/databasemock');\nconst categories = require('../src/categories');\nconst topics = require('../src/topics');\nconst posts = require('../src/posts');\nconst user = require('../src/user');\nconst groups = require('../src/groups');\nconst privileges = require('../src/privileges');\nconst meta = require('../src/meta');\nconst socketUser = require('../src/socket.io/user');\nconst helpers = require('./helpers');\nconst file = require('../src/file');\nconst image = require('../src/image');\n\nconst emptyUploadsFolder = async () => {\n    const files = await fs.readdir(`${nconf.get('upload_path')}/files`);\n    await Promise.all(files.map(async (filename) => {\n        await file.delete(`${nconf.get('upload_path')}/files/${filename}`);\n    }));\n};\n\ndescribe('Upload Controllers', () => {\n    let tid;\n    let cid;\n    let pid;\n    let adminUid;\n    let regularUid;\n    let maliciousUid;\n\n    before((done) => {\n        async.series({\n            category: function (next) {\n                categories.create({\n                    name: 'Test Category',\n                    description: 'Test category created by testing script',\n                }, next);\n            },\n            adminUid: function (next) {\n                user.create({ username: 'admin', password: 'barbar' }, next);\n            },\n            regularUid: function (next) {\n                user.create({ username: 'regular', password: 'zugzug' }, next);\n            },\n            maliciousUid: function (next) {\n                user.create({ username: 'malicioususer', password: 'herpderp' }, next);\n            },\n        }, (err, results) => {\n            if (err) {\n                return done(err);\n            }\n            adminUid = results.adminUid;\n            regularUid = results.regularUid;\n            maliciousUid = results.maliciousUid;\n            cid = results.category.cid;\n\n            topics.post({ uid: adminUid, title: 'test topic title', content: 'test topic content', cid: results.category.cid }, (err, result) => {\n                if (err) {\n                    return done(err);\n                }\n                tid = result.topicData.tid;\n                pid = result.postData.pid;\n                groups.join('administrators', adminUid, done);\n            });\n        });\n    });\n\n    describe('regular user uploads rate limits', () => {\n        let jar;\n        let csrf_token;\n\n        before(async () => {\n            ({ jar, csrf_token } = await helpers.loginUser('malicioususer', 'herpderp'));\n            await privileges.global.give(['groups:upload:post:file'], 'registered-users');\n        });\n\n        it('should fail if the user exceeds the upload rate limit threshold', (done) => {\n            const oldValue = meta.config.allowedFileExtensions;\n            meta.config.allowedFileExtensions = 'png,jpg,bmp,html';\n            require('../src/middleware/uploads').clearCache();\n\n            // why / 2? see: helpers.uploadFile for a weird quirk where we actually\n            // upload 2 files per upload in our tests.\n            const times = (meta.config.uploadRateLimitThreshold / 2) + 1;\n            async.timesSeries(times, (i, next) => {\n                helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/503.html'), {}, jar, csrf_token, (err, res, body) => {\n                    if (i + 1 >= times) {\n                        assert.strictEqual(res.statusCode, 500);\n                        assert.strictEqual(body.error, '[[error:upload-ratelimit-reached]]');\n                    } else {\n                        assert.ifError(err);\n                        assert.strictEqual(res.statusCode, 200);\n                        assert(body && body.status && body.response && body.response.images);\n                        assert(Array.isArray(body.response.images));\n                        assert(body.response.images[0].url);\n                    }\n\n                    next(err);\n                });\n            }, (err) => {\n                meta.config.allowedFileExtensions = oldValue;\n                assert.ifError(err);\n                done();\n            });\n        });\n    });\n\n    describe('regular user uploads', () => {\n        let jar;\n        let csrf_token;\n\n        before(async () => {\n            meta.config.uploadRateLimitThreshold = 1000;\n            ({ jar, csrf_token } = await helpers.loginUser('regular', 'zugzug'));\n            await privileges.global.give(['groups:upload:post:file'], 'registered-users');\n        });\n\n        it('should upload an image to a post', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body && body.status && body.response && body.response.images);\n                assert(Array.isArray(body.response.images));\n                assert(body.response.images[0].url);\n                done();\n            });\n        });\n\n        it('should upload an image to a post and then delete the upload', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.strictEqual(res.statusCode, 200);\n                assert(body && body.status && body.response && body.response.images);\n                assert(Array.isArray(body.response.images));\n                assert(body.response.images[0].url);\n                const name = body.response.images[0].url.replace(`${nconf.get('relative_path') + nconf.get('upload_url')}/`, '');\n                socketUser.deleteUpload({ uid: regularUid }, { uid: regularUid, name: name }, (err) => {\n                    assert.ifError(err);\n                    db.getSortedSetRange(`uid:${regularUid}:uploads`, 0, -1, (err, uploads) => {\n                        assert.ifError(err);\n                        assert.equal(uploads.includes(name), false);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should not allow deleting if path is not correct', (done) => {\n            socketUser.deleteUpload({ uid: adminUid }, { uid: regularUid, name: '../../bkconfig.json' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-path]]');\n                done();\n            });\n        });\n\n        it('should not allow deleting if path is not correct', (done) => {\n            socketUser.deleteUpload({ uid: adminUid }, { uid: regularUid, name: '/files/../../bkconfig.json' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-path]]');\n                done();\n            });\n        });\n\n        it('should resize and upload an image to a post', (done) => {\n            const oldValue = meta.config.resizeImageWidth;\n            meta.config.resizeImageWidth = 10;\n            meta.config.resizeImageWidthThreshold = 10;\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body && body.status && body.response && body.response.images);\n                assert(Array.isArray(body.response.images));\n                assert(body.response.images[0].url);\n                assert(body.response.images[0].url.match(/\\/assets\\/uploads\\/files\\/\\d+-test-resized\\.png/));\n                meta.config.resizeImageWidth = oldValue;\n                meta.config.resizeImageWidthThreshold = 1520;\n                done();\n            });\n        });\n\n        it('should upload a file to a post', (done) => {\n            const oldValue = meta.config.allowedFileExtensions;\n            meta.config.allowedFileExtensions = 'png,jpg,bmp,html';\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/503.html'), {}, jar, csrf_token, (err, res, body) => {\n                meta.config.allowedFileExtensions = oldValue;\n                assert.ifError(err);\n                assert.strictEqual(res.statusCode, 200);\n                assert(body && body.status && body.response && body.response.images);\n                assert(Array.isArray(body.response.images));\n                assert(body.response.images[0].url);\n                done();\n            });\n        });\n\n        it('should fail to upload image to post if image dimensions are too big', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/toobig.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.strictEqual(res.statusCode, 500);\n                assert(body && body.status && body.status.message);\n                assert.strictEqual(body.status.message, 'Image dimensions are too big');\n                done();\n            });\n        });\n\n        it('should fail to upload image to post if image is broken', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/brokenimage.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.strictEqual(res.statusCode, 500);\n                assert(body && body.status && body.status.message);\n                assert.strictEqual(body.status.message, 'Input file contains unsupported image format');\n                done();\n            });\n        });\n\n        it('should fail if file is not an image', (done) => {\n            image.isFileTypeAllowed(path.join(__dirname, '../test/files/notanimage.png'), (err) => {\n                assert.strictEqual(err.message, 'Input file contains unsupported image format');\n                done();\n            });\n        });\n\n        it('should fail if file is not an image', (done) => {\n            image.isFileTypeAllowed(path.join(__dirname, '../test/files/notanimage.png'), (err) => {\n                assert.strictEqual(err.message, 'Input file contains unsupported image format');\n                done();\n            });\n        });\n\n        it('should fail if file is not an image', (done) => {\n            image.size(path.join(__dirname, '../test/files/notanimage.png'), (err) => {\n                assert.strictEqual(err.message, 'Input file contains unsupported image format');\n                done();\n            });\n        });\n\n        it('should fail if file is missing', (done) => {\n            image.size(path.join(__dirname, '../test/files/doesnotexist.png'), (err) => {\n                assert(err.message.startsWith('Input file is missing'));\n                done();\n            });\n        });\n\n        it('should not allow non image uploads', (done) => {\n            socketUser.updateCover({ uid: 1 }, { uid: 1, file: { path: '../../text.txt' } }, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should not allow non image uploads', (done) => {\n            socketUser.updateCover({ uid: 1 }, { uid: 1, imageData: 'data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        it('should not allow svg uploads', (done) => {\n            socketUser.updateCover({ uid: 1 }, { uid: 1, imageData: 'data:image/svg;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        it('should not allow non image uploads', (done) => {\n            socketUser.uploadCroppedPicture({ uid: 1 }, { uid: 1, file: { path: '../../text.txt' } }, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should not allow non image uploads', (done) => {\n            socketUser.uploadCroppedPicture({ uid: 1 }, { uid: 1, imageData: 'data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        it('should not allow svg uploads', (done) => {\n            socketUser.uploadCroppedPicture({ uid: 1 }, { uid: 1, imageData: 'data:image/svg;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+' }, (err) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        it('should delete users uploads if account is deleted', (done) => {\n            let uid;\n            let url;\n            const file = require('../src/file');\n\n            async.waterfall([\n                function (next) {\n                    user.create({ username: 'uploader', password: 'barbar' }, next);\n                },\n                function (_uid, next) {\n                    uid = _uid;\n                    helpers.loginUser('uploader', 'barbar', next);\n                },\n                function (data, next) {\n                    helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, data.jar, data.csrf_token, next);\n                },\n                function (res, body, next) {\n                    assert(body && body.status && body.response && body.response.images);\n                    assert(Array.isArray(body.response.images));\n                    assert(body.response.images[0].url);\n                    url = body.response.images[0].url;\n\n                    user.delete(1, uid, next);\n                },\n                function (userData, next) {\n                    const filePath = path.join(nconf.get('upload_path'), url.replace('/assets/uploads', ''));\n                    file.exists(filePath, next);\n                },\n                function (exists, next) {\n                    assert(!exists);\n                    done();\n                },\n            ], done);\n        });\n\n        after(emptyUploadsFolder);\n    });\n\n    describe('admin uploads', () => {\n        let jar;\n        let csrf_token;\n        let regularJar;\n        let regular_csrf_token;\n\n        before(async () => {\n            ({ jar, csrf_token } = await helpers.loginUser('admin', 'barbar'));\n            const regularLogin = await helpers.loginUser('regular', 'zugzug');\n            regularJar = regularLogin.jar;\n            regular_csrf_token = regularLogin.csrf_token;\n        });\n\n        it('should upload site logo', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/uploadlogo`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(Array.isArray(body));\n                assert.equal(body[0].url, `${nconf.get('relative_path')}/assets/uploads/system/site-logo.png`);\n                done();\n            });\n        });\n\n        it('should fail to upload invalid file type', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/category/uploadpicture`, path.join(__dirname, '../test/files/503.html'), { params: JSON.stringify({ cid: cid }) }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(body.error, '[[error:invalid-image-type, image/png&#44; image/jpeg&#44; image/pjpeg&#44; image/jpg&#44; image/gif&#44; image/svg+xml]]');\n                done();\n            });\n        });\n\n        it('should fail to upload category image with invalid json params', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/category/uploadpicture`, path.join(__dirname, '../test/files/test.png'), { params: 'invalid json' }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(body.error, '[[error:invalid-json]]');\n                done();\n            });\n        });\n\n        it('should upload category image', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/category/uploadpicture`, path.join(__dirname, '../test/files/test.png'), { params: JSON.stringify({ cid: cid }) }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(Array.isArray(body));\n                assert.equal(body[0].url, `${nconf.get('relative_path')}/assets/uploads/category/category-1.png`);\n                done();\n            });\n        });\n\n        it('should upload default avatar', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/uploadDefaultAvatar`, path.join(__dirname, '../test/files/test.png'), { }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert.equal(body[0].url, `${nconf.get('relative_path')}/assets/uploads/system/avatar-default.png`);\n                done();\n            });\n        });\n\n        it('should upload og image', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/uploadOgImage`, path.join(__dirname, '../test/files/test.png'), { }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert.equal(body[0].url, `${nconf.get('relative_path')}/assets/uploads/system/og-image.png`);\n                done();\n            });\n        });\n\n        it('should upload favicon', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/uploadfavicon`, path.join(__dirname, '../test/files/favicon.ico'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(Array.isArray(body));\n                assert.equal(body[0].url, '/assets/uploads/system/favicon.ico');\n                done();\n            });\n        });\n\n        it('should upload touch icon', (done) => {\n            const touchiconAssetPath = '/assets/uploads/system/touchicon-orig.png';\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/uploadTouchIcon`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(Array.isArray(body));\n                assert.equal(body[0].url, touchiconAssetPath);\n                meta.config['brand:touchIcon'] = touchiconAssetPath;\n                request(`${nconf.get('url')}/apple-touch-icon`, (err, res, body) => {\n                    assert.ifError(err);\n                    assert.equal(res.statusCode, 200);\n                    assert(body);\n                    done();\n                });\n            });\n        });\n\n        it('should upload regular file', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/upload/file`, path.join(__dirname, '../test/files/test.png'), {\n                params: JSON.stringify({\n                    folder: 'system',\n                }),\n            }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(Array.isArray(body));\n                assert.equal(body[0].url, '/assets/uploads/system/test.png');\n                assert(file.existsSync(path.join(nconf.get('upload_path'), 'system', 'test.png')));\n                done();\n            });\n        });\n\n        it('should fail to upload regular file in wrong directory', (done) => {\n            helpers.uploadFile(`${nconf.get('url')}/api/admin/upload/file`, path.join(__dirname, '../test/files/test.png'), {\n                params: JSON.stringify({\n                    folder: '../../system',\n                }),\n            }, jar, csrf_token, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 500);\n                assert.strictEqual(body.error, '[[error:invalid-path]]');\n                done();\n            });\n        });\n\n        describe('ACP uploads screen', () => {\n            it('should create a folder', async () => {\n                const res = await helpers.createFolder('', 'myfolder', jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n                assert(file.existsSync(path.join(nconf.get('upload_path'), 'myfolder')));\n            });\n\n            it('should fail to create a folder if it already exists', async () => {\n                const res = await helpers.createFolder('', 'myfolder', jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.deepStrictEqual(res.body.status, {\n                    code: 'forbidden',\n                    message: 'Folder exists',\n                });\n            });\n\n            it('should fail to create a folder as a non-admin', async () => {\n                const res = await helpers.createFolder('', 'hisfolder', regularJar, regular_csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.deepStrictEqual(res.body.status, {\n                    code: 'forbidden',\n                    message: 'You are not authorised to make this call',\n                });\n            });\n\n            it('should fail to create a folder in wrong directory', async () => {\n                const res = await helpers.createFolder('../traversing', 'unexpectedfolder', jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.deepStrictEqual(res.body.status, {\n                    code: 'forbidden',\n                    message: 'Invalid path',\n                });\n            });\n\n            it('should use basename of given folderName to create new folder', async () => {\n                const res = await helpers.createFolder('/myfolder', '../another folder', jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n                const slugifiedName = 'another-folder';\n                assert(file.existsSync(path.join(nconf.get('upload_path'), 'myfolder', slugifiedName)));\n            });\n\n            it('should fail to delete a file as a non-admin', async () => {\n                const res = await requestAsync.delete(`${nconf.get('url')}/api/v3/files`, {\n                    body: {\n                        path: '/system/test.png',\n                    },\n                    jar: regularJar,\n                    json: true,\n                    headers: {\n                        'x-csrf-token': regular_csrf_token,\n                    },\n                    simple: false,\n                    resolveWithFullResponse: true,\n                });\n                assert.strictEqual(res.statusCode, 403);\n                assert.deepStrictEqual(res.body.status, {\n                    code: 'forbidden',\n                    message: 'You are not authorised to make this call',\n                });\n            });\n        });\n\n        after(emptyUploadsFolder);\n    });\n\n    describe('library methods', () => {\n        describe('.getOrphans()', () => {\n            before(async () => {\n                const { jar, csrf_token } = await helpers.loginUser('regular', 'zugzug');\n                await helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token);\n            });\n\n            it('should return files with no post associated with them', async () => {\n                const orphans = await posts.uploads.getOrphans();\n\n                assert.strictEqual(orphans.length, 2);\n                orphans.forEach((relPath) => {\n                    assert(relPath.startsWith('files/'));\n                    assert(relPath.endsWith('test.png'));\n                });\n            });\n\n            after(emptyUploadsFolder);\n        });\n\n        describe('.cleanOrphans()', () => {\n            let _orphanExpiryDays;\n\n            before(async () => {\n                const { jar, csrf_token } = await helpers.loginUser('regular', 'zugzug');\n                await helpers.uploadFile(`${nconf.get('url')}/api/post/upload`, path.join(__dirname, '../test/files/test.png'), {}, jar, csrf_token);\n\n                // modify all files in uploads folder to be 30 days old\n                const files = await fs.readdir(`${nconf.get('upload_path')}/files`);\n                const p30d = (Date.now() - (1000 * 60 * 60 * 24 * 30)) / 1000;\n                await Promise.all(files.map(async (filename) => {\n                    await fs.utimes(`${nconf.get('upload_path')}/files/${filename}`, p30d, p30d);\n                }));\n\n                _orphanExpiryDays = meta.config.orphanExpiryDays;\n            });\n\n            it('should not touch orphans if not configured to do so', async () => {\n                await posts.uploads.cleanOrphans();\n                const orphans = await posts.uploads.getOrphans();\n\n                assert.strictEqual(orphans.length, 2);\n            });\n\n            it('should not touch orphans if they are newer than the configured expiry', async () => {\n                meta.config.orphanExpiryDays = 60;\n                await posts.uploads.cleanOrphans();\n                const orphans = await posts.uploads.getOrphans();\n\n                assert.strictEqual(orphans.length, 2);\n            });\n\n            it('should delete orphans older than the configured number of days', async () => {\n                meta.config.orphanExpiryDays = 7;\n                await posts.uploads.cleanOrphans();\n                const orphans = await posts.uploads.getOrphans();\n\n                assert.strictEqual(orphans.length, 0);\n            });\n\n            after(async () => {\n                await emptyUploadsFolder();\n                meta.config.orphanExpiryDays = _orphanExpiryDays;\n            });\n        });\n    });\n});\n"},"test/user.js":{"tests":[{"id":"2168","name":"User should get admins and mods"},{"id":"2169","name":"User should allow user to login even if password is weak"},{"id":"2170","name":"User .create(), when created should be created properly"},{"id":"2171","name":"User .create(), when created should have a valid email, if using an email"},{"id":"2172","name":"User .create(), when created should error with invalid password"},{"id":"2173","name":"User .create(), when created should error with a too long password"},{"id":"2174","name":"User .create(), when created should error if username is already taken or rename user"},{"id":"2175","name":"User .create(), when created should error if email is already taken"},{"id":"2176","name":"User .uniqueUsername() should deal with collisions"},{"id":"2177","name":"User .isModerator() should return false"},{"id":"2178","name":"User .isModerator() should return two false results"},{"id":"2179","name":"User .getModeratorUids() should retrieve all users with moderator bit in category privilege"},{"id":"2180","name":"User .isReadyToPost() should error when a user makes two posts in quick succession"},{"id":"2181","name":"User .isReadyToPost() should allow a post if the last post time is > 10 seconds"},{"id":"2182","name":"User .isReadyToPost() should error when a new user posts if the last post time is 10 <"+" 30 seconds"},{"id":"2183","name":"User .isReadyToPost() should not error if a non-newbie user posts if the last post time is 10 <"+" 30 seconds"},{"id":"2184","name":"User .isReadyToPost() should only post 1 topic out of 10"},{"id":"2185","name":"User .search() should return an object containing an array of matching users"},{"id":"2186","name":"User .search() should search user"},{"id":"2187","name":"User .search() should error for guest"},{"id":"2188","name":"User .search() should error with invalid data"},{"id":"2189","name":"User .search() should error for unprivileged user"},{"id":"2190","name":"User .search() should search users by ip"},{"id":"2191","name":"User .search() should search users by uid"},{"id":"2192","name":"User .search() should search users by fullname"},{"id":"2193","name":"User .search() should return empty array if query is empty"},{"id":"2194","name":"User .search() should filter users"},{"id":"2195","name":"User .search() should sort results by username"},{"id":"2196","name":"User .delete() should delete a user account"},{"id":"2197","name":"User .delete() should not re-add user to users:postcount if post is purged after user account deletion"},{"id":"2198","name":"User .delete() should not re-add user to users:reputation if post is upvoted after user account deletion"},{"id":"2199","name":"User .delete() should delete user even if they started a chat"},{"id":"2200","name":"User passwordReset .generate() should generate a new reset code"},{"id":"2201","name":"User passwordReset .generate() should invalidate a previous generated reset code"},{"id":"2202","name":"User passwordReset .validate() should ensure that this new code is valid"},{"id":"2203","name":"User passwordReset .validate() should correctly identify an invalid code"},{"id":"2204","name":"User passwordReset .send() should create a new reset code and reset password"},{"id":"2205","name":"User passwordReset .commit() should update the user's password and confirm their email"},{"id":"2206","name":"User passwordReset .should error if same password is used for reset"},{"id":"2207","name":"User passwordReset should not validate email if password reset is due to expiry"},{"id":"2208","name":"User hash methods should return uid from email"},{"id":"2209","name":"User hash methods should return uid from username"},{"id":"2210","name":"User hash methods should return uid from userslug"},{"id":"2211","name":"User hash methods should get user data even if one uid is NaN"},{"id":"2212","name":"User hash methods should not return private user data"},{"id":"2213","name":"User hash methods should not return password even if explicitly requested"},{"id":"2214","name":"User hash methods should not modify the fields array passed in"},{"id":"2215","name":"User hash methods should return an icon text and valid background if username and picture is explicitly requested"},{"id":"2216","name":"User hash methods should return a valid background, even if an invalid background colour is set"},{"id":"2217","name":"User hash methods should return private data if field is whitelisted"},{"id":"2218","name":"User hash methods should return 0 as uid if username is falsy"},{"id":"2219","name":"User hash methods should get username by userslug"},{"id":"2220","name":"User hash methods should get uids by emails"},{"id":"2221","name":"User hash methods should not get groupTitle for guests"},{"id":"2222","name":"User hash methods should load guest data"},{"id":"2223","name":"User profile methods should return error if not logged in"},{"id":"2224","name":"User profile methods should return error if data is invalid"},{"id":"2225","name":"User profile methods should return error if data is missing uid"},{"id":"2226","name":"User profile methods should change a user's password"},{"id":"2227","name":"User profile methods should not let user change another user's password"},{"id":"2228","name":"User profile methods should not let user change admin's password"},{"id":"2229","name":"User profile methods should let admin change another users password"},{"id":"2230","name":"User profile methods should not let admin change their password if current password is incorrect"},{"id":"2231","name":"User profile methods should change username"},{"id":"2232","name":"User profile methods should not let setting an empty username"},{"id":"2233","name":"User profile methods should let updating profile if current username is above max length and it is not being changed"},{"id":"2234","name":"User profile methods should not update a user's username if it did not change"},{"id":"2235","name":"User profile methods should not update a user's username if a password is not supplied"},{"id":"2236","name":"User profile methods should send validation email"},{"id":"2237","name":"User profile methods should update cover image"},{"id":"2238","name":"User profile methods should remove cover image"},{"id":"2239","name":"User profile methods should set user status"},{"id":"2240","name":"User profile methods should fail for invalid status"},{"id":"2241","name":"User profile methods should get user status"},{"id":"2242","name":"User profile methods should change user picture"},{"id":"2243","name":"User profile methods should let you set an external image"},{"id":"2244","name":"User profile methods should fail to change user picture with invalid data"},{"id":"2245","name":"User profile methods should fail to change user picture with invalid uid"},{"id":"2246","name":"User profile methods should set user picture to uploaded"},{"id":"2247","name":"User profile methods should return error if profile image uploads disabled"},{"id":"2248","name":"User profile methods should return error if profile image has no mime type"},{"id":"2249","name":"User profile methods should load profile page"},{"id":"2250","name":"User profile methods should load settings page"},{"id":"2251","name":"User profile methods should load edit page"},{"id":"2252","name":"User profile methods should load edit/email page"},{"id":"2253","name":"User profile methods should load user's groups page"},{"id":"2254","name":"User profile methods .updateProfile() should update a user's profile"},{"id":"2255","name":"User profile methods .updateProfile() should also generate an email confirmation code for the changed email"},{"id":"2256","name":"User profile methods user.uploadCroppedPicture should upload cropped profile picture"},{"id":"2257","name":"User profile methods user.uploadCroppedPicture should upload cropped profile picture in chunks"},{"id":"2258","name":"User profile methods user.uploadCroppedPicture should error if both file and imageData are missing"},{"id":"2259","name":"User profile methods user.uploadCroppedPicture should error if file size is too big"},{"id":"2260","name":"User profile methods user.uploadCroppedPicture should not allow image data with bad MIME type to be passed in"},{"id":"2261","name":"User profile methods user.uploadCroppedPicture should get profile pictures"},{"id":"2262","name":"User profile methods user.uploadCroppedPicture should get default profile avatar"},{"id":"2263","name":"User profile methods user.uploadCroppedPicture should fail to get profile pictures with invalid data"},{"id":"2264","name":"User profile methods user.uploadCroppedPicture should remove uploaded picture"},{"id":"2265","name":"User profile methods user.uploadCroppedPicture should fail to remove uploaded picture with invalid-data"},{"id":"2266","name":"User user info should return error if there is no ban reason"},{"id":"2267","name":"User user info should get history from set"},{"id":"2268","name":"User user info should return the correct ban reason"},{"id":"2269","name":"User user info should ban user permanently"},{"id":"2270","name":"User user info should ban user temporarily"},{"id":"2271","name":"User user info should error if until is NaN"},{"id":"2272","name":"User user info should be member of \"banned-users\" system group only after a ban"},{"id":"2273","name":"User user info should restore system group memberships after an unban (for an unverified user)"},{"id":"2274","name":"User user info should restore system group memberships after an unban (for a verified user)"},{"id":"2275","name":"User user info should be able to post in category for banned users"},{"id":"2276","name":"User Digest.getSubscribers should accurately build digest list given ACP default \"null\" (not set)"},{"id":"2277","name":"User Digest.getSubscribers should accurately build digest list given ACP default \"day\""},{"id":"2278","name":"User Digest.getSubscribers should accurately build digest list given ACP default \"week\""},{"id":"2279","name":"User Digest.getSubscribers should accurately build digest list given ACP default \"off\""},{"id":"2280","name":"User digests should send digests"},{"id":"2281","name":"User digests should not send digests"},{"id":"2282","name":"User digests should get delivery times"},{"id":"2283","name":"User digests unsubscribe via POST should unsubscribe from digest if one-click unsubscribe is POSTed"},{"id":"2284","name":"User digests unsubscribe via POST should unsubscribe from notifications if one-click unsubscribe is POSTed"},{"id":"2285","name":"User digests unsubscribe via POST should return errors on missing template in token"},{"id":"2286","name":"User digests unsubscribe via POST should return errors on wrong template in token"},{"id":"2287","name":"User digests unsubscribe via POST should return errors on missing token"},{"id":"2288","name":"User digests unsubscribe via POST should return errors on token signed with wrong secret (verify-failure)"},{"id":"2289","name":"User socket methods should fail with invalid data"},{"id":"2290","name":"User socket methods should return true if user/group exists"},{"id":"2291","name":"User socket methods should return false if user/group does not exists"},{"id":"2292","name":"User socket methods should delete user"},{"id":"2293","name":"User socket methods should clean profile images after account deletion"},{"id":"2294","name":"User socket methods should fail to delete user with wrong password"},{"id":"2295","name":"User socket methods should delete user with correct password"},{"id":"2296","name":"User socket methods should fail to delete user if account deletion is not allowed"},{"id":"2297","name":"User socket methods should send reset email"},{"id":"2298","name":"User socket methods should return invalid-data error"},{"id":"2299","name":"User socket methods should not error"},{"id":"2300","name":"User socket methods should commit reset"},{"id":"2301","name":"User socket methods should save user settings"},{"id":"2302","name":"User socket methods should properly escape homePageRoute"},{"id":"2303","name":"User socket methods should error if language is invalid"},{"id":"2304","name":"User socket methods should set moderation note"},{"id":"2305","name":"User socket methods should get unread count 0 for guest"},{"id":"2306","name":"User socket methods should get unread count for user"},{"id":"2307","name":"User socket methods should get unread chat count 0 for guest"},{"id":"2308","name":"User socket methods should get unread chat count for user"},{"id":"2309","name":"User socket methods should get unread counts 0 for guest"},{"id":"2310","name":"User socket methods should get unread counts for user"},{"id":"2311","name":"User socket methods should get user data by uid"},{"id":"2312","name":"User socket methods should get user data by username"},{"id":"2313","name":"User socket methods should get user data by email"},{"id":"2314","name":"User socket methods should check/consent gdpr status"},{"id":"2315","name":"User approval queue should add user to approval queue"},{"id":"2316","name":"User approval queue should fail to add user to queue if username is taken"},{"id":"2317","name":"User approval queue should fail to add user to queue if email is taken"},{"id":"2318","name":"User approval queue should reject user registration"},{"id":"2319","name":"User approval queue should accept user registration"},{"id":"2320","name":"User approval queue should trim username and add user to registration queue"},{"id":"2321","name":"User invites when inviter is not an admin and does not have invite privilege should error if user does not have invite privilege"},{"id":"2322","name":"User invites when inviter is not an admin and does not have invite privilege should error out if user tries to use an inviter's uid via the API"},{"id":"2323","name":"User invites when inviter has invite privilege should error with invalid data"},{"id":"2324","name":"User invites when inviter has invite privilege should error if user is not admin and type is admin-invite-only"},{"id":"2325","name":"User invites when inviter has invite privilege should send invitation email (without groups to be joined)"},{"id":"2326","name":"User invites when inviter has invite privilege should send multiple invitation emails (with a public group to be joined)"},{"id":"2327","name":"User invites when inviter has invite privilege should error if the user has not permission to invite to the group"},{"id":"2328","name":"User invites when inviter has invite privilege should error if a non-admin tries to invite to the administrators group"},{"id":"2329","name":"User invites when inviter has invite privilege should to invite to own private group"},{"id":"2330","name":"User invites when inviter has invite privilege should to invite to multiple groups"},{"id":"2331","name":"User invites when inviter has invite privilege should error if tries to invite to hidden group"},{"id":"2332","name":"User invites when inviter has invite privilege should error if ouf of invitations"},{"id":"2333","name":"User invites when inviter has invite privilege should send invitation email after maximumInvites increased"},{"id":"2334","name":"User invites when inviter has invite privilege should error if invite is sent via API with a different UID"},{"id":"2335","name":"User invites when inviter has invite privilege should succeed if email exists but not actually send an invite"},{"id":"2336","name":"User invites when inviter is an admin should escape email"},{"id":"2337","name":"User invites when inviter is an admin should invite to the administrators group if inviter is an admin"},{"id":"2338","name":"User invites after invites checks should get user's invites"},{"id":"2339","name":"User invites after invites checks should get all invites"},{"id":"2340","name":"User invites after invites checks should fail to verify invitation with invalid data"},{"id":"2341","name":"User invites after invites checks should fail to verify invitation with invalid email"},{"id":"2342","name":"User invites after invites checks should verify installation with no errors"},{"id":"2343","name":"User invites after invites checks should error with invalid username"},{"id":"2344","name":"User invites after invites checks should delete invitation"},{"id":"2345","name":"User invites after invites checks should delete invitation key"},{"id":"2346","name":"User invites after invites checks should joined the groups from invitation after registration"},{"id":"2347","name":"User invites invite groups should show a list of groups for adding to an invite"},{"id":"2348","name":"User invites invite groups should error out if you request invite groups for another uid"},{"id":"2349","name":"User email confirm should error with invalid code"},{"id":"2350","name":"User email confirm should confirm email of user"},{"id":"2351","name":"User email confirm should confirm email of user by uid"},{"id":"2352","name":"User email confirm should remove the email from a different account if the email is already in use"},{"id":"2353","name":"User user jobs should start user jobs"},{"id":"2354","name":"User user jobs should stop user jobs"},{"id":"2355","name":"User user jobs should send digest"},{"id":"2356","name":"User hideEmail/hideFullname should hide unconfirmed emails on profile pages"},{"id":"2357","name":"User hideEmail/hideFullname should hide from guests by default"},{"id":"2358","name":"User hideEmail/hideFullname should hide from unprivileged users by default"},{"id":"2359","name":"User hideEmail/hideFullname should be visible to self by default"},{"id":"2360","name":"User hideEmail/hideFullname should be visible to privileged users by default"},{"id":"2361","name":"User hideEmail/hideFullname should hide from guests (system-wide: hide, by-user: hide)"},{"id":"2362","name":"User hideEmail/hideFullname should hide from unprivileged users (system-wide: hide, by-user: hide)"},{"id":"2363","name":"User hideEmail/hideFullname should be visible to self (system-wide: hide, by-user: hide)"},{"id":"2364","name":"User hideEmail/hideFullname should be visible to privileged users (system-wide: hide, by-user: hide)"},{"id":"2365","name":"User hideEmail/hideFullname should hide from guests (system-wide: show, by-user: hide)"},{"id":"2366","name":"User hideEmail/hideFullname should hide from unprivileged users (system-wide: show, by-user: hide)"},{"id":"2367","name":"User hideEmail/hideFullname should be visible to self (system-wide: show, by-user: hide)"},{"id":"2368","name":"User hideEmail/hideFullname should be visible to privileged users (system-wide: show, by-user: hide)"},{"id":"2369","name":"User hideEmail/hideFullname should be visible to guests (system-wide: show, by-user: show)"},{"id":"2370","name":"User hideEmail/hideFullname should be visible to unprivileged users (system-wide: show, by-user: show)"},{"id":"2371","name":"User hideEmail/hideFullname should hide from guests (system-wide: hide, by-user: show)"},{"id":"2372","name":"User hideEmail/hideFullname should hide from unprivileged users (system-wide: hide, by-user: show)"},{"id":"2373","name":"User hideEmail/hideFullname should be visible to self (system-wide: hide, by-user: show)"},{"id":"2374","name":"User hideEmail/hideFullname should be visible to privileged users (system-wide: hide, by-user: show)"},{"id":"2375","name":"User hideEmail/hideFullname should handle array of user data (system-wide: hide)"},{"id":"2376","name":"User hideEmail/hideFullname should hide fullname in topic list and topic"},{"id":"2377","name":"User user blocking methods .toggle() should toggle block"},{"id":"2378","name":"User user blocking methods .add() should block a uid"},{"id":"2379","name":"User user blocking methods .add() should automatically increment corresponding user field"},{"id":"2380","name":"User user blocking methods .add() should error if you try to block the same uid again"},{"id":"2381","name":"User user blocking methods .remove() should unblock a uid"},{"id":"2382","name":"User user blocking methods .remove() should automatically decrement corresponding user field"},{"id":"2383","name":"User user blocking methods .remove() should error if you try to unblock the same uid again"},{"id":"2384","name":"User user blocking methods .is() should return a Boolean with blocked status for the queried uid"},{"id":"2385","name":"User user blocking methods .list() should return a list of blocked uids"},{"id":"2386","name":"User user blocking methods .filter() should remove entries by blocked uids and return filtered set"},{"id":"2387","name":"User user blocking methods .filter() should allow property argument to be passed in to customise checked property"},{"id":"2388","name":"User user blocking methods .filter() should not process invalid sets"},{"id":"2389","name":"User user blocking methods .filter() should process plain sets that just contain uids"},{"id":"2390","name":"User user blocking methods .filter() should filter uids that are blocking targetUid"},{"id":"2391","name":"User status/online should return offline if user is guest"},{"id":"2392","name":"User status/online should return true"},{"id":"2393","name":"User isPrivilegedOrSelf should return not error if self"},{"id":"2394","name":"User isPrivilegedOrSelf should not error if privileged"},{"id":"2395","name":"User isPrivilegedOrSelf should error if not privileged"},{"id":"2396","name":"User User's subfolder tests"}],"source":"'use strict';\n\nconst assert = require('assert');\nconst async = require('async');\nconst fs = require('fs');\nconst path = require('path');\nconst nconf = require('nconf');\nconst validator = require('validator');\nconst request = require('request');\nconst requestAsync = require('request-promise-native');\nconst jwt = require('jsonwebtoken');\n\nconst db = require('./mocks/databasemock');\nconst User = require('../src/user');\nconst Topics = require('../src/topics');\nconst Categories = require('../src/categories');\nconst Posts = require('../src/posts');\nconst Password = require('../src/password');\nconst groups = require('../src/groups');\nconst messaging = require('../src/messaging');\nconst helpers = require('./helpers');\nconst meta = require('../src/meta');\nconst file = require('../src/file');\nconst socketUser = require('../src/socket.io/user');\nconst apiUser = require('../src/api/users');\nconst utils = require('../src/utils');\nconst privileges = require('../src/privileges');\n\ndescribe('User', () => {\n    let userData;\n    let testUid;\n    let testCid;\n\n    const plugins = require('../src/plugins');\n\n    async function dummyEmailerHook(data) {\n        // pretend to handle sending emails\n    }\n    before((done) => {\n        // Attach an emailer hook so related requests do not error\n        plugins.hooks.register('emailer-test', {\n            hook: 'filter:email.send',\n            method: dummyEmailerHook,\n        });\n\n        Categories.create({\n            name: 'Test Category',\n            description: 'A test',\n            order: 1,\n        }, (err, categoryObj) => {\n            if (err) {\n                return done(err);\n            }\n\n            testCid = categoryObj.cid;\n            done();\n        });\n    });\n    after(() => {\n        plugins.hooks.unregister('emailer-test', 'filter:email.send');\n    });\n\n    beforeEach(() => {\n        userData = {\n            username: 'John Smith',\n            fullname: 'John Smith McNamara',\n            password: 'swordfish',\n            email: 'john@example.com',\n            callback: undefined,\n        };\n    });\n\n    const goodImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAACcJJREFUeNqMl9tvnNV6xn/f+s5z8DCeg88Zj+NYdhJH4KShFoJAIkzVphLVJnsDaiV6gUKaC2qQUFVATbnoValAakuQYKMqBKUUJCgI9XBBSmOROMqGoCStHbA9sWM7nrFn/I3n9B17kcwoabfarj9gvet53+d9nmdJAwMDAAgh8DyPtbU1XNfFMAwkScK2bTzPw/M8dF1/SAhxKAiCxxVF2aeqqqTr+q+Af+7o6Ch0d3f/69TU1KwkSRiGwbFjx3jmmWd47rnn+OGHH1BVFYX/5QRBkPQ87xeSJP22YRi/oapqStM0PM/D931kWSYIgnHf98cXFxepVqtomjZt2/Zf2bb990EQ4Pv+PXfeU1CSpGYhfN9/TgjxQTQaJQgCwuEwQRBQKpUwDAPTNPF9n0ajAYDv+8zPzzM+Pr6/Wq2eqdVqfxOJRA6Zpnn57hrivyEC0IQQZ4Mg+MAwDCKRCJIkUa/XEUIQi8XQNI1QKIQkSQghUBQFIQSmaTI7OwtAuVxOTE9Pfzc9Pf27lUqlBUgulUoUi0VKpRKqqg4EQfAfiqLsDIfDAC0E4XCYaDSKEALXdalUKvfM1/d9hBBYlkUul2N4eJi3335bcl33mW+++aaUz+cvSJKE8uKLL6JpGo7j8Omnn/7d+vp6sr+/HyEEjuMgyzKu6yJJEsViEVVV8TyPjY2NVisV5fZkTNMkkUhw8+ZN6vU6Kysr7Nmzh9OnT7/12GOPDS8sLByT7rQR4A9XV1d/+cILLzA9PU0kEmF4eBhFUTh//jyWZaHrOkII0uk0jUaDWq1GJpOhWCyysrLC1tYWnuehqir79+9H13W6urp48803+f7773n++ef/4G7S/H4ikUCSJNbX11trcuvWLcrlMrIs4zgODzzwABMTE/i+T7lcpq2tjUqlwubmJrZts7y8jBCCkZERGo0G2WyWkydPkkql6Onp+eMmwihwc3JyMvrWW2+RTCYBcF0XWZbRdZ3l5WX27NnD008/TSwWQ1VVyuVy63GhUIhEIkEqlcJxHCzLIhaLMTQ0xJkzZ7Btm3379lmS53kIIczZ2dnFsbGxRK1Wo729HQDP8zAMg5WVFXp7e5mcnKSzs5N8Po/rutTrdVzXbQmHrutEo1FM00RVVXp7e0kkEgRBwMWLF9F1vaxUq1UikUjtlVdeuV6pVBJ9fX3Ytn2bwrLMysoKXV1dTE5OkslksCwLTdMwDANVVdnY2CAIApLJJJFIBMdxiMfj7Nq1C1VViUajLQCvvvrqkhKJRJiZmfmdb7/99jeTySSyLLfWodFoEAqFOH78OLt37yaXy2GaJoqisLy8zNTUFFevXiUIAtrb29m5cyePPPJIa+cymQz1eh2A0dFRCoXCsgIwNTW1J5/P093dTbFYRJZlJEmiWq1y4MABxsbGqNVqhEIh6vU6QRBQLpcxDIPh4WE8z2NxcZFTp05x7tw5Xn755ZY6dXZ2tliZzWa/EwD1ev3RsbExxsfHSafTVCoVGo0Gqqqya9cuIpEIQgh832dtbY3FxUUA+vr62LZtG2NjYxw5coTDhw+ztLTEyZMnuXr1KoVC4R4d3bt375R84sQJEY/H/2Jubq7N9326urqwbZt6vY5pmhw5coS+vr4W9YvFIrdu3WJqagohBFeuXOHcuXOtue7evRtN01rtfO+991haWmJkZGQrkUi8JIC9iqL0BkFAIpFACMETTzxBV1cXiUSC7u5uHMfB8zyCIMA0TeLxONlsFlmW8X2fwcFBHMdhfn6eer1Oe3s7Dz30EBMTE1y6dImjR49y6tSppR07dqwrjuM8+OWXXzI0NMTly5e5du0aQ0NDTExMkMvlCIKAIAhaIh2LxQiHw0QiEfL5POl0mlqtRq1Wo6OjA8uykGWZdDrN0tISvb29vPPOOzz++OPk83lELpf7rXfffRfDMOjo6MBxHEqlEocOHWLHjh00Gg0kSULTNIS4bS6qqhKPxxkaGmJ4eJjR0VH279/PwMAA27dvJ5vN4vs+X331FR9//DGzs7OEQiE++eQTlPb29keuX7/OtWvXOH78ONVqlZs3b9LW1kYmk8F13dZeCiGQJAnXdRFCYBgGsiwjhMC2bQqFAkEQoOs6P/74Iw8++CCDg4Pous6xY8f47LPPkIIguDo2Nrbzxo0bfPjhh9i2zczMTHNvcF2XpsZalkWj0cB1Xe4o1O3YoCisra3x008/EY/H6erqAuDAgQNEIhGCIODQoUP/ubCwMCKAjx599FHW19f56KOP6OjooFgsks/niUajKIqCbds4joMQAiFESxxs226xd2Zmhng8Tl9fH67r0mg0sG2bbDZLpVIhl8vd5gHwtysrKy8Dcdd1mZubo6enh1gsRrVabZlrk6VND/R9n3q9TqVSQdd1QqEQi4uLnD9/nlKpxODgIHv37gXAcRyCICiFQiHEzp07i1988cUfKYpCIpHANE22b9/eUhNFUVotDIKghc7zPCzLolKpsLW1RVtbG0EQ4DgOmqbR09NDM1qUSiWAPwdQ7ujjmf7+/kQymfxrSZJQVZWtra2WG+i63iKH53m4rku1WqVcLmNZFu3t7S2x7+/vJ51O89prr7VYfenSpcPAP1UqFeSHH36YeDxOKpW6eP/9988Bv9d09nw+T7VapVKptJjZnE2tVmNtbY1cLke5XGZra4vNzU16enp49tlnGRgYaD7iTxqNxgexWIzDhw+jNEPQHV87NT8/f+PChQtnR0ZGqFarrUVuOsDds2u2b2FhgVQqRSQSYWFhgStXrtDf308ymcwBf3nw4EEOHjx4O5c2lURVVRzHYXp6+t8uX7785IULFz7LZDLous59991HOBy+h31N9xgdHSWTyVCtVhkaGmLfvn1MT08zPz/PzMzM6c8//9xr+uE9QViWZer1OhsbGxiG8fns7OzPc7ncx729vXR3d1OpVNi2bRuhUAhZljEMA9/3sW0bVVVZWlri4sWLjI+P8/rrr/P111/z5JNPXrIs69cn76ZeGoaBpmm0tbX9Q6FQeHhubu7fC4UCkUiE1dVVstks8Xgc0zSRZZlGo9ESAdM02djYoNFo8MYbb2BZ1mYoFOKuZPjr/xZBEHCHred83x/b3Nz8l/X19aRlWWxsbNDZ2cnw8DDhcBjf96lWq/T09HD06FGeeuopXnrpJc6ePUs6nb4hhPi/C959ZFn+TtO0lG3bJ0ql0p85jsPW1haFQoG2tjYkSWpF/Uwmw9raGu+//z7A977vX2+GrP93wSZiTdNOGIbxy3K5/DPHcfYXCoVe27Yzpmm2m6bppVKp/Orqqnv69OmoZVn/mEwm/9TzvP9x138NAMpJ4VFTBr6SAAAAAElFTkSuQmCC';\n\n    describe('.create(), when created', () => {\n        it('should be created properly', async () => {\n            testUid = await User.create({ username: userData.username, password: userData.password });\n            assert.ok(testUid);\n\n            await User.setUserField(testUid, 'email', userData.email);\n            await User.email.confirmByUid(testUid);\n        });\n\n        it('should be created properly', async () => {\n            const email = '<"+"h1>test<"+"/h1>@gmail.com';\n            const uid = await User.create({ username: 'weirdemail', email: email });\n            const data = await User.getUserData(uid);\n\n            const validationPending = await User.email.isValidationPending(uid, email);\n            assert.strictEqual(validationPending, true);\n\n            assert.equal(data.email, '&lt;h1&gt;test&lt;&#x2F;h1&gt;@gmail.com');\n            assert.strictEqual(data.profileviews, 0);\n            assert.strictEqual(data.reputation, 0);\n            assert.strictEqual(data.postcount, 0);\n            assert.strictEqual(data.topiccount, 0);\n            assert.strictEqual(data.lastposttime, 0);\n            assert.strictEqual(data.banned, false);\n        });\n\n        it('should have a valid email, if using an email', (done) => {\n            User.create({ username: userData.username, password: userData.password, email: 'fakeMail' }, (err) => {\n                assert(err);\n                assert.equal(err.message, '[[error:invalid-email]]');\n                done();\n            });\n        });\n\n        it('should error with invalid password', (done) => {\n            User.create({ username: 'test', password: '1' }, (err) => {\n                assert.equal(err.message, '[[reset_password:password_too_short]]');\n                done();\n            });\n        });\n\n        it('should error with invalid password', (done) => {\n            User.create({ username: 'test', password: {} }, (err) => {\n                assert.equal(err.message, '[[error:invalid-password]]');\n                done();\n            });\n        });\n\n        it('should error with a too long password', (done) => {\n            let toolong = '';\n            for (let i = 0; i <"+" 5000; i++) {\n                toolong += 'a';\n            }\n            User.create({ username: 'test', password: toolong }, (err) => {\n                assert.equal(err.message, '[[error:password-too-long]]');\n                done();\n            });\n        });\n\n        it('should error if username is already taken or rename user', async () => {\n            let err;\n            async function tryCreate(data) {\n                try {\n                    return await User.create(data);\n                } catch (_err) {\n                    err = _err;\n                }\n            }\n\n            const [uid1, uid2] = await Promise.all([\n                tryCreate({ username: 'dupe1' }),\n                tryCreate({ username: 'dupe1' }),\n            ]);\n            if (err) {\n                assert.strictEqual(err.message, '[[error:username-taken]]');\n            } else {\n                const userData = await User.getUsersFields([uid1, uid2], ['username']);\n                const userNames = userData.map(u => u.username);\n                // make sure only 1 dupe1 is created\n                assert.equal(userNames.filter(username => username === 'dupe1').length, 1);\n                assert.equal(userNames.filter(username => username === 'dupe1 0').length, 1);\n            }\n        });\n\n        it('should error if email is already taken', async () => {\n            let err;\n            async function tryCreate(data) {\n                try {\n                    return await User.create(data);\n                } catch (_err) {\n                    err = _err;\n                }\n            }\n\n            await Promise.all([\n                tryCreate({ username: 'notdupe1', email: 'dupe@dupe.com' }),\n                tryCreate({ username: 'notdupe2', email: 'dupe@dupe.com' }),\n            ]);\n            assert.strictEqual(err.message, '[[error:email-taken]]');\n        });\n    });\n\n    describe('.uniqueUsername()', () => {\n        it('should deal with collisions', (done) => {\n            const users = [];\n            for (let i = 0; i <"+" 10; i += 1) {\n                users.push({\n                    username: 'Jane Doe',\n                    email: `jane.doe${i}@example.com`,\n                });\n            }\n\n            async.series([\n                function (next) {\n                    async.eachSeries(users, (user, next) => {\n                        User.create(user, next);\n                    }, next);\n                },\n                function (next) {\n                    User.uniqueUsername({\n                        username: 'Jane Doe',\n                        userslug: 'jane-doe',\n                    }, (err, username) => {\n                        assert.ifError(err);\n\n                        assert.strictEqual(username, 'Jane Doe 9');\n                        next();\n                    });\n                },\n            ], done);\n        });\n    });\n\n    describe('.isModerator()', () => {\n        it('should return false', (done) => {\n            User.isModerator(testUid, testCid, (err, isModerator) => {\n                assert.equal(err, null);\n                assert.equal(isModerator, false);\n                done();\n            });\n        });\n\n        it('should return two false results', (done) => {\n            User.isModerator([testUid, testUid], testCid, (err, isModerator) => {\n                assert.equal(err, null);\n                assert.equal(isModerator[0], false);\n                assert.equal(isModerator[1], false);\n                done();\n            });\n        });\n\n        it('should return two false results', (done) => {\n            User.isModerator(testUid, [testCid, testCid], (err, isModerator) => {\n                assert.equal(err, null);\n                assert.equal(isModerator[0], false);\n                assert.equal(isModerator[1], false);\n                done();\n            });\n        });\n    });\n\n    describe('.getModeratorUids()', () => {\n        before((done) => {\n            groups.join('cid:1:privileges:moderate', 1, done);\n        });\n\n        it('should retrieve all users with moderator bit in category privilege', (done) => {\n            User.getModeratorUids((err, uids) => {\n                assert.ifError(err);\n                assert.strictEqual(1, uids.length);\n                assert.strictEqual(1, parseInt(uids[0], 10));\n                done();\n            });\n        });\n\n        after((done) => {\n            groups.leave('cid:1:privileges:moderate', 1, done);\n        });\n    });\n\n    describe('.getModeratorUids()', () => {\n        before((done) => {\n            async.series([\n                async.apply(groups.create, { name: 'testGroup' }),\n                async.apply(groups.join, 'cid:1:privileges:groups:moderate', 'testGroup'),\n                async.apply(groups.join, 'testGroup', 1),\n            ], done);\n        });\n\n        it('should retrieve all users with moderator bit in category privilege', (done) => {\n            User.getModeratorUids((err, uids) => {\n                assert.ifError(err);\n                assert.strictEqual(1, uids.length);\n                assert.strictEqual(1, parseInt(uids[0], 10));\n                done();\n            });\n        });\n\n        after((done) => {\n            async.series([\n                async.apply(groups.leave, 'cid:1:privileges:groups:moderate', 'testGroup'),\n                async.apply(groups.destroy, 'testGroup'),\n            ], done);\n        });\n    });\n\n    describe('.isReadyToPost()', () => {\n        it('should error when a user makes two posts in quick succession', (done) => {\n            meta.config = meta.config || {};\n            meta.config.postDelay = '10';\n\n            async.series([\n                async.apply(Topics.post, {\n                    uid: testUid,\n                    title: 'Topic 1',\n                    content: 'lorem ipsum',\n                    cid: testCid,\n                }),\n                async.apply(Topics.post, {\n                    uid: testUid,\n                    title: 'Topic 2',\n                    content: 'lorem ipsum',\n                    cid: testCid,\n                }),\n            ], (err) => {\n                assert(err);\n                done();\n            });\n        });\n\n        it('should allow a post if the last post time is > 10 seconds', (done) => {\n            User.setUserField(testUid, 'lastposttime', +new Date() - (11 * 1000), () => {\n                Topics.post({\n                    uid: testUid,\n                    title: 'Topic 3',\n                    content: 'lorem ipsum',\n                    cid: testCid,\n                }, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n\n        it('should error when a new user posts if the last post time is 10 <"+" 30 seconds', (done) => {\n            meta.config.newbiePostDelay = 30;\n            meta.config.newbiePostDelayThreshold = 3;\n\n            User.setUserField(testUid, 'lastposttime', +new Date() - (20 * 1000), () => {\n                Topics.post({\n                    uid: testUid,\n                    title: 'Topic 4',\n                    content: 'lorem ipsum',\n                    cid: testCid,\n                }, (err) => {\n                    assert(err);\n                    done();\n                });\n            });\n        });\n\n        it('should not error if a non-newbie user posts if the last post time is 10 <"+" 30 seconds', (done) => {\n            User.setUserFields(testUid, {\n                lastposttime: +new Date() - (20 * 1000),\n                reputation: 10,\n            }, () => {\n                Topics.post({\n                    uid: testUid,\n                    title: 'Topic 5',\n                    content: 'lorem ipsum',\n                    cid: testCid,\n                }, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n\n        it('should only post 1 topic out of 10', async () => {\n            await User.create({ username: 'flooder', password: '123456' });\n            const { jar } = await helpers.loginUser('flooder', '123456');\n            const titles = new Array(10).fill('topic title');\n            const res = await Promise.allSettled(titles.map(async (title) => {\n                const { body } = await helpers.request('post', '/api/v3/topics', {\n                    form: {\n                        cid: testCid,\n                        title: title,\n                        content: 'the content',\n                    },\n                    jar: jar,\n                    json: true,\n                });\n                return body.status;\n            }));\n            const failed = res.filter(res => res.value.code === 'bad-request');\n            const success = res.filter(res => res.value.code === 'ok');\n            assert.strictEqual(failed.length, 9);\n            assert.strictEqual(success.length, 1);\n        });\n    });\n\n    describe('.search()', () => {\n        let adminUid;\n        let uid;\n        before(async () => {\n            adminUid = await User.create({ username: 'noteadmin' });\n            await groups.join('administrators', adminUid);\n        });\n\n        it('should return an object containing an array of matching users', (done) => {\n            User.search({ query: 'john' }, (err, searchData) => {\n                assert.ifError(err);\n                uid = searchData.users[0].uid;\n                assert.equal(Array.isArray(searchData.users) && searchData.users.length > 0, true);\n                assert.equal(searchData.users[0].username, 'John Smith');\n                done();\n            });\n        });\n\n        it('should search user', async () => {\n            const searchData = await apiUser.search({ uid: testUid }, { query: 'john' });\n            assert.equal(searchData.users[0].username, 'John Smith');\n        });\n\n        it('should error for guest', async () => {\n            try {\n                await apiUser.search({ uid: 0 }, { query: 'john' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should error with invalid data', async () => {\n            try {\n                await apiUser.search({ uid: testUid }, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should error for unprivileged user', async () => {\n            try {\n                await apiUser.search({ uid: testUid }, { searchBy: 'ip', query: '123' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should error for unprivileged user', async () => {\n            try {\n                await apiUser.search({ uid: testUid }, { filters: ['banned'], query: '123' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should error for unprivileged user', async () => {\n            try {\n                await apiUser.search({ uid: testUid }, { filters: ['flagged'], query: '123' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should search users by ip', async () => {\n            const uid = await User.create({ username: 'ipsearch' });\n            await db.sortedSetAdd('ip:1.1.1.1:uid', [1, 1], [testUid, uid]);\n            const data = await apiUser.search({ uid: adminUid }, { query: '1.1.1.1', searchBy: 'ip' });\n            assert(Array.isArray(data.users));\n            assert.equal(data.users.length, 2);\n        });\n\n        it('should search users by uid', async () => {\n            const data = await apiUser.search({ uid: testUid }, { query: uid, searchBy: 'uid' });\n            assert(Array.isArray(data.users));\n            assert.equal(data.users[0].uid, uid);\n        });\n\n        it('should search users by fullname', async () => {\n            const uid = await User.create({ username: 'fullnamesearch1', fullname: 'Mr. Fullname' });\n            const data = await apiUser.search({ uid: adminUid }, { query: 'mr', searchBy: 'fullname' });\n            assert(Array.isArray(data.users));\n            assert.equal(data.users.length, 1);\n            assert.equal(uid, data.users[0].uid);\n        });\n\n        it('should search users by fullname', async () => {\n            const uid = await User.create({ username: 'fullnamesearch2', fullname: 'Baris:Usakli' });\n            const data = await apiUser.search({ uid: adminUid }, { query: 'baris:', searchBy: 'fullname' });\n            assert(Array.isArray(data.users));\n            assert.equal(data.users.length, 1);\n            assert.equal(uid, data.users[0].uid);\n        });\n\n        it('should return empty array if query is empty', async () => {\n            const data = await apiUser.search({ uid: testUid }, { query: '' });\n            assert.equal(data.users.length, 0);\n        });\n\n        it('should filter users', async () => {\n            const uid = await User.create({ username: 'ipsearch_filter' });\n            await User.bans.ban(uid, 0, '');\n            await User.setUserFields(uid, { flags: 10 });\n            const data = await apiUser.search({ uid: adminUid }, {\n                query: 'ipsearch',\n                filters: ['online', 'banned', 'flagged'],\n            });\n            assert.equal(data.users[0].username, 'ipsearch_filter');\n        });\n\n        it('should sort results by username', (done) => {\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'brian' }, next);\n                },\n                function (uid, next) {\n                    User.create({ username: 'baris' }, next);\n                },\n                function (uid, next) {\n                    User.create({ username: 'bzari' }, next);\n                },\n                function (uid, next) {\n                    User.search({\n                        uid: testUid,\n                        query: 'b',\n                        sortBy: 'username',\n                        paginate: false,\n                    }, next);\n                },\n            ], (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.users[0].username, 'baris');\n                assert.equal(data.users[1].username, 'brian');\n                assert.equal(data.users[2].username, 'bzari');\n                done();\n            });\n        });\n    });\n\n    describe('.delete()', () => {\n        let uid;\n        before((done) => {\n            User.create({ username: 'usertodelete', password: '123456', email: 'delete@me.com' }, (err, newUid) => {\n                assert.ifError(err);\n                uid = newUid;\n                done();\n            });\n        });\n\n        it('should delete a user account', (done) => {\n            User.delete(1, uid, (err) => {\n                assert.ifError(err);\n                User.existsBySlug('usertodelete', (err, exists) => {\n                    assert.ifError(err);\n                    assert.equal(exists, false);\n                    done();\n                });\n            });\n        });\n\n        it('should not re-add user to users:postcount if post is purged after user account deletion', async () => {\n            const uid = await User.create({ username: 'olduserwithposts' });\n            assert(await db.isSortedSetMember('users:postcount', uid));\n\n            const result = await Topics.post({\n                uid: uid,\n                title: 'old user topic',\n                content: 'old user topic post content',\n                cid: testCid,\n            });\n            assert.equal(await db.sortedSetScore('users:postcount', uid), 1);\n            await User.deleteAccount(uid);\n            assert(!await db.isSortedSetMember('users:postcount', uid));\n            await Posts.purge(result.postData.pid, 1);\n            assert(!await db.isSortedSetMember('users:postcount', uid));\n        });\n\n        it('should not re-add user to users:reputation if post is upvoted after user account deletion', async () => {\n            const uid = await User.create({ username: 'olduserwithpostsupvote' });\n            assert(await db.isSortedSetMember('users:reputation', uid));\n\n            const result = await Topics.post({\n                uid: uid,\n                title: 'old user topic',\n                content: 'old user topic post content',\n                cid: testCid,\n            });\n            assert.equal(await db.sortedSetScore('users:reputation', uid), 0);\n            await User.deleteAccount(uid);\n            assert(!await db.isSortedSetMember('users:reputation', uid));\n            await Posts.upvote(result.postData.pid, 1);\n            assert(!await db.isSortedSetMember('users:reputation', uid));\n        });\n\n        it('should delete user even if they started a chat', async () => {\n            const socketModules = require('../src/socket.io/modules');\n            const uid1 = await User.create({ username: 'chatuserdelete1' });\n            const uid2 = await User.create({ username: 'chatuserdelete2' });\n            const roomId = await messaging.newRoom(uid1, [uid2]);\n            await messaging.addMessage({\n                uid: uid1,\n                content: 'hello',\n                roomId,\n            });\n            await messaging.leaveRoom([uid2], roomId);\n            await User.delete(1, uid1);\n            assert.strictEqual(await User.exists(uid1), false);\n        });\n    });\n\n    describe('passwordReset', () => {\n        let uid;\n        let code;\n        before(async () => {\n            uid = await User.create({ username: 'resetuser', password: '123456' });\n            await User.setUserField(uid, 'email', 'reset@me.com');\n            await User.email.confirmByUid(uid);\n        });\n\n        it('.generate() should generate a new reset code', (done) => {\n            User.reset.generate(uid, (err, _code) => {\n                assert.ifError(err);\n                assert(_code);\n\n                code = _code;\n                done();\n            });\n        });\n\n        it('.generate() should invalidate a previous generated reset code', async () => {\n            const _code = await User.reset.generate(uid);\n            const valid = await User.reset.validate(code);\n            assert.strictEqual(valid, false);\n\n            code = _code;\n        });\n\n        it('.validate() should ensure that this new code is valid', (done) => {\n            User.reset.validate(code, (err, valid) => {\n                assert.ifError(err);\n                assert.strictEqual(valid, true);\n                done();\n            });\n        });\n\n        it('.validate() should correctly identify an invalid code', (done) => {\n            User.reset.validate(`${code}abcdef`, (err, valid) => {\n                assert.ifError(err);\n                assert.strictEqual(valid, false);\n                done();\n            });\n        });\n\n        it('.send() should create a new reset code and reset password', async () => {\n            code = await User.reset.send('reset@me.com');\n        });\n\n        it('.commit() should update the user\\'s password and confirm their email', (done) => {\n            User.reset.commit(code, 'newpassword', (err) => {\n                assert.ifError(err);\n\n                async.parallel({\n                    userData: function (next) {\n                        User.getUserData(uid, next);\n                    },\n                    password: function (next) {\n                        db.getObjectField(`user:${uid}`, 'password', next);\n                    },\n                }, (err, results) => {\n                    assert.ifError(err);\n                    Password.compare('newpassword', results.password, true, (err, match) => {\n                        assert.ifError(err);\n                        assert(match);\n                        assert.strictEqual(results.userData['email:confirmed'], 1);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('.should error if same password is used for reset', async () => {\n            const uid = await User.create({ username: 'badmemory', email: 'bad@memory.com', password: '123456' });\n            const code = await User.reset.generate(uid);\n            let err;\n            try {\n                await User.reset.commit(code, '123456');\n            } catch (_err) {\n                err = _err;\n            }\n            assert.strictEqual(err.message, '[[error:reset-same-password]]');\n        });\n\n        it('should not validate email if password reset is due to expiry', async () => {\n            const uid = await User.create({ username: 'resetexpiry', email: 'reset@expiry.com', password: '123456' });\n            let confirmed = await User.getUserField(uid, 'email:confirmed');\n            let [verified, unverified] = await groups.isMemberOfGroups(uid, ['verified-users', 'unverified-users']);\n            assert.strictEqual(confirmed, 0);\n            assert.strictEqual(verified, false);\n            assert.strictEqual(unverified, true);\n            await User.setUserField(uid, 'passwordExpiry', Date.now());\n            const code = await User.reset.generate(uid);\n            await User.reset.commit(code, '654321');\n            confirmed = await User.getUserField(uid, 'email:confirmed');\n            [verified, unverified] = await groups.isMemberOfGroups(uid, ['verified-users', 'unverified-users']);\n            assert.strictEqual(confirmed, 0);\n            assert.strictEqual(verified, false);\n            assert.strictEqual(unverified, true);\n        });\n    });\n\n    describe('hash methods', () => {\n        it('should return uid from email', (done) => {\n            User.getUidByEmail('john@example.com', (err, uid) => {\n                assert.ifError(err);\n                assert.equal(parseInt(uid, 10), parseInt(testUid, 10));\n                done();\n            });\n        });\n\n        it('should return uid from username', (done) => {\n            User.getUidByUsername('John Smith', (err, uid) => {\n                assert.ifError(err);\n                assert.equal(parseInt(uid, 10), parseInt(testUid, 10));\n                done();\n            });\n        });\n\n        it('should return uid from userslug', (done) => {\n            User.getUidByUserslug('john-smith', (err, uid) => {\n                assert.ifError(err);\n                assert.equal(parseInt(uid, 10), parseInt(testUid, 10));\n                done();\n            });\n        });\n\n        it('should get user data even if one uid is NaN', (done) => {\n            User.getUsersData([NaN, testUid], (err, data) => {\n                assert.ifError(err);\n                assert(data[0]);\n                assert.equal(data[0].username, '[[global:guest]]');\n                assert(data[1]);\n                assert.equal(data[1].username, userData.username);\n                done();\n            });\n        });\n\n        it('should not return private user data', (done) => {\n            User.setUserFields(testUid, {\n                fb_token: '123123123',\n                another_secret: 'abcde',\n                postcount: '123',\n            }, (err) => {\n                assert.ifError(err);\n                User.getUserData(testUid, (err, userData) => {\n                    assert.ifError(err);\n                    assert(!userData.hasOwnProperty('fb_token'));\n                    assert(!userData.hasOwnProperty('another_secret'));\n                    assert(!userData.hasOwnProperty('password'));\n                    assert(!userData.hasOwnProperty('rss_token'));\n                    assert.strictEqual(userData.postcount, 123);\n                    assert.strictEqual(userData.uid, testUid);\n                    done();\n                });\n            });\n        });\n\n        it('should not return password even if explicitly requested', (done) => {\n            User.getUserFields(testUid, ['password'], (err, payload) => {\n                assert.ifError(err);\n                assert(!payload.hasOwnProperty('password'));\n                done();\n            });\n        });\n\n        it('should not modify the fields array passed in', async () => {\n            const fields = ['username', 'email'];\n            await User.getUserFields(testUid, fields);\n            assert.deepStrictEqual(fields, ['username', 'email']);\n        });\n\n        it('should return an icon text and valid background if username and picture is explicitly requested', async () => {\n            const payload = await User.getUserFields(testUid, ['username', 'picture']);\n            const validBackgrounds = await User.getIconBackgrounds(testUid);\n            assert.strictEqual(payload['icon:text'], userData.username.slice(0, 1).toUpperCase());\n            assert(payload['icon:bgColor']);\n            assert(validBackgrounds.includes(payload['icon:bgColor']));\n        });\n\n        it('should return a valid background, even if an invalid background colour is set', async () => {\n            await User.setUserField(testUid, 'icon:bgColor', 'teal');\n            const payload = await User.getUserFields(testUid, ['username', 'picture']);\n            const validBackgrounds = await User.getIconBackgrounds(testUid);\n\n            assert(payload['icon:bgColor']);\n            assert(validBackgrounds.includes(payload['icon:bgColor']));\n        });\n\n        it('should return private data if field is whitelisted', (done) => {\n            function filterMethod(data, callback) {\n                data.whitelist.push('another_secret');\n                callback(null, data);\n            }\n\n            plugins.hooks.register('test-plugin', { hook: 'filter:user.whitelistFields', method: filterMethod });\n            User.getUserData(testUid, (err, userData) => {\n                assert.ifError(err);\n                assert(!userData.hasOwnProperty('fb_token'));\n                assert.equal(userData.another_secret, 'abcde');\n                plugins.hooks.unregister('test-plugin', 'filter:user.whitelistFields', filterMethod);\n                done();\n            });\n        });\n\n        it('should return 0 as uid if username is falsy', (done) => {\n            User.getUidByUsername('', (err, uid) => {\n                assert.ifError(err);\n                assert.strictEqual(uid, 0);\n                done();\n            });\n        });\n\n        it('should get username by userslug', (done) => {\n            User.getUsernameByUserslug('john-smith', (err, username) => {\n                assert.ifError(err);\n                assert.strictEqual('John Smith', username);\n                done();\n            });\n        });\n\n        it('should get uids by emails', (done) => {\n            User.getUidsByEmails(['john@example.com'], (err, uids) => {\n                assert.ifError(err);\n                assert.equal(uids[0], testUid);\n                done();\n            });\n        });\n\n        it('should not get groupTitle for guests', (done) => {\n            User.getUserData(0, (err, userData) => {\n                assert.ifError(err);\n                assert.strictEqual(userData.groupTitle, '');\n                assert.deepStrictEqual(userData.groupTitleArray, []);\n                done();\n            });\n        });\n\n        it('should load guest data', (done) => {\n            User.getUsersData([1, 0], (err, data) => {\n                assert.ifError(err);\n                assert.strictEqual(data[1].username, '[[global:guest]]');\n                assert.strictEqual(data[1].userslug, '');\n                assert.strictEqual(data[1].uid, 0);\n                done();\n            });\n        });\n    });\n\n    describe('profile methods', () => {\n        let uid;\n        let jar;\n        let csrf_token;\n\n        before(async () => {\n            const newUid = await User.create({ username: 'updateprofile', email: 'update@me.com', password: '123456' });\n            uid = newUid;\n\n            await User.setUserField(uid, 'email', 'update@me.com');\n            await User.email.confirmByUid(uid);\n\n            ({ jar, csrf_token } = await helpers.loginUser('updateprofile', '123456'));\n        });\n\n        it('should return error if not logged in', async () => {\n            try {\n                await apiUser.update({ uid: 0 }, { uid: 1 });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-uid]]');\n            }\n        });\n\n        it('should return error if data is invalid', async () => {\n            try {\n                await apiUser.update({ uid: uid }, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should return error if data is missing uid', async () => {\n            try {\n                await apiUser.update({ uid: uid }, { username: 'bip', email: 'bop' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        describe('.updateProfile()', () => {\n            let uid;\n\n            it('should update a user\\'s profile', async () => {\n                uid = await User.create({ username: 'justforupdate', email: 'just@for.updated', password: '123456' });\n                await User.setUserField(uid, 'email', 'just@for.updated');\n                await User.email.confirmByUid(uid);\n\n                const data = {\n                    uid: uid,\n                    username: 'updatedUserName',\n                    email: 'updatedEmail@me.com',\n                    fullname: 'updatedFullname',\n                    website: 'http://nodebb.org',\n                    location: 'izmir',\n                    groupTitle: 'testGroup',\n                    birthday: '01/01/1980',\n                    signature: 'nodebb is good',\n                    password: '123456',\n                };\n                const result = await apiUser.update({ uid: uid }, { ...data, password: '123456', invalid: 'field' });\n                assert.equal(result.username, 'updatedUserName');\n                assert.equal(result.userslug, 'updatedusername');\n                assert.equal(result.location, 'izmir');\n\n                const userData = await db.getObject(`user:${uid}`);\n                Object.keys(data).forEach((key) => {\n                    if (key === 'email') {\n                        assert.strictEqual(userData.email, 'just@for.updated'); // email remains the same until confirmed\n                    } else if (key !== 'password') {\n                        assert.equal(data[key], userData[key]);\n                    } else {\n                        assert(userData[key].startsWith('$2a$'));\n                    }\n                });\n                // updateProfile only saves valid fields\n                assert.strictEqual(userData.invalid, undefined);\n            });\n\n            it('should also generate an email confirmation code for the changed email', async () => {\n                const confirmSent = await User.email.isValidationPending(uid, 'updatedemail@me.com');\n                assert.strictEqual(confirmSent, true);\n            });\n        });\n\n        it('should change a user\\'s password', async () => {\n            const uid = await User.create({ username: 'changepassword', password: '123456' });\n            await apiUser.changePassword({ uid: uid }, { uid: uid, newPassword: '654321', currentPassword: '123456' });\n            const correct = await User.isPasswordCorrect(uid, '654321', '127.0.0.1');\n            assert(correct);\n        });\n\n        it('should not let user change another user\\'s password', async () => {\n            const regularUserUid = await User.create({ username: 'regularuserpwdchange', password: 'regularuser1234' });\n            const uid = await User.create({ username: 'changeadminpwd1', password: '123456' });\n            try {\n                await apiUser.changePassword({ uid: uid }, { uid: regularUserUid, newPassword: '654321', currentPassword: '123456' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[user:change_password_error_privileges]]');\n            }\n        });\n\n        it('should not let user change admin\\'s password', async () => {\n            const adminUid = await User.create({ username: 'adminpwdchange', password: 'admin1234' });\n            await groups.join('administrators', adminUid);\n            const uid = await User.create({ username: 'changeadminpwd2', password: '123456' });\n            try {\n                await apiUser.changePassword({ uid: uid }, { uid: adminUid, newPassword: '654321', currentPassword: '123456' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[user:change_password_error_privileges]]');\n            }\n        });\n\n        it('should let admin change another users password', async () => {\n            const adminUid = await User.create({ username: 'adminpwdchange2', password: 'admin1234' });\n            await groups.join('administrators', adminUid);\n            const uid = await User.create({ username: 'forgotmypassword', password: '123456' });\n\n            await apiUser.changePassword({ uid: adminUid }, { uid: uid, newPassword: '654321' });\n            const correct = await User.isPasswordCorrect(uid, '654321', '127.0.0.1');\n            assert(correct);\n        });\n\n        it('should not let admin change their password if current password is incorrect', async () => {\n            const adminUid = await User.create({ username: 'adminforgotpwd', password: 'admin1234' });\n            await groups.join('administrators', adminUid);\n\n            try {\n                await apiUser.changePassword({ uid: adminUid }, { uid: adminUid, newPassword: '654321', currentPassword: 'wrongpwd' });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[user:change_password_error_wrong_current]]');\n            }\n        });\n\n        it('should change username', async () => {\n            await apiUser.update({ uid: uid }, { uid: uid, username: 'updatedAgain', password: '123456' });\n            const username = await db.getObjectField(`user:${uid}`, 'username');\n            assert.equal(username, 'updatedAgain');\n        });\n\n        it('should not let setting an empty username', async () => {\n            await apiUser.update({ uid: uid }, { uid: uid, username: '', password: '123456' });\n            const username = await db.getObjectField(`user:${uid}`, 'username');\n            assert.strictEqual(username, 'updatedAgain');\n        });\n\n        it('should let updating profile if current username is above max length and it is not being changed', async () => {\n            const maxLength = meta.config.maximumUsernameLength + 1;\n            const longName = new Array(maxLength).fill('a').join('');\n            const uid = await User.create({ username: longName });\n            await apiUser.update({ uid: uid }, { uid: uid, username: longName, email: 'verylong@name.com' });\n            const userData = await db.getObject(`user:${uid}`);\n            const awaitingValidation = await User.email.isValidationPending(uid, 'verylong@name.com');\n\n            assert.strictEqual(userData.username, longName);\n            assert.strictEqual(awaitingValidation, true);\n        });\n\n        it('should not update a user\\'s username if it did not change', async () => {\n            await apiUser.update({ uid: uid }, { uid: uid, username: 'updatedAgain', password: '123456' });\n            const data = await db.getSortedSetRevRange(`user:${uid}:usernames`, 0, -1);\n            assert.equal(data.length, 2);\n            assert(data[0].startsWith('updatedAgain'));\n        });\n\n        it('should not update a user\\'s username if a password is not supplied', async () => {\n            try {\n                await apiUser.update({ uid: uid }, { uid: uid, username: 'updatedAgain', password: '' });\n                assert(false);\n            } catch (err) {\n                assert.strictEqual(err.message, '[[error:invalid-password]]');\n            }\n        });\n\n        it('should send validation email', async () => {\n            const uid = await User.create({ username: 'pooremailupdate', email: 'poor@update.me', password: '123456' });\n            await User.email.expireValidation(uid);\n            await apiUser.update({ uid: uid }, { uid: uid, email: 'updatedAgain@me.com', password: '123456' });\n\n            assert.strictEqual(await User.email.isValidationPending(uid, 'updatedAgain@me.com'.toLowerCase()), true);\n        });\n\n        it('should update cover image', (done) => {\n            const position = '50.0301% 19.2464%';\n            const coverData = { uid: uid, imageData: goodImage, position: position };\n            socketUser.updateCover({ uid: uid }, coverData, (err, result) => {\n                assert.ifError(err);\n                assert(result.url);\n                db.getObjectFields(`user:${uid}`, ['cover:url', 'cover:position'], (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data['cover:url'], result.url);\n                    assert.equal(data['cover:position'], position);\n                    done();\n                });\n            });\n        });\n\n        it('should remove cover image', async () => {\n            const coverPath = await User.getLocalCoverPath(uid);\n            await socketUser.removeCover({ uid: uid }, { uid: uid });\n            const coverUrlNow = await db.getObjectField(`user:${uid}`, 'cover:url');\n            assert.strictEqual(coverUrlNow, null);\n            assert.strictEqual(fs.existsSync(coverPath), false);\n        });\n\n        it('should set user status', (done) => {\n            socketUser.setStatus({ uid: uid }, 'away', (err, data) => {\n                assert.ifError(err);\n                assert.equal(data.uid, uid);\n                assert.equal(data.status, 'away');\n                done();\n            });\n        });\n\n        it('should fail for invalid status', (done) => {\n            socketUser.setStatus({ uid: uid }, '12345', (err) => {\n                assert.equal(err.message, '[[error:invalid-user-status]]');\n                done();\n            });\n        });\n\n        it('should get user status', (done) => {\n            socketUser.checkStatus({ uid: uid }, uid, (err, status) => {\n                assert.ifError(err);\n                assert.equal(status, 'away');\n                done();\n            });\n        });\n\n        it('should change user picture', async () => {\n            await apiUser.changePicture({ uid: uid }, { type: 'default', uid: uid });\n            const picture = await User.getUserField(uid, 'picture');\n            assert.equal(picture, '');\n        });\n\n        it('should let you set an external image', async () => {\n            const token = await helpers.getCsrfToken(jar);\n            const body = await requestAsync(`${nconf.get('url')}/api/v3/users/${uid}/picture`, {\n                jar,\n                method: 'put',\n                json: true,\n                headers: {\n                    'x-csrf-token': token,\n                },\n                body: {\n                    type: 'external',\n                    url: 'https://example.org/picture.jpg',\n                },\n            });\n\n            assert(body && body.status && body.response);\n            assert.strictEqual(body.status.code, 'ok');\n\n            const picture = await User.getUserField(uid, 'picture');\n            assert.strictEqual(picture, validator.escape('https://example.org/picture.jpg'));\n        });\n\n        it('should fail to change user picture with invalid data', async () => {\n            try {\n                await apiUser.changePicture({ uid: uid }, null);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-data]]');\n            }\n        });\n\n        it('should fail to change user picture with invalid uid', async () => {\n            try {\n                await apiUser.changePicture({ uid: 0 }, { uid: 1 });\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:no-privileges]]');\n            }\n        });\n\n        it('should set user picture to uploaded', async () => {\n            await User.setUserField(uid, 'uploadedpicture', '/test');\n            await apiUser.changePicture({ uid: uid }, { type: 'uploaded', uid: uid });\n            const picture = await User.getUserField(uid, 'picture');\n            assert.equal(picture, `${nconf.get('relative_path')}/test`);\n        });\n\n        it('should return error if profile image uploads disabled', (done) => {\n            meta.config.allowProfileImageUploads = 0;\n            const picture = {\n                path: path.join(nconf.get('base_dir'), 'test/files/test_copy.png'),\n                size: 7189,\n                name: 'test.png',\n                type: 'image/png',\n            };\n            User.uploadCroppedPicture({\n                callerUid: uid,\n                uid: uid,\n                file: picture,\n            }, (err) => {\n                assert.equal(err.message, '[[error:profile-image-uploads-disabled]]');\n                meta.config.allowProfileImageUploads = 1;\n                done();\n            });\n        });\n\n        it('should return error if profile image has no mime type', (done) => {\n            User.uploadCroppedPicture({\n                callerUid: uid,\n                uid: uid,\n                imageData: 'data:image/invalid;base64,R0lGODlhPQBEAPeoAJosM/',\n            }, (err) => {\n                assert.equal(err.message, '[[error:invalid-image]]');\n                done();\n            });\n        });\n\n        describe('user.uploadCroppedPicture', () => {\n            const badImage = 'data:audio/mp3;base64,R0lGODlhPQBEAPeoAJosM//AwO/AwHVYZ/z595kzAP/s7P+goOXMv8+fhw/v739/f+8PD98fH/8mJl+fn/9ZWb8/PzWlwv///6wWGbImAPgTEMImIN9gUFCEm/gDALULDN8PAD6atYdCTX9gUNKlj8wZAKUsAOzZz+UMAOsJAP/Z2ccMDA8PD/95eX5NWvsJCOVNQPtfX/8zM8+QePLl38MGBr8JCP+zs9myn/8GBqwpAP/GxgwJCPny78lzYLgjAJ8vAP9fX/+MjMUcAN8zM/9wcM8ZGcATEL+QePdZWf/29uc/P9cmJu9MTDImIN+/r7+/vz8/P8VNQGNugV8AAF9fX8swMNgTAFlDOICAgPNSUnNWSMQ5MBAQEJE3QPIGAM9AQMqGcG9vb6MhJsEdGM8vLx8fH98AANIWAMuQeL8fABkTEPPQ0OM5OSYdGFl5jo+Pj/+pqcsTE78wMFNGQLYmID4dGPvd3UBAQJmTkP+8vH9QUK+vr8ZWSHpzcJMmILdwcLOGcHRQUHxwcK9PT9DQ0O/v70w5MLypoG8wKOuwsP/g4P/Q0IcwKEswKMl8aJ9fX2xjdOtGRs/Pz+Dg4GImIP8gIH0sKEAwKKmTiKZ8aB/f39Wsl+LFt8dgUE9PT5x5aHBwcP+AgP+WltdgYMyZfyywz78AAAAAAAD///8AAP9mZv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAKgALAAAAAA9AEQAAAj/AFEJHEiwoMGDCBMqXMiwocAbBww4nEhxoYkUpzJGrMixogkfGUNqlNixJEIDB0SqHGmyJSojM1bKZOmyop0gM3Oe2liTISKMOoPy7GnwY9CjIYcSRYm0aVKSLmE6nfq05QycVLPuhDrxBlCtYJUqNAq2bNWEBj6ZXRuyxZyDRtqwnXvkhACDV+euTeJm1Ki7A73qNWtFiF+/gA95Gly2CJLDhwEHMOUAAuOpLYDEgBxZ4GRTlC1fDnpkM+fOqD6DDj1aZpITp0dtGCDhr+fVuCu3zlg49ijaokTZTo27uG7Gjn2P+hI8+PDPERoUB318bWbfAJ5sUNFcuGRTYUqV/3ogfXp1rWlMc6awJjiAAd2fm4ogXjz56aypOoIde4OE5u/F9x199dlXnnGiHZWEYbGpsAEA3QXYnHwEFliKAgswgJ8LPeiUXGwedCAKABACCN+EA1pYIIYaFlcDhytd51sGAJbo3onOpajiihlO92KHGaUXGwWjUBChjSPiWJuOO/LYIm4v1tXfE6J4gCSJEZ7YgRYUNrkji9P55sF/ogxw5ZkSqIDaZBV6aSGYq/lGZplndkckZ98xoICbTcIJGQAZcNmdmUc210hs35nCyJ58fgmIKX5RQGOZowxaZwYA+JaoKQwswGijBV4C6SiTUmpphMspJx9unX4KaimjDv9aaXOEBteBqmuuxgEHoLX6Kqx+yXqqBANsgCtit4FWQAEkrNbpq7HSOmtwag5w57GrmlJBASEU18ADjUYb3ADTinIttsgSB1oJFfA63bduimuqKB1keqwUhoCSK374wbujvOSu4QG6UvxBRydcpKsav++Ca6G8A6Pr1x2kVMyHwsVxUALDq/krnrhPSOzXG1lUTIoffqGR7Goi2MAxbv6O2kEG56I7CSlRsEFKFVyovDJoIRTg7sugNRDGqCJzJgcKE0ywc0ELm6KBCCJo8DIPFeCWNGcyqNFE06ToAfV0HBRgxsvLThHn1oddQMrXj5DyAQgjEHSAJMWZwS3HPxT/QMbabI/iBCliMLEJKX2EEkomBAUCxRi42VDADxyTYDVogV+wSChqmKxEKCDAYFDFj4OmwbY7bDGdBhtrnTQYOigeChUmc1K3QTnAUfEgGFgAWt88hKA6aCRIXhxnQ1yg3BCayK44EWdkUQcBByEQChFXfCB776aQsG0BIlQgQgE8qO26X1h8cEUep8ngRBnOy74E9QgRgEAC8SvOfQkh7FDBDmS43PmGoIiKUUEGkMEC/PJHgxw0xH74yx/3XnaYRJgMB8obxQW6kL9QYEJ0FIFgByfIL7/IQAlvQwEpnAC7DtLNJCKUoO/w45c44GwCXiAFB/OXAATQryUxdN4LfFiwgjCNYg+kYMIEFkCKDs6PKAIJouyGWMS1FSKJOMRB/BoIxYJIUXFUxNwoIkEKPAgCBZSQHQ1A2EWDfDEUVLyADj5AChSIQW6gu10bE/JG2VnCZGfo4R4d0sdQoBAHhPjhIB94v/wRoRKQWGRHgrhGSQJxCS+0pCZbEhAAOw==';\n\n            it('should upload cropped profile picture', async () => {\n                const result = await socketUser.uploadCroppedPicture({ uid: uid }, { uid: uid, imageData: goodImage });\n                assert(result.url);\n                const data = await db.getObjectFields(`user:${uid}`, ['uploadedpicture', 'picture']);\n                assert.strictEqual(result.url, data.uploadedpicture);\n                assert.strictEqual(result.url, data.picture);\n            });\n\n            it('should upload cropped profile picture in chunks', async () => {\n                const socketUploads = require('../src/socket.io/uploads');\n                const socketData = {\n                    uid,\n                    method: 'user.uploadCroppedPicture',\n                    size: goodImage.length,\n                    progress: 0,\n                };\n                const chunkSize = 1000;\n                let result;\n                do {\n                    const chunk = goodImage.slice(socketData.progress, socketData.progress + chunkSize);\n                    socketData.progress += chunk.length;\n                    // eslint-disable-next-line\n                    result = await socketUploads.upload({ uid: uid }, {\n                        chunk: chunk,\n                        params: socketData,\n                    });\n                } while (socketData.progress <"+" socketData.size);\n\n                assert(result.url);\n                const data = await db.getObjectFields(`user:${uid}`, ['uploadedpicture', 'picture']);\n                assert.strictEqual(result.url, data.uploadedpicture);\n                assert.strictEqual(result.url, data.picture);\n            });\n\n            it('should error if both file and imageData are missing', (done) => {\n                User.uploadCroppedPicture({}, (err) => {\n                    assert.equal('[[error:invalid-data]]', err.message);\n                    done();\n                });\n            });\n\n            it('should error if file size is too big', (done) => {\n                const temp = meta.config.maximumProfileImageSize;\n                meta.config.maximumProfileImageSize = 1;\n                User.uploadCroppedPicture({\n                    callerUid: uid,\n                    uid: 1,\n                    imageData: goodImage,\n                }, (err) => {\n                    assert.equal('[[error:file-too-big, 1]]', err.message);\n\n                    // Restore old value\n                    meta.config.maximumProfileImageSize = temp;\n                    done();\n                });\n            });\n\n            it('should not allow image data with bad MIME type to be passed in', (done) => {\n                User.uploadCroppedPicture({\n                    callerUid: uid,\n                    uid: 1,\n                    imageData: badImage,\n                }, (err) => {\n                    assert.equal('[[error:invalid-image]]', err.message);\n                    done();\n                });\n            });\n\n            it('should get profile pictures', (done) => {\n                socketUser.getProfilePictures({ uid: uid }, { uid: uid }, (err, data) => {\n                    assert.ifError(err);\n                    assert(data);\n                    assert(Array.isArray(data));\n                    assert.equal(data[0].type, 'uploaded');\n                    assert.equal(data[0].text, '[[user:uploaded_picture]]');\n                    done();\n                });\n            });\n\n            it('should get default profile avatar', (done) => {\n                assert.strictEqual(User.getDefaultAvatar(), '');\n                meta.config.defaultAvatar = 'https://path/to/default/avatar';\n                assert.strictEqual(User.getDefaultAvatar(), meta.config.defaultAvatar);\n                meta.config.defaultAvatar = '/path/to/default/avatar';\n                assert.strictEqual(User.getDefaultAvatar(), nconf.get('relative_path') + meta.config.defaultAvatar);\n                meta.config.defaultAvatar = '';\n                done();\n            });\n\n            it('should fail to get profile pictures with invalid data', (done) => {\n                socketUser.getProfilePictures({ uid: uid }, null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    socketUser.getProfilePictures({ uid: uid }, { uid: null }, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        done();\n                    });\n                });\n            });\n\n            it('should remove uploaded picture', async () => {\n                const avatarPath = await User.getLocalAvatarPath(uid);\n                assert.notStrictEqual(avatarPath, false);\n                await socketUser.removeUploadedPicture({ uid: uid }, { uid: uid });\n                const uploadedPicture = await User.getUserField(uid, 'uploadedpicture');\n                assert.strictEqual(uploadedPicture, '');\n                assert.strictEqual(fs.existsSync(avatarPath), false);\n            });\n\n            it('should fail to remove uploaded picture with invalid-data', (done) => {\n                socketUser.removeUploadedPicture({ uid: uid }, null, (err) => {\n                    assert.equal(err.message, '[[error:invalid-data]]');\n                    socketUser.removeUploadedPicture({ uid: uid }, { }, (err) => {\n                        assert.equal(err.message, '[[error:invalid-data]]');\n                        socketUser.removeUploadedPicture({ uid: null }, { }, (err) => {\n                            assert.equal(err.message, '[[error:invalid-data]]');\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should load profile page', (done) => {\n            request(`${nconf.get('url')}/api/user/updatedagain`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n\n        it('should load settings page', (done) => {\n            request(`${nconf.get('url')}/api/user/updatedagain/settings`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body.settings);\n                assert(body.languages);\n                assert(body.homePageRoutes);\n                done();\n            });\n        });\n\n        it('should load edit page', (done) => {\n            request(`${nconf.get('url')}/api/user/updatedagain/edit`, { jar: jar, json: true }, (err, res, body) => {\n                assert.ifError(err);\n                assert.equal(res.statusCode, 200);\n                assert(body);\n                done();\n            });\n        });\n\n        it('should load edit/email page', async () => {\n            const res = await requestAsync(`${nconf.get('url')}/api/user/updatedagain/edit/email`, { jar: jar, json: true, resolveWithFullResponse: true });\n            assert.strictEqual(res.statusCode, 200);\n            assert(res.body);\n\n            // Accessing this page will mark the user's account as needing an updated email, below code undo's.\n            await requestAsync({\n                uri: `${nconf.get('url')}/register/abort?_csrf=${csrf_token}`,\n                jar,\n                method: 'POST',\n                simple: false,\n            });\n        });\n\n        it('should load user\\'s groups page', async () => {\n            await groups.create({\n                name: 'Test',\n                description: 'Foobar!',\n            });\n\n            await groups.join('Test', uid);\n            const body = await requestAsync(`${nconf.get('url')}/api/user/updatedagain/groups`, { jar: jar, json: true });\n\n            assert(Array.isArray(body.groups));\n            assert.equal(body.groups[0].name, 'Test');\n        });\n    });\n\n    describe('user info', () => {\n        let testUserUid;\n        let verifiedTestUserUid;\n\n        before(async () => {\n            // Might be the first user thus a verified one if this test part is ran alone\n            verifiedTestUserUid = await User.create({ username: 'bannedUser', password: '123456', email: 'banneduser@example.com' });\n            await User.setUserField(verifiedTestUserUid, 'email:confirmed', 1);\n            testUserUid = await User.create({ username: 'bannedUser2', password: '123456', email: 'banneduser2@example.com' });\n        });\n\n        it('should return error if there is no ban reason', (done) => {\n            User.getLatestBanInfo(123, (err) => {\n                assert.equal(err.message, 'no-ban-info');\n                done();\n            });\n        });\n\n        it('should get history from set', async () => {\n            const now = Date.now();\n            await db.sortedSetAdd(`user:${testUserUid}:usernames`, now, `derp:${now}`);\n            const data = await User.getHistory(`user:${testUserUid}:usernames`);\n            assert.equal(data[0].value, 'derp');\n            assert.equal(data[0].timestamp, now);\n        });\n\n        it('should return the correct ban reason', (done) => {\n            async.series([\n                function (next) {\n                    User.bans.ban(testUserUid, 0, '', (err) => {\n                        assert.ifError(err);\n                        next(err);\n                    });\n                },\n                function (next) {\n                    User.getModerationHistory(testUserUid, (err, data) => {\n                        assert.ifError(err);\n                        assert.equal(data.bans.length, 1, 'one ban');\n                        assert.equal(data.bans[0].reason, '[[user:info.banned-no-reason]]', 'no ban reason');\n\n                        next(err);\n                    });\n                },\n            ], (err) => {\n                assert.ifError(err);\n                User.bans.unban(testUserUid, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n\n        it('should ban user permanently', (done) => {\n            User.bans.ban(testUserUid, (err) => {\n                assert.ifError(err);\n                User.bans.isBanned(testUserUid, (err, isBanned) => {\n                    assert.ifError(err);\n                    assert.equal(isBanned, true);\n                    User.bans.unban(testUserUid, done);\n                });\n            });\n        });\n\n        it('should ban user temporarily', (done) => {\n            User.bans.ban(testUserUid, Date.now() + 2000, (err) => {\n                assert.ifError(err);\n\n                User.bans.isBanned(testUserUid, (err, isBanned) => {\n                    assert.ifError(err);\n                    assert.equal(isBanned, true);\n                    setTimeout(() => {\n                        User.bans.isBanned(testUserUid, (err, isBanned) => {\n                            assert.ifError(err);\n                            assert.equal(isBanned, false);\n                            User.bans.unban(testUserUid, done);\n                        });\n                    }, 3000);\n                });\n            });\n        });\n\n        it('should error if until is NaN', (done) => {\n            User.bans.ban(testUserUid, 'asd', (err) => {\n                assert.equal(err.message, '[[error:ban-expiry-missing]]');\n                done();\n            });\n        });\n\n        it('should be member of \"banned-users\" system group only after a ban', async () => {\n            await User.bans.ban(testUserUid);\n\n            const systemGroups = groups.systemGroups.filter(group => group !== groups.BANNED_USERS);\n            const isMember = await groups.isMember(testUserUid, groups.BANNED_USERS);\n            const isMemberOfAny = await groups.isMemberOfAny(testUserUid, systemGroups);\n\n            assert.strictEqual(isMember, true);\n            assert.strictEqual(isMemberOfAny, false);\n        });\n\n        it('should restore system group memberships after an unban (for an unverified user)', async () => {\n            await User.bans.unban(testUserUid);\n\n            const isMemberOfGroups = await groups.isMemberOfGroups(testUserUid, groups.systemGroups);\n            const membership = new Map(groups.systemGroups.map((item, index) => [item, isMemberOfGroups[index]]));\n\n            assert.strictEqual(membership.get('registered-users'), true);\n            assert.strictEqual(membership.get('verified-users'), false);\n            assert.strictEqual(membership.get('unverified-users'), true);\n            assert.strictEqual(membership.get(groups.BANNED_USERS), false);\n            // administrators cannot be banned\n            assert.strictEqual(membership.get('administrators'), false);\n            // This will not restored\n            assert.strictEqual(membership.get('Global Moderators'), false);\n        });\n\n        it('should restore system group memberships after an unban (for a verified user)', async () => {\n            await User.bans.ban(verifiedTestUserUid);\n            await User.bans.unban(verifiedTestUserUid);\n\n            const isMemberOfGroups = await groups.isMemberOfGroups(verifiedTestUserUid, groups.systemGroups);\n            const membership = new Map(groups.systemGroups.map((item, index) => [item, isMemberOfGroups[index]]));\n\n            assert.strictEqual(membership.get('verified-users'), true);\n            assert.strictEqual(membership.get('unverified-users'), false);\n        });\n\n        it('should be able to post in category for banned users', async () => {\n            const { cid } = await Categories.create({\n                name: 'Test Category',\n                description: 'A test',\n                order: 1,\n            });\n            const testUid = await User.create({ username: userData.username });\n            await User.bans.ban(testUid);\n            let _err;\n            try {\n                await Topics.post({ title: 'banned topic', content: 'tttttttttttt', cid: cid, uid: testUid });\n            } catch (err) {\n                _err = err;\n            }\n            assert.strictEqual(_err && _err.message, '[[error:no-privileges]]');\n\n            await Promise.all([\n                privileges.categories.give(['groups:topics:create', 'groups:topics:reply'], cid, 'banned-users'),\n                privileges.categories.rescind(['groups:topics:create', 'groups:topics:reply'], cid, 'registered-users'),\n            ]);\n\n            const result = await Topics.post({ title: 'banned topic', content: 'tttttttttttt', cid: cid, uid: testUid });\n            assert(result);\n            assert.strictEqual(result.topicData.title, 'banned topic');\n        });\n    });\n\n    describe('Digest.getSubscribers', () => {\n        const uidIndex = {};\n\n        before((done) => {\n            const testUsers = ['daysub', 'offsub', 'nullsub', 'weeksub'];\n            async.each(testUsers, (username, next) => {\n                async.waterfall([\n                    async.apply(User.create, { username: username, email: `${username}@example.com` }),\n                    function (uid, next) {\n                        if (username === 'nullsub') {\n                            return setImmediate(next);\n                        }\n\n                        uidIndex[username] = uid;\n\n                        const sub = username.slice(0, -3);\n                        async.parallel([\n                            async.apply(User.updateDigestSetting, uid, sub),\n                            async.apply(User.setSetting, uid, 'dailyDigestFreq', sub),\n                        ], next);\n                    },\n                ], next);\n            }, done);\n        });\n\n        it('should accurately build digest list given ACP default \"null\" (not set)', (done) => {\n            User.digest.getSubscribers('day', (err, subs) => {\n                assert.ifError(err);\n                assert.strictEqual(subs.length, 1);\n\n                done();\n            });\n        });\n\n        it('should accurately build digest list given ACP default \"day\"', (done) => {\n            async.series([\n                async.apply(meta.configs.set, 'dailyDigestFreq', 'day'),\n                function (next) {\n                    User.digest.getSubscribers('day', (err, subs) => {\n                        assert.ifError(err);\n                        assert.strictEqual(subs.includes(uidIndex.daysub.toString()), true); // daysub is emailed\n                        assert.strictEqual(subs.includes(uidIndex.weeksub.toString()), false); // weeksub isn't emailed\n                        assert.strictEqual(subs.includes(uidIndex.offsub.toString()), false); // offsub isn't emailed\n\n                        next();\n                    });\n                },\n            ], done);\n        });\n\n        it('should accurately build digest list given ACP default \"week\"', (done) => {\n            async.series([\n                async.apply(meta.configs.set, 'dailyDigestFreq', 'week'),\n                function (next) {\n                    User.digest.getSubscribers('week', (err, subs) => {\n                        assert.ifError(err);\n                        assert.strictEqual(subs.includes(uidIndex.weeksub.toString()), true); // weeksub is emailed\n                        assert.strictEqual(subs.includes(uidIndex.daysub.toString()), false); // daysub is emailed\n                        assert.strictEqual(subs.includes(uidIndex.offsub.toString()), false); // offsub isn't emailed\n\n                        next();\n                    });\n                },\n            ], done);\n        });\n\n        it('should accurately build digest list given ACP default \"off\"', (done) => {\n            async.series([\n                async.apply(meta.configs.set, 'dailyDigestFreq', 'off'),\n                function (next) {\n                    User.digest.getSubscribers('day', (err, subs) => {\n                        assert.ifError(err);\n                        assert.strictEqual(subs.length, 1);\n\n                        next();\n                    });\n                },\n            ], done);\n        });\n    });\n\n    describe('digests', () => {\n        let uid;\n        before((done) => {\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'digestuser', email: 'test@example.com' }, next);\n                },\n                function (_uid, next) {\n                    uid = _uid;\n                    User.updateDigestSetting(uid, 'day', next);\n                },\n                function (next) {\n                    User.setSetting(uid, 'dailyDigestFreq', 'day', next);\n                },\n                function (next) {\n                    User.setSetting(uid, 'notificationType_test', 'notificationemail', next);\n                },\n            ], done);\n        });\n\n        it('should send digests', (done) => {\n            const oldValue = meta.config.includeUnverifiedEmails;\n            meta.config.includeUnverifiedEmails = true;\n            User.digest.execute({ interval: 'day' }, (err) => {\n                assert.ifError(err);\n                meta.config.includeUnverifiedEmails = oldValue;\n                done();\n            });\n        });\n\n        it('should not send digests', (done) => {\n            User.digest.execute({ interval: 'month' }, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should get delivery times', async () => {\n            const data = await User.digest.getDeliveryTimes(0, -1);\n            const users = data.users.filter(u => u.username === 'digestuser');\n            assert.strictEqual(users[0].setting, 'day');\n        });\n\n        describe('unsubscribe via POST', () => {\n            it('should unsubscribe from digest if one-click unsubscribe is POSTed', (done) => {\n                const token = jwt.sign({\n                    template: 'digest',\n                    uid: uid,\n                }, nconf.get('secret'));\n\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/${token}`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 200);\n\n                    db.getObjectField(`user:${uid}:settings`, 'dailyDigestFreq', (err, value) => {\n                        assert.ifError(err);\n                        assert.strictEqual(value, 'off');\n                        done();\n                    });\n                });\n            });\n\n            it('should unsubscribe from notifications if one-click unsubscribe is POSTed', (done) => {\n                const token = jwt.sign({\n                    template: 'notification',\n                    type: 'test',\n                    uid: uid,\n                }, nconf.get('secret'));\n\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/${token}`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 200);\n\n                    db.getObjectField(`user:${uid}:settings`, 'notificationType_test', (err, value) => {\n                        assert.ifError(err);\n                        assert.strictEqual(value, 'notification');\n                        done();\n                    });\n                });\n            });\n\n            it('should return errors on missing template in token', (done) => {\n                const token = jwt.sign({\n                    uid: uid,\n                }, nconf.get('secret'));\n\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/${token}`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 404);\n                    done();\n                });\n            });\n\n            it('should return errors on wrong template in token', (done) => {\n                const token = jwt.sign({\n                    template: 'user',\n                    uid: uid,\n                }, nconf.get('secret'));\n\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/${token}`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 404);\n                    done();\n                });\n            });\n\n            it('should return errors on missing token', (done) => {\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 404);\n                    done();\n                });\n            });\n\n            it('should return errors on token signed with wrong secret (verify-failure)', (done) => {\n                const token = jwt.sign({\n                    template: 'notification',\n                    type: 'test',\n                    uid: uid,\n                }, `${nconf.get('secret')}aababacaba`);\n\n                request({\n                    method: 'post',\n                    url: `${nconf.get('url')}/email/unsubscribe/${token}`,\n                }, (err, res) => {\n                    assert.ifError(err);\n                    assert.strictEqual(res.statusCode, 403);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('socket methods', () => {\n        const socketUser = require('../src/socket.io/user');\n        let delUid;\n\n        it('should fail with invalid data', (done) => {\n            meta.userOrGroupExists(null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should return true if user/group exists', (done) => {\n            meta.userOrGroupExists('registered-users', (err, exists) => {\n                assert.ifError(err);\n                assert(exists);\n                done();\n            });\n        });\n\n        it('should return true if user/group exists', (done) => {\n            meta.userOrGroupExists('John Smith', (err, exists) => {\n                assert.ifError(err);\n                assert(exists);\n                done();\n            });\n        });\n\n        it('should return false if user/group does not exists', (done) => {\n            meta.userOrGroupExists('doesnot exist', (err, exists) => {\n                assert.ifError(err);\n                assert(!exists);\n                done();\n            });\n        });\n\n        it('should delete user', async () => {\n            delUid = await User.create({ username: 'willbedeleted' });\n\n            // Upload some avatars and covers before deleting\n            meta.config['profile:keepAllUserImages'] = 1;\n            let result = await socketUser.uploadCroppedPicture({ uid: delUid }, { uid: delUid, imageData: goodImage });\n            assert(result.url);\n            result = await socketUser.uploadCroppedPicture({ uid: delUid }, { uid: delUid, imageData: goodImage });\n            assert(result.url);\n\n            const position = '50.0301% 19.2464%';\n            const coverData = { uid: delUid, imageData: goodImage, position: position };\n            result = await socketUser.updateCover({ uid: delUid }, coverData);\n            assert(result.url);\n            result = await socketUser.updateCover({ uid: delUid }, coverData);\n            assert(result.url);\n            meta.config['profile:keepAllUserImages'] = 0;\n\n            await apiUser.deleteAccount({ uid: delUid }, { uid: delUid });\n            const exists = await meta.userOrGroupExists('willbedeleted');\n            assert(!exists);\n        });\n\n        it('should clean profile images after account deletion', () => {\n            const allProfileFiles = fs.readdirSync(path.join(nconf.get('upload_path'), 'profile'));\n            const deletedUserImages = allProfileFiles.filter(\n                f => f.startsWith(`${delUid}-profilecover`) || f.startsWith(`${delUid}-profileavatar`)\n            );\n            assert.strictEqual(deletedUserImages.length, 0);\n        });\n\n        it('should fail to delete user with wrong password', async () => {\n            const uid = await User.create({ username: 'willbedeletedpwd', password: '123456' });\n            try {\n                await apiUser.deleteAccount({ uid: uid }, { uid: uid, password: '654321' });\n                assert(false);\n            } catch (err) {\n                assert.strictEqual(err.message, '[[error:invalid-password]]');\n            }\n        });\n\n        it('should delete user with correct password', async () => {\n            const uid = await User.create({ username: 'willbedeletedcorrectpwd', password: '123456' });\n            await apiUser.deleteAccount({ uid: uid }, { uid: uid, password: '123456' });\n            const exists = await User.exists(uid);\n            assert(!exists);\n        });\n\n        it('should fail to delete user if account deletion is not allowed', async () => {\n            const oldValue = meta.config.allowAccountDelete;\n            meta.config.allowAccountDelete = 0;\n            const uid = await User.create({ username: 'tobedeleted' });\n            try {\n                await apiUser.deleteAccount({ uid: uid }, { uid: uid });\n                assert(false);\n            } catch (err) {\n                assert.strictEqual(err.message, '[[error:account-deletion-disabled]]');\n            }\n            meta.config.allowAccountDelete = oldValue;\n        });\n\n        it('should send reset email', (done) => {\n            socketUser.reset.send({ uid: 0 }, 'john@example.com', (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should return invalid-data error', (done) => {\n            socketUser.reset.send({ uid: 0 }, null, (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should not error', (done) => {\n            socketUser.reset.send({ uid: 0 }, 'doestnot@exist.com', (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should commit reset', (done) => {\n            db.getObject('reset:uid', (err, data) => {\n                assert.ifError(err);\n                const code = Object.keys(data).find(code => parseInt(data[code], 10) === parseInt(testUid, 10));\n                socketUser.reset.commit({ uid: 0 }, { code: code, password: 'pwdchange' }, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n\n        it('should save user settings', async () => {\n            const data = {\n                uid: testUid,\n                settings: {\n                    bootswatchSkin: 'default',\n                    homePageRoute: 'none',\n                    homePageCustom: '',\n                    openOutgoingLinksInNewTab: 0,\n                    scrollToMyPost: 1,\n                    userLang: 'en-GB',\n                    usePagination: 1,\n                    topicsPerPage: '10',\n                    postsPerPage: '5',\n                    showemail: 1,\n                    showfullname: 1,\n                    restrictChat: 0,\n                    followTopicsOnCreate: 1,\n                    followTopicsOnReply: 1,\n                },\n            };\n            await apiUser.updateSettings({ uid: testUid }, data);\n            const userSettings = await User.getSettings(testUid);\n            assert.strictEqual(userSettings.usePagination, true);\n        });\n\n        it('should properly escape homePageRoute', async () => {\n            const data = {\n                uid: testUid,\n                settings: {\n                    bootswatchSkin: 'default',\n                    homePageRoute: 'category/6/testing-ground',\n                    homePageCustom: '',\n                    openOutgoingLinksInNewTab: 0,\n                    scrollToMyPost: 1,\n                    userLang: 'en-GB',\n                    usePagination: 1,\n                    topicsPerPage: '10',\n                    postsPerPage: '5',\n                    showemail: 1,\n                    showfullname: 1,\n                    restrictChat: 0,\n                    followTopicsOnCreate: 1,\n                    followTopicsOnReply: 1,\n                },\n            };\n            await apiUser.updateSettings({ uid: testUid }, data);\n            const userSettings = await User.getSettings(testUid);\n            assert.strictEqual(userSettings.homePageRoute, 'category/6/testing-ground');\n        });\n\n\n        it('should error if language is invalid', async () => {\n            const data = {\n                uid: testUid,\n                settings: {\n                    userLang: '<"+"invalid-string>',\n                    topicsPerPage: '10',\n                    postsPerPage: '5',\n                },\n            };\n            try {\n                await apiUser.updateSettings({ uid: testUid }, data);\n                assert(false);\n            } catch (err) {\n                assert.equal(err.message, '[[error:invalid-language]]');\n            }\n        });\n\n        it('should set moderation note', (done) => {\n            let adminUid;\n            async.waterfall([\n                function (next) {\n                    User.create({ username: 'noteadmin' }, next);\n                },\n                function (_adminUid, next) {\n                    adminUid = _adminUid;\n                    groups.join('administrators', adminUid, next);\n                },\n                function (next) {\n                    socketUser.setModerationNote({ uid: adminUid }, { uid: testUid, note: 'this is a test user' }, next);\n                },\n                function (next) {\n                    setTimeout(next, 50);\n                },\n                function (next) {\n                    socketUser.setModerationNote({ uid: adminUid }, { uid: testUid, note: '<"+"svg/onload=alert(document.location);//' }, next);\n                },\n                function (next) {\n                    User.getModerationNotes(testUid, 0, -1, next);\n                },\n            ], (err, notes) => {\n                assert.ifError(err);\n                assert.equal(notes[0].note, '&lt;svg&#x2F;onload=alert(document.location);&#x2F;&#x2F;');\n                assert.equal(notes[0].uid, adminUid);\n                assert.equal(notes[1].note, 'this is a test user');\n                assert(notes[0].timestamp);\n                done();\n            });\n        });\n\n        it('should get unread count 0 for guest', async () => {\n            const count = await socketUser.getUnreadCount({ uid: 0 });\n            assert.strictEqual(count, 0);\n        });\n\n        it('should get unread count for user', async () => {\n            const count = await socketUser.getUnreadCount({ uid: testUid });\n            assert.strictEqual(count, 4);\n        });\n\n        it('should get unread chat count 0 for guest', async () => {\n            const count = await socketUser.getUnreadChatCount({ uid: 0 });\n            assert.strictEqual(count, 0);\n        });\n\n        it('should get unread chat count for user', async () => {\n            const count = await socketUser.getUnreadChatCount({ uid: testUid });\n            assert.strictEqual(count, 0);\n        });\n\n        it('should get unread counts 0 for guest', async () => {\n            const counts = await socketUser.getUnreadCounts({ uid: 0 });\n            assert.deepStrictEqual(counts, {});\n        });\n\n        it('should get unread counts for user', async () => {\n            const counts = await socketUser.getUnreadCounts({ uid: testUid });\n            assert.deepStrictEqual(counts, {\n                unreadChatCount: 0,\n                unreadCounts: {\n                    '': 4,\n                    new: 4,\n                    unreplied: 4,\n                    watched: 0,\n                },\n                unreadNewTopicCount: 4,\n                unreadNotificationCount: 0,\n                unreadTopicCount: 4,\n                unreadUnrepliedTopicCount: 4,\n                unreadWatchedTopicCount: 0,\n            });\n        });\n\n        it('should get user data by uid', async () => {\n            const userData = await socketUser.getUserByUID({ uid: testUid }, testUid);\n            assert.strictEqual(userData.uid, testUid);\n        });\n\n        it('should get user data by username', async () => {\n            const userData = await socketUser.getUserByUsername({ uid: testUid }, 'John Smith');\n            assert.strictEqual(userData.uid, testUid);\n        });\n\n        it('should get user data by email', async () => {\n            const userData = await socketUser.getUserByEmail({ uid: testUid }, 'john@example.com');\n            assert.strictEqual(userData.uid, testUid);\n        });\n\n        it('should check/consent gdpr status', async () => {\n            const consent = await socketUser.gdpr.check({ uid: testUid }, { uid: testUid });\n            assert(!consent);\n            await socketUser.gdpr.consent({ uid: testUid });\n            const consentAfter = await socketUser.gdpr.check({ uid: testUid }, { uid: testUid });\n            assert(consentAfter);\n        });\n    });\n\n    describe('approval queue', () => {\n        let oldRegistrationApprovalType;\n        let adminUid;\n        before((done) => {\n            oldRegistrationApprovalType = meta.config.registrationApprovalType;\n            meta.config.registrationApprovalType = 'admin-approval';\n            User.create({ username: 'admin', password: '123456' }, (err, uid) => {\n                assert.ifError(err);\n                adminUid = uid;\n                groups.join('administrators', uid, done);\n            });\n        });\n\n        after((done) => {\n            meta.config.registrationApprovalType = oldRegistrationApprovalType;\n            done();\n        });\n\n        it('should add user to approval queue', (done) => {\n            helpers.registerUser({\n                username: 'rejectme',\n                password: '123456',\n                'password-confirm': '123456',\n                'account-type': 'student',\n                email: '<"+"script>alert(\"ok\")<"+"script>reject@me.com',\n                gdpr_consent: true,\n            }, (err) => {\n                assert.ifError(err);\n                helpers.loginUser('admin', '123456', (err, data) => {\n                    assert.ifError(err);\n                    request(`${nconf.get('url')}/api/admin/manage/registration`, { jar: data.jar, json: true }, (err, res, body) => {\n                        assert.ifError(err);\n                        assert.equal(body.users[0].username, 'rejectme');\n                        assert.equal(body.users[0].email, '&lt;script&gt;alert(&quot;ok&quot;)&lt;script&gt;reject@me.com');\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should fail to add user to queue if username is taken', (done) => {\n            helpers.registerUser({\n                username: 'rejectme',\n                password: '123456',\n                'password-confirm': '123456',\n                'account-type': 'student',\n                email: '<"+"script>alert(\"ok\")<"+"script>reject@me.com',\n                gdpr_consent: true,\n            }, (err, jar, res, body) => {\n                assert.ifError(err);\n                assert.equal(body, '[[error:username-taken]]');\n                done();\n            });\n        });\n\n        it('should fail to add user to queue if email is taken', (done) => {\n            helpers.registerUser({\n                username: 'rejectmenew',\n                password: '123456',\n                'password-confirm': '123456',\n                'account-type': 'student',\n                email: '<"+"script>alert(\"ok\")<"+"script>reject@me.com',\n                gdpr_consent: true,\n            }, (err, jar, res, body) => {\n                assert.ifError(err);\n                assert.equal(body, '[[error:email-taken]]');\n                done();\n            });\n        });\n\n        it('should reject user registration', (done) => {\n            socketUser.rejectRegistration({ uid: adminUid }, { username: 'rejectme' }, (err) => {\n                assert.ifError(err);\n                User.getRegistrationQueue(0, -1, (err, users) => {\n                    assert.ifError(err);\n                    assert.equal(users.length, 0);\n                    done();\n                });\n            });\n        });\n\n        it('should accept user registration', (done) => {\n            helpers.registerUser({\n                username: 'acceptme',\n                password: '123456',\n                'password-confirm': '123456',\n                'account-type': 'student',\n                email: 'accept@me.com',\n                gdpr_consent: true,\n            }, (err) => {\n                assert.ifError(err);\n                socketUser.acceptRegistration({ uid: adminUid }, { username: 'acceptme' }, (err, uid) => {\n                    assert.ifError(err);\n                    User.exists(uid, (err, exists) => {\n                        assert.ifError(err);\n                        assert(exists);\n                        User.getRegistrationQueue(0, -1, (err, users) => {\n                            assert.ifError(err);\n                            assert.equal(users.length, 0);\n                            done();\n                        });\n                    });\n                });\n            });\n        });\n\n        it('should trim username and add user to registration queue', (done) => {\n            helpers.registerUser({\n                username: 'invalidname\\r\\n',\n                password: '123456',\n                'password-confirm': '123456',\n                'account-type': 'student',\n                email: 'invalidtest@test.com',\n                gdpr_consent: true,\n            }, (err) => {\n                assert.ifError(err);\n                db.getSortedSetRange('registration:queue', 0, -1, (err, data) => {\n                    assert.ifError(err);\n                    assert.equal(data[0], 'invalidname');\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('invites', () => {\n        let notAnInviterUid;\n        let inviterUid;\n        let adminUid;\n\n        const PUBLIC_GROUP = 'publicGroup';\n        const PRIVATE_GROUP = 'privateGroup';\n        const OWN_PRIVATE_GROUP = 'ownPrivateGroup';\n        const HIDDEN_GROUP = 'hiddenGroup';\n\n        const COMMON_PW = '123456';\n\n        before(async () => {\n            const results = await utils.promiseParallel({\n                publicGroup: groups.create({ name: PUBLIC_GROUP, private: 0 }),\n                privateGroup: groups.create({ name: PRIVATE_GROUP, private: 1 }),\n                hiddenGroup: groups.create({ name: HIDDEN_GROUP, hidden: 1 }),\n                notAnInviter: User.create({ username: 'notAnInviter', password: COMMON_PW }),\n                inviter: User.create({ username: 'inviter', password: COMMON_PW }),\n                admin: User.create({ username: 'adminInvite', password: COMMON_PW }),\n            });\n\n            notAnInviterUid = results.notAnInviter;\n            inviterUid = results.inviter;\n            adminUid = results.admin;\n\n            await User.setUserField(inviterUid, 'email', 'inviter@nodebb.org');\n            await Promise.all([\n                groups.create({ name: OWN_PRIVATE_GROUP, ownerUid: inviterUid, private: 1 }),\n                groups.join('administrators', adminUid),\n                groups.join('cid:0:privileges:invite', inviterUid),\n                User.email.confirmByUid(inviterUid),\n            ]);\n        });\n\n        describe('when inviter is not an admin and does not have invite privilege', () => {\n            let csrf_token;\n            let jar;\n\n            before((done) => {\n                helpers.loginUser('notAnInviter', COMMON_PW, (err, data) => {\n                    assert.ifError(err);\n                    jar = data.jar;\n\n                    request({\n                        url: `${nconf.get('url')}/api/config`,\n                        json: true,\n                        jar: jar,\n                    }, (err, response, body) => {\n                        assert.ifError(err);\n                        csrf_token = body.csrf_token;\n                        done();\n                    });\n                });\n            });\n\n            it('should error if user does not have invite privilege', async () => {\n                const { res } = await helpers.invite({ emails: 'invite1@test.com', groupsToJoin: [] }, notAnInviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n            });\n\n            it('should error out if user tries to use an inviter\\'s uid via the API', async () => {\n                const { res } = await helpers.invite({ emails: 'invite1@test.com', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                const numInvites = await User.getInvitesNumber(inviterUid);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n                assert.strictEqual(numInvites, 0);\n            });\n        });\n\n        describe('when inviter has invite privilege', () => {\n            let csrf_token;\n            let jar;\n\n            before((done) => {\n                helpers.loginUser('inviter', COMMON_PW, (err, data) => {\n                    assert.ifError(err);\n                    jar = data.jar;\n\n                    request({\n                        url: `${nconf.get('url')}/api/config`,\n                        json: true,\n                        jar: jar,\n                    }, (err, response, body) => {\n                        assert.ifError(err);\n                        csrf_token = body.csrf_token;\n                        done();\n                    });\n                });\n            });\n\n            it('should error with invalid data', async () => {\n                const { res } = await helpers.invite({}, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 400);\n                assert.strictEqual(res.body.status.message, 'Invalid Data');\n            });\n\n            it('should error if user is not admin and type is admin-invite-only', async () => {\n                meta.config.registrationType = 'admin-invite-only';\n                const { res } = await helpers.invite({ emails: 'invite1@test.com', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n            });\n\n            it('should send invitation email (without groups to be joined)', async () => {\n                meta.config.registrationType = 'normal';\n                const { res } = await helpers.invite({ emails: 'invite1@test.com', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n\n            it('should send multiple invitation emails (with a public group to be joined)', async () => {\n                const { res } = await helpers.invite({ emails: 'invite2@test.com,invite3@test.com', groupsToJoin: [PUBLIC_GROUP] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n\n            it('should error if the user has not permission to invite to the group', async () => {\n                const { res } = await helpers.invite({ emails: 'invite4@test.com', groupsToJoin: [PRIVATE_GROUP] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n            });\n\n            it('should error if a non-admin tries to invite to the administrators group', async () => {\n                const { res } = await helpers.invite({ emails: 'invite4@test.com', groupsToJoin: ['administrators'] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n            });\n\n            it('should to invite to own private group', async () => {\n                const { res } = await helpers.invite({ emails: 'invite4@test.com', groupsToJoin: [OWN_PRIVATE_GROUP] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n\n            it('should to invite to multiple groups', async () => {\n                const { res } = await helpers.invite({ emails: 'invite5@test.com', groupsToJoin: [PUBLIC_GROUP, OWN_PRIVATE_GROUP] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n\n            it('should error if tries to invite to hidden group', async () => {\n                const { res } = await helpers.invite({ emails: 'invite6@test.com', groupsToJoin: [HIDDEN_GROUP] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n            });\n\n            it('should error if ouf of invitations', async () => {\n                meta.config.maximumInvites = 1;\n                const { res } = await helpers.invite({ emails: 'invite6@test.com', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, `You have invited the maximum amount of people (${5} out of ${1}).`);\n                meta.config.maximumInvites = 10;\n            });\n\n            it('should send invitation email after maximumInvites increased', async () => {\n                const { res } = await helpers.invite({ emails: 'invite6@test.com', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n\n            it('should error if invite is sent via API with a different UID', async () => {\n                const { res } = await helpers.invite({ emails: 'inviter@nodebb.org', groupsToJoin: [] }, adminUid, jar, csrf_token);\n                const numInvites = await User.getInvitesNumber(adminUid);\n                assert.strictEqual(res.statusCode, 403);\n                assert.strictEqual(res.body.status.message, 'You do not have enough privileges for this action.');\n                assert.strictEqual(numInvites, 0);\n            });\n\n            it('should succeed if email exists but not actually send an invite', async () => {\n                const { res } = await helpers.invite({ emails: 'inviter@nodebb.org', groupsToJoin: [] }, inviterUid, jar, csrf_token);\n                const numInvites = await User.getInvitesNumber(adminUid);\n\n                assert.strictEqual(res.statusCode, 200);\n                assert.strictEqual(numInvites, 0);\n            });\n        });\n\n        describe('when inviter is an admin', () => {\n            let csrf_token;\n            let jar;\n\n            before((done) => {\n                helpers.loginUser('adminInvite', COMMON_PW, (err, data) => {\n                    assert.ifError(err);\n                    jar = data.jar;\n\n                    request({\n                        url: `${nconf.get('url')}/api/config`,\n                        json: true,\n                        jar: jar,\n                    }, (err, response, body) => {\n                        assert.ifError(err);\n                        csrf_token = body.csrf_token;\n                        done();\n                    });\n                });\n            });\n\n            it('should escape email', async () => {\n                await helpers.invite({ emails: '<"+"script>alert(\"ok\");<"+"/script>', groupsToJoin: [] }, adminUid, jar, csrf_token);\n                const data = await User.getInvites(adminUid);\n                assert.strictEqual(data[0], '&lt;script&gt;alert(&quot;ok&quot;);&lt;&#x2F;script&gt;');\n                await User.deleteInvitationKey('<"+"script>alert(\"ok\");<"+"/script>');\n            });\n\n            it('should invite to the administrators group if inviter is an admin', async () => {\n                const { res } = await helpers.invite({ emails: 'invite99@test.com', groupsToJoin: ['administrators'] }, adminUid, jar, csrf_token);\n                assert.strictEqual(res.statusCode, 200);\n            });\n        });\n\n        describe('after invites checks', () => {\n            it('should get user\\'s invites', (done) => {\n                User.getInvites(inviterUid, (err, data) => {\n                    assert.ifError(err);\n                    Array.from(Array(6)).forEach((_, i) => {\n                        assert.notEqual(data.indexOf(`invite${i + 1}@test.com`), -1);\n                    });\n                    done();\n                });\n            });\n\n            it('should get all invites', (done) => {\n                User.getAllInvites((err, data) => {\n                    assert.ifError(err);\n\n                    const adminData = data.filter(d => parseInt(d.uid, 10) === adminUid)[0];\n                    assert.notEqual(adminData.invitations.indexOf('invite99@test.com'), -1);\n\n                    const inviterData = data.filter(d => parseInt(d.uid, 10) === inviterUid)[0];\n                    Array.from(Array(6)).forEach((_, i) => {\n                        assert.notEqual(inviterData.invitations.indexOf(`invite${i + 1}@test.com`), -1);\n                    });\n\n                    done();\n                });\n            });\n\n            it('should fail to verify invitation with invalid data', (done) => {\n                User.verifyInvitation({ token: '', email: '' }, (err) => {\n                    assert.strictEqual(err.message, '[[register:invite.error-invite-only]]');\n                    done();\n                });\n            });\n\n            it('should fail to verify invitation with invalid email', (done) => {\n                User.verifyInvitation({ token: 'test', email: 'doesnotexist@test.com' }, (err) => {\n                    assert.strictEqual(err.message, '[[register:invite.error-invalid-data]]');\n                    done();\n                });\n            });\n\n            it('should verify installation with no errors', (done) => {\n                const email = 'invite1@test.com';\n                db.get(`invitation:uid:${inviterUid}:invited:${email}`, 'token', (err, token) => {\n                    assert.ifError(err);\n                    User.verifyInvitation({ token: token, email: 'invite1@test.com' }, (err) => {\n                        assert.ifError(err);\n                        done();\n                    });\n                });\n            });\n\n            it('should error with invalid username', (done) => {\n                User.deleteInvitation('doesnotexist', 'test@test.com', (err) => {\n                    assert.equal(err.message, '[[error:invalid-username]]');\n                    done();\n                });\n            });\n\n            it('should delete invitation', (done) => {\n                const socketUser = require('../src/socket.io/user');\n                socketUser.deleteInvitation({ uid: adminUid }, { invitedBy: 'inviter', email: 'invite1@test.com' }, (err) => {\n                    assert.ifError(err);\n                    db.isSetMember(`invitation:uid:${inviterUid}`, 'invite1@test.com', (err, isMember) => {\n                        assert.ifError(err);\n                        assert.equal(isMember, false);\n                        done();\n                    });\n                });\n            });\n\n            it('should delete invitation key', (done) => {\n                User.deleteInvitationKey('invite99@test.com', (err) => {\n                    assert.ifError(err);\n                    db.isSetMember(`invitation:uid:${adminUid}`, 'invite99@test.com', (err, isMember) => {\n                        assert.ifError(err);\n                        assert.equal(isMember, false);\n                        db.isSetMember('invitation:uids', adminUid, (err, isMember) => {\n                            assert.ifError(err);\n                            assert.equal(isMember, false);\n                            done();\n                        });\n                    });\n                });\n            });\n\n            it('should joined the groups from invitation after registration', async () => {\n                const email = 'invite5@test.com';\n                const groupsToJoin = [PUBLIC_GROUP, OWN_PRIVATE_GROUP];\n                const token = await db.get(`invitation:uid:${inviterUid}:invited:${email}`);\n\n                await new Promise((resolve, reject) => {\n                    helpers.registerUser({\n                        username: 'invite5',\n                        password: '123456',\n                        'password-confirm': '123456',\n                        'account-type': 'student',\n                        email: email,\n                        gdpr_consent: true,\n                        token: token,\n                    }, async (err, jar, response, body) => {\n                        if (err) {\n                            reject(err);\n                        }\n\n                        const memberships = await groups.isMemberOfGroups(body.uid, groupsToJoin);\n                        const joinedToAll = memberships.filter(Boolean);\n\n                        if (joinedToAll.length !== groupsToJoin.length) {\n                            reject(new Error('Not joined to the groups'));\n                        }\n\n                        resolve();\n                    });\n                });\n            });\n        });\n\n        describe('invite groups', () => {\n            let csrf_token;\n            let jar;\n\n            before((done) => {\n                helpers.loginUser('inviter', COMMON_PW, (err, data) => {\n                    assert.ifError(err);\n                    jar = data.jar;\n\n                    request({\n                        url: `${nconf.get('url')}/api/config`,\n                        json: true,\n                        jar: jar,\n                    }, (err, response, body) => {\n                        assert.ifError(err);\n                        csrf_token = body.csrf_token;\n                        done();\n                    });\n                });\n            });\n\n            it('should show a list of groups for adding to an invite', async () => {\n                const body = await requestAsync({\n                    url: `${nconf.get('url')}/api/v3/users/${inviterUid}/invites/groups`,\n                    json: true,\n                    jar,\n                });\n\n                assert(Array.isArray(body.response));\n                assert.strictEqual(2, body.response.length);\n                assert.deepStrictEqual(body.response, ['ownPrivateGroup', 'publicGroup']);\n            });\n\n            it('should error out if you request invite groups for another uid', async () => {\n                const res = await requestAsync({\n                    url: `${nconf.get('url')}/api/v3/users/${adminUid}/invites/groups`,\n                    json: true,\n                    jar,\n                    simple: false,\n                    resolveWithFullResponse: true,\n                });\n\n                assert.strictEqual(res.statusCode, 401);\n                assert.deepStrictEqual(res.body, {\n                    status: {\n                        code: 'not-authorised',\n                        message: 'A valid login session was not found. Please log in and try again.',\n                    },\n                    response: {},\n                });\n            });\n        });\n    });\n\n    describe('email confirm', () => {\n        it('should error with invalid code', (done) => {\n            User.email.confirmByCode('asdasda', (err) => {\n                assert.equal(err.message, '[[error:invalid-data]]');\n                done();\n            });\n        });\n\n        it('should confirm email of user', async () => {\n            const email = 'confirm@me.com';\n            const uid = await User.create({\n                username: 'confirme',\n                email: email,\n            });\n\n            const code = await User.email.sendValidationEmail(uid, { email, force: 1 });\n            const unverified = await groups.isMember(uid, 'unverified-users');\n            assert.strictEqual(unverified, true);\n            await User.email.confirmByCode(code);\n            const [confirmed, isVerified] = await Promise.all([\n                db.getObjectField(`user:${uid}`, 'email:confirmed'),\n                groups.isMember(uid, 'verified-users', uid),\n            ]);\n            assert.strictEqual(parseInt(confirmed, 10), 1);\n            assert.strictEqual(isVerified, true);\n        });\n\n        it('should confirm email of user by uid', async () => {\n            const email = 'confirm2@me.com';\n            const uid = await User.create({\n                username: 'confirme2',\n                email,\n            });\n            await User.setUserField(uid, 'email', email);\n\n            const unverified = await groups.isMember(uid, 'unverified-users');\n            assert.strictEqual(unverified, true);\n            await User.email.confirmByUid(uid);\n            const [confirmed, isVerified] = await Promise.all([\n                db.getObjectField(`user:${uid}`, 'email:confirmed'),\n                groups.isMember(uid, 'verified-users', uid),\n            ]);\n            assert.strictEqual(parseInt(confirmed, 10), 1);\n            assert.strictEqual(isVerified, true);\n        });\n\n        it('should remove the email from a different account if the email is already in use', async () => {\n            const email = 'confirm2@me.com';\n            const uid = await User.create({\n                username: 'confirme3',\n            });\n\n            const oldUid = await db.sortedSetScore('email:uid', email);\n            const code = await User.email.sendValidationEmail(uid, email);\n            await User.email.confirmByCode(code);\n\n            const oldUserData = await User.getUserData(oldUid);\n\n            assert.strictEqual((await db.sortedSetScore('email:uid', email)), uid);\n            assert.strictEqual(oldUserData.email, '');\n        });\n    });\n\n    describe('user jobs', () => {\n        it('should start user jobs', (done) => {\n            User.startJobs();\n            done();\n        });\n\n        it('should stop user jobs', (done) => {\n            User.stopJobs();\n            done();\n        });\n\n        it('should send digest', (done) => {\n            db.sortedSetAdd('digest:day:uids', [Date.now(), Date.now()], [1, 2], (err) => {\n                assert.ifError(err);\n                User.digest.execute({ interval: 'day' }, (err) => {\n                    assert.ifError(err);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('hideEmail/hideFullname', () => {\n        const COMMON_PW = '123456';\n        const hidingUser = {\n            username: 'hiddenemail',\n            email: 'should@be.hidden',\n            fullname: 'baris soner usakli',\n            password: COMMON_PW,\n        };\n        const regularUser = {\n            username: 'regularUser',\n            email: 'regular@example.com',\n            fullname: 'regular user',\n            password: COMMON_PW,\n        };\n        let hidingUserJar;\n        let adminUid;\n        let adminJar;\n        let globalModJar;\n        let regularUserJar;\n\n        before(async () => {\n            adminUid = await User.create({\n                username: 'adminhideemail',\n                password: COMMON_PW,\n            });\n            await groups.join('administrators', adminUid);\n            ({ jar: adminJar } = await helpers.loginUser('adminhideemail', COMMON_PW));\n\n            // Edge case: In a grepped test, this user shouldn't be created as the first user\n            // to have its email not confirmed\n            hidingUser.uid = await User.create(hidingUser);\n            ({ jar: hidingUserJar } = await helpers.loginUser(hidingUser.username, COMMON_PW));\n\n            const globalModUid = await User.create({\n                username: 'globalmodhideemail',\n                password: COMMON_PW,\n            });\n            await groups.join('Global Moderators', globalModUid);\n            ({ jar: globalModJar } = await helpers.loginUser('globalmodhideemail', COMMON_PW));\n\n            regularUser.uid = await User.create(regularUser);\n            ({ jar: regularUserJar } = await helpers.loginUser(regularUser.username, COMMON_PW));\n        });\n\n        after((done) => {\n            meta.config.hideEmail = 0;\n            meta.config.hideFullname = 0;\n            done();\n        });\n\n        async function assertPrivacy({ expectVisible, jar, v3Api, emailOnly }) {\n            const path = v3Api ? `v3/users/${hidingUser.uid}` : `user/${hidingUser.username}`;\n            const response = await requestAsync(`${nconf.get('url')}/api/${path}`, { json: true, jar });\n            const { response: userData } = v3Api ? response : { response };\n\n            assert.strictEqual(userData.email, expectVisible ? hidingUser.email : '');\n            if (!emailOnly) {\n                assert.strictEqual(userData.fullname, expectVisible ? hidingUser.fullname : '');\n            }\n        }\n\n        it('should hide unconfirmed emails on profile pages', async () => {\n            await assertPrivacy({ v3Api: false, emailOnly: true });\n            await assertPrivacy({ v3Api: false, jar: hidingUserJar, emailOnly: true });\n            await assertPrivacy({ v3Api: false, jar: adminJar, emailOnly: true });\n            await assertPrivacy({ v3Api: false, jar: globalModJar, emailOnly: true });\n            await assertPrivacy({ v3Api: false, jar: regularUserJar, emailOnly: true });\n\n            // Let's confirm for afterwards\n            await User.email.confirmByUid(hidingUser.uid);\n        });\n\n        it('should hide from guests by default', async () => {\n            await assertPrivacy({ v3Api: false });\n        });\n\n        it('should hide from unprivileged users by default', async () => {\n            await assertPrivacy({ v3Api: false, jar: regularUserJar });\n            await assertPrivacy({ v3Api: true, jar: regularUserJar });\n        });\n\n        it('should be visible to self by default', async () => {\n            await assertPrivacy({ v3Api: false, jar: hidingUserJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: hidingUserJar, expectVisible: true });\n        });\n\n        it('should be visible to privileged users by default', async () => {\n            await assertPrivacy({ v3Api: false, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: false, jar: globalModJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: globalModJar, expectVisible: true });\n        });\n\n        it('should hide from guests (system-wide: hide, by-user: hide)', async () => {\n            meta.config.hideEmail = 1;\n            meta.config.hideFullname = 1;\n            // Explicitly set user's privacy settings to hide its email and fullname\n            const data = { uid: hidingUser.uid, settings: { showemail: 0, showfullname: 0 } };\n            await apiUser.updateSettings({ uid: hidingUser.uid }, data);\n\n            await assertPrivacy({ v3Api: false });\n        });\n\n        it('should hide from unprivileged users (system-wide: hide, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: regularUserJar });\n            await assertPrivacy({ v3Api: true, jar: regularUserJar });\n        });\n\n        it('should be visible to self (system-wide: hide, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: hidingUserJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: hidingUserJar, expectVisible: true });\n        });\n\n        it('should be visible to privileged users (system-wide: hide, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: false, jar: globalModJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: globalModJar, expectVisible: true });\n        });\n\n        it('should hide from guests (system-wide: show, by-user: hide)', async () => {\n            meta.config.hideEmail = 0;\n            meta.config.hideFullname = 0;\n\n            await assertPrivacy({ v3Api: false });\n        });\n\n        it('should hide from unprivileged users (system-wide: show, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: regularUserJar });\n            await assertPrivacy({ v3Api: true, jar: regularUserJar });\n        });\n\n        it('should be visible to self (system-wide: show, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: hidingUserJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: hidingUserJar, expectVisible: true });\n        });\n\n        it('should be visible to privileged users (system-wide: show, by-user: hide)', async () => {\n            await assertPrivacy({ v3Api: false, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: false, jar: globalModJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: globalModJar, expectVisible: true });\n        });\n\n        it('should be visible to guests (system-wide: show, by-user: show)', async () => {\n            meta.config.hideEmail = 0;\n            meta.config.hideFullname = 0;\n\n            // Set user's individual privacy settings to show its email and fullname\n            const data = { uid: hidingUser.uid, settings: { showemail: 1, showfullname: 1 } };\n            await apiUser.updateSettings({ uid: hidingUser.uid }, data);\n\n            await assertPrivacy({ v3Api: false, expectVisible: true });\n        });\n\n        it('should be visible to unprivileged users (system-wide: show, by-user: show)', async () => {\n            await assertPrivacy({ v3Api: false, jar: regularUserJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: regularUserJar, expectVisible: true });\n        });\n\n        // System-wide \"hide\" prioritized over individual users' settings\n        it('should hide from guests (system-wide: hide, by-user: show)', async () => {\n            meta.config.hideEmail = 1;\n            meta.config.hideFullname = 1;\n\n            await assertPrivacy({ v3Api: false });\n        });\n\n        it('should hide from unprivileged users (system-wide: hide, by-user: show)', async () => {\n            await assertPrivacy({ v3Api: false, jar: regularUserJar });\n            await assertPrivacy({ v3Api: true, jar: regularUserJar });\n        });\n\n        it('should be visible to self (system-wide: hide, by-user: show)', async () => {\n            await assertPrivacy({ v3Api: false, jar: hidingUserJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: hidingUserJar, expectVisible: true });\n        });\n\n        it('should be visible to privileged users (system-wide: hide, by-user: show)', async () => {\n            await assertPrivacy({ v3Api: false, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: adminJar, expectVisible: true });\n            await assertPrivacy({ v3Api: false, jar: globalModJar, expectVisible: true });\n            await assertPrivacy({ v3Api: true, jar: globalModJar, expectVisible: true });\n        });\n\n        it('should handle array of user data (system-wide: hide)', async () => {\n            const userData = await User.hidePrivateData([hidingUser, regularUser], hidingUser.uid);\n            assert.strictEqual(userData[0].fullname, hidingUser.fullname);\n            assert.strictEqual(userData[0].email, hidingUser.email);\n            assert.strictEqual(userData[1].fullname, '');\n            assert.strictEqual(userData[1].email, '');\n        });\n\n        it('should hide fullname in topic list and topic', (done) => {\n            Topics.post({\n                uid: hidingUser.uid,\n                title: 'Topic hidden',\n                content: 'lorem ipsum',\n                cid: testCid,\n            }, (err) => {\n                assert.ifError(err);\n                request(`${nconf.get('url')}/api/recent`, { json: true }, (err, res, body) => {\n                    assert.ifError(err);\n                    assert(!body.topics[0].user.hasOwnProperty('fullname'));\n                    request(`${nconf.get('url')}/api/topic/${body.topics[0].slug}`, { json: true }, (err, res, body) => {\n                        assert.ifError(err);\n                        assert(!body.posts[0].user.hasOwnProperty('fullname'));\n                        done();\n                    });\n                });\n            });\n        });\n    });\n\n    describe('user blocking methods', (done) => {\n        let blockeeUid;\n        before((done) => {\n            User.create({\n                username: 'blockee',\n                email: 'blockee@example.org',\n                fullname: 'Block me',\n            }, (err, uid) => {\n                blockeeUid = uid;\n                done(err);\n            });\n        });\n\n        describe('.toggle()', () => {\n            it('should toggle block', (done) => {\n                socketUser.toggleBlock({ uid: 1 }, { blockerUid: 1, blockeeUid: blockeeUid }, (err) => {\n                    assert.ifError(err);\n                    User.blocks.is(blockeeUid, 1, (err, blocked) => {\n                        assert.ifError(err);\n                        assert(blocked);\n                        done();\n                    });\n                });\n            });\n\n            it('should toggle block', (done) => {\n                socketUser.toggleBlock({ uid: 1 }, { blockerUid: 1, blockeeUid: blockeeUid }, (err) => {\n                    assert.ifError(err);\n                    User.blocks.is(blockeeUid, 1, (err, blocked) => {\n                        assert.ifError(err);\n                        assert(!blocked);\n                        done();\n                    });\n                });\n            });\n        });\n\n        describe('.add()', () => {\n            it('should block a uid', (done) => {\n                User.blocks.add(blockeeUid, 1, (err) => {\n                    assert.ifError(err);\n                    User.blocks.list(1, (err, blocked_uids) => {\n                        assert.ifError(err);\n                        assert.strictEqual(Array.isArray(blocked_uids), true);\n                        assert.strictEqual(blocked_uids.length, 1);\n                        assert.strictEqual(blocked_uids.includes(blockeeUid), true);\n                        done();\n                    });\n                });\n            });\n\n            it('should automatically increment corresponding user field', (done) => {\n                db.getObjectField('user:1', 'blocksCount', (err, count) => {\n                    assert.ifError(err);\n                    assert.strictEqual(parseInt(count, 10), 1);\n                    done();\n                });\n            });\n\n            it('should error if you try to block the same uid again', (done) => {\n                User.blocks.add(blockeeUid, 1, (err) => {\n                    assert.equal(err.message, '[[error:already-blocked]]');\n                    done();\n                });\n            });\n        });\n\n        describe('.remove()', () => {\n            it('should unblock a uid', (done) => {\n                User.blocks.remove(blockeeUid, 1, (err) => {\n                    assert.ifError(err);\n                    User.blocks.list(1, (err, blocked_uids) => {\n                        assert.ifError(err);\n                        assert.strictEqual(Array.isArray(blocked_uids), true);\n                        assert.strictEqual(blocked_uids.length, 0);\n                        done();\n                    });\n                });\n            });\n\n            it('should automatically decrement corresponding user field', (done) => {\n                db.getObjectField('user:1', 'blocksCount', (err, count) => {\n                    assert.ifError(err);\n                    assert.strictEqual(parseInt(count, 10), 0);\n                    done();\n                });\n            });\n\n            it('should error if you try to unblock the same uid again', (done) => {\n                User.blocks.remove(blockeeUid, 1, (err) => {\n                    assert.equal(err.message, '[[error:already-unblocked]]');\n                    done();\n                });\n            });\n        });\n\n        describe('.is()', () => {\n            before((done) => {\n                User.blocks.add(blockeeUid, 1, done);\n            });\n\n            it('should return a Boolean with blocked status for the queried uid', (done) => {\n                User.blocks.is(blockeeUid, 1, (err, blocked) => {\n                    assert.ifError(err);\n                    assert.strictEqual(blocked, true);\n                    done();\n                });\n            });\n        });\n\n        describe('.list()', () => {\n            it('should return a list of blocked uids', (done) => {\n                User.blocks.list(1, (err, blocked_uids) => {\n                    assert.ifError(err);\n                    assert.strictEqual(Array.isArray(blocked_uids), true);\n                    assert.strictEqual(blocked_uids.length, 1);\n                    assert.strictEqual(blocked_uids.includes(blockeeUid), true);\n                    done();\n                });\n            });\n        });\n\n        describe('.filter()', () => {\n            it('should remove entries by blocked uids and return filtered set', (done) => {\n                User.blocks.filter(1, [{\n                    foo: 'foo',\n                    uid: blockeeUid,\n                }, {\n                    foo: 'bar',\n                    uid: 1,\n                }, {\n                    foo: 'baz',\n                    uid: blockeeUid,\n                }], (err, filtered) => {\n                    assert.ifError(err);\n                    assert.strictEqual(Array.isArray(filtered), true);\n                    assert.strictEqual(filtered.length, 1);\n                    assert.equal(filtered[0].uid, 1);\n                    done();\n                });\n            });\n\n            it('should allow property argument to be passed in to customise checked property', (done) => {\n                User.blocks.filter(1, 'fromuid', [{\n                    foo: 'foo',\n                    fromuid: blockeeUid,\n                }, {\n                    foo: 'bar',\n                    fromuid: 1,\n                }, {\n                    foo: 'baz',\n                    fromuid: blockeeUid,\n                }], (err, filtered) => {\n                    assert.ifError(err);\n                    assert.strictEqual(Array.isArray(filtered), true);\n                    assert.strictEqual(filtered.length, 1);\n                    assert.equal(filtered[0].fromuid, 1);\n                    done();\n                });\n            });\n\n            it('should not process invalid sets', (done) => {\n                User.blocks.filter(1, [{ foo: 'foo' }, { foo: 'bar' }, { foo: 'baz' }], (err, filtered) => {\n                    assert.ifError(err);\n                    assert.strictEqual(Array.isArray(filtered), true);\n                    assert.strictEqual(filtered.length, 3);\n                    filtered.forEach((obj) => {\n                        assert.strictEqual(obj.hasOwnProperty('foo'), true);\n                    });\n                    done();\n                });\n            });\n\n            it('should process plain sets that just contain uids', (done) => {\n                User.blocks.filter(1, [1, blockeeUid], (err, filtered) => {\n                    assert.ifError(err);\n                    assert.strictEqual(filtered.length, 1);\n                    assert.strictEqual(filtered[0], 1);\n                    done();\n                });\n            });\n\n            it('should filter uids that are blocking targetUid', (done) => {\n                User.blocks.filterUids(blockeeUid, [1, 2], (err, filtered) => {\n                    assert.ifError(err);\n                    assert.deepEqual(filtered, [2]);\n                    done();\n                });\n            });\n        });\n    });\n\n    describe('status/online', () => {\n        it('should return offline if user is guest', (done) => {\n            const status = User.getStatus({ uid: 0 });\n            assert.strictEqual(status, 'offline');\n            done();\n        });\n\n        it('should return offline if user is guest', async () => {\n            assert.strictEqual(await User.isOnline(0), false);\n        });\n\n        it('should return true', async () => {\n            assert.strictEqual(await User.isOnline(testUid), true);\n        });\n    });\n\n    describe('isPrivilegedOrSelf', () => {\n        it('should return not error if self', (done) => {\n            User.isPrivilegedOrSelf(1, 1, (err) => {\n                assert.ifError(err);\n                done();\n            });\n        });\n\n        it('should not error if privileged', (done) => {\n            User.create({ username: 'theadmin' }, (err, uid) => {\n                assert.ifError(err);\n                groups.join('administrators', uid, (err) => {\n                    assert.ifError(err);\n                    User.isPrivilegedOrSelf(uid, 2, (err) => {\n                        assert.ifError(err);\n                        done();\n                    });\n                });\n            });\n        });\n\n        it('should error if not privileged', (done) => {\n            User.isPrivilegedOrSelf(0, 1, (err) => {\n                assert.equal(err.message, '[[error:no-privileges]]');\n                done();\n            });\n        });\n    });\n\n    it('should get admins and mods', (done) => {\n        User.getAdminsandGlobalMods((err, data) => {\n            assert.ifError(err);\n            assert(Array.isArray(data));\n            done();\n        });\n    });\n\n    it('should allow user to login even if password is weak', (done) => {\n        User.create({ username: 'weakpwd', password: '123456' }, (err) => {\n            assert.ifError(err);\n            const oldValue = meta.config.minimumPasswordStrength;\n            meta.config.minimumPasswordStrength = 3;\n            helpers.loginUser('weakpwd', '123456', (err) => {\n                assert.ifError(err);\n                meta.config.minimumPasswordStrength = oldValue;\n                done();\n            });\n        });\n    });\n\n    describe('User\\'s', async () => {\n        let files;\n\n        before(async () => {\n            files = await file.walk(path.resolve(__dirname, './user'));\n        });\n\n        it('subfolder tests', () => {\n            files.forEach((filePath) => {\n                require(filePath);\n            });\n        });\n    });\n});\n"}},"projectRoot":"/Users/senfeng/Documents/CMU 2023-2024/17313/fall23-nodebb-softwear","config":{"_comment":"This config was generated using 'stryker init'. Please take a look at: https://stryker-mutator.io/docs/stryker-js/configuration/ for more information.","packageManager":"npm","reporters":["html","clear-text","progress","dashboard"],"testRunner":"mocha","testRunner_comment":"Take a look at (missing 'homepage' URL in package.json) for information about the mocha plugin.","coverageAnalysis":"off","ignorePatterns":["build/public/plugins/nodebb-plugin-emoji","build/public/plugins/nodebb-plugin-markdown/styles","build/public/plugins/nodebb-rewards-essentials/static","test/controllers.js","test/plugins.js","test/build.js","test/search.js","test/upgrade.js"],"mutate":["src/posts/*.js"],"allowConsoleColors":true,"checkers":[],"checkerNodeArgs":[],"commandRunner":{"command":"npm test"},"clearTextReporter":{"allowColor":true,"allowEmojis":false,"logTests":true,"maxTestsToLog":3,"reportTests":true,"reportMutants":true,"reportScoreTable":true},"dashboard":{"baseUrl":"https://dashboard.stryker-mutator.io/api/reports","reportType":"full"},"dryRunOnly":false,"eventReporter":{"baseDir":"reports/mutation/events"},"ignoreStatic":false,"incremental":false,"incrementalFile":"reports/stryker-incremental.json","force":false,"fileLogLevel":"off","inPlace":false,"logLevel":"info","maxConcurrentTestRunners":9007199254740991,"maxTestRunnerReuse":0,"mutator":{"plugins":null,"excludedMutations":[]},"plugins":["@stryker-mutator/*"],"appendPlugins":[],"htmlReporter":{"fileName":"reports/mutation/mutation.html"},"jsonReporter":{"fileName":"reports/mutation/mutation.json"},"disableTypeChecks":true,"symlinkNodeModules":true,"tempDirName":".stryker-tmp","cleanTempDir":true,"testRunnerNodeArgs":[],"thresholds":{"high":80,"low":60,"break":null},"timeoutFactor":1.5,"timeoutMS":5000,"dryRunTimeoutMinutes":5,"tsconfigFile":"tsconfig.json","warnings":true,"disableBail":false,"allowEmpty":false,"ignorers":[],"mochaOptions":{}},"framework":{"name":"StrykerJS","version":"7.3.0","branding":{"homepageUrl":"https://stryker-mutator.io","imageUrl":"data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"},"dependencies":{"@stryker-mutator/mocha-runner":"7.3.0","mocha":"10.2.0","typescript":"4.9.5","webpack":"5.75.0"}}};
      function updateTheme() {
        document.body.style.backgroundColor = app.themeBackgroundColor;
      }
      app.addEventListener('theme-changed', updateTheme);
      updateTheme();
    </script>
  </body>
  </html>